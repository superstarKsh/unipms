/* SBGrid 2.1.	2515.TEST Copyright ⓒ 2015, SoftBowl.co.td All rights reserved */
jQuery.download=function(b,c,d){if(b&&c){c=typeof c=="string"?c:jQuery.param(c);var a="";jQuery.each(c.split("&"),function(){var e=this.split("=");a+='<input type="hidden" name="'+e[0]+'" value="'+e[1]+'" />'});jQuery('<form action="'+b+'" method="'+(d||"post")+'">'+a+"</form>").appendTo("body").submit().remove()}};jQuery.fn.reverse=[].reverse;SBGrid=function(){};SBGrid.getGrid=function(a){if(typeof document.SBHE_allElement=="undefined"){return null}return document.SBHE_allElement.m_htCollection[a]};SBGrid.checkParameter=function(d,a,c,b){if(!(d[a])){if(typeof b!="undefined"){if(c=="Array"){d[a]=[]}else{d[a]=b}}else{SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check '"+a+"' property of SBGrid.",SBGrid.DEF.DEBUG_MODE);return false}}else{if((typeof d[a])!=c){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if '"+a+"' property's type is '"+c+"'.",SBGrid.DEF.DEBUG_MODE);return false}}return true};SBGrid.adjustParam=function(c,b){if(typeof c=="string"){if(b=="boolean"){if(c=="true"){return true}else{if(c=="false"){return false}}}else{if(b=="number"){var a=parseInt(c);if(!isNaN(a)){return a}}}}return c};SBGrid.create=function(e){if(arguments.length!=1){SBGrid.DEF.APIerrorMsg("SBGrid.create","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof e!="object"){SBGrid.DEF.APIerrorMsg("SBGrid.create","Please check if parameter's type is 'object'.",SBGrid.DEF.DEBUG_MODE);return}else{var l={};for(var n in e){switch(n){case"strParentId":l.parent=e[n];break;case"strId":l.id=e[n];break;case"strTheme":l.theme=e[n];break;case"strAlert":l.alert=e[n];break;case"strHelp":l.help=e[n];break;case"strHint":l.hint=e[n];break;case"bAllowBigSelection":l.allowbigselection=SBGrid.adjustParam(e[n],"boolean");break;case"bAllowSelection":l.allowselection=SBGrid.adjustParam(e[n],"boolean");break;case"bIsTextareaScroll":l.istextareascroll=SBGrid.adjustParam(e[n],"boolean");break;case"bOneClickEdit":l.oneclickedit=SBGrid.adjustParam(e[n],"boolean");break;case"bAllowUserResize":l.allowuserresize=SBGrid.adjustParam(e[n],"boolean");break;case"bAutoResize":l.autoresize=SBGrid.adjustParam(e[n],"boolean");break;case"bAutoSizeMouse":l.autosizemouse=SBGrid.adjustParam(e[n],"boolean");break;case"bAutoResizeCaption":l.autoresizecaption=SBGrid.adjustParam(e[n],"boolean");break;case"strBackColorAlternate":l.backcoloralternate=e[n];break;case"strBackColorFrozen":l.backcolorfrozen=e[n];break;case"strCaption":l.caption=e[n];break;case"strColSep":l.colsep=e[n];break;case"strColWidth":l.colwidth=e[n];break;case"strDataType":l.datatype=e[n];break;case"nDefaultRows":l.defaultrows=SBGrid.adjustParam(e[n],"number");break;case"bDisabled":l.disabled=SBGrid.adjustParam(e[n],"boolean");break;case"bDragMode":l.dragmode=SBGrid.adjustParam(e[n],"boolean");break;case"bDropmode":l.dropmode=SBGrid.adjustParam(e[n],"boolean");break;case"bEllipsis":l.ellipsis=SBGrid.adjustParam(e[n],"boolean");break;case"strExplorerbar":l.explorerbar=e[n];break;case"strExplorerUI":l.explorerui=e[n];break;case"strExtendLastCol":l.extendlastcol=e[n];break;case"nFixedCols":l.fixedcols=SBGrid.adjustParam(e[n],"number");break;case"strFocusColor":l.focuscolor=e[n];break;case"strForeColorFrozen":l.forecolorfrozen=e[n];break;case"nFrozenBottomRows":l.frozenbottomrows=SBGrid.adjustParam(e[n],"number");break;case"nFrozenCols":l.frozencols=SBGrid.adjustParam(e[n],"number");break;case"nFrozenRows":l.frozenrows=SBGrid.adjustParam(e[n],"number");break;case"strMergeCellsFixedRows":l.mergecellsfixedrows=e[n];break;case"bMultiTotal":l.multitotal=SBGrid.adjustParam(e[n],"boolean");break;case"strNodeSet":l.nodeset=e[n];break;case"strJsonRef":l.jsonref=e[n];break;case"bRemoveHScroll":l.removehscroll=SBGrid.adjustParam(e[n],"boolean");break;case"bRemoveVScroll":l.removevscroll=SBGrid.adjustParam(e[n],"boolean");break;case"nRows":l.rows=SBGrid.adjustParam(e[n],"number");break;case"strRowSep":l.rowsep=e[n];break;case"strSelectFontColor":l.selectfontcolor=e[n];break;case"strSelectFontColorStyle":l.selectfontcolorstyle=e[n];break;case"strSelectImageStyle":l.selectimagestyle=e[n];break;case"strSelectMode":l.selectmode=e[n];break;case"strSubTotalPosition":l.subtotalposition=e[n];break;case"strStyle":l.style=e[n];break;case"strToolTip":l.tooltip=e[n];break;case"strVisibility":l.visibility=e[n];break;case"bIsDecimalFormatInsert":l.isdecimalformatinsert=SBGrid.adjustParam(e[n],"boolean");break;case"strUserDefineAttrib":l.userdefineattrib=e[n];break;case"strSummary":l.summary=e[n];break;case"strDataReplace":l.datareplace=e[n];break;case"bIsDataReplaceValueChanged":l.isdatareplacevaluechanged=SBGrid.adjustParam(e[n],"boolean");break;case"strDataHeight":l.dataheight=e[n];break;case"strRowHeader":l.rowheader=e[n];break;case"strRowHeight":l.rowheight=e[n];break;case"strDeleteFlagImage":l.deleteflagimage=e[n];break;case"strInsertFlagImage":l.insertflagimage=e[n];break;case"strNormalFlagImage":l.normalflagimage=e[n];break;case"strUpdateFlagImage":l.updateflagimage=e[n];break;case"strEmptyRecords":l.emptyrecords=e[n];break;case"strEmptyRecordsFontStyle":l.emptyrecordsfontstyle=e[n];break;case"nRenderingRows":l.renderingrows=SBGrid.adjustParam(e[n],"number");break;case"bAllowCopy":l.allowcopy=SBGrid.adjustParam(e[n],"boolean");break;case"bCellsInfoDisplay":l.cellsinfodisplay=SBGrid.adjustParam(e[n],"boolean");break;case"bAllowPaste":l.allowpaste=SBGrid.adjustParam(e[n],"boolean");break;case"bContextMenu":l.contextmenu=SBGrid.adjustParam(e[n],"boolean");break;case"arContextMenuList":l.contextmenulist=e[n];break;case"arCalcParam":l.calcparam=e[n];break;case"bDataSearching":l.datasearching=SBGrid.adjustParam(e[n],"boolean");break;case"bAutoSavePsnlData":l.autosavepsnldata=SBGrid.adjustParam(e[n],"boolean");break;case"strPsnlDataId":l.psnldataid=e[n];break;case"bUseWebAccess":l.usewebaccess=SBGrid.adjustParam(e[n],"boolean");break;case"strGridSummary":l.gridsummary=e[n];break;case"strUserCaption":l.usercaption=e[n];break;case"strBeforeElementId":l.beforeelementid=e[n];break;case"strNextElementId":l.nextelementid=e[n];break;case"bRealDataSync":l.realdatasync=SBGrid.adjustParam(e[n],"boolean");break;case"arExtRefList":l.extreflist=e[n];break;case"nScrollingDelayTime":l.scrollingdelaytime=SBGrid.adjustParam(e[n],"number");break;case"bIsShowLoadingImage":l.isshowloadingimage=SBGrid.adjustParam(e[n],"boolean");break;case"bUseMultiSorting":l.usemultisorting=SBGrid.adjustParam(e[n],"boolean");break;case"bIsSortFrozenBottomRows":l.issortfrozenbottomrows=SBGrid.adjustParam(e[n],"boolean");break;case"bComboDataSync":l.combodatasync=SBGrid.adjustParam(e[n],"boolean");break;case"bUseFrozenSelect":l.usefrozenselect=SBGrid.adjustParam(e[n],"boolean");break;case"bIsSortFrozenRows":l.sortfrozenrows=SBGrid.adjustParam(e[n],"boolean");break;case"allowbigselection":l.allowbigselection=SBGrid.adjustParam(e[n],"boolean");break;case"allowselection":l.allowselection=SBGrid.adjustParam(e[n],"boolean");break;case"istextareascroll":l.istextareascroll=SBGrid.adjustParam(e[n],"boolean");break;case"oneclickedit":l.oneclickedit=SBGrid.adjustParam(e[n],"boolean");break;case"allowuserresize":l.allowuserresize=SBGrid.adjustParam(e[n],"boolean");break;case"autoresize":l.autoresize=SBGrid.adjustParam(e[n],"boolean");break;case"autosizemouse":l.autosizemouse=SBGrid.adjustParam(e[n],"boolean");break;case"autoresizecaption":l.autoresizecaption=SBGrid.adjustParam(e[n],"boolean");break;case"defaultrows":l.defaultrows=SBGrid.adjustParam(e[n],"number");break;case"disabled":l.disabled=SBGrid.adjustParam(e[n],"boolean");break;case"dragmode":l.dragmode=SBGrid.adjustParam(e[n],"boolean");break;case"dropmode":l.dropmode=SBGrid.adjustParam(e[n],"boolean");break;case"ellipsis":l.ellipsis=SBGrid.adjustParam(e[n],"boolean");break;case"fixedcols":l.fixedcols=SBGrid.adjustParam(e[n],"number");break;case"frozenbottomrows":l.frozenbottomrows=SBGrid.adjustParam(e[n],"number");break;case"frozencols":l.frozencols=SBGrid.adjustParam(e[n],"number");break;case"frozenrows":l.frozenrows=SBGrid.adjustParam(e[n],"number");break;case"multitotal":l.multitotal=SBGrid.adjustParam(e[n],"boolean");break;case"removehscroll":l.removehscroll=SBGrid.adjustParam(e[n],"boolean");break;case"removevscroll":l.removevscroll=SBGrid.adjustParam(e[n],"boolean");break;case"rows":l.rows=SBGrid.adjustParam(e[n],"number");break;case"isdecimalformatinsert":l.isdecimalformatinsert=SBGrid.adjustParam(e[n],"boolean");break;case"isdatareplacevaluechanged":l.isdatareplacevaluechanged=SBGrid.adjustParam(e[n],"boolean");break;case"renderingrows":l.renderingrows=SBGrid.adjustParam(e[n],"number");break;case"allowcopy":l.allowcopy=SBGrid.adjustParam(e[n],"boolean");break;case"cellsinfodisplay":l.cellsinfodisplay=SBGrid.adjustParam(e[n],"boolean");break;case"allowpaste":l.allowpaste=SBGrid.adjustParam(e[n],"boolean");break;case"contextmenu":l.contextmenu=SBGrid.adjustParam(e[n],"boolean");break;case"datasearching":l.datasearching=SBGrid.adjustParam(e[n],"boolean");break;case"autosavepsnldata":l.autosavepsnldata=SBGrid.adjustParam(e[n],"boolean");break;case"usewebaccess":l.usewebaccess=SBGrid.adjustParam(e[n],"boolean");break;case"realdatasync":l.realdatasync=SBGrid.adjustParam(e[n],"boolean");break;case"isshowloadingimage":l.isshowloadingimage=SBGrid.adjustParam(e[n],"boolean");break;case"usemultisorting":l.usemultisorting=SBGrid.adjustParam(e[n],"boolean");break;case"issortfrozenbottomrows":l.issortfrozenbottomrows=SBGrid.adjustParam(e[n],"boolean");break;case"combodatasync":l.combodatasync=SBGrid.adjustParam(e[n],"boolean");break;case"scrollingdelaytime":l.scrollingdelaytime=SBGrid.adjustParam(e[n],"number");break;case"usefrozenselect":l.usefrozenselect=SBGrid.adjustParam(e[n],"boolean");break;case"sortfrozenrows":l.sortfrozenrows=SBGrid.adjustParam(e[n],"boolean");break;case"cellFocusColor":l.cellFocusColor=e[n];break;case"columns":l.columns=[];for(var f=0;f<e.columns.length;f++){var a=e.columns[f];var b={};for(var c in a){switch(c){case"allowuserresizewidth":b.allowUserResizeWidth=a[c];break;case"checkboxvalidate":b.checkboxValidate=a[c];break;case"textareawidth":b.textareaWidth=SBGrid.adjustParam(a[c],"number");break;case"datamerge":b.bDataMerge=SBGrid.adjustParam(a[c],"boolean");break;case"iscolhidden":b.bIsColHidden=SBGrid.adjustParam(a[c],"boolean");break;case"imageuri":b.imageUri=a[c];break;case"imagewidth":b.imageWidth=SBGrid.adjustParam(a[c],"number");break;case"imageheight":b.imageHeight=SBGrid.adjustParam(a[c],"number");break;case"imagestyle":b.imageStyle=a[c];break;case"imagealt":b.imageAlt=a[c];break;case"nodeset":b.strNodeSet=a[c];break;case"jsonnodeset":b.strJsonNodeSet=a[c];break;case"labelref":b.strLabelRef=a[c];break;case"valueref":b.strValueRef=a[c];break;case"roundmode":b.roundMode=a[c];break;case"roundposition":b.roundPosition=SBGrid.adjustParam(a[c],"number");break;case"secretmark":b.secretMark=a[c];break;case"secretstartposition":b.secretStartPosition=SBGrid.adjustParam(a[c],"number");break;case"secretendposition":b.secretEndPosition=SBGrid.adjustParam(a[c],"number");break;case"skipautoresize":b.bSkipAutoResize=SBGrid.adjustParam(a[c],"boolean");break;case"afterrenderer":b.afterRenderer=a[c];break;case"fixedrenderer":b.fixedRenderer=a[c];break;case"iscombofiltering":b.bIsComboFiltering=SBGrid.adjustParam(a[c],"boolean");break;case"combofilteringinfolist":b.arrComboFilteringInfoList=a[c];break;case"maxlength":b.maxlength=SBGrid.adjustParam(a[c],"number");break;case"disabled":b.disabled=SBGrid.adjustParam(a[c],"boolean");break;case"autonext":b.autonext=SBGrid.adjustParam(a[c],"boolean");break;case"visibility":b.bIsColHidden=a[c]=="hidden"?true:false;break;default:b[c]=a[c];break}}l.columns.push(b)}break;default:l[n]=e[n];break}}if(!SBGrid.checkParameter(l,"parent","string")){return}if(!document.getElementById(l.parent)){if(!document.getElementById("SBHE_"+l.parent)){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check 'parent' property of SBGrid.",SBGrid.DEF.DEBUG_MODE);return}}if(!SBGrid.checkParameter(l,"id","string")){return}if(SBGrid.getGrid(l.id)){SBGrid.getGrid(l.id).destroy()}if(!SBGrid.checkParameter(l,"theme","string","")){return}var d=document.getElementById(l.parent);if(d==null){d=document.getElementById("SBHE_"+l.parent)}if(d.tagName=="BODY"||l.parent=="body"){SBGrid.CT.DataGrid.initEngine(l.parent,l.theme)}else{if(d.tagName=="DIV"){var o="body";if(document.body.id!=null&&document.body.id!=""){o=document.body.id}else{document.body.id=o}SBGrid.CT.DataGrid.initEngine(o,l.theme);var g=SBGrid.DS.SBBody.createChild("softbowl:DIV","id:"+l.parent)}}if(!SBGrid.checkParameter(l,"alert","string","")){return}if(!SBGrid.checkParameter(l,"help","string","")){return}if(!SBGrid.checkParameter(l,"hint","string","")){return}if(!SBGrid.checkParameter(l,"allowbigselection","boolean",false)){return}if(!SBGrid.checkParameter(l,"allowselection","boolean",true)){return}if(!SBGrid.checkParameter(l,"istextareascroll","boolean",true)){return}if(!SBGrid.checkParameter(l,"oneclickedit","boolean",false)){return}if(!SBGrid.checkParameter(l,"usefrozenselect","boolean",true)){return}if(!SBGrid.checkParameter(l,"allowuserresize","boolean",true)){return}if(!SBGrid.checkParameter(l,"autoresize","boolean",false)){return}if(!SBGrid.checkParameter(l,"autosizemouse","boolean",false)){return}if(!SBGrid.checkParameter(l,"autoresizecaption","boolean",false)){return}if(!SBGrid.checkParameter(l,"backcoloralternate","string","")){return}if(!SBGrid.checkParameter(l,"sortfrozenrows","boolean",true)){return}if(!SBGrid.checkParameter(l,"cellFocusColor","string","")){return}if(l.backcoloralternate=="transparent"){l.backcoloralternate=""}if(!SBGrid.checkParameter(l,"backcolorfrozen","string","")){return}if(!SBGrid.checkParameter(l,"caption","string")){return}if(!SBGrid.checkParameter(l,"colsep","string","^")){return}if(!SBGrid.checkParameter(l,"colwidth","string","")){return}if(l.colwidth==""){var m=l.caption.split("^");for(var f=1;f<=m.length;f++){l.colwidth+="100";if(f==m.length){break}l.colwidth+=","}}else{l.colwidth=l.colwidth.replace(/ /g,"")}if(!SBGrid.checkParameter(l,"datatype","string","xml")){return}if(!SBGrid.checkParameter(l,"defaultrows","number",0)){return}if(!SBGrid.checkParameter(l,"disabled","boolean",false)){return}if(!SBGrid.checkParameter(l,"dragmode","boolean",true)){return}if(!SBGrid.checkParameter(l,"dropmode","boolean",false)){return}if(!SBGrid.checkParameter(l,"ellipsis","boolean",false)){return}if(!SBGrid.checkParameter(l,"explorerbar","string","")){return}if(!SBGrid.checkParameter(l,"explorerui","string","")){return}if(!SBGrid.checkParameter(l,"extendlastcol","string","false")){return}if(!SBGrid.checkParameter(l,"fixedcols","number",0)){return}if(!SBGrid.checkParameter(l,"focuscolor","string","")){return}if(!SBGrid.checkParameter(l,"forecolorfrozen","string","")){return}if(!SBGrid.checkParameter(l,"frozenbottomrows","number",0)){return}if(!SBGrid.checkParameter(l,"frozencols","number",0)){return}if(!SBGrid.checkParameter(l,"frozenrows","number",0)){return}if(!SBGrid.checkParameter(l,"mergecellsfixedrows","string","bycolrec")){return}if(!SBGrid.checkParameter(l,"multitotal","boolean",true)){return}if(!SBGrid.checkParameter(l,"nodeset","string","")){return}if(l.nodeset!=""){l.jsonref=""}if(!SBGrid.checkParameter(l,"jsonref","string","")){return}if(l.jsonref!=""){l.nodeset=""}if(!SBGrid.checkParameter(l,"removehscroll","boolean",false)){return}if(!SBGrid.checkParameter(l,"removevscroll","boolean",false)){return}if(!SBGrid.checkParameter(l,"rows","number",0)){return}if(!SBGrid.checkParameter(l,"rowsep","string","|")){return}if(!SBGrid.checkParameter(l,"selectfontcolor","string","")){return}if(!SBGrid.checkParameter(l,"selectfontcolorstyle","string","invert")){return}if(!SBGrid.checkParameter(l,"selectimagestyle","string","invert")){return}if(!SBGrid.checkParameter(l,"selectmode","string","listbox")){return}if(!SBGrid.checkParameter(l,"subtotalposition","string","above")){return}if(!SBGrid.checkParameter(l,"style","string")){return}if(!SBGrid.checkParameter(l,"tooltip","string","")){return}if(!SBGrid.checkParameter(l,"visibility","string","visible")){return}if(!SBGrid.checkParameter(l,"isdecimalformatinsert","boolean",false)){return}if(!SBGrid.checkParameter(l,"userdefineattrib","string","automerge:false;")){return}if(!SBGrid.checkParameter(l,"summary","string","")){return}if(!SBGrid.checkParameter(l,"datareplace","string","undefined")){return}if(!SBGrid.checkParameter(l,"isdatareplacevaluechanged","boolean",false)){return}if(!SBGrid.checkParameter(l,"dataheight","string","")){return}if(!SBGrid.checkParameter(l,"rowheader","string","")){return}if(!SBGrid.checkParameter(l,"rowheight","string","")){return}if(!SBGrid.checkParameter(l,"deleteflagimage","string","")){return}if(!SBGrid.checkParameter(l,"insertflagimage","string","")){return}if(!SBGrid.checkParameter(l,"normalflagimage","string","")){return}if(!SBGrid.checkParameter(l,"updateflagimage","string","")){return}if(!SBGrid.checkParameter(l,"emptyrecords","string","")){return}if(!SBGrid.checkParameter(l,"emptyrecordsfontstyle","string","")){return}if(!SBGrid.checkParameter(l,"renderingrows","number",null)){return}if(!SBGrid.checkParameter(l,"allowcopy","boolean",false)){return}if(!SBGrid.checkParameter(l,"cellsinfodisplay","boolean",false)){return}if(!SBGrid.checkParameter(l,"allowpaste","boolean",false)){return}if(!SBGrid.checkParameter(l,"contextmenu","boolean",false)){return}if(!SBGrid.checkParameter(l,"contextmenulist","Array","[]")){return}if(!SBGrid.checkParameter(l,"calcparam","Array","[]")){return}if(!SBGrid.checkParameter(l,"datasearching","boolean",false)){return}if(!SBGrid.checkParameter(l,"autosavepsnldata","boolean",false)){return}if(!SBGrid.checkParameter(l,"psnldataid","string","")){return}if(!SBGrid.checkParameter(l,"usewebaccess","boolean",false)){return}if(!SBGrid.checkParameter(l,"gridsummary","string","")){return}if(!SBGrid.checkParameter(l,"usercaption","string","")){return}if(!SBGrid.checkParameter(l,"beforeelementid","string","")){return}if(!SBGrid.checkParameter(l,"nextelementid","string","")){return}if(!SBGrid.checkParameter(l,"realdatasync","boolean",true)){return}if(!SBGrid.checkParameter(l,"extreflist","Array","[]")){return}if(!SBGrid.checkParameter(l,"scrollingdelaytime","number",200)){return}if(l.scrollingdelaytime<0){l.scrollingdelaytime=200}if(!SBGrid.checkParameter(l,"isshowloadingimage","boolean",true)){return}if(!SBGrid.checkParameter(l,"usemultisorting","boolean",false)){return}if(!SBGrid.checkParameter(l,"issortfrozenbottomrows","boolean",true)){return}if(!SBGrid.checkParameter(l,"combodatasync","boolean",false)){return}switch(l.theme){case"metal":SBGrid.DEF.imgWait="kr/co/softbowl/imageMetal/datagrid/wait_Metal.png";SBGrid.DEF.imgCheck="kr/co/softbowl/imageMetal/checkbox/check.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/imageMetal/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/imageMetal/radio/radio.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/imageMetal/radio/unradio.png";SBGrid.DEF.imgButton="kr/co/softbowl/imageMetal/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/imageMetal/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/imageMetal/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/imageMetal/treeview/uncheck.gif";SBGrid.DEF.imgUnCheck="kr/co/softbowl/imageMetal/checkbox/uncheck.png";SBGrid.DEF.imgRHDelete="kr/co/softbowl/imageMetal/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/imageMetal/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/imageMetal/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/imageMetal/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/imageMetal/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/imageMetal/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/imageMetal/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/imageMetal/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/imageMetal/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/imageMetal/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/imageMetal/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/imageMetal/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/imageMetal/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/imageMetal/radio/disunradio.png";break;case"blue":SBGrid.DEF.imgWait="kr/co/softbowl/imageBlue/datagrid/wait.png";SBGrid.DEF.imgCheck="kr/co/softbowl/imageBlue/checkbox/checkBlue.png";SBGrid.DEF.imgUnCheck="kr/co/softbowl/imageBlue/checkbox/uncheckBlue.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/imageBlue/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/imageBlue/radio/radioBlue.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/imageBlue/radio/unradioBlue.png";SBGrid.DEF.imgButton="kr/co/softbowl/imageBlue/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/imageBlue/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/imageBlue/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/imageBlue/treeview/uncheck.gif";SBGrid.DEF.imgRHDelete="kr/co/softbowl/imageBlue/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/imageBlue/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/imageBlue/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/imageBlue/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/imageBlue/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/imageBlue/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/imageBlue/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/imageBlue/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/imageBlue/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/imageBlue/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/imageBlue/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/imageBlue/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/imageBlue/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/imageBlue/radio/disunradio.png";break;case"gray":SBGrid.DEF.imgWait="kr/co/softbowl/imageGray/datagrid/wait.png";SBGrid.DEF.imgCheck="kr/co/softbowl/imageGray/checkbox/check_gray.png";SBGrid.DEF.imgUnCheck="kr/co/softbowl/imageGray/checkbox/uncheck_gray.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/imageGray/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/imageGray/radio/radio_gray.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/imageGray/radio/unradio_gray.png";SBGrid.DEF.imgButton="kr/co/softbowl/imageGray/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/imageGray/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/imageGray/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/imageGray/treeview/uncheck.gif";SBGrid.DEF.imgRHDelete="kr/co/softbowl/imageGray/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/imageGray/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/imageGray/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/imageGray/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/imageGray/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/imageGray/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/imageGray/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/imageGray/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/imageGray/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/imageGray/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/imageGray/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/imageGray/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/imageGray/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/imageGray/radio/disunradio.png";break;case"pink":SBGrid.DEF.imgWait="kr/co/softbowl/imagePink/datagrid/wait_pink.png";SBGrid.DEF.imgCheck="kr/co/softbowl/imagePink/checkbox/check_pink.png";SBGrid.DEF.imgUnCheck="kr/co/softbowl/imagePink/checkbox/uncheck_pink.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/imagePink/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/imagePink/radio/radio_pink.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/imagePink/radio/unradio_pink.png";SBGrid.DEF.imgButton="kr/co/softbowl/imagePink/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/imagePink/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/imagePink/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/imagePink/treeview/uncheck.gif";SBGrid.DEF.imgRHDelete="kr/co/softbowl/imagePink/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/imagePink/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/imagePink/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/imagePink/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/imagePink/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/imagePink/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/imagePink/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/imagePink/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/imagePink/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/imagePink/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/imagePink/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/imagePink/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/imagePink/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/imagePink/radio/disunradio.png";break;case"desert":SBGrid.DEF.imgWait="kr/co/softbowl/imageDesert/datagrid/wait_desert.png";SBGrid.DEF.imgCheck="kr/co/softbowl/imageDesert/checkbox/check_desert.png";SBGrid.DEF.imgUnCheck="kr/co/softbowl/imageDesert/checkbox/uncheck_desert.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/imageDesert/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/imageDesert/radio/radio_desert.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/imageDesert/radio/unradio_desert.png";SBGrid.DEF.imgButton="kr/co/softbowl/imageDesert/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/imageDesert/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/imageDesert/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/imageDesert/treeview/uncheck.gif";SBGrid.DEF.imgRHDelete="kr/co/softbowl/imageDesert/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/imageDesert/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/imageDesert/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/imageDesert/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/imageDesert/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/imageDesert/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/imageDesert/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/imageDesert/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/imageDesert/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/imageDesert/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/imageDesert/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/imageDesert/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/imageDesert/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/imageDesert/radio/disunradio.png";break;case"pastelblue":SBGrid.DEF.imgWait="kr/co/softbowl/imagePastelBlue/datagrid/wait_pastelblue.png";SBGrid.DEF.imgCheck="kr/co/softbowl/imagePastelBlue/checkbox/check_pastelblue.png";SBGrid.DEF.imgUnCheck="kr/co/softbowl/imagePastelBlue/checkbox/uncheck_pastelblue.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/imagePastelBlue/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/imagePastelBlue/radio/radio_pastelblue.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/imagePastelBlue/radio/unradio_pastelblue.png";SBGrid.DEF.imgButton="kr/co/softbowl/imagePastelBlue/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/imagePastelBlue/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/imagePastelBlue/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/imagePastelBlue/treeview/uncheck.gif";SBGrid.DEF.imgRHDelete="kr/co/softbowl/imagePastelBlue/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/imagePastelBlue/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/imagePastelBlue/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/imagePastelBlue/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/imagePastelBlue/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/imagePastelBlue/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/imagePastelBlue/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/imagePastelBlue/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/imagePastelBlue/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/imagePastelBlue/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/imagePastelBlue/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/imagePastelBlue/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/imagePastelBlue/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/imagePastelBlue/radio/disunradio.png";break;case"claret":SBGrid.DEF.imgWait="kr/co/softbowl/imageClaret/datagrid/wait_pastelblue.png";SBGrid.DEF.imgCheck="kr/co/softbowl/imageClaret/checkbox/check_pastelblue.png";SBGrid.DEF.imgUnCheck="kr/co/softbowl/imageClaret/checkbox/uncheck_pastelblue.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/imageClaret/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/imageClaret/radio/radio_pastelblue.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/imageClaret/radio/unradio_pastelblue.png";SBGrid.DEF.imgButton="kr/co/softbowl/imageClaret/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/imageClaret/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/imageClaret/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/imageClaret/treeview/uncheck.gif";SBGrid.DEF.imgRHDelete="kr/co/softbowl/imageClaret/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/imageClaret/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/imageClaret/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/imageClaret/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/imageClaret/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/imageClaret/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/imageClaret/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/imageClaret/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/imageClaret/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/imageClaret/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/imageClaret/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/imageClaret/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/imageClaret/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/imageClaret/radio/disunradio.png";break;default:SBGrid.DEF.imgWait="kr/co/softbowl/image/datagrid/wait.gif";SBGrid.DEF.imgCheck="kr/co/softbowl/image/checkbox/check.png";SBGrid.DEF.imgUnCheck="kr/co/softbowl/image/checkbox/uncheck.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/image/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/image/radio/radio.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/image/radio/unradio.png";SBGrid.DEF.imgButton="kr/co/softbowl/image/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/image/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/image/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/image/treeview/uncheck.gif";SBGrid.DEF.imgRHDelete="kr/co/softbowl/image/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/image/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/image/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/image/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/image/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/image/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/image/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/image/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/image/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/image/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/image/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/image/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/image/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/image/radio/disunradio.png"}var h=new SBGrid.CT.DataGrid(l.parent,l.alert,l.help,l.hint,l.allowbigselection,l.allowselection,l.allowuserresize,l.autoresize,l.autosizemouse,l.backcoloralternate,l.backcolorfrozen,l.caption,l.captionlayout,l["class"],l.colsep,l.colwidth,l.dataheight,l.datatype,l.defaultrows,l.deleteflagimage,l.disabled,l.dragmode,l.dropmode,l.ellipsis,l.explorerbar,l.explorerui,l.extendlastcol,l.fixedcols,l.focuscolor,l.forecolorfrozen,l.frozenbottomrows,l.frozencols,l.frozenrows,l.id,l.insertflagimage,l.mergecells,l.mergecellsfixedcols,l.mergecellsfixedrows,l.multitotal,l.nodeset,l.jsonref,l.normalflagimage,l.overflow,l.removehscroll,l.removevscroll,l.rowheader,l.rowheight,l.rows,l.rowsep,l.scroll,l.selectfontcolor,l.selectfontcolorstyle,l.selectimagestyle,l.selectmode,l.subtotalposition,l.style,"softbowl:datagrid",l.tooltip,l.updateflagimage,l.visibility,l.wallpaper,l.isdecimalformatinsert,l.userdefineattrib,l.summary,l.autoresizecaption,l.datareplace,l.isdatareplacevaluechanged,l.ready,l.gridready,l.emptyrecords,l.emptyrecordsfontstyle,l.theme,l.createall,l.renderingrows,l.allowcopy,l.allowpaste,l.beforeelementid,l.nextelementid,l.realdatasync,l.extreflist,l.scrollingdelaytime,l.contextmenu,l.datasearching,l.isshowloadingimage,l.autosavepsnldata,l.psnldataid,l.contextmenulist,l.istextareascroll,l.usemultisorting,l.sortfrozenrows,l.issortfrozenbottomrows,l.gridsummary,l.usercaption,l.usewebaccess,l.calcparam,l.combodatasync,l.cellsinfodisplay,l.oneclickedit,l.usefrozenselect,l.cellFocusColor);if(l.columns){h.createColumns(l.columns)}return h}};SBGrid.DEF=function(){};SBGrid.UT=function(){};SBGrid.CT=function(){};SBGrid.DS=function(){};SBGrid.US=null;SBGrid.DEF.__LANGUAGE="kr";SBGrid.DEF.__chromeFrame=false;SBGrid.DEF.__useBinding=false;var agt=navigator.userAgent.toLowerCase();SBGrid.DEF.is_major=parseInt(navigator.appVersion);SBGrid.DEF.is_minor=parseFloat(navigator.appVersion);SBGrid.DEF.is_moz=((agt.indexOf("mozilla")!=-1)&&(agt.indexOf("spoofer")==-1)&&(agt.indexOf("compatible")==-1)&&(agt.indexOf("opera")==-1)&&(agt.indexOf("webtv")==-1)&&(agt.indexOf("hotjava")==-1));SBGrid.DEF.is_moz2=(SBGrid.DEF.is_moz&&(SBGrid.DEF.is_major==2));SBGrid.DEF.is_moz3=(SBGrid.DEF.is_moz&&(SBGrid.DEF.is_major==3));SBGrid.DEF.is_moz4=(SBGrid.DEF.is_moz&&(SBGrid.DEF.is_major==4));SBGrid.DEF.is_gecko=(agt.indexOf("gecko")!=-1);SBGrid.DEF.is_firefox=(agt.indexOf("firefox")!=-1);SBGrid.DEF.is_nav2=SBGrid.DEF.is_moz2;SBGrid.DEF.is_nav3=SBGrid.DEF.is_moz3;SBGrid.DEF.is_nav4=SBGrid.DEF.is_moz4;SBGrid.DEF.is_nav4up=(SBGrid.DEF.is_nav4||((SBGrid.DEF.is_major>=4)&&(agt.indexOf("netscape")!=-1)));SBGrid.DEF.is_nav=(SBGrid.DEF.is_nav2||SBGrid.DEF.is_nav3||SBGrid.DEF.is_nav4);SBGrid.DEF.is_mozilla=(SBGrid.DEF.is_moz&&SBGrid.DEF.is_gecko);SBGrid.DEF.is_mozilla1=(SBGrid.DEF.is_moz&&SBGrid.DEF.is_gecko&&(agt.indexOf("rv:1")!=-1));SBGrid.DEF.is_ie=((agt.indexOf("msie")!=-1)&&(agt.indexOf("opera")==-1));SBGrid.DEF.is_ie6=(SBGrid.DEF.is_ie&&(SBGrid.DEF.is_major==4)&&(agt.indexOf("msie 6.")!=-1));SBGrid.DEF.is_ie7=(SBGrid.DEF.is_ie&&(SBGrid.DEF.is_major==4)&&(agt.indexOf("msie 7.")!=-1)&&navigator.userAgent.indexOf("Trident")==-1);if(SBGrid.DEF.is_ie7){SBGrid.DEF.is_ie6=false}SBGrid.DEF.is_ie8=(SBGrid.DEF.is_ie&&(SBGrid.DEF.is_major==4)&&((agt.indexOf("msie 8.")!=-1)||((agt.indexOf("msie 7.")!=-1)&&(navigator.userAgent.indexOf("Trident")!=-1))));if(SBGrid.DEF.is_ie8){SBGrid.DEF.is_ie6=false;SBGrid.DEF.is_ie7=false}SBGrid.DEF.is_ie9=(SBGrid.DEF.is_ie&&(SBGrid.DEF.is_major==5)&&(agt.indexOf("msie 9.")!=-1));if(SBGrid.DEF.is_ie9){SBGrid.DEF.is_ie6=false;SBGrid.DEF.is_ie7=false;SBGrid.DEF.is_ie8=false;SBGrid.DEF.is_ie10=false}SBGrid.DEF.is_ie10=(SBGrid.DEF.is_ie&&(SBGrid.DEF.is_major==5)&&(agt.indexOf("msie 10.")!=-1));if(SBGrid.DEF.is_ie10){SBGrid.DEF.is_ie6=false;SBGrid.DEF.is_ie7=false;SBGrid.DEF.is_ie8=false;SBGrid.DEF.is_ie9=false}SBGrid.DEF.is_ie11=((SBGrid.DEF.is_major==5)&&(agt.indexOf("trident/7.0")!=-1)&&(agt.indexOf("rv:11.")!=-1));if(SBGrid.DEF.is_ie11){SBGrid.DEF.is_ie6=false;SBGrid.DEF.is_ie7=false;SBGrid.DEF.is_ie8=false;SBGrid.DEF.is_ie9=false;SBGrid.DEF.is_ie10=false}SBGrid.DEF.is_opera=(agt.indexOf("opera")!=-1);SBGrid.DEF.is_safari=((agt.indexOf("safari")!=-1));SBGrid.DEF.is_chrome=!SBGrid.DEF.is_ie&&(agt.indexOf("chrome")!=-1)?true:false;if(SBGrid.DEF.is_chrome){SBGrid.DEF.is_safari=false}SBGrid.DEF.is_crOs=SBGrid.DEF.is_chrome&&(agt.indexOf("csos")!=-1);SBGrid.DEF.is_chromeFrame=!SBGrid.DEF.is_ie&&SBGrid.DEF.is_chrome&&SBGrid.DEF.__chromeFrame;SBGrid.DEF.is_webkit=SBGrid.DEF.is_safari||SBGrid.DEF.is_chrome;SBGrid.DEF.is_mozBrowser=SBGrid.DEF.is_firefox||SBGrid.DEF.is_opera;SBGrid.DEF.is_ipad=(SBGrid.DEF.is_safari&&(agt.indexOf("ipad")!=-1));SBGrid.DEF.is_iphone=(SBGrid.DEF.is_safari&&(agt.indexOf("iphone")!=-1));SBGrid.DEF.is_apple=(SBGrid.DEF.is_ipad||SBGrid.DEF.is_iphone);SBGrid.DEF.is_android=(agt.indexOf("android")!=-1);SBGrid.DEF.is_opera_mini=(agt.indexOf("opera mini")!=-1);SBGrid.DEF.is_smartphone=false;(function(){function ak(b){function a(g,h,l,d,f,m){for(;f>=0&&m>f;f+=b){var c=d?d[f]:f;l=h(l,g[c],c,g)}return l}return function(h,l,f,g){l=av(l,g,4);var m=!ab(h)&&al.keys(h),d=(m||h).length,n=b>0?0:d-1;return arguments.length<3&&(f=h[m?m[n]:n],n+=b),a(h,l,f,m,n,d)}}function ae(a){return function(d,f,g){f=ax(f,g);for(var b=null!=d&&d.length,c=a>0?0:b-1;c>=0&&b>c;c+=a){if(f(d[c],c,d)){return c}}return -1}}function ag(g,c){var d=D.length,f=g.constructor,a=al.isFunction(f)&&f.prototype||aj,b="constructor";for(al.has(g,b)&&!al.contains(c,b)&&c.push(b);d--;){b=D[d],b in g&&g[b]!==a[b]&&!al.contains(c,b)&&c.push(b)}}var au=this,ad=au._,ap=Array.prototype,aj=Object.prototype,ay=Function.prototype,aw=ap.push,am=ap.slice,at=aj.toString,af=aj.hasOwnProperty,ai=Array.isArray,aq=Object.keys,ac=ay.bind,ar=Object.create,Z=function(){},al=function(a){return a instanceof al?a:this instanceof al?void (this._wrapped=a):new al(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=al),exports._=al):au._=al,al.VERSION="1.8.2";var av=function(c,a,b){if(a===void 0){return c}switch(null==b?3:b){case 1:return function(d){return c.call(a,d)};case 2:return function(d,f){return c.call(a,d,f)};case 3:return function(f,g,d){return c.call(a,f,g,d)};case 4:return function(g,h,d,f){return c.call(a,g,h,d,f)}}return function(){return c.apply(a,arguments)}},ax=function(c,a,b){return null==c?al.identity:al.isFunction(c)?av(c,a,b):al.isObject(c)?al.matcher(c):al.property(c)};al.iteratee=function(b,a){return ax(b,a,1/0)};var aa=function(b,a){return function(m){var n=arguments.length;if(2>n||null==m){return m}for(var g=1;n>g;g++){for(var h=arguments[g],p=b(h),f=p.length,q=0;f>q;q++){var d=p[q];a&&m[d]!==void 0||(m[d]=h[d])}}return m}},az=function(b){if(!al.isObject(b)){return{}}if(ar){return ar(b)}Z.prototype=b;var a=new Z;return Z.prototype=null,a},ao=Math.pow(2,53)-1,ab=function(b){var a=b&&b.length;return"number"==typeof a&&a>=0&&ao>=a};al.each=al.forEach=function(g,c,d){c=av(c,d);var f,a;if(ab(g)){for(f=0,a=g.length;a>f;f++){c(g[f],f,g)}}else{var b=al.keys(g);for(f=0,a=b.length;a>f;f++){c(g[b[f]],b[f],g)}}return g},al.map=al.collect=function(m,f,g){f=ax(f,g);for(var h=!ab(m)&&al.keys(m),c=(h||m).length,d=Array(c),l=0;c>l;l++){var b=h?h[l]:l;d[l]=f(m[b],b,m)}return d},al.reduce=al.foldl=al.inject=ak(1),al.reduceRight=al.foldr=ak(-1),al.find=al.detect=function(d,a,b){var c;return c=ab(d)?al.findIndex(d,a,b):al.findKey(d,a,b),c!==void 0&&c!==-1?d[c]:void 0},al.filter=al.select=function(d,a,b){var c=[];return a=ax(a,b),al.each(d,function(g,f,e){a(g,f,e)&&c.push(g)}),c},al.reject=function(c,a,b){return al.filter(c,al.negate(ax(a)),b)},al.every=al.all=function(h,c,d){c=ax(c,d);for(var f=!ab(h)&&al.keys(h),a=(f||h).length,b=0;a>b;b++){var g=f?f[b]:b;if(!c(h[g],g,h)){return !1}}return !0},al.some=al.any=function(h,c,d){c=ax(c,d);for(var f=!ab(h)&&al.keys(h),a=(f||h).length,b=0;a>b;b++){var g=f?f[b]:b;if(c(h[g],g,h)){return !0}}return !1},al.contains=al.includes=al.include=function(c,a,b){return ab(c)||(c=al.values(c)),al.indexOf(c,a,"number"==typeof b&&b)>=0},al.invoke=function(d,a){var b=am.call(arguments,2),c=al.isFunction(a);return al.map(d,function(f){var e=c?a:f[a];return null==e?e:e.apply(f,b)})},al.pluck=function(b,a){return al.map(b,al.property(a))},al.where=function(b,a){return al.filter(b,al.matcher(a))},al.findWhere=function(b,a){return al.find(b,al.matcher(a))},al.max=function(f,q,b){var h,p,g=-1/0,d=-1/0;if(null==q&&null!=f){f=ab(f)?f:al.values(f);for(var m=0,l=f.length;l>m;m++){h=f[m],h>g&&(g=h)}}else{q=ax(q,b),al.each(f,function(i,a,c){p=q(i,a,c),(p>d||p===-1/0&&g===-1/0)&&(g=i,d=p)})}return g},al.min=function(f,q,b){var h,p,g=1/0,d=1/0;if(null==q&&null!=f){f=ab(f)?f:al.values(f);for(var m=0,l=f.length;l>m;m++){h=f[m],g>h&&(g=h)}}else{q=ax(q,b),al.each(f,function(i,a,c){p=q(i,a,c),(d>p||1/0===p&&1/0===g)&&(g=i,d=p)})}return g},al.shuffle=function(g){for(var c,d=ab(g)?g:al.values(g),f=d.length,a=Array(f),b=0;f>b;b++){c=al.random(0,b),c!==b&&(a[b]=a[c]),a[c]=d[b]}return a},al.sample=function(c,a,b){return null==a||b?(ab(c)||(c=al.values(c)),c[al.random(c.length-1)]):al.shuffle(c).slice(0,Math.max(0,a))},al.sortBy=function(c,a,b){return a=ax(a,b),al.pluck(al.map(c,function(g,d,f){return{value:g,index:d,criteria:a(g,d,f)}}).sort(function(h,d){var f=h.criteria,g=d.criteria;if(f!==g){if(f>g||f===void 0){return 1}if(g>f||g===void 0){return -1}}return h.index-d.index}),"value")};var X=function(a){return function(c,d,f){var b={};return d=ax(d,f),al.each(c,function(h,g){var l=d(h,g,c);a(b,h,l)}),b}};al.groupBy=X(function(c,a,b){al.has(c,b)?c[b].push(a):c[b]=[a]}),al.indexBy=X(function(c,a,b){c[b]=a}),al.countBy=X(function(c,a,b){al.has(c,b)?c[b]++:c[b]=1}),al.toArray=function(a){return a?al.isArray(a)?am.call(a):ab(a)?al.map(a,al.identity):al.values(a):[]},al.size=function(a){return null==a?0:ab(a)?a.length:al.keys(a).length},al.partition=function(f,b,c){b=ax(b,c);var d=[],a=[];return al.each(f,function(h,g,e){(b(h,g,e)?d:a).push(h)}),[d,a]},al.first=al.head=al.take=function(c,a,b){return null==c?void 0:null==a||b?c[0]:al.initial(c,c.length-a)},al.initial=function(c,a,b){return am.call(c,0,Math.max(0,c.length-(null==a||b?1:a)))},al.last=function(c,a,b){return null==c?void 0:null==a||b?c[c.length-1]:al.rest(c,Math.max(0,c.length-a))},al.rest=al.tail=al.drop=function(c,a,b){return am.call(c,null==a||b?1:a)},al.compact=function(a){return al.filter(a,al.identity)};var an=function(g,x,b,q){for(var w=[],m=0,d=q||0,v=g&&g.length;v>d;d++){var s=g[d];if(ab(s)&&(al.isArray(s)||al.isArguments(s))){x||(s=an(s,x,b));var h=0,p=s.length;for(w.length+=p;p>h;){w[m++]=s[h++]}}else{b||(w[m++]=s)}}return w};al.flatten=function(b,a){return an(b,a,!1)},al.without=function(a){return al.difference(a,am.call(arguments,1))},al.uniq=al.unique=function(f,v,b,m){if(null==f){return[]}al.isBoolean(v)||(m=b,b=v,v=!1),null!=b&&(b=ax(b,m));for(var s=[],h=[],d=0,q=f.length;q>d;d++){var p=f[d],g=b?b(p,d,f):p;v?(d&&h===g||s.push(p),h=g):b?al.contains(h,g)||(h.push(g),s.push(p)):al.contains(s,p)||s.push(p)}return s},al.union=function(){return al.uniq(an(arguments,!0,!0))},al.intersection=function(h){if(null==h){return[]}for(var c=[],d=arguments.length,f=0,a=h.length;a>f;f++){var b=h[f];if(!al.contains(c,b)){for(var g=1;d>g&&al.contains(arguments[g],b);g++){}g===d&&c.push(b)}}return c},al.difference=function(b){var a=an(arguments,!0,!0,1);return al.filter(b,function(c){return !al.contains(a,c)})},al.zip=function(){return al.unzip(arguments)},al.unzip=function(d){for(var a=d&&al.max(d,"length").length||0,b=Array(a),c=0;a>c;c++){b[c]=al.pluck(d,c)}return b},al.object=function(f,b){for(var c={},d=0,a=f&&f.length;a>d;d++){b?c[f[d]]=b[d]:c[f[d][0]]=f[d][1]}return c},al.indexOf=function(f,b,c){var d=0,a=f&&f.length;if("number"==typeof c){d=0>c?Math.max(0,a+c):c}else{if(c&&a){return d=al.sortedIndex(f,b),f[d]===b?d:-1}}if(b!==b){return al.findIndex(am.call(f,d),al.isNaN)}for(;a>d;d++){if(f[d]===b){return d}}return -1},al.lastIndexOf=function(d,a,b){var c=d?d.length:0;if("number"==typeof b&&(c=0>b?c+b+1:Math.min(c,b+1)),a!==a){return al.findLastIndex(am.call(d,0,c),al.isNaN)}for(;--c>=0;){if(d[c]===a){return c}}return -1},al.findIndex=ae(1),al.findLastIndex=ae(-1),al.sortedIndex=function(m,f,g,h){g=ax(g,h,1);for(var c=g(f),d=0,l=m.length;l>d;){var b=Math.floor((d+l)/2);g(m[b])<c?d=b+1:l=b}return d},al.range=function(g,c,d){arguments.length<=1&&(c=g||0,g=0),d=d||1;for(var f=Math.max(Math.ceil((c-g)/d),0),a=Array(f),b=0;f>b;b++,g+=d){a[b]=g}return a};var H=function(h,c,d,f,a){if(!(f instanceof c)){return h.apply(d,a)}var b=az(h.prototype),g=h.apply(b,a);return al.isObject(g)?g:b};al.bind=function(d,a){if(ac&&d.bind===ac){return ac.apply(d,am.call(arguments,1))}if(!al.isFunction(d)){throw new TypeError("Bind must be called on a function")}var b=am.call(arguments,2),c=function(){return H(d,c,a,this,b.concat(am.call(arguments)))};return c},al.partial=function(c){var a=am.call(arguments,1),b=function(){for(var g=0,d=a.length,f=Array(d),h=0;d>h;h++){f[h]=a[h]===al?arguments[g++]:a[h]}for(;g<arguments.length;){f.push(arguments[g++])}return H(c,b,this,this,f)};return b},al.bindAll=function(d){var a,b,c=arguments.length;if(1>=c){throw new Error("bindAll must be passed function names")}for(a=1;c>a;a++){b=arguments[a],d[b]=al.bind(d[b],d)}return d},al.memoize=function(c,a){var b=function(g){var d=b.cache,f=""+(a?a.apply(this,arguments):g);return al.has(d,f)||(d[f]=c.apply(this,arguments)),d[f]};return b.cache={},b},al.delay=function(c,a){var b=am.call(arguments,2);return setTimeout(function(){return c.apply(null,b)},a)},al.defer=al.partial(al.delay,al,1),al.throttle=function(f,q,b){var h,p,g,d=null,m=0;b||(b={});var l=function(){m=b.leading===!1?0:al.now(),d=null,g=f.apply(h,p),d||(h=p=null)};return function(){var a=al.now();m||b.leading!==!1||(m=a);var c=q-(a-m);return h=this,p=arguments,0>=c||c>q?(d&&(clearTimeout(d),d=null),m=a,g=f.apply(h,p),d||(h=p=null)):d||b.trailing===!1||(d=setTimeout(l,c)),g}},al.debounce=function(f,q,b){var h,p,g,d,m,l=function(){var a=al.now()-d;q>a&&a>=0?h=setTimeout(l,q-a):(h=null,b||(m=f.apply(g,p),h||(g=p=null)))};return function(){g=this,p=arguments,d=al.now();var a=b&&!h;return h||(h=setTimeout(l,q)),a&&(m=f.apply(g,p),g=p=null),m}},al.wrap=function(b,a){return al.partial(a,b)},al.negate=function(a){return function(){return !a.apply(this,arguments)}},al.compose=function(){var b=arguments,a=b.length-1;return function(){for(var c=a,d=b[a].apply(this,arguments);c--;){d=b[c].call(this,d)}return d}},al.after=function(b,a){return function(){return --b<1?a.apply(this,arguments):void 0}},al.before=function(c,a){var b;return function(){return --c>0&&(b=a.apply(this,arguments)),1>=c&&(a=null),b}},al.once=al.partial(al.before,2);var U=!{toString:null}.propertyIsEnumerable("toString"),D=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];al.keys=function(c){if(!al.isObject(c)){return[]}if(aq){return aq(c)}var a=[];for(var b in c){al.has(c,b)&&a.push(b)}return U&&ag(c,a),a},al.allKeys=function(c){if(!al.isObject(c)){return[]}var a=[];for(var b in c){a.push(b)}return U&&ag(c,a),a},al.values=function(f){for(var b=al.keys(f),c=b.length,d=Array(c),a=0;c>a;a++){d[a]=f[b[a]]}return d},al.mapObject=function(m,f,g){f=ax(f,g);for(var h,c=al.keys(m),d=c.length,l={},b=0;d>b;b++){h=c[b],l[h]=f(m[h],h,m)}return l},al.pairs=function(f){for(var b=al.keys(f),c=b.length,d=Array(c),a=0;c>a;a++){d[a]=[b[a],f[b[a]]]}return d},al.invert=function(f){for(var b={},c=al.keys(f),d=0,a=c.length;a>d;d++){b[f[c[d]]]=c[d]}return b},al.functions=al.methods=function(c){var a=[];for(var b in c){al.isFunction(c[b])&&a.push(b)}return a.sort()},al.extend=aa(al.allKeys),al.extendOwn=al.assign=aa(al.keys),al.findKey=function(h,c,d){c=ax(c,d);for(var f,a=al.keys(h),b=0,g=a.length;g>b;b++){if(f=a[b],c(h[f],f,h)){return f}}},al.pick=function(g,x,b){var q,w,m={},d=g;if(null==d){return m}al.isFunction(x)?(w=al.allKeys(d),q=av(x,b)):(w=an(arguments,!1,!1,1),q=function(e,a,c){return a in c},d=Object(d));for(var v=0,s=w.length;s>v;v++){var h=w[v],p=d[h];q(p,h,d)&&(m[h]=p)}return m},al.omit=function(d,a,b){if(al.isFunction(a)){a=al.negate(a)}else{var c=al.map(an(arguments,!1,!1,1),String);a=function(f,e){return !al.contains(c,e)}}return al.pick(d,a,b)},al.defaults=aa(al.allKeys,!0),al.clone=function(a){return al.isObject(a)?al.isArray(a)?a.slice():al.extend({},a):a},al.tap=function(b,a){return a(b),b},al.isMatch=function(h,c){var d=al.keys(c),f=d.length;if(null==h){return !f}for(var a=Object(h),b=0;f>b;b++){var g=d[b];if(c[g]!==a[g]||!(g in a)){return !1}}return !0};var V=function(f,w,b,m){if(f===w){return 0!==f||1/f===1/w}if(null==f||null==w){return f===w}f instanceof al&&(f=f._wrapped),w instanceof al&&(w=w._wrapped);var v=at.call(f);if(v!==at.call(w)){return !1}switch(v){case"[object RegExp]":case"[object String]":return""+f==""+w;case"[object Number]":return +f!==+f?+w!==+w:0===+f?1/+f===1/w:+f===+w;case"[object Date]":case"[object Boolean]":return +f===+w}var h="[object Array]"===v;if(!h){if("object"!=typeof f||"object"!=typeof w){return !1}var d=f.constructor,q=w.constructor;if(d!==q&&!(al.isFunction(d)&&d instanceof d&&al.isFunction(q)&&q instanceof q)&&"constructor" in f&&"constructor" in w){return !1}}b=b||[],m=m||[];for(var p=b.length;p--;){if(b[p]===f){return m[p]===w}}if(b.push(f),m.push(w),h){if(p=f.length,p!==w.length){return !1}for(;p--;){if(!V(f[p],w[p],b,m)){return !1}}}else{var g,x=al.keys(f);if(p=x.length,al.keys(w).length!==p){return !1}for(;p--;){if(g=x[p],!al.has(w,g)||!V(f[g],w[g],b,m)){return !1}}}return b.pop(),m.pop(),!0};al.isEqual=function(b,a){return V(b,a)},al.isEmpty=function(a){return null==a?!0:ab(a)&&(al.isArray(a)||al.isString(a)||al.isArguments(a))?0===a.length:0===al.keys(a).length},al.isElement=function(a){return !(!a||1!==a.nodeType)},al.isArray=ai||function(a){return"[object Array]"===at.call(a)},al.isObject=function(b){var a=typeof b;return"function"===a||"object"===a&&!!b},al.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(a){al["is"+a]=function(b){return at.call(b)==="[object "+a+"]"}}),al.isArguments(arguments)||(al.isArguments=function(a){return al.has(a,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(al.isFunction=function(a){return"function"==typeof a||!1}),al.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},al.isNaN=function(a){return al.isNumber(a)&&a!==+a},al.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"===at.call(a)},al.isNull=function(a){return null===a},al.isUndefined=function(a){return a===void 0},al.has=function(b,a){return null!=b&&af.call(b,a)},al.noConflict=function(){return au._=ad,this},al.identity=function(a){return a},al.constant=function(a){return function(){return a}},al.noop=function(){},al.property=function(a){return function(b){return null==b?void 0:b[a]}},al.propertyOf=function(a){return null==a?function(){}:function(b){return a[b]}},al.matcher=al.matches=function(a){return a=al.extendOwn({},a),function(b){return al.isMatch(b,a)}},al.times=function(f,b,c){var d=Array(Math.max(0,f));b=av(b,c,1);for(var a=0;f>a;a++){d[a]=b(a)}return d},al.random=function(b,a){return null==a&&(a=b,b=0),b+Math.floor(Math.random()*(a-b+1))},al.now=Date.now||function(){return(new Date).getTime()};var L={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},J=al.invert(L),Q=function(f){var b=function(e){return f[e]},c="(?:"+al.keys(f).join("|")+")",d=RegExp(c),a=RegExp(c,"g");return function(e){return e=null==e?"":""+e,d.test(e)?e.replace(a,b):e}};al.escape=Q(L),al.unescape=Q(J),al.result=function(d,a,b){var c=null==d?void 0:d[a];return c===void 0&&(c=b),al.isFunction(c)?c.call(d):c};var W=0;al.uniqueId=function(b){var a=++W+"";return b?b+a:a},al.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/(.)^/,G={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},ah=/\\|'|\r|\n|\u2028|\u2029/g,P=function(a){return"\\"+G[a]};al.template=function(f,v,b){!v&&b&&(v=b),v=al.defaults({},v,al.templateSettings);var m=RegExp([(v.escape||C).source,(v.interpolate||C).source,(v.evaluate||C).source].join("|")+"|$","g"),s=0,h="__p+='";f.replace(m,function(i,l,n,u,c){return h+=f.slice(s,c).replace(ah,P),s=c+i.length,l?h+="'+\n((__t=("+l+"))==null?'':_.escape(__t))+\n'":n?h+="'+\n((__t=("+n+"))==null?'':__t)+\n'":u&&(h+="';\n"+u+"\n__p+='"),i}),h+="';\n",v.variable||(h="with(obj||{}){\n"+h+"}\n"),h="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+h+"return __p;\n";try{var d=new Function(v.variable||"obj","_",h)}catch(q){throw q.source=h,q}var p=function(a){return d.call(this,a,al)},g=v.variable||"obj";return p.source="function("+g+"){\n"+h+"}",p},al.chain=function(b){var a=al(b);return a._chain=!0,a};var Y=function(b,a){return b._chain?al(a).chain():a};al.mixin=function(a){al.each(al.functions(a),function(b){var c=al[b]=a[b];al.prototype[b]=function(){var d=[this._wrapped];return aw.apply(d,arguments),Y(this,c.apply(al,d))}})},al.mixin(al),al.each(["pop","push","reverse","shift","sort","splice","unshift"],function(b){var a=ap[b];al.prototype[b]=function(){var c=this._wrapped;return a.apply(c,arguments),"shift"!==b&&"splice"!==b||0!==c.length||delete c[0],Y(this,c)}}),al.each(["concat","join","slice"],function(b){var a=ap[b];al.prototype[b]=function(){return Y(this,a.apply(this._wrapped,arguments))}}),al.prototype.value=function(){return this._wrapped},al.prototype.valueOf=al.prototype.toJSON=al.prototype.value,al.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return al})}).call(this);SBGrid.DEF.Lan_Month="";SBGrid.DEF.Lan_Day="";SBGrid.DEF.Lan_Monday="";SBGrid.DEF.Lan_Tuesday="";SBGrid.DEF.Lan_Wednesday="";SBGrid.DEF.Lan_Thursday="";SBGrid.DEF.Lan_Friday="";SBGrid.DEF.Lan_Saturday="";SBGrid.DEF.Lan_Sunday="";SBGrid.DEF.Lan_Today="";SBGrid.DEF.Lan_DefaultFontFamily="";SBGrid.CF=function(){};SBGrid.CF.Init=function(a){var b=a.id;a.m_heCtrl=document.getElementById("SBHE_"+b);if(null!=a.m_heCtrl){a.m_heCtrl.parentWindow=window}b=null;a=null};SBGrid.CF.UnInit=function(a){a.m_heCtrl=null;a=null};SBGrid.CF.GetLabel=function(a){var b=a.label;if(null!=b&&typeof b=="string"){a=null;return String(b)}else{a=null;return""}};SBGrid.CF.SetLabel=function(a,c,b){if(null!=a.m_heCtrl){if(b){a.m_heCtrl.title=c}a.m_heCtrl.setAttribute("label",c)}a.label=c;a=null;c=null};SBGrid.CF.SetLabelChange=function(a,b){if(null!=a.m_heCtrl){jQuery(a.m_heCtrl).html(b)}a=null;b=null};SBGrid.CF.GetValue=function(a){var b=a.value;if(null!=b&&typeof b=="string"){a=null;return String(b)}else{a=null;return""}};SBGrid.CF.SetValue=function(a,b){a.value=b;a=null;strLabel=null};SBGrid.CF.SetHtmlElement=function(a,b){a.m_heCtrl=b;a=null;b=null};SBGrid.CF.GetSelect=function(a){return a.selected};SBGrid.CF.SetSelect=function(b,a){a=null!=a?a:b.m_bSelect;b.selected=a;var c=b.getElement();if(null!=c){c.setSelect(a)}b=null;c=null;a=null};SBGrid.CF.GridInit=function(a){var c=a.id;a.m_heCtrl=document.getElementById("SBHE_"+c);var b=document.getElementById(c+"_data");if(b){a.m_heDCtrl=b;b=null}c=null;a=null};SBGrid.CF.GridUnInit=function(a){a.m_heCtrl=null;a.m_heDCtrl=null;a=null};SBGrid.CF.GridSetMergeType=function(a,b){if(SBGrid.DEF.SBSM_COLHIDE==a.mergeType){return}if(b){a.mergeType=SBGrid.DEF.SBSM_NORMAL}else{a.mergeType=SBGrid.DEF.SBSM_LOCK}a=null;b=null};SBGrid.CF.GridSetFixedWindowText=function(a,c){if(null==a.m_heCtrl){return}a.text=c;var b=a.m_heCtrl;if(b){jQuery(b).html('<span style="border-color: transparent;"><span style="white-space:nowrap;">'+c+"</span></span>")}b=null;a=null;c=null};SBGrid.CF.GridGetWindowText=function(a){var b=a.getElement();if("softbowl:gridfixedcell"!=b.getElementName()){if(SBGrid.DEF.SBIT_IMAGE==b.getInputType()){if(a.m_jsonObject){return a.m_jsonObject[b.attribute.ref]+""}else{if(a.m_xnNodeElement){return SBGrid.UT.XmlLib.getTextValue(a.m_xnNodeElement)}}return""}}return jQuery(a.m_heCtrl).text()};SBGrid.CF.GridSetWindowText=function(p,n,d,m){if(n.indexOf("<script")>-1){var l=n.replaceAll("<script","<![CDATA[<script]]>");n=l}if(n.indexOf("<\/script")>-1){var l=n.replaceAll("<\/script","<![CDATA[<\/script]]>");n=l}var c=p.getElement();if(p.m_heDCtrl){if(null==n){n=""}if(d){if(null==n){n=""}n=n.formatting(m)}else{if(null==n){n=""}var c=p.m_objElement;m=c.getAttribute("format");n=n.formatting(m);var h=SBGrid.DEF.formatStatus(m);if(4==h&&""!=c.attribute.roundmode&&""!=c.attribute.roundposition){n=SBGrid.DEF.getRoundMode(n,c.attribute.roundmode,c.attribute.roundposition)}}var a=jQuery(p.m_heDCtrl);if(n==a.text()){a=null;return}if(""!=n&&(-1!=c.attribute.secretendposition||-1!=c.attribute.secretstartposition)){var e=-1==c.attribute.secretstartposition?0:c.attribute.secretstartposition;var b=-1==c.attribute.secretendposition?n.length:c.attribute.secretendposition;if(b>e){var o=c.attribute.secretmark;var l=n.substr(0,e);var f=n.substr(b,n.length);for(var g=e;g<b;g++){l+=o}n=l+f;strmark=null;l=null;f=null}e=null;b=null}if(p.parent.autoResize){p.m_heDCtrl.innerHTML=n}else{a.html('<span style="white-space:nowrap;">'+n+"</span>")}a=null}c=null;p=null;n=null;d=null;m=null};SBGrid.CF.GridSetTextRefresh=function(w,t,e,m){if(m==undefined||typeof m!="boolean"){m=false}var f=t,q;q=e;if(q!=""&&q!="undefined"&&q!=null){if(t==q[0]){t=q[1];if(m){SBGrid.CF.GridSetText(w,t)}}}if(null!=t){var h=w.getElement();if(h){switch(h.getInputType()){case SBGrid.DEF.SBIT_CHECK:case SBGrid.DEF.SBIT_RADIO:var c=(t==h.getTrueValue())?true:false;var r=c?h.getTrueValue():h.getFalseValue();if(c){h.m_nBeforeSelectRow=w.row}w.setBoolState(c);w.setWindowText(t);c=null;r=null;break;case SBGrid.DEF.SBIT_COMBO:var n=h.m_objCombo;if(h.m_bIsCellCombo&&n.isnodeset){var a=w.getAttribute("nodeset");if(null!=a){n.nodeset=a;n.reBuild()}else{if(null!=h.m_strComboNodeSet&h.m_strComboNodeSet!=n.nodeset){n.nodeset=h.m_strComboNodeSet;n.refresh()}}a=null}f=n.getLableByValue(t);w.setWindowText(f);n=null;break;case SBGrid.DEF.SBIT_IMAGE:var g=h.getImageUri(),l=h.getImageWidth(),s=h.getImageHeight(),o=h.getImageStyle(),b=h.getImageClickFuncName(),u=h.getImageAlt();if(g!=null&&g!=""&&g!="undefined"){t=g}w.setImage(t,b,l,s,o,u);break;default:w.setWindowText(t);break}if(w.m_bIsHidden!=undefined){if(w.m_objElement!=null&&w.m_objElement.m_bHiddenState!=true){if(w.m_heCtrl!=null){for(var p=0;p<w.m_heCtrl.childNodes.length;p++){var d=w.m_heCtrl.childNodes[p];var v="";if(w.m_bIsHidden==true){v="none"}d.style.display=v;d=null}}}}h=null}}if(w.parent.m_strTooltip!=""){if("label"==w.parent.m_strTooltip){if(null!=w.m_heCtrl){w.m_heCtrl.title=f}}else{if("true"==w.parent.m_strTooltip){if(null!=w.m_heCtrl){w.m_heCtrl.title=t}}}}f=null;w=null;t=null;e=null;q=null};SBGrid.CF.GridSetTextRefreshGroup=function(b,a,d,g){if(g==undefined||typeof g!="boolean"){g=false}var f=a,c;c=d;if(c!=""&&c!="undefined"&&c!=null){if(a==c[0]){a=c[1];if(g){SBGrid.CF.GridSetText(b,a)}}}if(null!=a){var e=b.getElement();if(e){b.setWindowTextGroup(a);e=null}}if(b.parent.m_strTooltip!=""){if("label"==b.parent.m_strTooltip){if(null!=b.m_heCtrl){b.m_heCtrl.title=f}}else{if("true"==b.parent.m_strTooltip){if(null!=b.m_heCtrl){b.m_heCtrl.title=a}}}}f=null;b=null;a=null;d=null;c=null};SBGrid.CF.GridSetBoolState=function(a,g,d,b,f){a.boolstate=g;if(d){a.setText(strValue)}if(null!=a.m_heCtrl){var c=a.m_heCtrl.firstChild;if(c){var e=a.m_objElement;if(SBGrid.DEF.SBIT_CHECK==e.getInputType()){c.src=a.boolstate?e.getAttribute("checkimage"):e.getAttribute("uncheckimage")}else{if(SBGrid.DEF.SBIT_RADIO==e.getInputType()){c.src=a.boolstate?e.getAttribute("selectimage"):e.getAttribute("unselectimage")}}e=null}c=null}a=null;g=null;d=null;b=null;f=null};SBGrid.CF.GridChangeRowHeadUpdate=function(a,c){if(a.m_heCtrl!=null){var b=a.m_heCtrl.firstChild;if(null!=b){switch(c){case SBGrid.DEF.SBGS_INSERT:case SBGrid.DEF.SBGS_INSERTANDNEW:b.style.backgroundImage="url("+a.parent.m_strInsertFlagImage+")";break;case SBGrid.DEF.SBGS_UPDATE:b.style.backgroundImage="url("+a.parent.m_strUpdateFlagImage+")";break;case SBGrid.DEF.SBGS_DELETE:case SBGrid.DEF.SBGS_DELETEANDUPDATE:b.style.backgroundImage="url("+a.parent.m_strDeleteFlagImage+")";break;default:b.style.backgroundImage="url("+a.parent.m_strNormalFlagImage+")";break}}b=null;a=null;c=null}};SBGrid.CF.GridChangeRowHeadSelect=function(b,a){if(b.m_heCtrl!=null){var c=b.m_heCtrl.firstChild;if(null!=c){if(a){c.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHSelect+")"}else{c.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHBlank+")"}}c=null;b=null;a=null}};SBGrid.CF.GridGetText=function(b){if(b.m_jsonObject){return b.m_jsonObject[b.m_objElement.attribute.ref]+""}else{if(b.m_xnNodeElement){return SBGrid.UT.XmlLib.getTextValue(b.m_xnNodeElement)}else{var a=b.text;if(a){return a}}}return""};SBGrid.CF.GridSetText=function(a,c){if(a.m_jsonObject){a.m_jsonObject[a.m_objElement.attribute.ref]=c+""}else{if(a.m_xnNodeElement){SBGrid.UT.XmlLib.setTextValue(a.m_xnNodeElement,c)}else{a.text=c}}var b=a.getElement();var d=(c==b.getTrueValue())?true:false;a.setBoolState(d);a=null;c=null};SBGrid.CF.GridSetFixedCheck=function(a,c){if(SBGrid.DEF.SBIT_CHECK==a.m_objElement.getInputType()){if(a.parent.getCellDisabled(a.row,a.col)==false){var b=c?a.m_objElement.getTrueValue():a.m_objElement.getFalseValue();SBGrid.CF.GridSetBoolState(a,c);SBGrid.CF.GridSetText(a,b)}}};SBGrid.CF.xnTextNodeDelete=function(a){var b=a.firstChild;while(null!=b){if(null==b.nodeValue){SBGrid.CF.xnTextNodeDelete(b)}else{b.nodeValue=""}b=b.nextSibling}};function __initSBDataGrid(){return false}SBGrid.US=_.noConflict();SBGrid.DS.Collection=function(){this.m_htCollection={};this.m_arOrder=new Array();this.m_nLength=0};SBGrid.DS.Collection.prototype.add=function(b,a){if(null==this.m_htCollection[b]){this.m_arOrder.push(b)}this.m_htCollection[b]=a;this.m_nLength=this.m_arOrder.length;b=null;a=null};SBGrid.DS.Collection.prototype.count=function(){return this.m_arOrder.length};SBGrid.DS.Collection.prototype.exists=function(a){return(null!=this.m_htCollection[a])};SBGrid.DS.Collection.prototype.item=function(a){switch(typeof(a)){case"string":return this.m_htCollection[a];default:return this.m_htCollection[this.m_arOrder[a]]}};SBGrid.DS.Collection.prototype.swap=function(e,c){if(this.exists(e)&&this.exists(c)){var d=SBGrid.DEF.__deepCopy(this.item(e));var b=SBGrid.DEF.linearSearch(this.m_arOrder,e);var a=SBGrid.DEF.linearSearch(this.m_arOrder,c);SBGrid.DEF.swap(this.m_arOrder,b,a);this.add(e,this.item(c));this.add(c,d);d=null}};SBGrid.DS.Collection.prototype.keys=function(a){return(a?SBGrid.US.clone(this.m_arOrder):this.m_arOrder)};SBGrid.DS.Collection.prototype.remove=function(b){delete this.m_htCollection[b];var a=SBGrid.DEF.arrFind_Value(this.m_arOrder,b);if(0<=a){this.m_arOrder.splice(a,1)}this.m_nLength=this.m_arOrder.length};SBGrid.DS.Collection.prototype.clear=function(){SBGrid.DEF.wipe(this.m_htCollection);SBGrid.DEF.clearArray(this.m_arOrder);this.m_nLength=0};SBGrid.DS.Collection.prototype.getCollection=function(){return this.m_htCollection};SBGrid.DS.SET=function(){this.m_htCollection={};this.m_arOrder=new Array();this.m_nLength=0};SBGrid.DS.SET.prototype.add=function(a){if(null==this.m_htCollection[a]){this.m_arOrder.push(a)}this.m_htCollection[a]="";this.m_nLength=this.m_arOrder.length;a=null};SBGrid.DS.SET.prototype.count=function(){return this.m_arOrder.length};SBGrid.DS.SET.prototype.exists=function(a){return(null!=this.m_htCollection[a])};SBGrid.DS.SET.prototype.keys=function(a){return(a?SBGrid.US.clone(this.m_arOrder):this.m_arOrder)};SBGrid.DS.SET.prototype.remove=function(b){delete this.m_htCollection[b];var a=SBGrid.US.findIndex(this.m_arOrder,b);if(0<=a){this.m_arOrder.splice(a,1)}this.m_nLength=this.m_arOrder.length};SBGrid.DS.SET.prototype.clear=function(){SBGrid.DEF.wipe(this.m_htCollection);SBGrid.DEF.clearArray(this.m_arOrder);this.m_nLength=0};if(!Object.keys){Object.keys=(function(){var c=Object.prototype.hasOwnProperty,d=!({toString:null}).propertyIsEnumerable("toString"),b=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=b.length;return function(g){if(typeof g!=="object"&&(typeof g!=="function"||g===null)){throw new TypeError("Object.keys called on non-object")}var e=[],h,f;for(h in g){if(c.call(g,h)){e.push(h)}}if(d){for(f=0;f<a;f++){if(c.call(g,b[f])){e.push(b[f])}}}return e}}())}SBGrid.DS.Map=function(){this.datastore=new Array()};SBGrid.DS.Map.prototype.keys=function(a){if(a==true){return Object.keys(this.datastore).sort()}return Object.keys(this.datastore)};SBGrid.DS.Map.prototype.add=function(a,b){this.datastore[a]=b};SBGrid.DS.Map.prototype.find=function(a){return this.datastore[a]};SBGrid.DS.Map.prototype.remove=function(a){delete this.datastore[a]};SBGrid.DS.Map.prototype.showAll=function(b){var d=this.keys(b);for(var a=0,c=d.length;a<c;a++){console.log(d[a]+" -> "+this.datastore[d[a]])}d=null};SBGrid.DS.Map.prototype.count=function(){return this.keys().length};SBGrid.DS.Map.prototype.clear=function(){var c=this.keys();for(var a=0,b=c.length;a<b;a++){delete this.datastore[c[a]]}c=null};SBGrid.DS.Set=function(){this.dataStore=[]};SBGrid.DS.Set.prototype.add=function(a){if(this.dataStore.indexOf(a)<0){this.dataStore.push(a);return true}else{return false}};SBGrid.DS.Set.prototype.remove=function(a){var b=this.dataStore.indexOf(a);if(b>-1){this.dataStore.splice(b,1);return true}else{return false}};SBGrid.DS.Set.prototype.clear=function(){this.dataStore=[]};SBGrid.DS.Set.prototype.keys=function(a){if(a){return this.dataStore.sort()}else{return this.dataStore}};SBGrid.DS.Set.prototype.contains=function(a){if(this.dataStore.indexOf(a)>-1){return true}else{return false}};SBGrid.DS.Set.prototype.union=function(c){var a=new Set();for(var b=0;b<this.dataStore.length;++b){a.add(this.dataStore[b])}for(var b=0;b<c.dataStore.length;++b){if(!a.contains(c.dataStore[b])){a.dataStore.push(c.dataStore[b])}}return a};SBGrid.DS.Set.prototype.intersect=function(c){var a=new Set();for(var b=0;b<this.dataStore.length;++b){if(c.contains(this.dataStore[b])){a.add(this.dataStore[b])}}return a};SBGrid.DS.Set.prototype.count=function(){return this.dataStore.length};SBGrid.DS.Set.prototype.subset=function(b){if(this.count()>b.count()){return false}else{for(var a=0;a<this.dataStore.length;a++){if(!b.contains(this.dataStore[a])){return false}}}return true};SBGrid.DS.Set.prototype.difference=function(c){var a=new Set();for(var b=0;b<this.dataStore.length;++b){if(!c.contains(this.dataStore[b])){a.add(this.dataStore[b])}}return a};SBGrid.DS.Queue=function(){this.m_arDataStore=[]};SBGrid.DS.Queue.prototype.enqueue=function(a){this.m_arDataStore.push(a)};SBGrid.DS.Queue.prototype.dequeue=function(){return this.m_arDataStore.shift()};SBGrid.DS.Queue.prototype.front=function(){return this.m_arDataStore[0]};SBGrid.DS.Queue.prototype.back=function(){return this.m_arDataStore[this.m_arDataStore.length-1]};SBGrid.DS.Queue.prototype.empty=function(){if(this.m_arDataStore.length==0){return true}else{return false}};SBGrid.DS.Queue.prototype.clear=function(){while(this.dequeue()){}};SBGrid.DS.Stack=function(){this.m_arDataStore=[];this.top=0};SBGrid.DS.Stack.prototype.push=function(a){this.m_arDataStore[this.top++]=a};SBGrid.DS.Stack.prototype.pop=function(){return this.m_arDataStore[this.top>=1?--this.top:-1]};SBGrid.DS.Stack.prototype.peek=function(){return this.m_arDataStore[this.top-1]};SBGrid.DS.Stack.prototype.count=function(){return this.top};SBGrid.DS.Stack.prototype.clear=function(){SBGrid.DEF.clearArray(this.m_arDataStore);this.top=0};SBGrid.DEF.quickSort=function(a){if(a.length==0){return[]}var e=[];var d=[];var b=a[0];for(var c=1;c<a.length;c++){if(a[c]<b){e.push(a[c])}else{d.push(a[c])}}return SBGrid.DEF.quickSort(e).concat(b,SBGrid.DEF.quickSort(d))};SBGrid.DEF.insertionSort=function(a){var c,b;for(var d=1;d<=a.length-1;++d){c=a[d];b=d;while(b>0&&(a[b-1]>=c)){a[b]=a[b-1];--b}a[b]=c}};SBGrid.DEF.mergeSort=function(a){if(a.length<2){return}var c=1;var d,b;while(c<a.length){d=0;b=c;while(b+c<=a.length){SBGrid.DEF.mergeArrays(a,d,d+c,b,b+c);d=b+c;b=d+c}if(b<a.length){mergeArrays(a,d,d+c,b,a.length)}c*=2}};SBGrid.DEF.mergeArrays=function(p,e,c,d,b){var l=new Array(b-d+1);var a=new Array(c-e+1);h=d;for(var o=0;o<(l.length-1);++o){l[o]=p[h];++h}h=e;for(var o=0;o<(a.length-1);++o){a[o]=p[h];++h}l[l.length-1]=Infinity;a[a.length-1]=Infinity;var g=0;var f=0;for(var h=e;h<b;++h){if(a[g]<=l[f]){p[h]=a[g];g++}else{p[h]=l[f];f++}}};SBGrid.DEF.swap=function(a,b,c){temp=a[b];a[b]=a[c];a[c]=temp};SBGrid.DEF.linearSearch=function(a,c){var d=SBGrid.DEF.__deepCopy(a);for(var b=0;b<d.length;++b){if(d[b]==c){if(b>0){SBGrid.DEF.swap(d,b,b-1)}return b}}return -1};SBGrid.DEF.findMin=function(a){var c=a[0];for(var b=1;b<a.length;++b){if(a[b]<c){c=a[b]}}return c};SBGrid.DEF.findMax=function(b){var a=b[0];for(var c=1;c<b.length;++c){if(b[c]>a){a=b[c]}}return a};SBGrid.DEF.arrBinarySearch=function(c,a){var d=a.length-1;var e=0;while(e<=d){var b=Math.floor((d+e)/2);if(a[b]<c){e=b+1}else{if(a[b]>c){d=b-1}else{return b}}}return -1};SBGrid.DEF.arrUnion=function(d,b){var e=new Array();for(var c=0;c<b.length;c++){if(SBGrid.DEF.arrBinarySearch(b[c],d)==-1){e.push(b[c])}}var a=d.concat(e);a.sort(SBGrid.DEF.numberASC);return a};SBGrid.DEF.arrDifferenceOfSets=function(d,b){for(var c=0;c<b.length;c++){var a=SBGrid.DEF.arrBinarySearch(b[c],d);if(a!=-1){d.splice(a,1)}}return d};SBGrid.DEF.arrIntersection=function(b,a){var c=new Array();while(b.length>0&&a.length>0){if(b[0]<a[0]){b.shift()}else{if(b[0]>a[0]){a.shift()}else{c.push(b.shift());a.shift()}}}return c};jQuery(document).ready(function(){var b=document.head||document.getElementsByTagName("head")[0];var a=document.createElement("style");a.type="text/css";b.appendChild(a);jQuery(document).bind("click",SBGrid.DEF.setDefaultOnclick)});SBGrid.DEF.cssName="";SBGrid.DEF.SB_CS_NORMAL=0;SBGrid.DEF.SB_CS_FOCUS=1;SBGrid.DEF.SB_CS_SELECT=2;SBGrid.DEF.SB_CS_HOVER=4;SBGrid.DEF.SB_CS_DOWN=8;SBGrid.DEF.SB_CS_DISABLE=16;SBGrid.DEF.SB_CS_ACTIVE=32;SBGrid.DEF.SB_NONE=0;SBGrid.DEF.SB_SINGLE=1;SBGrid.DEF.SB_MULTIPLE=2;SBGrid.DEF.SBKE_NONE=0;SBGrid.DEF.SBKE_NEXT=1;SBGrid.DEF.SBKE_PREVIOUS=2;SBGrid.DEF.SBKE_MOVETOP=3;SBGrid.DEF.SBKE_MOVEBOTTOM=4;SBGrid.DEF.SBSM_FREE=1;SBGrid.DEF.SBSM_BYROW=2;SBGrid.DEF.SBSM_BYCOL=3;SBGrid.DEF.SBSM_LIST=4;SBGrid.DEF.SBSM_NONE=5;SBGrid.DEF.SBRS_NONE=1;SBGrid.DEF.SBRS_VERT=2;SBGrid.DEF.SBRS_HORZ=4;SBGrid.DEF.SBRH_SEQ=1;SBGrid.DEF.SBRH_SELECT=2;SBGrid.DEF.SBRH_UPDATE=3;SBGrid.DEF.SBRH_REVERSESEQ=4;SBGrid.DEF.SBCH_TEXT=1;SBGrid.DEF.SBCH_ROWINS=2;SBGrid.DEF.SBCH_ROWDEL=4;SBGrid.DEF.SBGS_ALL=-1;SBGrid.DEF.SBGS_NEW=0;SBGrid.DEF.SBGS_INSERT=1;SBGrid.DEF.SBGS_UPDATE=2;SBGrid.DEF.SBGS_DELETE=4;SBGrid.DEF.SBGS_INSERTANDNEW=3;SBGrid.DEF.SBGS_DELETEANDINSERT=5;SBGrid.DEF.SBGS_DELETEANDUPDATE=6;SBGrid.DEF.SBEB_NONE=0;SBGrid.DEF.SBEB_SORT=1;SBGrid.DEF.SBEB_MOVE=2;SBGrid.DEF.SBEB_SORT_MOVE=3;SBGrid.DEF.SBEB_SORT_SHOW=4;SBGrid.DEF.SBEB_SORT_SHOW_MOVE=5;SBGrid.DEF.SBEB_UI_FILTERING=1;SBGrid.DEF.SBEB_UI_HIDE=2;SBGrid.DEF.SBEB_UI_FILTERING_HIDE=3;SBGrid.DEF.SBEB_UI_FILTERING_SHOW=4;SBGrid.DEF.SBEB_UI_HIDE_SHOW=5;SBGrid.DEF.SBEB_UI_FILTERING_SHOW_HIDE_SHOW=6;SBGrid.DEF.SBST_NONE=0;SBGrid.DEF.SBST_ASC=1;SBGrid.DEF.SBST_DESC=2;SBGrid.DEF.SBST_USERSORT=3;SBGrid.DEF.SBIT_OUTPUT=0;SBGrid.DEF.SBIT_INPUT=1;SBGrid.DEF.SBIT_COMBO=2;SBGrid.DEF.SBIT_CHECK=3;SBGrid.DEF.SBIT_RADIO=4;SBGrid.DEF.SBIT_INPUTBUTTON=5;SBGrid.DEF.SBIT_INPUTDATE=6;SBGrid.DEF.SBIT_SORTARROW=7;SBGrid.DEF.SBIT_TEXTAREA=8;SBGrid.DEF.SBIT_BROWSER=9;SBGrid.DEF.SBIT_INIT=10;SBGrid.DEF.SBIT_INPUTSPIN=11;SBGrid.DEF.SBIT_COUNT=12;SBGrid.DEF.SBIT_IMAGE=13;SBGrid.DEF.SBIT_OUTPUTBUTTON=14;SBGrid.DEF.SB_APPEARANCE=["checkbox","radio","listbox","dcombo"];SBGrid.DEF.SB_NONE_EDIT=0;SBGrid.DEF.SB_POPUP_SEARCH=1;SBGrid.DEF.SB_NO_POPUP_SEARCH=2;SBGrid.DEF.SB_INPUT=3;SBGrid.DEF.SB_POPUP_INPUT=4;SBGrid.DEF.SB_CSS_NULL=0;SBGrid.DEF.SB_CSS_FIRST=SBGrid.DEF.SB_CSS_NULL;SBGrid.DEF.SB_CSS_USER=1;SBGrid.DEF.SB_CSS_UNIVERSAL=2;SBGrid.DEF.SB_CSS_TYPE=3;SBGrid.DEF.SB_CSS_DYNAMIC_PSEUDO=4;SBGrid.DEF.SB_CSS_ID=5;SBGrid.DEF.SB_CSS_DESCENDANT=6;SBGrid.DEF.SB_CSS_CHILD=7;SBGrid.DEF.SB_CSS_GROUP=8;SBGrid.DEF.SB_AS_NULL=0;SBGrid.DEF.SB_AS_EXIST=1;SBGrid.DEF.SB_AS_EQUAL=2;SBGrid.DEF.SB_HNS=1;SBGrid.DEF.SB_HID=16;SBGrid.DEF.SB_HCLASS=256;SBGrid.DEF.SB_gChildList=new Array();SBGrid.DEF.SBEA_HSB_AS_EVENT=1;SBGrid.DEF.SBEA_ACTION=2;SBGrid.DEF.SBEA_HSB_AS_DOM=32;SBGrid.DEF.SBEA_CONTROL_BASE=256;SBGrid.DEF.SBEA_CONTROL=(SBGrid.DEF.SBEA_CONTROL_BASE|SBGrid.DEF.SBEA_HSB_AS_EVENT);SBGrid.DEF.SBEA_HSB_AS_FORMAT=512;SBGrid.DEF.SBEA_HSB_AS_TEXT=1024;SBGrid.DEF.SBEA_GROUP_BASE=4096;SBGrid.DEF.SBEA_GROUP=(SBGrid.DEF.SBEA_CONTROL|SBGrid.DEF.SBEA_GROUP_BASE);SBGrid.DEF.SBEA_PI_BASE=65536;SBGrid.DEF.SBSM_NORMAL=0;SBGrid.DEF.SBSM_MERGED=1;SBGrid.DEF.SBSM_HIDE=2;SBGrid.DEF.SBSM_LOCK=3;SBGrid.DEF.SBSM_COLHIDE=4;SBGrid.DEF.SBSM_USER_LOCK=5;SBGrid.DEF.SBCT_EDIT=1;SBGrid.DEF.SBCT_BUTTON=2;SBGrid.DEF.SBCT_VIEW=3;SBGrid.DEF.SB_KOREAN="";SBGrid.DEF.SBLE_GRID="";SBGrid.DEF.SBLE_BUTTON="";SBGrid.DEF.bParsed=false;SBGrid.DEF.bDragDrop=false;SBGrid.DEF.bShowPop=true;SBGrid.DEF.bIsDragMode=false;SBGrid.DEF.m_arAccesskey=new Array();SBGrid.DEF.n_scrollingTimer=null;SBGrid.DEF.n_FilteringTimer=null;SBGrid.DEF.bIsResizeFlg=false;SBGrid.DEF.bIsAfterMouseUpFlg=true;SBGrid.DEF.nMouseEventStatus=SBGrid.DEF.SB_MOUSE_EVENT_NONE;SBGrid.DEF.DEBUG_MODE_ALERT=0;SBGrid.DEF.DEBUG_MODE_CONSOLE=1;SBGrid.DEF.DEBUG_MODE_ALERT_CONSOLE=2;SBGrid.DEF.DEBUG_MODE_NONE=3;SBGrid.DEF.DEBUG_MODE=SBGrid.DEF.DEBUG_MODE_ALERT_CONSOLE;SBGrid.DEF.m_arrColorNameList=["aliceblue","antiquewhite","aqua","aquamarine","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"];SBGrid.EVT=function(){this.name;this.handler;this.propagate;this.defaultAction};SBGrid.EVT.BUTTON_LEFT=1;SBGrid.EVT.BUTTON_MIDDLE=2;SBGrid.EVT.BUTTON_RIGHT=3;SBGrid.EVT.BACKSPACE=8;SBGrid.EVT.TAB=9;SBGrid.EVT.ENTER=13;SBGrid.EVT.SHIFT=16;SBGrid.EVT.CONTROL=17;SBGrid.EVT.ALT=18;SBGrid.EVT.PAUSE_BREAK=19;SBGrid.EVT.CAPSLOCK=20;SBGrid.EVT.ESC=27;SBGrid.EVT.SPACE=32;SBGrid.EVT.PAGEUP=33;SBGrid.EVT.PAGEDOWN=34;SBGrid.EVT.END=35;SBGrid.EVT.HOME=36;SBGrid.EVT.LEFT=37;SBGrid.EVT.UP=38;SBGrid.EVT.RIGHT=39;SBGrid.EVT.DOWN=40;SBGrid.EVT.INSERT=45;SBGrid.EVT.DELETE=46;SBGrid.EVT.ZERO=48;SBGrid.EVT.ONE=49;SBGrid.EVT.TWO=50;SBGrid.EVT.THREE=51;SBGrid.EVT.FOUR=52;SBGrid.EVT.FIVE=53;SBGrid.EVT.SIX=54;SBGrid.EVT.SEVEN=55;SBGrid.EVT.EIGHT=56;SBGrid.EVT.NINE=57;SBGrid.EVT.A=65;SBGrid.EVT.B=66;SBGrid.EVT.C=67;SBGrid.EVT.D=68;SBGrid.EVT.E=69;SBGrid.EVT.F=70;SBGrid.EVT.G=71;SBGrid.EVT.H=72;SBGrid.EVT.I=73;SBGrid.EVT.J=74;SBGrid.EVT.K=75;SBGrid.EVT.L=76;SBGrid.EVT.M=77;SBGrid.EVT.N=78;SBGrid.EVT.O=79;SBGrid.EVT.P=80;SBGrid.EVT.Q=81;SBGrid.EVT.R=82;SBGrid.EVT.S=83;SBGrid.EVT.T=84;SBGrid.EVT.U=85;SBGrid.EVT.V=86;SBGrid.EVT.W=87;SBGrid.EVT.X=88;SBGrid.EVT.Y=89;SBGrid.EVT.Z=90;SBGrid.EVT.F1=112;SBGrid.EVT.F2=113;SBGrid.EVT.F3=114;SBGrid.EVT.F4=115;SBGrid.EVT.F5=116;SBGrid.EVT.F6=117;SBGrid.EVT.F7=118;SBGrid.EVT.F8=119;SBGrid.EVT.F9=120;SBGrid.EVT.F10=121;SBGrid.EVT.F11=122;SBGrid.EVT.F12=123;SBGrid.EVT.TRANSLANGUAGE=229;SBGrid.DEF.SB_ITEMLIST={};SBGrid.DEF.SB_STYLELIST={};SBGrid.DEF.SB_STYLELIST.left=true;SBGrid.DEF.SB_STYLELIST.right=true;SBGrid.DEF.SB_STYLELIST.top=true;SBGrid.DEF.SB_STYLELIST.bottom=true;SBGrid.DEF.SB_STYLELIST.width=true;SBGrid.DEF.SB_STYLELIST.height=true;SBGrid.DEF.SB_STYLELIST["font-family"]=true;SBGrid.DEF.SB_STYLELIST["font-size"]=true;SBGrid.DEF.SB_STYLELIST["font-weight"]=true;SBGrid.DEF.SB_STYLELIST["font-style"]=true;SBGrid.DEF.SB_STYLELIST["text-decoration"]=true;SBGrid.DEF.SB_STYLELIST.color=true;SBGrid.DEF.SB_STYLELIST["text-align"]=true;SBGrid.DEF.SB_STYLELIST["vertical-align"]=true;SBGrid.DEF.SB_STYLELIST["word-wrap"]=true;SBGrid.DEF.SB_STYLELIST["line-spacing"]=true;SBGrid.DEF.SB_STYLELIST["letter-spacing"]=true;SBGrid.DEF.SB_STYLELIST.padding=true;SBGrid.DEF.SB_STYLELIST["padding-left"]=true;SBGrid.DEF.SB_STYLELIST["padding-top"]=true;SBGrid.DEF.SB_STYLELIST["padding-right"]=true;SBGrid.DEF.SB_STYLELIST["padding-bottom"]=true;SBGrid.DEF.SB_STYLELIST["background-color"]=true;SBGrid.DEF.SB_STYLELIST["background-image"]=true;SBGrid.DEF.SB_STYLELIST["background-repeat"]=true;SBGrid.DEF.SB_STYLELIST["background-position"]=true;SBGrid.DEF.SB_STYLELIST["border-color"]=true;SBGrid.DEF.SB_STYLELIST["border-left-color"]=true;SBGrid.DEF.SB_STYLELIST["border-top-color"]=true;SBGrid.DEF.SB_STYLELIST["border-right-color"]=true;SBGrid.DEF.SB_STYLELIST["border-bottom-color"]=true;SBGrid.DEF.SB_STYLELIST["border-width"]=true;SBGrid.DEF.SB_STYLELIST["border-left-width"]=true;SBGrid.DEF.SB_STYLELIST["border-top-width"]=true;SBGrid.DEF.SB_STYLELIST["border-right-width"]=true;SBGrid.DEF.SB_STYLELIST["border-bottom-width"]=true;SBGrid.DEF.SB_STYLELIST["border-style"]=true;SBGrid.DEF.SB_STYLELIST["border-left-style"]=true;SBGrid.DEF.SB_STYLELIST["border-top-style"]=true;SBGrid.DEF.SB_STYLELIST["border-right-style"]=true;SBGrid.DEF.SB_STYLELIST["border-bottom-style"]=true;SBGrid.DEF.SB_STYLELIST.margin=true;SBGrid.DEF.SB_STYLELIST["margin-left"]=true;SBGrid.DEF.SB_STYLELIST["margin-top"]=true;SBGrid.DEF.SB_STYLELIST["margin-right"]=true;SBGrid.DEF.SB_STYLELIST["margin-bottom"]=true;SBGrid.DEF.SB_STYLELIST.opacity=true;SBGrid.DEF.SB_STYLELIST.clip=true;SBGrid.DEF.SB_STYLELIST.gradient=true;SBGrid.DEF.SB_STYLELIST.cursor=true;SBGrid.DEF.SB_STYLELIST["focus-rect"]=true;SBGrid.DEF.SB_STYLELIST.unloadmark=true;SBGrid.DEF.SB_STYLELIST.display=true;SBGrid.DEF.SB_STYLELIST.overflow=true;SBGrid.DEF.SB_STYLELIST["background-repeat"]=true;SBGrid.DEF.SB_TAGLIST={};SBGrid.DEF.SB_TAGLIST["xhtml:body"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:caption"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:output"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:input"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:secret"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:select"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:select1"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:group"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:datagrid"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:textarea"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:calendar"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:table"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:img"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:object"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:file"]=true;SBGrid.DEF.SB_SRC_CHECKICON="./kr/co/softbowl/image/checkbox/check.png";SBGrid.DEF.SB_SRC_UNCHECKICON="./kr/co/softbowl/image/checkbox/uncheck.png";SBGrid.DEF.STR_SBGRID_ID;SBGrid.DEF.SB_REF_ATTR={};SBGrid.DS.DOMNodeList=function(){this.length=0;this.m_arNode=new Array();this.m_nIterator=0};SBGrid.DS.DOMNodeList.prototype.add=function(a){this.m_arNode.push(a);this.length=this.m_arNode.length};SBGrid.DS.DOMNodeList.prototype.item=function(a){if(0>a&&this.length<=a){return null}return this.m_arNode[a]};SBGrid.DS.DOMNodeList.prototype.nextNode=function(){if(0>this.m_nIterator&&this.length<=this.m_nIterator){return null}return this.m_arNode[this.m_nIterator++]};SBGrid.DS.DOMNodeList.prototype.removeNext=function(){this.m_arNode.splice(this.m_nIterator++,1);this.length=this.m_arNode.length};SBGrid.DS.DOMNodeList.prototype.removeAll=function(){this.m_arNode=new Array();this.m_nIterator=0;this.length=this.m_arNode.length};SBGrid.DS.DOMNodeList.prototype.reset=function(){this.m_nIterator=0};SBGrid.DEF.fextractDupArr=function(d){for(var b=0;b<d.length;b++){var c=0;for(var a=0;a<d.length;a++){if(d[b]!=d[a]){continue}else{c++;if(c>1){spliced=d.splice(a,1)}}}}return d};SBGrid.DEF.arrFind_Value=function(b,a){for(var c=0;c<b.length;c++){var d=b[c];if(d==a){return c}}return -1};SBGrid.DEF.arrRemoveAt=function(b,a){return b.splice(a,1)};SBGrid.DEF.numberASC=function(d,c){return d-c};SBGrid.DEF.numberorder=function(d,c){return d[0]-c[0]};SBGrid.DEF.giveHex=function(a){switch(a){case 10:return"A";case 11:return"B";case 12:return"C";case 13:return"D";case 14:return"E";case 15:return"E";default:return String(a)}};SBGrid.DEF.hex2rgb=function(d,a){var c=d.replace("#","");c=c.match(new RegExp("(.{"+c.length/3+"})","g"));for(var b=0;b<c.length;b++){c[b]=parseInt(c[b].length==1?c[b]+c[b]:c[b],16)}if(typeof a!="undefined"){c.push(a)}return"rgb("+c.join(",")+")"};SBGrid.DEF.rgb2hex=function(b){if(b.search("rgb")==-1){return b}else{if(b=="rgba(0, 0, 0, 0)"){return"transparent"}else{b=b.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/);function a(c){return("0"+parseInt(c).toString(16)).slice(-2)}return"#"+a(b[1])+a(b[2])+a(b[3])}}};SBGrid.DEF.colorNameToHex=function(c,b){var a,d={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",darkgrey:"#a9a9a9",darkslategrey:"#2f4f4f",dimgrey:"#696969",grey:"#808080",lightgray:"#d3d3d3",lightslategrey:"#778899",slategrey:"#708090"};if(d[c.toLowerCase()]!==undefined){a=d[c.toLowerCase()]}else{if(b){a=c}else{a=undefined}}return a};String.prototype.textCharConvert=function(){var a=this;if(!(typeof this=="object"&&this instanceof String)){a=a+""}a=a.replace(/\\n/g,"\n");a=a.replace(/\\r/g,"\r");a=a.replace(/\\t/g,"\t");return a};String.prototype.newlineCharConvert=function(){var a=this;if(!(typeof this=="object"&&this instanceof String)){a=a+""}a=a.replace(/\&/g,"&amp;");a=a.replace(/\</g,"&lt;");a=a.replace(/\>/g,"&gt;");a=a.split(" ").join("&nbsp;");a=a.split("\n").join("<br>");a=a.split("\r").join("");a=a.split("\t").join("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");return a};String.prototype.newlineCharNoBrConvert=function(){var a=this;if(!(typeof this=="object"&&this instanceof String)){a=a+""}a=a.replace(/\&/g,"&amp;");a=a.replace(/\</g,"&lt;");a=a.replace(/\>/g,"&gt;");a=a.split(" ").join("&nbsp;");a=a.split("\r").join("");a=a.split("\t").join("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");return a};String.prototype.invertRGB=function(){var f=this;var a=this;if(!(typeof this=="object"&&this instanceof String)){f=f+"";a=a+""}if(-1!=this.indexOf("rgb")){var e=a.substring(a.indexOf("(")+1,a.length);var c=e.split(/\,/g);f="#";for(var d=0;d<c.length;d++){f+=SBGrid.DEF.giveHex(Math.floor(parseInt(c[d])/16));f+=SBGrid.DEF.giveHex(parseInt(c[d])%16)}}var b="";for(var d=0;d<f.length;d++){switch(f.charAt(d)){case"F":case"f":b+="0";break;case"E":case"e":b+="1";break;case"D":case"d":b+="2";break;case"C":case"c":b+="3";break;case"B":case"b":b+="4";break;case"A":case"a":b+="5";break;case"9":b+="6";break;case"8":b+="7";break;case"7":b+="8";break;case"6":b+="9";break;case"5":b+="A";break;case"4":b+="B";break;case"3":b+="C";break;case"2":b+="D";break;case"1":b+="E";break;case"0":b+="F";break;default:b+=f.charAt(d);break}}return b};String.prototype.formatting=function(n){if(""==n){return this}var a=this;if(!(typeof this=="object"&&this instanceof String)){a=a+""}var d="";if(/\((\D+)\)/.test(n)){d=n.substring(n.indexOf("("),n.indexOf(")")+1);n=n.substring(d.length,n.length)}var g="";var o="";if(/\'(\D+)\'/.test(n)){g=n.substring(n.indexOf("'"),n.lastIndexOf("'")+1);n=n.substring(0,n.length-g.length);o=g.substring(1,g.length-1)}if(n.indexOf("9#")){n=n.replace("9#","#")}if("-1"==n.indexOf("#")&&"-1"==n.indexOf("0")){return SBGrid.DEF.inputValidateCheck(n,a,d)}else{var q="";var f=n.indexOf(".");var m="-1"!=n.indexOf(",")?1:0;m="-1"!=f?(m+2):m;var c=false;switch(m){case 2:case 3:c=true;break}if(""!=d){d=d.charAt(1);if(d!=a.charAt(0)){d=""}}var l="";if(-1!=f){while("0"==n.charAt((f+1))){l+="0";f++}}else{if(-1!=a.indexOf(".")){a=a.substring(0,a.indexOf("."))}}var e=0;a=a.replace(/[^.\d]/g,"");if("9#"!=n){for(var h=0;h<a.length;h++){if("0"!=a.charAt(h)){e=h;if(0!=h&&"."==a.charAt(h)){e--}break}}}a=a.substring(e,a.length);switch(m){case 0:q=SBGrid.DEF.inputMoneyUnitValidateCheckPattern3(a,n,l);break;case 1:q=SBGrid.DEF.inputMoneyUnitValidateCheckPattern2(a,c,l);break;case 2:q=SBGrid.DEF.inputMoneyUnitValidateCheckPattern3(a,n,l);break;case 3:if(-1==a.indexOf(".")){q=SBGrid.DEF.inputMoneyUnitValidateCheckPattern2(a,c,l);if(""!=l){q+="."+l}}else{var b=a.indexOf(".");q+=SBGrid.DEF.inputMoneyUnitValidateCheckPattern2(a.substring(0,b),c,l);q+=".";var p=SBGrid.DEF.inputMoneyUnitValidateCheckPattern1(a.substring(b+1,a.length),l);q+=p}break}if(""!=d){q=d+q}if(null!=o&&""!=o){q+=o}return q}};String.prototype.isRegular=function(c){var a=this;if(!(typeof this=="object"&&this instanceof String)){a=a+""}var b=a.match(c);if(null!=b){return true}else{return false}};String.prototype.insertAttribute=function(b,d){if(!b||!d){return this}var c=this;var a=c.lastIndexOf(">");if(-1==a){return this}var c=c.substring(0,a);c=c+" "+b+'="'+d+'">';return c};String.prototype.isEmpty=function(){var a=this;if(!(typeof this=="object"&&this instanceof String)){a=a+""}if(0<a.length){return false}else{return true}};String.prototype.trim=function(){var a=this;if(!(typeof this=="object"&&this instanceof String)){a=a+""}return a.replace(/(^\s*)|(\s*$)/g,"")};String.prototype.compactTrim=function(){var a=this;if(!(typeof this=="object"&&this instanceof String)){a=a+""}return a.replace(/(\s*)/g,"")};String.prototype.replaceAll=function(c,b){var a=this;if(!(typeof this=="object"&&this instanceof String)){a=a+""}return a.split(c).join(b)};String.prototype.getByte=function(){var a=this;if(!(typeof this=="object"&&this instanceof String)){a=a+""}var c=0;for(var b=0;b<a.length;b++){if(a.charCodeAt(b)>127){c+=2}else{c++}}return c};String.prototype.setByteWithStrLength=function(d){var b=0;var c="";for(var a=0;a<this.length&&b<d;a++){if(this.charCodeAt(a)>127){b+=2;c+=this.charAt(a)}else{b++;c+=this.charAt(a)}}return c};String.prototype.changeExtension=function(e,d){var a=this;if(!(typeof this=="object"&&this instanceof String)){a=a+""}var b=a.lastIndexOf(".");if(b>0&&b<a.length&&e==a.substr(b+1)){var c=a.substring(0,b);return c+"."+d}return a};SBGrid.UT.URIEncoder=function(){};SBGrid.UT.URIEncoder.encode=function(e,b){b=b.toUpperCase();if(""==b||"UTF-8"==b||"UTF-16"==b){return encodeURIComponent(e)}else{var c=new SBGrid.UT.HttpClient();var d="encode="+b+"&value="+encodeURIComponent(e);var a=c.post(SBGrid.DEF.__getAppName()+"kr/co/softbowl/jsp/encoding.jsp",d);if(null!=a){return a.trim()}}return e};SBGrid.DS.Point=function(b,a){this.m_nX=b;this.m_nY=a};SBGrid.DS.Point.prototype.clone=function(){return new SBGrid.DS.Point(this.m_nX,this.m_nY)};SBGrid.DS.Point.prototype.getX=function(){return this.m_nX};SBGrid.DS.Point.prototype.setX=function(a){this.m_nX=a};SBGrid.DS.Point.prototype.getY=function(){return this.m_nY};SBGrid.DS.Point.prototype.setY=function(a){this.m_nY=a};SBGrid.DEF.getRoundMode=function(f,a,e){var h=f.split(/\./g);var d=Number(e);if(d<0&&null!=h[1]){if(Math.abs(d)>h[1].length){return f}else{if("round"==a){if(parseInt(h[1].charAt(Math.abs(d)-1))>4){a="ceil"}else{a="floor"}}if("ceil"==a){if(-1==d){return String(Number(h[0])+1)}else{var g="0.";for(var c=0;c<(Math.abs(d)-1);c++){if((c+1)==(Math.abs(d)-1)){g+="1";break}else{g+="0"}}if("1"==h[1].substring(0,Math.abs(d)-1)){return h[0]+".2"}var b=Number(h[0]+"."+h[1].substring(0,Math.abs(d)-1))+Number(g);return String(b.toFixed(Math.abs(d)-1))}}else{if(-1==d){return h[0]}else{return h[0]+"."+h[1].substring(0,Math.abs(d)-1)}}}}else{if(d>0){if(d>h[0].length){return f}else{if("round"==a){if(parseInt(h[0].charAt(h[0].length-d))>4){a="ceil"}else{a="floor"}}if("ceil"==a){if(h[0].length==d){return String(Math.pow(10,d))}else{var g=h[0].substring(0,h[0].length-d);for(var c=0;c<d;c++){g+="0"}return String(Number(g)+Math.pow(10,d))}}else{if(h[0].length==d){return"0"}else{var g=h[0].substring(0,h[0].length-d);for(var c=0;c<d;c++){g+="0"}return g}}}}else{return f}}return f};SBGrid.DS.Rectangle=function(d,c,b,a){this.m_nX=d;this.m_nY=c;this.m_nWidth=b;this.m_nHeight=a;this.m_nBottom;this.m_nRight;this.adjustButtomRight()};SBGrid.DS.Rectangle.prototype.getX=function(){return this.m_nX};SBGrid.DS.Rectangle.prototype.getY=function(){return this.m_nY};SBGrid.DS.Rectangle.prototype.setX=function(a){this.m_nX=a;this.adjustButtomRight()};SBGrid.DS.Rectangle.prototype.setY=function(a){this.m_nY=a;this.adjustButtomRight()};SBGrid.DS.Rectangle.prototype.getWidth=function(){return this.m_nWidth};SBGrid.DS.Rectangle.prototype.setWidth=function(a){this.m_nWidth=a;this.adjustButtomRight()};SBGrid.DS.Rectangle.prototype.getHeight=function(){return this.m_nHeight};SBGrid.DS.Rectangle.prototype.setHeight=function(a){this.m_nHeight=a;this.adjustButtomRight()};SBGrid.DS.Rectangle.prototype.getBottom=function(){return this.m_nBottom};SBGrid.DS.Rectangle.prototype.getRight=function(){return this.m_nRight};SBGrid.DS.Rectangle.prototype.adjustButtomRight=function(){this.m_nRight=this.m_nX+this.m_nWidth;this.m_nBottom=this.m_nY+this.m_nHeight};SBGrid.DS.Rectangle.prototype.isContainsPoint=function(a){if(null!=a&&a instanceof Point){if(this.m_nX<=a.getX()&&this.m_nRight>=a.getX()&&this.m_nY<=a.getY()&&this.m_nBottom>=a.getY()){return true}}return false};SBGrid.DEF.inputValidateCheck=function(h,a,c){var l="";var b="";var d=0;var g=0;var e=h.length;if(""!=c){c=c.charAt(1);if(c!=a.charAt(0)){c=""}}reSpecialChar=/\s/g;a=a.replace(reSpecialChar,"");reSpecialChar=/\W/g;a=a.replace(reSpecialChar,"");for(var f=0;f<e;f++){if(d!=e&&""!=a.charAt(g)){if("9"!=h.charAt(d)&&"y"!=h.charAt(d)&&"m"!=h.charAt(d)&&"d"!=h.charAt(d)&&"h"!=h.charAt(d)&&"n"!=h.charAt(d)&&"s"!=h.charAt(d)&&"A"!=h.charAt(d)&&"a"!=h.charAt(d)&&"C"!=h.charAt(d)&&"L"!=h.charAt(d)){l=l+h.charAt(d);d++}else{for(;g<a.length;g++){b=SBGrid.DEF.validateFormat(d,a.charAt(g),h,a);if(""!=b){l=l+b;g++;if("9"!=h.charAt(d+1)&&"y"!=h.charAt(d+1)&&"m"!=h.charAt(d+1)&&"d"!=h.charAt(d+1)&&"h"!=h.charAt(d+1)&&"n"!=h.charAt(d+1)&&"s"!=h.charAt(d+1)&&"A"!=h.charAt(d+1)&&"a"!=h.charAt(d+1)&&"C"!=h.charAt(d+1)&&"L"!=h.charAt(d+1)){l=l+h.charAt(d+1);d++}break}}d++}}}if(""!=c){l=c+l}return l};SBGrid.DEF.validateFormat=function(a,e,c,b){var d=e.charCodeAt(0);switch(c.charAt(a)){case"9":if(d>=48&&d<=57){return String.fromCharCode(d)}return"";case"y":if(d>=48&&d<=57){return String.fromCharCode(d)}return"";case"m":if("m"==c.charAt(a+1)){if(d>=48&&d<=49){return String.fromCharCode(d)}}else{if("m"==c.charAt(a-1)&&"1"==b.charAt(a-1)){if(d>=48&&d<=50){return String.fromCharCode(d)}}else{if(d>=48&&d<=57){return String.fromCharCode(d)}}}return"";case"d":if("d"==c.charAt(a+1)){if("m"==c.charAt(a-2)&&"2"==b.charAt(a-2)&&(("m"==c.charAt(a-3)&&"0"==b.charAt(a-3))||"m"!=c.charAt(a-3))){if(d>=48&&d<=50){return String.fromCharCode(d)}}else{if(d>=48&&d<=51){return String.fromCharCode(d)}}}else{if("d"==c.charAt(a-1)&&"3"!=b.charAt(a-1)){if(d>=48&&d<=57){return String.fromCharCode(d)}}else{if("d"==c.charAt(a-1)&&"3"==b.charAt(a-1)){if(d>=48&&d<=49){return String.fromCharCode(d)}}else{if(d>=48&&d<=57){return String.fromCharCode(d)}}}}return"";case"h":if("h"==c.charAt(a+1)){if(d>=48&&d<=50){return String.fromCharCode(d)}}else{if("h"==c.charAt(a-1)&&"2"==b.charAt(a-1)){if(d>=48&&d<=57){return String.fromCharCode(d)}}else{if(d>=48&&d<=57){return String.fromCharCode(d)}}}return"";case"n":if("n"==c.charAt(a+1)){if(d>=48&&d<=53){return String.fromCharCode(d)}}else{if(d>=48&&d<=57){return String.fromCharCode(d)}}return"";case"s":if("s"==c.charAt(a+1)){if(d>=48&&d<=53){return String.fromCharCode(d)}}else{if(d>=48&&d<=57){return String.fromCharCode(d)}}return"";case"A":if((d>=48&&d<=57)||(d>=65&&d<=90)||(d>=97&&d<=129)){return e}return"";case"a":if((d==32)||(d>=48&&d<=57)||(d>=65&&d<=90)||(d>=97&&d<=129)){return e}return"";case"C":if((d>=48&&d<=112)||d>185||(d>=97&&d<=129)){return e}return"";case"L":if((d>=65&&d<=90)||(d>=97&&d<=129)){return e}return"";default:alert("미구현");return""}};SBGrid.DEF.inputMoneyUnitValidateCheckPattern1=function(a,d){var c="";var e=a.length;e=0==d.length?e:d.length;for(var b=0;b<e;b++){if(""!=a.charAt(b)){c+=a.charAt(b);continue}else{c+="0"}}return c};SBGrid.DEF.inputMoneyUnitValidateCheckPattern2=function(a,b,g){var l="";a=a.replace(/\D/g,"");var e=a.length;var c=e%3;var h=(e/2)-1;var n=0;var f=0;var m=false;for(var d=0;d<e;d++){if(0==d&&a.charCodeAt(d)==48){l=a.charAt(d)}else{if(c==n){if(e>3&&c!=0){l=l+",";m=true}else{if(e>3){m=true}}}if(3==f){l=l+",";f=0}l+=a.charAt(d);n++;if(m){f++}}}if(""==l&&b&&""!=g){l="0"}return l};SBGrid.DEF.inputMoneyUnitValidateCheckPattern3=function(b,h,e){var d="";b=b.replace(/[^\.\d]/g,"");var g=0==e.length?0:e.length;var f=b.length;for(var c=0;c<f;c++){d+=b.charAt(c)}if(""==d&&"0"==h.replace(/[^\.\d]/g,"").charAt(0)){d="0"}if(-1!=b.indexOf(".")){var a=b.substring(b.indexOf("."),f).length;for(var c=a;c<=g;c++){d+="0"}}else{if(0<g){d+=".";for(var c=0;c<g;c++){d+="0"}}}return d};SBGrid.DEF.formatStatus=function(a){if(""==a){return 0}var b;if("-1"==a.indexOf("#")&&"-1"==a.indexOf("0")){return 1}else{b="-1"!=a.indexOf(",")?3:2;b="-1"!=a.indexOf(".")?(b+2):b;return b}};SBGrid.DS.CaretPosition=function(){var b=null;var a=null};SBGrid.DEF.getCaretPosition=function(a){var d=new SBGrid.DS.CaretPosition();if("selectionStart" in a){d.start=a.selectionStart;d.end=a.selectionEnd;return d}if(document.selection){var e=document.selection.createRange().getBookmark();var b=a.createTextRange();b.moveToBookmark(e);var c=a.createTextRange();c.collapse(true);c.setEndPoint("EndToStart",b);d.start=c.text.length;d.end=c.text.length+b.text.length}else{if(a.selectionStart||a.selectionStart=="0"){d.start=a.selectionStart;d.end=a.selectionEnd}}return d};SBGrid.DEF.setCaretPosition=function(a,c,f){try{if(document.selection){a.blur();a.focus();a.value=a.value;var b=a.createTextRange();b.moveStart("character",-a.value.length);b.moveEnd("character",-a.value.length);b.moveStart("character",c);b.moveEnd("character",f-c);b.select()}else{if(a.selectionStart||a.selectionStart=="0"){a.selectionStart=null;a.selectionEnd=null;a.selectionStart=c;a.selectionEnd=f;a.focus()}}}catch(d){SBGrid.DEF.errorMsg("SBGrid.DEF.setCaretPosition::"+d)}};SBGrid.DEF.getSelectionText=function(a){var b="";if(document.selection){b=document.selection.createRange();return b.text}else{if(null!=a&&null!=a.selectionStart){return a.value.substring(a.selectionStart,a.selectionEnd)}else{return window.getSelection()}}};SBGrid.DEF.setSelectionText=function(b,a){if(document.selection){var d=document.selection.createRange();d.text=a}else{var c=b.selectionStart;var e=0!=b.selectionStart?b.value.substring(0,b.selectionStart):"";var f=b.value.substring(b.selectionEnd,b.value.length);b.value=e+a+f;b.focus();b.selectionStart=c;b.selectionEnd=c+a.length}};SBGrid.DEF.getInputKeyCode=function(a){if((48<=a&&57>=a)||(65<=a&&90>=a)||(96<=a&&111>=a)||(219<=a&&222>=a)||(186<=a&&192>=a)||32==a||229==a){return true}return false};SBGrid.DEF.__initWindowAndDocSize=function(){window.nViewportWidth=null;window.nViewportHeight=null;if(typeof window.innerWidth!="undefined"){window.nViewportWidth=window.innerWidth;window.nViewportHeight=window.innerHeight}else{if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!=0){window.nViewportWidth=document.documentElement.clientWidth;window.nViewportHeight=document.documentElement.clientHeight}else{window.nViewportWidth=document.getElementsByTagName("body")[0].clientWidth;window.nViewportHeight=document.getElementsByTagName("body")[0].clientHeight}}};SBGrid.DEF.errorMsg=function(a){if(window.console){console.log(a)}};SBGrid.DEF.APIerrorMsg=function(a,b,d){if(d<0||d>3){d=SBGrid.DEF.DEBUGMODE_ALERT_CONSOLE}var c="SBGrid API '"+a+"()' ERROR!!\n";c+=b;if(d==SBGrid.DEF.DEBUG_MODE_CONSOLE||d==SBGrid.DEF.DEBUG_MODE_ALERT_CONSOLE){SBGrid.DEF.errorMsg(c)}if(d==SBGrid.DEF.DEBUG_MODE_ALERT||d==SBGrid.DEF.DEBUG_MODE_ALERT_CONSOLE){alert(c)}};SBGrid.DEF.makeStyleSheetClass=function(a,b){SBGrid.DEF.createCSSRule("."+a,b)};SBGrid.DEF.createCSSRule=function(g,e){if(g.indexOf(" ")>-1){return}var d=document.getElementById("SBHE_SBGrid_Style");if(d==undefined){d=document.createElement("style");d.setAttribute("id","SBHE_SBGrid_Style");d.setAttribute("type","text/css");document.getElementsByTagName("head")[0].appendChild(d)}var b=d.sheet?d.sheet:d.styleSheet;var c=b.cssRules||b.rules;if(c){var a=null;var f=c.length;while(f){a=c[--f];if(g==a.selectorText){if(b.cssRules){b.deleteRule(f)}else{b.removeRule(f)}}}}if(b.insertRule){b.insertRule(g+"{"+e+"}",0)}else{b.addRule(g,e==""?"{}":e,0)}d=b=null};SBGrid.DEF.findCSSRule=function(d){var l=document.styleSheets,h=l.length,c=[],g,b,e;var a=RegExp("\\b"+d+"\\b","i");for(var f=0;f<h;++f){g=l[f].cssRules||l[f].rules;if(g){b=g.length;while(b){e=g[--b];if(a.test(e.selectorText)){c.push(e.style)}}}}return c};SBGrid.DEF.findCSSRuleEx=function(c){var d=[];try{var e=SBGrid.DEF.findCSSRule(c);for(var h=0;h<e.length;h++){var m=new SBGrid.DS.Collection();var l=e[h];var a=l.cssText.split(";");for(var g=0;g<a.length;g++){var b=a[g].trim();if(b.isEmpty()){b=null;continue}var f=a[g].split(":");if(f.length==2){m.add(f[0].trim(),f[1].trim())}SBGrid.DEF.clearArray(f);f=null;b=null}d.push(SBGrid.US.clone(m));l=null;m=null}e=null;return SBGrid.US.clone(d)}finally{SBGrid.DEF.clearArray(d);d=null}};SBGrid.DEF.findToMakeStyleSheet=function(b){var a=SBGrid.DEF.findCSSRule(b);if(a.length==1){return a[0]}else{if(a.length>1){return a}else{SBGrid.DEF.createCSSRule("."+b,"");return SBGrid.DEF.findToMakeStyleSheet(b)}}};SBGrid.DEF.uploadUsingPOST=function(c,b){var d=new XMLHttpRequest();d.onreadystatechange=function(){if(4==this.readyState){if(200==this.status){var n=this.responseText;if(null!=n||!n.isEmpty()){n=n.trim();if(n){var f=SBGrid.UT.XmlLib.loadXMLFromString(n);if(f.selectSingleNode("/root")){var p=f.selectSingleNode("/root/tagName");var g=f.selectSingleNode("/root/fileName");var h=f.selectSingleNode("/root/tempName");var e=f.selectSingleNode("/root/filePath");var m=SBGrid.UT.XmlLib.getTextValue(p);var o=SBGrid.UT.XmlLib.getTextValue(g);var i=SBGrid.UT.XmlLib.getTextValue(h).replaceAll(SBGrid.UT.XmlLib.getTextValue(e),"");var l=document.SBHE_controls.item(m.substring(3,m.lastIndexOf(".")));l.setAttachedFile(o,i)}l.dispatch("onfileselected")}}}else{throw new Error(this.status)}}};d.open("POST",SBGrid.DEF.__getAppName()+"/FileUpload.tfs",true);var a=new FormData();a.append(c,b);d.send(a)};SBGrid.DEF.RGB_convert=function(c){var e=c.toString(16);var d="";var a=e.length;for(var b=a;b<6;b++){d+="0"}d+=e;e=d.substring(4,6)+d.substring(2,4)+d.substring(0,2);return e};SBGrid.DEF.__initDocument=function(){if(document.SBHE_allElement==undefined){document.SBHE_allElement=new SBGrid.DS.Collection()}if(document.SBHE_controls==undefined){document.SBHE_controls=new SBGrid.DS.Collection()}if(document.SBHE_grids==undefined){document.SBHE_grids=new SBGrid.DS.Collection()}};SBGrid.DEF.__initControls=function(){for(var b=0;b<document.SBHE_controls.count();b++){var a=document.SBHE_controls.item(b);if(null!=a){a.init()}}};SBGrid.DEF.__appendAll=function(b,a){document.SBHE_allElement.add(b,a)};SBGrid.DEF.__removeAll=function(a){document.SBHE_allElement.remove(a)};SBGrid.DEF.__appendControl=function(b,a){document.SBHE_controls.add(b,a)};SBGrid.DEF.__removeControl=function(a){document.SBHE_controls.remove(a)};SBGrid.DEF.__appendGrid=function(b,a){document.SBHE_grids.add(b,a)};SBGrid.DEF.__removeGrid=function(a){document.SBHE_grids.remove(a)};SBGrid.DEF.__getSBGridList=function(b){var a=[];if(document.SBHE_grids){a=document.SBHE_grids.keys()}return a};createSBDataGrid=function(e){if(arguments.length!=1){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof e!="object"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if parameter's type is 'object'.",SBGrid.DEF.DEBUG_MODE);return}else{if(!(e.strParentId)||!(document.getElementById(e.strParentId))){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check 'strParentId' property of SBGrid.",SBGrid.DEF.DEBUG_MODE);return}if(!(e.strId)){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check 'strId' property of SBGrid.",SBGrid.DEF.DEBUG_MODE);return}else{if((typeof e.strId)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strId' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(SBGrid.getGrid(e.strId)){SBGrid.getGrid(e.strId).destroy()}if(!(e.strTheme)){e.strTheme=""}else{if((typeof e.strTheme)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strTheme' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}var d=document.getElementById(e.strParentId);if(d.tagName=="BODY"||e.strParentId=="body"){SBGrid.CT.DataGrid.initEngine(e.strParentId,e.strTheme)}else{if(d.tagName=="DIV"){var b="body";if(document.body.id!=null&&document.body.id!=""){b=document.body.id}else{document.body.id=b}SBGrid.CT.DataGrid.initEngine(b,e.strTheme);var a=SBGrid.DS.SBBody.createChild("softbowl:DIV","id:"+e.strParentId)}}if(!(e.strAlert)){e.strAlert=""}else{if((typeof e.strAlert)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strAlert' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strHelp)){e.strHelp=""}else{if((typeof e.strHelp)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strHelp' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strHint)){e.strHint=""}else{if((typeof e.strHint)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strHint' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bAllowBigSelection==undefined){e.bAllowBigSelection=false}else{if((typeof e.bAllowBigSelection)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bAllowBigSelection' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bAllowSelection==undefined){e.bAllowSelection=true}else{if((typeof e.bAllowSelection)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bAllowSelection' property's type is  'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bIsTextareaScroll==undefined){e.bIsTextareaScroll=true}else{if((typeof e.bIsTextareaScroll)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bIsTextareaScroll' property's type is  'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bOneClickEdit==undefined){e.bOneClickEdit=false}else{if((typeof e.bOneClickEdit)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bOneClickEdit' property's type is  'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bAllowUserResize==undefined){e.bAllowUserResize=true}else{if((typeof e.bAllowUserResize)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bAllowUserResize' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bAutoResize==undefined){e.bAutoResize=false}else{if((typeof e.bAutoResize)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bAutoResize' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bAutoSizeMouse==undefined){e.bAutoSizeMouse=false}else{if((typeof e.bAutoSizeMouse)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bAutoSizeMouse' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bAutoResizeCaption==undefined){e.bAutoResizeCaption=false}else{if((typeof e.bAutoResizeCaption)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bAutoResizeCaption' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strBackColorAlternate)){e.strBackColorAlternate=""}else{if(SBGrid.DEF.vaildCheckOfColor(e.strBackColorAlternate)==false){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strBackColorAlternate' property's value.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strBackColorFrozen)){e.strBackColorFrozen=""}else{if(SBGrid.DEF.vaildCheckOfColor(e.strBackColorFrozen)==false){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strBackColorFrozen' property's value.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strCellFocusColor)){e.strCellFocusColor=""}else{if(SBGrid.DEF.vaildCheckOfColor(e.strCellFocusColor)==false){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strCellFocusColor' property's value.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strCaption)){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check 'strCaption' property of SBGrid.\nex> 'caption1^caption2^caption3'",SBGrid.DEF.DEBUG_MODE);return}else{if((typeof e.strCaption)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strCaption' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strColSep)){e.strColSep="^"}else{if((typeof e.strColSep)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strColSep' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strColWidth)){e.strColWidth="";var f=e.strCaption.split("^");for(var c=1;c<=f.length;c++){e.strColWidth+="100";if(c==f.length){break}e.strColWidth+=","}}else{if((typeof e.strColWidth)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strColWidth' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}e.strColWidth=e.strColWidth.replace(/ /g,"")}if(!(e.strDataType)){e.strDataType="xml"}else{if((typeof e.strDataType)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strDataType' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.nDefaultRows)){e.nDefaultRows=0}else{if((typeof e.nDefaultRows)!="number"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'nDefaultRows' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bDisabled==undefined){e.bDisabled=false}else{if((typeof e.bDisabled)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bDisabled' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bDragMode==undefined){e.bDragMode=true}else{if((typeof e.bDragMode)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bDragMode' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bDropmode==undefined){e.bDropmode=false}else{if((typeof e.bDropmode)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bDropmode' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bEllipsis==undefined){e.bEllipsis=false}else{if((typeof e.bEllipsis)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bEllipsis' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strExplorerbar)){e.strExplorerbar=""}else{if((typeof e.strExplorerbar)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strExplorerbar' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strExplorerUI)){e.strExplorerUI=""}else{if((typeof e.strExplorerUI)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strExplorerUI' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strExtendLastCol)){e.strExtendLastCol="false"}else{if((typeof e.strExtendLastCol)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strExtendLastCol' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.nFixedCols)){e.nFixedCols=0}else{if((typeof e.nFixedCols)!="number"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'nFixedCols' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strFocusColor)){e.strFocusColor=""}else{if(SBGrid.DEF.vaildCheckOfColor(e.strFocusColor)==false){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strFocusColor' property's value.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strForeColorFrozen)){e.strForeColorFrozen=""}else{if(SBGrid.DEF.vaildCheckOfColor(e.strForeColorFrozen)==false){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strForeColorFrozen' property's value.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.nFrozenBottomRows)){e.nFrozenBottomRows=0}else{if((typeof e.nFrozenBottomRows)!="number"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'nFrozenBottomRows' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.nFrozenCols)){e.nFrozenCols=0}else{if((typeof e.nFrozenCols)!="number"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'nFrozenCols' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.nFrozenRows)){e.nFrozenRows=0}else{if((typeof e.nFrozenRows)!="number"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'nFrozenRows' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strMergeCellsFixedRows)){e.strMergeCellsFixedRows="bycolrec"}else{if((typeof e.strMergeCellsFixedRows)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strMergeCellsFixedRows' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bMultiTotal==undefined){e.bMultiTotal=true}else{if((typeof e.bMultiTotal)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bMultiTotal' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.strNodeSet){if((typeof e.strNodeSet)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strNodeSet' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}e.strJsonRef=""}if(e.strJsonRef){if((typeof e.strJsonRef)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strJsonRef' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}e.strNodeSet=""}if(e.bRemoveHScroll==undefined){e.bRemoveHScroll=false}else{if((typeof e.bRemoveHScroll)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bRemoveHScroll' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bRemoveVScroll==undefined){e.bRemoveVScroll=false}else{if((typeof e.bRemoveVScroll)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bRemoveVScroll' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.nRows)){e.nRows=0}else{if((typeof e.nRows)!="number"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'nRows' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strRowSep)){e.strRowSep="|"}else{if((typeof e.strRowSep)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strRowSep' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strSelectFontColor)){e.strSelectFontColor=""}else{if((typeof e.strSelectFontColor)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strSelectFontColor' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strSelectFontColorStyle)){e.strSelectFontColorStyle="invert"}else{if((typeof e.strSelectFontColorStyle)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strSelectFontColorStyle' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strSelectImageStyle)){e.strSelectImageStyle="invert"}else{if((typeof e.strSelectImageStyle)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strSelectImageStyle' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strSelectMode)){e.strSelectMode="listbox"}else{if((typeof e.strSelectMode)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strSelectMode' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strSubTotalPosition)){e.strSubTotalPosition="above"}else{if((typeof e.strSubTotalPosition)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strSubTotalPosition' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strStyle)){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check 'strStyle' property of SBGrid.",SBGrid.DEF.DEBUG_MODE);return}else{if((typeof e.strStyle)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strStyle' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strToolTip)){e.strToolTip=""}else{if((typeof e.strToolTip)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strToolTip' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strVisibility)){e.strVisibility="visible"}else{if((typeof e.strVisibility)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strVisibility' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bIsDecimalFormatInsert==undefined){e.bIsDecimalFormatInsert=false}else{if((typeof e.bIsDecimalFormatInsert)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bIsDecimalFormatInsert' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!e.strUserDefineAttrib){e.strUserDefineAttrib="automerge:false;"}else{if((typeof e.strUserDefineAttrib)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strUserDefineAttrib' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}e.strUserDefineAttrib="automerge:false;"+e.strUserDefineAttrib}if(!(e.strSummary)){e.strSummary=""}else{if((typeof e.strSummary)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strSummary' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strDataReplace)){e.strDataReplace="undefined"}else{if((typeof e.strDataReplace)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strDataReplace' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bIsDataReplaceValueChanged==undefined){e.bIsDataReplaceValueChanged=false}else{if((typeof e.bIsDataReplaceValueChanged)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bIsDataReplaceValueChanged' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strDataHeight)){e.strDataHeight=""}else{if((typeof e.strDataHeight)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strDataHeight' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strRowHeader)){e.strRowHeader=""}else{if((typeof e.strRowHeader)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strRowHeader' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strRowHeight)){e.strRowHeight=""}else{if((typeof e.strRowHeight)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strRowHeight' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strDeleteFlagImage)){e.strDeleteFlagImage=""}else{if((typeof e.strDeleteFlagImage)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strDeleteFlagImage' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strInsertFlagImage)){e.strInsertFlagImage=""}else{if((typeof e.strInsertFlagImage)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strInsertFlagImage' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strNormalFlagImage)){e.strNormalFlagImage=""}else{if((typeof e.strNormalFlagImage)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strNormalFlagImage' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strUpdateFlagImage)){e.strUpdateFlagImage=""}else{if((typeof e.strUpdateFlagImage)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strUpdateFlagImage' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strEmptyRecords)){e.strEmptyRecords=""}else{if((typeof e.strEmptyRecords)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strEmptyRecords' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strEmptyRecordsFontStyle)){e.strEmptyRecordsFontStyle=""}else{if((typeof e.strEmptyRecordsFontStyle)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strEmptyRecordsFontStyle' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.nRenderingRows)){e.nRenderingRows=null}else{if((typeof e.nRenderingRows)!="number"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'nRenderingRows' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bAllowCopy==undefined){e.bAllowCopy=false}else{if((typeof e.bAllowCopy)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bAllowCopy' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bCellsInfoDisplay==undefined){e.bCellsInfoDisplay=false}else{if((typeof e.bCellsInfoDisplay)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bCellsInfoDisplay' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bAllowPaste==undefined){e.bAllowPaste=false}else{if((typeof e.bAllowPaste)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bAllowPaste' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bContextMenu==undefined){e.bContextMenu=false}else{if((typeof e.bContextMenu)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bContextMenu' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}else{if(e.bContextMenu==true){document.getElementById(e.strParentId).oncontextmenu=new Function("return false")}}}if(!(e.arContextMenuList)){e.arContextMenuList=[]}else{if(!(e.arContextMenuList instanceof Array)){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'arContextMenuList' property's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.arCalcParam)){e.arCalcParam=[]}else{if(!(e.arCalcParam instanceof Array)){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'arCalcParam' property's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bDataSearching==undefined){e.bDataSearching=false}else{if((typeof e.bDataSearching)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bDataSearching' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bAutoSavePsnlData==undefined){e.bAutoSavePsnlData=false}else{if((typeof e.bAutoSavePsnlData)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bAutoSavePsnlData' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strPsnlDataId)){e.strPsnlDataId=""}else{if((typeof e.strPsnlDataId)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strPsnlDataId' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bUseWebAccess==undefined){e.bUseWebAccess=false}else{if((typeof e.bUseWebAccess)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bUseWebAccess' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strGridSummary)){e.strGridSummary=""}else{if((typeof e.strGridSummary)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strGridSummary' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strUserCaption)){e.strUserCaption=""}else{if((typeof e.strUserCaption)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strUserCaption' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bUseWebAccess==undefined){e.bUseWebAccess=false}else{if((typeof e.bUseWebAccess)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bUseWebAccess' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strBeforeElementId)){e.strBeforeElementId=""}else{if((typeof e.strBeforeElementId)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strBeforeElementId' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strNextElementId)){e.strNextElementId=""}else{if((typeof e.strNextElementId)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strNextElementId' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bRealDataSync==undefined){e.bRealDataSync=true}else{if((typeof e.bRealDataSync)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bRealDataSync' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.arExtRefList)){e.arExtRefList=[]}else{if(!(e.arExtRefList instanceof Array)){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'arExtRefList' property's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.nScrollingDelayTime)){e.nScrollingDelayTime=200}else{if((typeof e.nScrollingDelayTime)!="number"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'nScrollingDelayTime' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}else{if(e.nScrollingDelayTime<0){e.nScrollingDelayTime=200}}}if(e.bIsShowLoadingImage==undefined){e.bIsShowLoadingImage=true}else{if((typeof e.bIsShowLoadingImage)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bIsShowLoadingImage' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bUseMultiSorting==undefined){e.bUseMultiSorting=false}else{if((typeof e.bUseMultiSorting)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bUseMultiSorting' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bIsSortFrozenRows==undefined){e.bIsSortFrozenRows=true}else{if((typeof e.bIsSortFrozenRows)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bIsSortFrozenRows' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bIsSortFrozenBottomRows==undefined){e.bIsSortFrozenBottomRows=true}else{if((typeof e.bIsSortFrozenBottomRows)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bIsSortFrozenBottomRows' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bComboDataSync==undefined){e.bComboDataSync=false}else{if((typeof e.bComboDataSync)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bComboDataSync' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.bUseFrozenSelect==undefined){e.bUseFrozenSelect=true}else{if((typeof e.bUseFrozenSelect)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bUseFrozenSelect' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}switch(e.strTheme){case"metal":SBGrid.DEF.imgWait="kr/co/softbowl/imageMetal/datagrid/wait_Metal.png";SBGrid.DEF.imgCheck="kr/co/softbowl/imageMetal/checkbox/check.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/imageMetal/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/imageMetal/radio/radio.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/imageMetal/radio/unradio.png";SBGrid.DEF.imgButton="kr/co/softbowl/imageMetal/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/imageMetal/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/imageMetal/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/imageMetal/treeview/uncheck.gif";SBGrid.DEF.imgUnCheck="kr/co/softbowl/imageMetal/checkbox/uncheck.png";SBGrid.DEF.imgRHDelete="kr/co/softbowl/imageMetal/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/imageMetal/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/imageMetal/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/imageMetal/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/imageMetal/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/imageMetal/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/imageMetal/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/imageMetal/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/imageMetal/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/imageMetal/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/imageMetal/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/imageMetal/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/imageMetal/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/imageMetal/radio/disunradio.png";break;case"blue":SBGrid.DEF.imgWait="kr/co/softbowl/imageBlue/datagrid/wait.png";SBGrid.DEF.imgCheck="kr/co/softbowl/imageBlue/checkbox/checkBlue.png";SBGrid.DEF.imgUnCheck="kr/co/softbowl/imageBlue/checkbox/uncheckBlue.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/imageBlue/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/imageBlue/radio/radioBlue.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/imageBlue/radio/unradioBlue.png";SBGrid.DEF.imgButton="kr/co/softbowl/imageBlue/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/imageBlue/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/imageBlue/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/imageBlue/treeview/uncheck.gif";SBGrid.DEF.imgRHDelete="kr/co/softbowl/imageBlue/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/imageBlue/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/imageBlue/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/imageBlue/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/imageBlue/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/imageBlue/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/imageBlue/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/imageBlue/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/imageBlue/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/imageBlue/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/imageBlue/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/imageBlue/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/imageBlue/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/imageBlue/radio/disunradio.png";break;case"gray":SBGrid.DEF.imgWait="kr/co/softbowl/imageGray/datagrid/wait.png";SBGrid.DEF.imgCheck="kr/co/softbowl/imageGray/checkbox/check_gray.png";SBGrid.DEF.imgUnCheck="kr/co/softbowl/imageGray/checkbox/uncheck_gray.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/imageGray/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/imageGray/radio/radio_gray.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/imageGray/radio/unradio_gray.png";SBGrid.DEF.imgButton="kr/co/softbowl/imageGray/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/imageGray/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/imageGray/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/imageGray/treeview/uncheck.gif";SBGrid.DEF.imgRHDelete="kr/co/softbowl/imageGray/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/imageGray/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/imageGray/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/imageGray/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/imageGray/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/imageGray/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/imageGray/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/imageGray/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/imageGray/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/imageGray/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/imageGray/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/imageGray/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/imageGray/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/imageGray/radio/disunradio.png";break;case"pink":SBGrid.DEF.imgWait="kr/co/softbowl/imagePink/datagrid/wait_pink.png";SBGrid.DEF.imgCheck="kr/co/softbowl/imagePink/checkbox/check_pink.png";SBGrid.DEF.imgUnCheck="kr/co/softbowl/imagePink/checkbox/uncheck_pink.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/imagePink/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/imagePink/radio/radio_pink.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/imagePink/radio/unradio_pink.png";SBGrid.DEF.imgButton="kr/co/softbowl/imagePink/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/imagePink/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/imagePink/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/imagePink/treeview/uncheck.gif";SBGrid.DEF.imgRHDelete="kr/co/softbowl/imagePink/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/imagePink/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/imagePink/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/imagePink/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/imagePink/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/imagePink/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/imagePink/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/imagePink/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/imagePink/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/imagePink/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/imagePink/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/imagePink/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/imagePink/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/imagePink/radio/disunradio.png";break;case"desert":SBGrid.DEF.imgWait="kr/co/softbowl/imageDesert/datagrid/wait_desert.png";SBGrid.DEF.imgCheck="kr/co/softbowl/imageDesert/checkbox/check_desert.png";SBGrid.DEF.imgUnCheck="kr/co/softbowl/imageDesert/checkbox/uncheck_desert.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/imageDesert/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/imageDesert/radio/radio_desert.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/imageDesert/radio/unradio_desert.png";SBGrid.DEF.imgButton="kr/co/softbowl/imageDesert/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/imageDesert/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/imageDesert/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/imageDesert/treeview/uncheck.gif";SBGrid.DEF.imgRHDelete="kr/co/softbowl/imageDesert/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/imageDesert/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/imageDesert/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/imageDesert/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/imageDesert/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/imageDesert/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/imageDesert/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/imageDesert/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/imageDesert/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/imageDesert/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/imageDesert/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/imageDesert/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/imageDesert/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/imageDesert/radio/disunradio.png";break;case"pastelblue":SBGrid.DEF.imgWait="kr/co/softbowl/imagePastelBlue/datagrid/wait_pastelblue.png";SBGrid.DEF.imgCheck="kr/co/softbowl/imagePastelBlue/checkbox/check_pastelblue.png";SBGrid.DEF.imgUnCheck="kr/co/softbowl/imagePastelBlue/checkbox/uncheck_pastelblue.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/imagePastelBlue/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/imagePastelBlue/radio/radio_pastelblue.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/imagePastelBlue/radio/unradio_pastelblue.png";SBGrid.DEF.imgButton="kr/co/softbowl/imagePastelBlue/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/imagePastelBlue/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/imagePastelBlue/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/imagePastelBlue/treeview/uncheck.gif";SBGrid.DEF.imgRHDelete="kr/co/softbowl/imagePastelBlue/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/imagePastelBlue/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/imagePastelBlue/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/imagePastelBlue/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/imagePastelBlue/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/imagePastelBlue/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/imagePastelBlue/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/imagePastelBlue/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/imagePastelBlue/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/imagePastelBlue/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/imagePastelBlue/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/imagePastelBlue/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/imagePastelBlue/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/imagePastelBlue/radio/disunradio.png";break;case"claret":SBGrid.DEF.imgWait="kr/co/softbowl/imageClaret/datagrid/wait.gif";SBGrid.DEF.imgCheck="kr/co/softbowl/imageClaret/checkbox/check.png";SBGrid.DEF.imgUnCheck="kr/co/softbowl/imageClaret/checkbox/uncheck.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/imageClaret/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/imageClaret/radio/radio.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/imageClaret/radio/unradio.png";SBGrid.DEF.imgButton="kr/co/softbowl/imageClaret/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/imageClaret/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/imageClaret/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/imageClaret/treeview/uncheck.gif";SBGrid.DEF.imgRHDelete="kr/co/softbowl/imageClaret/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/imageClaret/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/imageClaret/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/imageClaret/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/imageClaret/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/imageClaret/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/imageClaret/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/imageClaret/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/imageClaret/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/imageClaret/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/imageClaret/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/imageClaret/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/imageClaret/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/imageClaret/radio/disunradio.png";break;default:SBGrid.DEF.imgWait="kr/co/softbowl/image/datagrid/wait.gif";SBGrid.DEF.imgCheck="kr/co/softbowl/image/checkbox/check.png";SBGrid.DEF.imgUnCheck="kr/co/softbowl/image/checkbox/uncheck.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/image/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/image/radio/radio.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/image/radio/unradio.png";SBGrid.DEF.imgButton="kr/co/softbowl/image/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/image/combo/combo.png";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/image/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/image/treeview/uncheck.gif";SBGrid.DEF.imgRHDelete="kr/co/softbowl/image/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/image/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/image/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/image/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/image/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/image/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/image/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/image/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/image/global/buttonReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/image/global/buttonExpansion.png";SBGrid.DEF.imgDisCheck="kr/co/softbowl/image/checkbox/discheck.png";SBGrid.DEF.imgDisUnCheck="kr/co/softbowl/image/checkbox/disuncheck.png";SBGrid.DEF.imgDisRadio="kr/co/softbowl/image/radio/disradio.png";SBGrid.DEF.imgDisUnRadio="kr/co/softbowl/image/radio/disunradio.png"}return new SBGrid.CT.DataGrid(e.strParentId,e.strAlert,e.strHelp,e.strHint,e.bAllowBigSelection,e.bAllowSelection,e.bAllowUserResize,e.bAutoResize,e.bAutoSizeMouse,e.strBackColorAlternate,e.strBackColorFrozen,e.strCaption,e.strCaptionLayout,e.strClass,e.strColSep,e.strColWidth,e.strDataHeight,e.strDataType,e.nDefaultRows,e.strDeleteFlagImage,e.bDisabled,e.bDragMode,e.bDropmode,e.bEllipsis,e.strExplorerbar,e.strExplorerUI,e.strExtendLastCol,e.nFixedCols,e.strFocusColor,e.strForeColorFrozen,e.nFrozenBottomRows,e.nFrozenCols,e.nFrozenRows,e.strId,e.strInsertFlagImage,e.strMergeCells,e.strMergeCellsFixedCols,e.strMergeCellsFixedRows,e.bMultiTotal,e.strNodeSet,e.strJsonRef,e.strNormalFlagImage,e.strOverflow,e.bRemoveHScroll,e.bRemoveVScroll,e.strRowHeader,e.strRowHeight,e.nRows,e.strRowSep,e.strScroll,e.strSelectFontColor,e.strSelectFontColorStyle,e.strSelectImageStyle,e.strSelectMode,e.strSubTotalPosition,e.strStyle,"softbowl:datagrid",e.strToolTip,e.strUpdateFlagImage,e.strVisibility,e.strWallPaper,e.bIsDecimalFormatInsert,e.strUserDefineAttrib,e.strSummary,e.bAutoResizeCaption,e.strDataReplace,e.bIsDataReplaceValueChanged,e.ready,e.strGridReady,e.strEmptyRecords,e.strEmptyRecordsFontStyle,e.strTheme,e.bCreateAll,e.nRenderingRows,e.bAllowCopy,e.bAllowPaste,e.strBeforeElementId,e.strNextElementId,e.bRealDataSync,e.arExtRefList,e.nScrollingDelayTime,e.bContextMenu,e.bDataSearching,e.bIsShowLoadingImage,e.bAutoSavePsnlData,e.strPsnlDataId,e.arContextMenuList,e.bIsTextareaScroll,e.bUseMultiSorting,e.bIsSortFrozenRows,e.bIsSortFrozenBottomRows,e.strGridSummary,e.strUserCaption,e.bUseWebAccess,e.arCalcParam,e.bComboDataSync,e.bCellsInfoDisplay,e.bOneClickEdit,e.bUseFrozenSelect,e.strCellFocusColor)}};SBGrid.DEF.createSBGrid=function(a){if(arguments.length!=1){SBGrid.DEF.APIerrorMsg("createSBGrid","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}else{if(typeof a!="object"){SBGrid.DEF.APIerrorMsg("createSBGrid","Please check if parameter's type is 'object'.",SBGrid.DEF.DEBUG_MODE);return}else{if(a.objSBGridInitInfo==null){SBGrid.DEF.APIerrorMsg("createSBGrid","Please check if 'objSBGridInitInfo' property is null.",SBGrid.DEF.DEBUG_MODE);return}if(a.arSBGridColumnInitInfo==null){SBGrid.DEF.APIerrorMsg("createSBGrid","Please check if 'arSBGridColumnInitInfo' property is null.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a.objSBGridInitInfo!="object"){SBGrid.DEF.APIerrorMsg("createSBGrid","Please check if 'objSBGridInitInfo' property's type is 'object'.",SBGrid.DEF.DEBUG_MODE);return}if(!(a.arSBGridColumnInitInfo instanceof Array)){SBGrid.DEF.APIerrorMsg("createSBGrid","Please check if 'arSBGridColumnInitInfo' property's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}var b=null;b=createSBDataGrid(a.objSBGridInitInfo);if(b){b.createColumns(a.arSBGridColumnInitInfo)}else{var c="SBGrid creating is failed.";alert(c)}return b}}};if(SBGrid.DEF.is_ie&&window==window.top){window.eval("var parent;")}SBGrid.DEF._W_getCurrentEvent=function(){return SBGrid.DEF.m_event};SBGrid.DEF._W_dummyEvent=function(){SBGrid.DEF.errorMsg("dummy does not support.")};SBGrid.DEF._W_onProcessEvent=function(g,m,i){if(!SBGrid.DEF.bParsed){return}if(SBGrid.DEF.m_event.name=="onfocus"){return}if(null==m&&null==i){m=SBGrid.DEF._W_getEventName(g);i=document.body.id;if(i==null||i==undefined){return}}var b=null;if(SBGrid.DEF.is_ie){b=g.srcElement}else{b=g.target}var l=window;var f=document;if(null!=b.parentWindow){l=b.parentWindow;f=b.parentWindow.document}SBGrid.DEF.initEvent(g,i);var a=m;var n=f.SBHE_allElement.m_htCollection[i];if(null!=n){if(null!=n.vscroll){n.vscroll.refresh();n.hscroll.refresh()}n.dispatch(a,SBGrid.DEF.m_event);if(SBGrid.DEF.is_smartphone&&"onscroll"==a&&n instanceof SBGrid.CT.HtmlBody){var h=document.SBHE_allElement.getCollection();for(var d in h){var c=h[d];if(null!=c&&c instanceof SBGrid.CT.DataGrid){c.moveGridExpansion()}else{if("softbowl:group"==c.elementName){c.moveGroupExpansion()}}}}}};SBGrid.DEF._W_onResize=function(e){SBGrid.DEF.__initWindowAndDocSize();if(document.SBHE_grids){var arKeyset=document.SBHE_grids.keys();for(var i=0;i<arKeyset.length;i++){var gridId=arKeyset[i];if(SBGrid.getGrid(gridId)){try{eval("SBGrid.getGrid('"+gridId+"').resizeEvt;SBGrid.getGrid('"+gridId+"').resize();")}catch(e){}}}}if(typeof SBUx!="undefined"&&document.SBHE_SBUxComponent){var arKeyset=document.SBHE_SBUxComponent.keys();for(var i=0;i<arKeyset.length;i++){var strId=arKeyset[i];if(SBUx.getComponent(strId)){try{eval("SBUx.getComponent('"+strId+"').resizeEvt;SBUx.getComponent('"+strId+"').resize();")}catch(e){}}}}};SBGrid.DEF._W_onBlurEvent=function(f){var d=document.activeElement;if(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11){if(d.tagName=="HTML"){d=document.activeElement.lastChild}}var c=SBGrid.DEF._W_findEventElement(d);if(d.id){if(SBGrid.DEF.SB_ITEMLIST[d.id]==true){return}}if(SBGrid.DEF.is_firefox){return}if(c){if(c.elementName=="xhtml:body"){var a;if(SBGrid.DEF.is_ie){a=f.srcElement}else{a=f.target}var b=SBGrid.DEF._W_findEventElement(a);if(null==b){return}if(b.elementName=="xhtml:body"){return}while(b&&b.elementName!="softbowl:datagrid"){b=b.parent}if(b){b.closePopUp()}}}};SBGrid.DEF._W_onBlurEventSBUx=function(f){var d=document.activeElement;var c=SBGrid.DEF._W_findEventElement(d);if(d.id){if(SBGrid.DEF.SB_ITEMLIST[d.id]==true){return}}if(c){if(c.elementName=="xhtml:body"||c.elementName=="softbowl:DIV"){var a;if(SBGrid.DEF.is_ie){a=f.srcElement}else{a=f.target}var b=SBGrid.DEF._W_findEventElement(a);if(null==b){return}if(b.id!=c.id){b.dispatch("onblur",SBGrid.DEF.m_event)}}}};SBGrid.DEF._W_onGridInputClipboad=function(c){var b=document.activeElement;var a=SBGrid.DEF._W_findEventElement(b);if(a){a.setAttribute("changeClipboard","true")}};SBGrid.DEF._W_onProcessMouseEvent=function(o){var c=SBGrid.DEF._W_getEventName(o);if("onmouseup"==c){var s=""}if("onmousedown"==c){var p=""}if("ondragstart"==c){var d=SBGrid.DEF._W_getCurrentEvent();d.browserPreventDefault();d.browserStopPropagation();return}if("onmousemove"==c){if(SBGrid.DEF.bIsDragMode){SBGrid.DEF.bIsDragMode=false}else{if(SBGrid.DEF.bDragDrop&&"onmouseup"==c){SBGrid.DEF.bDragDrop=false;var u=null;for(var h=0;h<document.SBHE_controls.count();h++){u=document.SBHE_controls.item(h);u.setAttribute("cursor",u.getAttribute("cursor"))}var r=document.getElementById("dragstyle");if(null!=r){var n=r.parentNode;n.removeChild(r)}}var l;if(SBGrid.DEF.is_ie){l=o.srcElement}else{l=o.target}var t=SBGrid.DEF._W_findEventElement(l);if(null==t){return}if(null!=SBGrid.DEF.m_event.cursorOver&&"on"==SBGrid.DEF.m_event.cursorOver){t.dispatch("oncursor")}if((-1==o.x&&-1==o.y)||(null!=SBGrid.DEF.m_nOldEventX&&null!=SBGrid.DEF.m_nOldEventY)&&o.x==SBGrid.DEF.m_nOldEventX&&o.y==SBGrid.DEF.m_nOldEventY){if(null!=SBGrid.DEF.m_event.hint&&"ready"==SBGrid.DEF.m_event.hint){var g=false;if("softbowl:treeitem"==t.tag){if(""!=t.parent.getAttribute("hint")){g=true}}var f=t.parent.getAttribute("tooltip");if(""!=t.getAttribute("hint")||g||"true"==f||"label"==f){SBGrid.DEF.m_event.hint="none";SBGrid.DEF.m_event.hinting=true;t.dispatch("onshowhint");t.dispatch("SBUx_hint");SBGrid.DEF.m_event.showHint=window.setTimeout(function(){SBGrid.DEF.m_event.hinting=false;t.dispatch("onhidehint")},5000)}f=null}return}}}if(!SBGrid.DEF.bParsed){return}var l;if(SBGrid.DEF.is_ie){l=o.srcElement}else{l=o.target}var t=SBGrid.DEF._W_findEventElement(l);if(null!=t){var m=false;if(("onmousedown"==c||"onmouseup"==c)&&"softbowl:comboinput"==t.tag&&""==t.parent.getAttribute("editmode")){t=null!=t.parent?t.parent:t;m=true}if(t instanceof SBGrid.CT.ContextMenu){return}var q=t.getId();if(null!=t.m_parentWindow){SBGrid.DEF.initEvent(o,q)}else{SBGrid.DEF.initEvent(o,q)}if(m){SBGrid.DEF.m_event.browserStopPropagation();SBGrid.DEF.m_event.browserPreventDefault()}t.dispatch(c)}SBGrid.DEF.m_nOldEventX=o.x;SBGrid.DEF.m_nOldEventY=o.y;if(o.stopPropagation){o.stopPropagation()}else{if(window.event){window.event.cancelBubble=true}}};SBGrid.DEF._W_onProcessFocusedEvent=function(e){if(!SBGrid.DEF.bParsed){return}SBGrid.DEF.m_bIsAccesskey=false;if("keydown"==e.type){if(e.keyCode==13){var a=""}}if("keypress"==e.type){var b=""}if("keyup"==e.type){if(0<SBGrid.DEF.m_arAccesskey.length){for(var i=0;i<SBGrid.DEF.m_arAccesskey.length;i++){if(e.keyCode==eval("SBGrid.EVT."+SBGrid.DEF.m_arAccesskey[i].accesskey)){switch(SBGrid.DEF.m_arAccesskey[i].combine){case"NONE":SBGrid.DEF.m_bIsAccesskey=true;break;case"CONTROL":if(e.ctrlKey){SBGrid.DEF.m_bIsAccesskey=true}break;case"SHIFT":if(e.shiftKey){SBGrid.DEF.m_bIsAccesskey=true}break}if(SBGrid.DEF.m_bIsAccesskey){setFocus(SBGrid.DEF.m_arAccesskey[i].target);break}}}}}var strEvent=SBGrid.DEF._W_getEventName(e);if(SBGrid.DEF.m_bIsAccesskey){strEvent="onaccesskey"}var strFocusId=SBGrid.DEF.m_event.focus;if(null!=strFocusId&&!strFocusId.isEmpty()){SBGrid.DEF.initEvent(e,strFocusId);var objFocused=SBGrid.DEF._W_findEventElement(document.SBHE_allElement.m_htCollection[strFocusId]);if("softbowl:cell"==objFocused.tag){objFocused=objFocused.getElement()}if(null!=objFocused){objFocused.dispatch(strEvent,SBGrid.DEF.m_event)}}if(e.stopPropagation){e.stopPropagation()}else{if(window.event){window.event.cancelBubble=true}}};SBGrid.DEF._W_getEventName=function(a){switch(a.type){case"mousedown":return"onmousedown";case"mousemove":return"onmousemove";case"mouseup":return"onmouseup";case"dblclick":return"ondblclick";case"keydown":return"onkeydown";case"keypress":return"onkeypress";case"keyup":return"onkeyup";case"mousewheel":return"onmousewheel";case"DOMMouseScroll":return"onmousewheel";case"scroll":return"onscroll";case"dragstart":return"ondragstart";case"draggesture":return"ondragstart";case"dragenter":return"ondragenter";case"dragover":return"ondragover";case"dragleave":return"ondragleave";case"dragexit":return"ondragleave";case"drop":return"ondrop";case"dragdrop":return"ondrop";case"drag":return"ondrag";case"focus":return"onfocus";case"click":return"onclick";case"change":return"onchange"}};SBGrid.DEF._W_findEventElement=function(c){if(null!=c){if(SBGrid.DEF.bSBUx&&c.tagName=="HTML"){c=document.body}var b;var e;var f;var h=c;while(null!=h&&h.getAttribute){var g=h.getAttribute("id");if(g){b=g.replace("SBHE_","");if(b=="__SB_ContextMenu"){return null}if(null!=b){e=h.getAttribute("parentId");if(null!=e){f=true}else{f=false}var d=null;var i=null;if(null==h.parentWindow){d=document;i=window}else{d=h.parentWindow.document;i=h.parentWindow}if(d.SBHE_allElement!=null){var l=d.SBHE_allElement.m_htCollection[b];if(SBGrid.DEF.bSBUx&&l==null&&c.tagName=="BODY"){l=SBGrid.DS.SBBody}if(null!=l){if((null!=i.SBGrid.CT.Cell&&l instanceof i.SBGrid.CT.Cell)||(null!=i.SBGrid.CT.SelectCell&&l instanceof i.SBGrid.CT.SelectCell)||(null!=i.SBGrid.CT.SelectItem&&l instanceof i.SBGrid.CT.SelectItem)||(null!=i.SBGrid.CT.DataGridCell&&l instanceof i.SBGrid.CT.DataGridCell)){var a=l.parent;if(null!=a){a.setAttribute("row",l.row);a.setAttribute("col",l.col)}}else{if((null!=i.SBGrid.CT.DataGrid&&l instanceof SBGrid.CT.DataGrid)){l.mouseCol=-1;l.mouseRow=-1}else{if((null!=i.SBGrid.CT.Select&&l instanceof SBGrid.CT.Select)){if("minimal"!=l.getAttribute("appearance")){l.m_nSelectedRow=-1;l.m_nSelectedCol=-1}l.m_bScoll=f}}}return l.getElement()}}}}if(SBGrid.DEF.is_firefox){h=h.parentNode}else{h=h.parentElement}}}return null};SBGrid.DEF.initEvent=function(c,b){SBGrid.DEF.m_event.name=SBGrid.DEF._W_getEventName(c);if(SBGrid.DEF.m_bIsAccesskey){SBGrid.DEF.m_event.name="onaccesskey"}SBGrid.DEF.m_event.target=b;SBGrid.DEF.m_event.altKey=c.altKey;SBGrid.DEF.m_event.ctrlKey=c.ctrlKey;SBGrid.DEF.m_event.shiftKey=c.shiftKey;SBGrid.DEF.m_event.metaKey=c.metaKey;SBGrid.DEF.m_event.keyCode=c.keyCode;if(SBGrid.DEF.is_ie){switch(c.button){case 1:SBGrid.DEF.m_event.button=SBGrid.EVT.BUTTON_LEFT;break;case 2:SBGrid.DEF.m_event.button=SBGrid.EVT.BUTTON_RIGHT;break;case 4:SBGrid.DEF.m_event.button=SBGrid.EVT.BUTTON_MIDDLE;break}}else{switch(c.button){case 0:SBGrid.DEF.m_event.button=SBGrid.EVT.BUTTON_LEFT;break;case 1:SBGrid.DEF.m_event.button=SBGrid.EVT.BUTTON_MIDDLE;break;case 2:SBGrid.DEF.m_event.button=SBGrid.EVT.BUTTON_RIGHT;break}}var a=document.SBHE_allElement.m_htCollection[b];if(null!=a.m_heCtrl){SBGrid.DEF.m_event.targetX=c.clientX-a.getClientLeft(true)-a.m_heCtrl.scrollLeft;SBGrid.DEF.m_event.targetY=c.clientY-a.getClientTop(true)-a.m_heCtrl.scrollTop}SBGrid.DEF.m_event.screenX=c.screenX;SBGrid.DEF.m_event.screenY=c.screenY;SBGrid.DEF.m_event.clientX=c.clientX;SBGrid.DEF.m_event.clientY=c.clientY;SBGrid.DEF.m_event.m_nRef=0;SBGrid.DEF.m_event.m_browserEvent=c;SBGrid.DEF.m_event.pTarget=a;if(c.wheelDelta){SBGrid.DEF.m_event.mouseWheel=c.wheelDelta/120}else{SBGrid.DEF.m_event.mouseWheel=-(c.detail/3)}};SBGrid.DEF.__attachEventHandler=function(strID){if(window.attachEvent){eval(strID+".attachEvent('onmousedown', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('onmousemove', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('onmouseup', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('ondblclick', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('onkeydown', SBGrid.DEF._W_onProcessFocusedEvent);");eval(strID+".attachEvent('onkeypress', SBGrid.DEF._W_onProcessFocusedEvent);");eval(strID+".attachEvent('onkeyup', SBGrid.DEF._W_onProcessFocusedEvent);");eval(strID+".attachEvent('onmousewheel', SBGrid.DEF._W_onProcessFocusedEvent);");window.attachEvent("onresize",SBGrid.DEF._W_onResize);eval(strID+".attachEvent('onscroll', SBGrid.DEF._W_onProcessEvent);");eval(strID+".attachEvent('ondragstart', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('ondragenter', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('ondragover', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('ondragleave', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('ondrop', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('ondrag', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('onchange', SBGrid.DEF._W_onProcessMouseEvent);")}else{eval(strID+".addEventListener('mousedown', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('mousemove', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('mouseup', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('dblclick', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('keydown', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".addEventListener('keypress', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".addEventListener('keyup', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".addEventListener('mousewheel', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".addEventListener('DOMMouseScroll', SBGrid.DEF._W_onProcessFocusedEvent, false);");window.addEventListener("resize",SBGrid.DEF._W_onResize,false);eval(strID+".addEventListener('scroll', SBGrid.DEF._W_onProcessEvent, false);");eval(strID+".addEventListener('dragstart', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('draggesture', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('dragenter', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('dragover', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('dragleave', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('dragexit', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('drop', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('dragdrop', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('drag', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('change', SBGrid.DEF._W_onProcessMouseEvent, false);")}};SBGrid.DEF.__attachBlurEventHandler=function(strID){if(window.attachEvent){eval(strID+".attachEvent('onblur', SBGrid.DEF._W_onBlurEventSBUx);")}else{eval(strID+".addEventListener('blur', SBGrid.DEF._W_onBlurEventSBUx, false);")}};SBGrid.DEF.__removeBlurEventHandler=function(strID){if(document.getElementById(strID)){if(window.detachEvent){eval(strID+".detachEvent('onblur', SBGrid.DEF._W_onBlurEventSBUx);")}else{eval(strID+".removeEventListener('blur', SBGrid.DEF._W_onBlurEventSBUx, false);")}}};SBGrid.DEF.__removeEventHandler=function(strID){if(document.getElementById(strID)){if(window.detachEvent){eval(strID+".detachEvent('onmousedown', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('onmousemove', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('onmouseup', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('ondblclick', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('onkeydown', SBGrid.DEF._W_onProcessFocusedEvent);");eval(strID+".detachEvent('onkeypress', SBGrid.DEF._W_onProcessFocusedEvent);");eval(strID+".detachEvent('onkeyup', SBGrid.DEF._W_onProcessFocusedEvent);");eval(strID+".detachEvent('onmousewheel', SBGrid.DEF._W_onProcessFocusedEvent);");window.detachEvent("onresize",SBGrid.DEF._W_onResize);eval(strID+".detachEvent('onscroll', SBGrid.DEF._W_onProcessEvent);");eval(strID+".detachEvent('ondragstart', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('ondragenter', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('ondragover', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('ondragleave', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('ondrop', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('ondrag', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('onchange', SBGrid.DEF._W_onProcessMouseEvent);")}else{eval(strID+".removeEventListener('mousedown', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('mousemove', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('mouseup', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('dblclick', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('keydown', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".removeEventListener('keypress', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".removeEventListener('keyup', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".removeEventListener('mousewheel', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".removeEventListener('DOMMouseScroll', SBGrid.DEF._W_onProcessFocusedEvent, false);");window.removeEventListener("resize",SBGrid.DEF._W_onResize,false);eval(strID+".removeEventListener('scroll', SBGrid.DEF._W_onProcessEvent, false);");eval(strID+".removeEventListener('dragstart', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('draggesture', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('dragenter', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('dragover', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('dragleave', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('dragexit', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('drop', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('dragdrop', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('drag', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('change', SBGrid.DEF._W_onProcessMouseEvent, false);")}}};SBGrid.DEF.__initWindow=function(){window.visible=true;SBGrid.DEF.m_nDelayTime=null;SBGrid.DEF.m_event={name:"",target:"",currentTarget:"",relatedTarget:"",propagate:"",defaultAction:"",description:"",hover:"",down:"",focus:"",drag:"",capture:"",altKey:"",ctrlKey:"",shiftKey:"",metaKey:"",keyCode:"",button:"",x:-1,y:-1,clientX:-1,clientY:-1,screenX:-1,screenY:-1,targetX:-1,targetY:-1,pTarget:null,dropData:"",dropDataType:"",m_nRef:0,m_browserEvent:null,preventDefault:function(){this.defaultAction="cancel"},routeDefault:function(){this.defaultAction="perform"},stopPropagation:function(){this.propagate="stop"},browserPreventDefault:function(){if(SBGrid.DEF.is_ie){this.m_browserEvent.returnValue=false}else{this.m_browserEvent.preventDefault()}},browserStopPropagation:function(){if(SBGrid.DEF.is_ie){this.m_browserEvent.cancelBubble=true}else{this.m_browserEvent.stopPropagation()}}};SBGrid.DEF.bParsed=true;SBGrid.DEF.m_strPrevClickElement;SBGrid.DEF.m_objPrevClickDate;if(typeof SBUx!="undefined"){SBGrid.DEF.bSBUx=true;SBGrid.DEF.children=new SBGrid.DS.Collection();SBGrid.DEF.mdiChildren=new SBGrid.DS.Collection();SBGrid.DEF.m_arChildIviewer=new Array();SBGrid.DEF.m_arLightgrid=new Array();SBGrid.DEF.m_arGlobalEventFireList=SBGrid.DEF.makeGlobalEventFireList();var d=window.dialogArguments;if(null!=d){var b=d.parent;window.type=d.type;if(null==window.parent){window.parent=b}window.opener=b;if(SBGrid.DEF.is_chrome){window.opener.SBGrid.DEF.disabledParent(b,window)}}var a=window;try{while(true){if(a.opener){if(a==a.opener){htmlwindow=a;htmldocument=a.document;break}a=a.opener;if(a.__SBUxViewer){continue}else{htmlwindow=a;htmldocument=a.document;break}}else{if(a==a.parent){htmlwindow=a;htmldocument=a.document;break}a=a.parent;if(a.__SBUxViewer){continue}else{htmlwindow=a;htmldocument=a.document;break}}}}catch(c){htmlwindow=window.top;htmldocument=window.top.document}if(window.opener){if(window.parent!=window.opener){if(SBGrid.DEF.is_ie||SBGrid.DEF.is_opera){if(null==parent){parent=window.opener}}else{if(null==window.parent){window.parent=window.opener}}}}else{if(SBGrid.DEF.is_firefox){opener=window.parent}else{window.opener=window.parent}}}else{SBGrid.DEF.bSBUx=false}};SBGrid.DEF.objTargetWindow=null;SBGrid.DEF.disabledParent=function(b,c){SBGrid.DEF.objTargetWindow=c;var a=document.getElementById("hidediv");if(null==a){a=document.createElement("div");b.document.body.appendChild(a);a.setAttribute("id","hidediv")}a.setAttribute("style","position:absolute;left:0px;top:0px;height:100%;width:100%;z-index:100;display:block;");a.onmousedown=SBGrid.DEF.setModalFocus;a.onclick=SBGrid.DEF.setModalFocus;a.ondblclick=SBGrid.DEF.setModalFocus};SBGrid.DEF.setModalFocus=function(){if(SBGrid.DEF.objTargetWindow){SBGrid.DEF.objTargetWindow.focus()}};SBGrid.DEF.enabledParent=function(b){var a=document.getElementById("hidediv");if(null!=a){a.parentNode.removeChild(a)}};SBGrid.DEF.setFocus=function(c){var b=SBGrid.DEF.m_event.focus;if(b==c){return}var d=document.SBHE_allElement.m_htCollection[b];if(null!=d){d=d.getElement();SBGrid.DEF.m_event.relatedTarget=c;d.dispatch("onblur",SBGrid.DEF.m_event);if(d.getState(SBGrid.DEF.SB_CS_DISABLE)){SBGrid.DEF.m_event.focus=""}if(!SBGrid.DEF.m_event.focus.isEmpty()){return}}var a=document.SBHE_allElement.m_htCollection[c];if(null!=a){a=a.getElement();SBGrid.DEF.m_event.relatedTarget=b;a.dispatch("onfocus",SBGrid.DEF.m_event);if(SBGrid.DEF.m_event.focus!=c){return}}SBGrid.DEF.m_event.relatedTarget=""};SBGrid.DEF.isSmartPhoneDblClick=function(c){var a=false;if(SBGrid.DEF.is_smartphone){var b=new Date().getTime();if(SBGrid.DEF.m_strPrevClickElement==c&&b<SBGrid.DEF.m_objPrevClickDate+1000){a=true}}return a};SBGrid.DEF.setPermitResize=function(a){SBGrid.DEF.bShowPop=a};SBGrid.DEF.setPrevClickInfo=function(b,a){if(SBGrid.DEF.is_smartphone){SBGrid.DEF.m_strPrevClickElement=b;SBGrid.DEF.m_objPrevClickDate=a}};SBGrid.DEF.removePrevClickInfo=function(){if(SBGrid.DEF.is_smartphone){SBGrid.DEF.m_strPrevClickElement=null;SBGrid.DEF.m_objPrevClickDate=null}};SBGrid.EVTUtil={DOMReady:function(a){if(document.addEventListener){document.addEventListener("DOMContentLoaded",a,false)}else{window.setTimeout(a,0)}},addHandler:function(a,c,b){if(a.addEventListener){a.addEventListener(c,b,false)}else{if(a.addEvent){a.addEvent("on"+c,b)}else{a["on"+c]=b}}},removeHandler:function(a,c,b){if(a.removeEventListener){a.removeEventListener(c,b)}else{if(a.detachEvent){a.detachEvent("on"+c,b)}else{a["on"+c]=null}}},getEventObj:function(a){return a?a:window.event},getEventTarget:function(a){return a.target?a.target:a.srcElement},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=false}};SBGrid.DEF.setPopupMenu=function(o,c,b,p,r){var d=document.getElementById("SbgridContextMenu");if(null!=d){document.body.removeChild(d)}if(o){var f="";var n="";f=document.createElement("ul");f.id="SbgridContextMenu";document.body.appendChild(f);var h=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,c+"/"+b);var q=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,c+"/"+p);var l=h.length;var a=q.length;var m=l>=a?a:l;for(var g=0;g<m;g++){n=n+'<li onclick="'+SBGrid.DS.XMLStorage.getUniqueStorage().getValue(q.item(g))+'" >'+SBGrid.DS.XMLStorage.getUniqueStorage().getValue(h.item(g))+"</li>"}jQuery(f).html(n);var e=new SBGrid.DEF._W_ContextMenu(event.srcElement,"SbgridContextMenu",function(i){})}};SBGrid.DEF._W_ContextMenu=function(b,d,a){var c=this,e=true;c.clickTarget=null;c.target=b;c.menu=document.getElementById(d);if(c.target){SBGrid.EVTUtil.addHandler(c.target,"contextmenu",function(f){if(e){f=SBGrid.EVTUtil.getEventObj(f);f.target=SBGrid.EVTUtil.getEventTarget(f);c.menu.style.top=f.clientY+"px";c.menu.style.left=f.clientX+"px";c.menu.style.display="block";c.clickTarget=f.target;if(typeof a=="function"){a(f)}SBGrid.EVTUtil.preventDefault(f)}});SBGrid.EVTUtil.addHandler(document.documentElement,"click",function(f){if(e){c.menu.style.display="none"}})}c.EnableContextMenu=function(f){e=f==true?true:false}};SBGrid.DEF.DOMAIN="./";SBGrid.DEF.__getAppName=function(){return SBGrid.DEF.DOMAIN};SBGrid.DEF.__deepCopy=function(d){if(Object.prototype.toString.call(d)==="[object Array]"){var b=[],c=0,a=d.length;for(;c<a;c++){b[c]=arguments.callee(d[c])}return b}if(typeof d==="object"){var b={},c;for(c in d){b[c]=arguments.callee(d[c])}return b}return d};SBGrid.DEF.isExistObject=function(strJSON){try{var obj=eval(strJSON);obj=null;return true}catch(e){return false}};SBGrid.DEF.getPropertyNameList=function(d){var a=[];for(var b in d){a.push(b);var c}return a};SBGrid.DEF.destroy=function(d){if(d==null){return}var a=SBGrid.DEF.getPropertyNameList(d);for(var c=0;c<a.length;c++){var b=a[c];d[b]=null}d=null};SBGrid.DEF.vaildCheckOfColor=function(e){var a=new RegExp("[a-fA-F0-9]");var d=e.indexOf("#");if(d!=-1){if(d!=0){return false}else{if(e.length>7){return false}else{for(var c=1;c<e.length;c++){if(a.test(e[c])==false){return false}}e=e.replace("#","0x");var b=parseInt(e);if(b>=0&&b<=16777215){return true}else{return false}}}}else{e=e.toLowerCase();if(SBGrid.DEF.arrBinarySearch(e,SBGrid.DEF.m_arrColorNameList)!=-1){return true}else{return false}}};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(a,b){if(this===undefined||this===null){throw new TypeError('"this" is null or not defined')}var c=this.length>>>0;b=+b||0;if(Math.abs(b)===Infinity){b=0}if(b<0){b+=c;if(b<0){b=0}}for(;b<c;b++){if(this[b]===a){return b}}return -1}}SBGrid.DEF.clearArray=function(a){while(a.length){a.pop()}};SBGrid.DEF.wipe=function(a){for(var b in a){if(a.hasOwnProperty(b)){delete a[b]}}if(a instanceof Array){SBGrid.DEF.clearArray(a)}return a};SBGrid.DEF.addEvent=function(b,c,a){if(b){if(b.addEventListener){c=c.replace("on","");b.addEventListener(c,a)}else{if(b.attachEvent){b.attachEvent(c,a)}}}};SBGrid.DEF.writeFile=function(a,d){if(a!=undefined&&(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11)&&typeof a=="string"){var c=new ActiveXObject("Scripting.FileSystemObject");if(!c.FileExists(a)){var b=c.CreateTextFile(a,true);d=d==undefined?"":d;b.WriteLine(d);b.close()}}};SBGrid.DEF.setDefaultOnclick=function(h){var l=document.activeElement;if(l){var p;if(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11){if(l.tagName=="HTML"){l=document.activeElement.lastChild}}var p=SBGrid.DEF._W_findEventElement(l);if(document.SBHE_grids){if(document.SBHE_grids.keys().length>0){p=SBGrid.DEF._W_findEventElement(l);if(p){var f=p.elementName;if(f.indexOf("softbowl")==-1){var b=document.SBHE_grids.keys();for(var c=0;c<b.length;c++){var m=SBGrid.getGrid(b[c]);m.closePopUp()}}}}}}if(typeof SBUx!="undefined"&&document.SBHE_SBUxComponent){if(h.srcElement){p=h.srcElement}else{p=h.target}if(!p){return}var o=document.SBHE_SBUxComponent.keys();var f=p.className;var d,n;if(p.firstChild!=null){d=p.firstChild.className}if(d==undefined||d==null){d=""}if(f.indexOf("sbgrid_combo")!=-1||f.indexOf("sbgrid_select4")!=-1||d.indexOf("sbgrid_combo")!=-1){}else{for(var c=0;c<o.length;c++){n=o[c];if(SBUx.getComponent(n)){if(typeof SBUx.getComponent(n).m_bShowItemList!="undefined"&&SBUx.getComponent(n).m_bShowItemList==true){SBUx.getComponent(n).m_bShowItemList=false;SBUx.getComponent(n).showItemList(false)}}}}var g=SBGrid.DEF._W_findEventElement(p);for(var c=0;c<o.length;c++){n=o[c];var a=SBUx.getComponent(n);if(a!=undefined&&a!=null){if(a.tag=="softbowl:input"){if(a.inputType=="date"){if(a.isDescendants(g.id)){continue}if(p.id!=a.m_heCtrl.nextElementSibling.id){SBUx.getComponent(n).m_objCalendar.setVisible(false)}}}if(a.tag=="softbowl:select1"){if(a.m_objButton!=null){if(p.id!=a.m_objButton.m_heCtrl.id&&p.id!=a.m_heComboboxInput.id&&p.id!=a.m_heCtrl.id){}}}}}o=f=d=n=null}};SBGrid.DEF.sort=function(h,v,q,a,e){if(!(h instanceof Array)){return}if(h.length<=1){return}if(q==undefined){q=0}if(a==undefined){a=h.length-1}if(e==undefined){e=SBGrid.DEF.SBST_ASC}var b=new SBGrid.DS.Map();var o=new SBGrid.DS.Map();var d=false;for(var r=q;r<=a;r++){var m=null;var g="";m=h[r];g=m[v];if(isFinite(g)){g=Number(g)}else{d=true}if(b.find(g)==undefined){var u=new SBGrid.DS.Map();u.add(r,m);b.add(g,u);u=null}else{b.find(g).add(r,m)}}var c=b.keys();if(c.length<=1){SBGrid.DEF.clearArray(c);b.clear();b=c=null;return false}if(d){c.sort()}else{c.sort(SBGrid.DEF.numberASC)}var t=[];for(var r=0,w=c.length;r<w;r++){var s=b.find(c[r]);if(s){var n=s.keys(true);for(var p=0,f=n.length;p<f;p++){t.push(s.find(n[p]))}SBGrid.DEF.clearArray(n);s.clear();s=n=null}}if(t.length!=(a-q+1)){SBGrid.DEF.clearArray(c);SBGrid.DEF.clearArray(t);b.clear();b=c=t=null;return false}for(var r=0,l=t.length;r<l;r++){h[r]=t[r]}SBGrid.DEF.clearArray(c);SBGrid.DEF.clearArray(t);b.clear();b=c=t=objFirstColCell=artRowHiddenIndexList=arRowStyleInfoList=null};SBGrid.DEF.multiSort=function(e,g,n,o){var c=g.shift();var p=c[0];var m=c[1];SBGrid.DEF.sort(e,p,n,o,m);if(g.length>0){var q=new SBGrid.DS.Map();for(var d=n;d<=o;d++){var h="";h=e[d][p];if(q.find(h)==undefined){var f=[];f.push(d);q.add(h,f)}else{q.find(h).push(d)}h=null}var l=q.keys();for(var d=0,b=l.length;d<b;d++){var a=l[d];var f=q.find(a);if(f.length>1){n=f[0];o=f[f.length-1];this._multiSort(e,SBGrid.DEF.__deepCopy(g),n,o)}a=f=null}q.clear();p=q=l=null}c=n=o=p=m=null};(function(s,o,i){if(document.implementation.hasFeature("XPath","3.0")&&!document.createNSResolver){function q(d){this.e=d;this.i=0;this.js=["with(XPath){return ","}"];this.expression(1,1)||this.error();return new Function("n","nsr",this.js.join(""))}q.ie=/MSIE/.test(navigator.userAgent);q.prototype={match:function(p,e){var d,f;if(!(d=p.exec(this.e.substr(this.i)))||(typeof e=="number"&&!(f=d[e]))||(typeof e=="object"&&!(f=e[d[1]]))){return false}this.m=d;this.i+=d[0].length;return f||d},error:function(f){f=(f||"Syntax error")+" at index "+this.i+": "+this.e.substr(this.i);var p;try{p=new m(51,f)}catch(d){p=new Error(f)}throw p},step:function(d,v,p,w){var f=3;if(this.match(/^(\/\/?|\.\.?|@)\s*/,1)){switch(this.m[1]){case"/":if(p){this.error()}if(!w){return this.step(d,v,1)}this.js.splice(d,0,' axis(axes["',"document-root",'"],');f+=this.nodeTypes.node.call(this,d+f);p=1;break;case"//":if(p){this.error()}this.js.splice(d,0,' axis(axes["',"descendant-or-self",'"],');f+=this.nodeTypes.node.call(this,d+f);p=1;break;case".":if(!p&&!w){this.error()}this.js.splice(d,0,' axis(axes["',"self",'"],');f+=this.nodeTypes.node.call(this,d+f);p=0;break;case"..":if(!p&&!w){this.error()}this.js.splice(d,0,' axis(axes["',"parent",'"],');f+=this.nodeTypes.node.call(this,d+f);p=0;break;case"@":if(!p&&!w){this.error()}this.js.splice(d,0,' axis(axes["',"attribute",'"],');f+=this.nodeTest(d+f,"node")||this.error("Missing nodeTest after @");p=0}}else{if(!p&&!w){return p?this.error():0}else{if(this.match(/^([ㄱ-ㅎ가-힣a-z]+(?:-[ㄱ-ㅎ가-힣a-z]+)*)\s*::\s*/,q.axes)){this.js.splice(d,0,' axis(axes["',this.m[1],'"],');f+=this.nodeTest(d+f,(this.m[1]=="attribute")?"node":"element")||this.error("Missing nodeTest after ::");p=0}else{if(f=this.nodeTest(d,"element")){this.js.splice(d,0,' axis(axes["',"child",'"],');f+=3;p=0}else{return 0}}}}for(var e;e=this.predicate(d+f);f+=e){}if(w){this.js.splice(v+f++,0,w)}f+=this.step(d,v+f,p);this.js.splice(v+f++,0,")");return f},expression:function(d,f,v){var w,e=this.operand(d);while(w=this.match(/^(or|and|!?=|[<>]=?|[|*+-]|div|mod)\s*/,this.operators)){if(v&&v[0]>=w[0]){this.i-=this.m[0].length;break}this.js.splice(d,0,w[1]);e++;this.js.splice(d+e++,0,w[2]);e+=this.expression(d+e,f,w)||this.error("Missing operand");this.js.splice(d+e++,0,w[3])}return e},operand:function(d){if(this.match(/^(-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)|"[^"]*"|'[^']*')\s*/,1)){this.js.splice(d,0,this.m[1]);return 1}var p;if(p=this.match(/^([ㄱ-ㅎ가-힣a-z]+(?:-[ㄱ-ㅎ가-힣a-z]+)*)\s*\(\s*/,this.functions)){var f=1,e;this.js.splice(d,0,p[1]);do{if(e){this.js.splice(d+f++,0,",")}f+=(e=this.expression(d+f,d+f))}while(e&&this.match(/^,\s*/));this.match(/^\)\s*/)||this.error("Missing (");if(p[0]){if(e){this.js.splice(d+f++,0,",")}this.js.splice(d+f++,0,p[0])}if(p[2]){this.js.splice(d+f++,0,p[2])}else{if(e>1){this.error("Function has arguments")}}f+=this.step(d,d+f);return f}if(this.match(/^\(\s*/)){var f=1;this.js.splice(d,0,"(");f+=this.expression(d+f,d+f);this.match(/^\)\s*/)||this.error("Missing )");this.js.splice(d+f++,")");return f}return this.step(d,d,0,"[n]")},operators:{"|":[1,"union(",",",")"],or:[1,"bool(",")||bool(",")"],and:[2,"bool(",")&&bool(",")"],"=":[3,"compare(eq,",",",")"],"!=":[3,"compare(ne,",",",")"],"<":[4,"compare(lt,",",",")"],">":[4,"compare(gt,",",",")"],"<=":[4,"compare(le,",",",")"],">=":[4,"compare(ge,",",",")"],"+":[5,"number(",")+number(",")"],"-":[5,"number(",")-number(",")"],"*":[6,"number(",")*number(",")"],div:[6,"number(",")/number(",")"],mod:[6,"number(",")%number(",")"]},functions:{last:[0,"nl.length"],position:[0,"(i+1)"],count:["nl","(",".length||0)"],id:["n","id(",")"],"local-name":["nl","localName(",")"],"namespace-uri":["nl","namespaceURI(",")"],name:["nl","qName(",")"],string:["n","string(",")"],concat:[0,"concat(",")"],"starts-with":[0,"startsWith(",")"],contains:[0,"contains(",")"],"substring-before":[0,"substringBefore(",")"],"substring-after":[0,"substringAfter(",")"],substring:[0,"substring(",")"],"string-length":["n","string(",").length"],"normalize-space":["n","normalizeSpace(",")"],translate:[0,"translate(",")"],"boolean":[0,"bool(",")"],not:[0,"!bool(",")"],"true":[0,"true "],"false":[0,"false "],number:["n","number(",")"],floor:[0,"Math.floor(number(","))"],ceiling:[0,"Math.ceil(number(","))"],round:[0,"Math.round(number(","))"],sum:[0,"sum(",")"]},predicate:function(d){var e=0;if(this.match(/^\[\s*/)){if(e=this.expression(d,d)){this.js.splice(d,0,"function(n,i,nl){with(XPath){var r=");e++;this.js.splice(d+e++,0,';return typeof r=="number"?Math.round(r)==i+1:bool(r)}},')}this.match(/^\]\s*/)||this.error("Missing ]")}return e},nodeTest:function(d,e){var f;if(f=this.match(/^([ㄱ-ㅎ가-힣a-z]+(?:-[ㄱ-ㅎ가-힣a-z]+)*)\(([^)]*)\)\s*/,this.nodeTypes)){return f.call(this,d,this.m[2])}if(this.match(/^\*\s*/)){return this.nodeTypes[e].call(this,d)}return this.nodeName(d)},nodeType:function(d,e){this.js.splice(d,0,"function(n){return n.nodeType==",e,"},");return 3},nodeTypes:{node:function(d){this.js.splice(d,0,"null,");return 1},element:function(d){return this.nodeType(d,1)},attribute:function(d){return this.nodeType(d,2)},text:function(d){return this.nodeType(d,3)},"processing-instruction":function(d,e){if(!e){return this.nodeType(d,7)}this.js.splice(d,0,"function(n){return n.nodeType==7&&n.target==",e,"},");return 3},comment:function(d){return this.nodeType(d,8)}},nodeName:function(d){if(!this.match(/^([ㄱ-ㅎ가-힣a-zA-Z0-9_]+(?:-?[ㄱ-ㅎ가-힣a-zA-Z0-9]+)*)(?::([ㄱ-ㅎ가-힣a-zA-Z0-9_]+(?:-?[ㄱ-ㅎ가-힣a-zA-Z0-9]+)*))?\s*/,1)){return 0}if(this.m[2]){this.js.splice(d,0,'function(n){if(!nsr)throw new XPathException(14);return "',this.m[2],'"==',q.ie?"n.baseName":"n.localName",'&&nsr.lookupNamespaceURI("',this.m[1],'")==n.namespaceURI},');return 7}else{this.js.splice(d,0,"function(n){return/^",this.m[1],"$/i.test(n.nodeName)},");return 3}}};q.order=function(e,f){var d=e.compareDocumentPosition?e.compareDocumentPosition(f):q.compareDocumentPosition.call(e,f);if(d&32){e=Array.prototype.indexOf.call(e.attributes,e);f=Array.prototype.indexOf.call(f.attributes,f);return(e<f)?-1:(e>f)?1:0}if(!d){if(e==f){return 0}if((e=e.ownerElement)&&(f=f.ownerElement)){return q.order(e,f)}return q.ie?1:0}return 3-((d&6)||3)};q.compare=function(v,e,w){if(e instanceof Array&&w instanceof Array){var d=e.map(this.string),f=w.map(this.string);for(e=d.length;--e>=0;){for(w=f.length;--w>=0;){if(!v(d[e],f[w])){return false}}}return true}if(e instanceof Array){for(var p=e.length;--p>=0;){if(!v(this[typeof w](e[p]),w)){return false}}return e.length>0}if(w instanceof Array){for(var p=w.length;--p>=0;){if(!v(e,this[typeof e](w[p]))){return false}}return w.length>0}if(typeof e=="boolean"||typeof w=="boolean"){return v(this.bool(e),this.bool(w))}if(typeof e=="number"||typeof w=="number"){return v(this.number(e),this.number(w))}return v(this.string(e),this.string(w))};q.eq=function(d,e){return d==e};q.ne=function(d,e){return d!=e};q.lt=function(d,e){return d<e};q.gt=function(d,e){return d>e};q.le=function(d,e){return d<=e};q.ge=function(d,e){return d>=e};q.id=function(f,r){if(arguments.length==1){r=f}var d=[];for(var p=this.string(f).split(/\s+/),e=p.length;--e>=0;){if(f=(r.ownerDocument||r).getElementById(p[e])){d.push(f)}}return d.sort(this.order)};q.localName=new Function("nl","return (nl.length&&nl[0]."+(q.ie?"baseName":"localName")+')||""');q.namespaceURI=function(d){return(d.length&&d[0].namespaceURI)||""};q.qName=function(d){return(d.length&&d[0].nodeName)||""};q.union=function(f,d){if(!f.length){return d}if(!d.length){return f}var e=[],r=f.length-1,p=d.length-1;for(;;){switch(this.order(f[r],d[p])){case -1:e.unshift(d[p--]);break;case 0:p--;case 1:e.unshift(f[r--]);break;default:throw new Error("Invalid order")}if(r<0){if(++p>0){e.unshift.apply(e,e.slice.call(d,0,p))}break}if(p<0){if(++r>0){e.unshift.apply(e,e.slice.call(f,0,r))}break}}return e};q.string=q.object=function(d){if(d instanceof Array&&typeof(d=d[0])=="undefined"){return""}if(typeof d=="string"){return d}switch(d.nodeType){case 1:case 9:case 11:return Array.prototype.map.call(d.childNodes,this.string,this).join("");default:return d.nodeValue||""}return String(d)};q.concat=function(){return Array.prototype.map.call(arguments,this.string,this).join("")};q.startsWith=function(e,d){return this.string(e).substr(0,(d=this.string(d)).length)==d};q.contains=function(e,d){return this.string(e).indexOf(this.string(d))!=-1};q.substringBefore=function(e,d){e=this.string(e);d=e.indexOf(this.string(d));return d!=-1?e.substr(0,d):""};q.substringAfter=function(e,d){e=this.string(e);d=this.string(d);var f=e.indexOf(d);return f!=-1?e.substr(f+d.length):""};q.substring=function(f,e,d){f=this.string(f);e=Math.round(this.number(e))-1;return(arguments.length==2)?f.substr(e<0?0:e):f.substr(e<0?0:e,Math.round(this.number(d))-Math.max(0,-e))};q.normalizeSpace=function(d){return this.string(d).replace(/^\s+/,"").replace(/\s+$/,"").replace(/\s+/g," ")};q.translate=function(p,e,y){p=this.string(p);e=this.string(e);y=this.string(y);var w=[],f=p.length,v=0,r,d;while(--f>=0){if((r=e.indexOf(d=p.charAt(v++)))==-1||(d=y.charAt(r))){w.push(d)}}return w.join("")};q.bool=q["boolean"]=function(d){if(typeof d=="boolean"){return d}if(d instanceof Array||typeof d=="string"){return d.length>0}return Boolean(d)};q.number=function(d){if(d instanceof Array&&typeof(d=d[0])=="undefined"){return 0}if(typeof d=="number"){return d}if(typeof d=="boolean"){return d?1:0}return Number(this.string(d))};q.sum=function(d){var f=0,e=d.length;while(--e>=0){f+=this.number(d[e])}return f};q.walk=function(p,e){var d,f=p.firstChild;while(f){e.push(f);if(d=f.firstChild){f=d}else{for(d=f;!(f=d.nextSibling)&&(d=d.parentNode)&&(d!=p);){}}}return e};q.axes={ancestor:function(e){var d=[];while(e=e.parentNode){d.unshift(e)}return d},"ancestor-or-self":function(e){var d=[];do{d.unshift(e)}while(e=e.parentNode);return d},attribute:new Function("n","var nl = [], a = n.attributes;if(a){attr:for(var x,i=a.length;--i>=0;){if(!(x=a[i]).specified){"+(q.ie?'switch(x.nodeName){case"selected":case"value":if(x.nodeValue)break;default:continue attr;}':"continue;")+"}nl.unshift(x);}}return nl;"),child:function(d){return d.childNodes||[]},descendant:function(d){return this.walk(d,[])},"descendant-or-self":function(d){return this.walk(d,[d])},following:function(f){var e=[],d;while(f){if(d=f.nextSibling){e.push(f=d);if(d=f.firstChild){e.push(f=d)}}else{f=f.parentNode}}return e},"following-sibling":function(e){var d=[];while(e=e.nextSibling){d.push(e)}return d},parent:function(d){return d.parentNode?[d.parentNode]:[]},preceding:function(r){var e=[],d,f=r.parentNode;while(r){if(d=r.previousSibling){for(r=d;d=r.lastChild;r=d){}e.unshift(r)}else{if(r=r.parentNode){if(r==f){f=f.parentNode}else{e.unshift(r)}}}}return e},"preceding-sibling":function(e){var d=[];while(e=e.previousSibling){d.unshift(e)}return d},self:function(d){return[d]},"document-root":function(d){return[d.ownerDocument||d]}};q.axis=function(A,z){var d,B,y=arguments.length-1,e=arguments[y],v=Array.prototype;for(var w=0,p,f=e.length;--f>=0;){B=A.call(this,e[w++]);if(z&&B.length){B=v.filter.call(B,z,this)}for(p=2;p<y&&B.length;B=v.filter.call(B,arguments[p++],this)){}d=d?this.union(d,B):B}return d||[]};q.cache={};function b(x){if(this==x){return 0}if(this.nodeType==2&&x.nodeType==2){return(this.ownerElement&&this.ownerElement==x.ownerElement)?32:0}var d=this.ownerElement||this,p=x.ownerElement||x;if(d.sourceIndex>=0&&p.sourceIndex>=0&&d.contains&&p.contains){return(((d.contains(p)&&16)||(p.contains(d)&&8))|((d.sourceIndex<p.sourceIndex&&4)||(p.sourceIndex<d.sourceIndex&&2)))||1}var v=d,w=p,e=0,f=0;while(v=v.parentNode){e++}while(w=w.parentNode){f++}if(e>f){while(e--!=f){d=d.parentNode}if(d==p){return 2|8}}else{if(f>e){while(f--!=e){p=p.parentNode}if(p==d){return 4|16}}}while((v=d.parentNode)!=(w=p.parentNode)){if(!(d=v)||!(p=w)){return 1}}while(d=d.nextSibling){if(d==p){return 4}}return 2}if(s.Node){var u=s.Node.prototype;if(i||!u.compareDocumentPosition){u.compareDocumentPosition=b}if(i||!u.contains){u.contains=function(d){return Boolean(this.compareDocumentPosition(d)&16)}}}else{q.compareDocumentPosition=b}if(i||!s.XPathException){function m(e,d){this.name="XPathException";this.code=e;this.message=d}var n=m,c=new Error;c.toString=function(){return this.name+":"+this.message};n.prototype=c;n.NAMESPACE_ERR=14;n.INVALID_EXPRESSION_ERR=51;n.TYPE_ERR=52;s.XPathException=n}if(i||!s.XPathNSResolver){function h(p){this.ns={};for(var d,e,f=p.attributes.length;--f>=0;){if(d=/xmlns:(.+)/.exec((e=p.attributes[f]).nodeName)){this.ns[d[1]]=e.nodeValue}}this.ns[""]=p.getAttribute("targetNamespace")}h.prototype={lookupNamespaceURI:function(d){return this.ns[d||""]}};s.XPathNSResolver=h}if(i||!s.XPathExpression){function t(f,d){this.fn=q.cache[f]||(q.cache[f]=new q(f));this.nsr=d}t.prototype={evaluate:function(e,d){return new g(this.fn(e,this.nsr),d)}};s.XPathExpression=t}if(i||!s.XPathResult){function g(e,d){if(d==0){switch(typeof e){default:d++;case"boolean":d++;case"string":d++;case"number":d++}}this.resultType=d;switch(d){case 1:this.numberValue=q.number(e);return;case 2:this.stringValue=q.string(e);return;case 3:this.booleanValue=q.bool(e);return;case 4:case 5:if(e instanceof Array){this.value=e;this.index=0;this.invalidIteratorState=false;return}break;case 6:case 7:if(e instanceof Array){this.value=e;this.snapshotLength=e.length;return}else{if(e instanceof NodeList){this.value=e;this.snapshotLength=e.length;return}}break;case 8:case 9:if(e instanceof Array){this.singleNodeValue=e[0];return}}throw new m(52)}var a=g;a.ANY_TYPE=0;a.NUMBER_TYPE=1;a.STRING_TYPE=2;a.BOOLEAN_TYPE=3;a.UNORDERED_NODE_ITERATOR_TYPE=4;a.ORDERED_NODE_ITERATOR_TYPE=5;a.UNORDERED_NODE_SNAPSHOT_TYPE=6;a.ORDERED_NODE_SNAPSHOT_TYPE=7;a.ANY_UNORDERED_NODE_TYPE=8;a.FIRST_ORDERED_NODE_TYPE=9;a.prototype={iterateNext:function(){switch(this.resultType){case 4:case 5:return this.value[this.index++]}throw new m(52)},snapshotItem:function(d){switch(this.resultType){case 6:case 7:return this.value[d]}throw new m(52)}};s.XPathResult=a}if(i||!s.XPathEvaluator){function l(){}var n=l;n.prototype={createExpression:function(f,d){return new t(f,d)},createNSResolver:function(d){return new h(d)},evaluate:function(p,r,f,d){return new t(p,f).evaluate(r,d)}};n.install=function(p,e){for(var d in l.prototype){if(e||!p[d]){p[d]=l.prototype[d]}}};s.XPathEvaluator=n;if(s.Document){n.install(s.Document.prototype,i)}else{n.install(document,i)}s.XPath=q}}})(window,document,/WebKit/.test(navigator.userAgent));SBGrid.UT.XmlLib=function(){};SBGrid.UT.XmlLib.loadXMLFromString=function(d,a){var b=null;if(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11){try{b=new ActiveXObject("Microsoft.XMLDOM");b.async=false;b.resolveExternals=true;b.validateOnParse=false;b.preserveWhiteSpace=true;b.loadXML(d);b.setProperty("SelectionLanguage","XPath")}catch(c){return null}}else{var f=new DOMParser();b=f.parseFromString(d,"text/xml")}return b};SBGrid.UT.XmlLib.createXML=function(a){var b=null;if(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11){b=new ActiveXObject("Microsoft.XMLDOM");b.async=false;b.resolveExternals=true;b.validateOnParse=false;b.documentElement=b.createElement(a)}else{b=document.implementation.createDocument("",a,null)}return b};SBGrid.UT.XmlLib.serializeToString=function(b){var c=null;if(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11){c=b.xml}else{var a=new XMLSerializer();c=a.serializeToString(b)}return c};SBGrid.UT.XmlLib.getAttribute=function(c,a){if(null!=c){var d=c.attributes.length;for(var b=0;b<d;b++){if(c.attributes[b].nodeName==a){return c.attributes[b].value}}}return null};SBGrid.UT.XmlLib.setAttribute=function(b,a,c){b.setAttribute(a,c)};SBGrid.UT.XmlLib.createChild=function(b,a){var d=b.ownerDocument;var c=d.createElement(a);b.appendChild(c);return c};SBGrid.UT.XmlLib.createChildWithValue=function(b,a,d){if(null==d){d=""}var c=SBGrid.UT.XmlLib.createChild(b,a);SBGrid.UT.XmlLib.setTextValue(c,d);return c};SBGrid.UT.XmlLib.getTextValue=function(a){var c="";try{if(null!=a.firstChild){if(SBGrid.DEF.Sbgrid_Node.TEXT_NODE==a.firstChild.nodeType||SBGrid.DEF.Sbgrid_Node.CDATA_SECTION_NODE==a.firstChild.nodeType){c=a.firstChild.nodeValue}}else{if(SBGrid.DEF.Sbgrid_Node.TEXT_NODE==a.nodeType||SBGrid.DEF.Sbgrid_Node.CDATA_SECTION_NODE==a.nodeType){c=jQuery(a).text()}}}catch(b){}return c};SBGrid.UT.XmlLib.importChildNode=function(c,d,a){var b=SBGrid.UT.XmlLib.importNode(c.ownerDocument,d,a);c.appendChild(b);return b};SBGrid.UT.XmlLib.importNode=function(c,b,a){if(c.importNode){return c.importNode(b,a)}else{return SBGrid.UT.XmlLib.importNodeOld(c,b,a)}};SBGrid.UT.XmlLib.importNodeOld=function(g,e,b){b=(b==null)?true:b;var f=function(o,n,l){if(b){for(var h=0;h<n.childNodes.length;h++){var m=SBGrid.UT.XmlLib.importNode(o,n.childNodes.item(h),true);l.appendChild(m)}}};var d=null;switch(e.nodeType){case SBGrid.DEF.Sbgrid_Node.ATTRIBUTE_NODE:if(null!=g.createAttributeNS){d=g.createAttributeNS(e.namespaceURI,e.nodeName)}else{d=g.createAttribute(e.nodeName)}d.value=e.value;break;case SBGrid.DEF.Sbgrid_Node.DOCUMENT_FRAGMENT_NODE:d=g.createDocumentFragment();f(g,e,d);break;case SBGrid.DEF.Sbgrid_Node.ELEMENT_NODE:if(null!=g.createElementNS){d=g.createElementNS(e.namespaceURI,e.tagName)}else{d=g.createElement(e.tagName)}for(var c=0;c<e.attributes.length;c++){var a=SBGrid.UT.XmlLib.importNode(g,e.attributes.item(c),b);if(null!=d.setAttributeNodeNS){d.setAttributeNodeNS(a)}else{d.setAttributeNode(a)}}f(g,e,d);break;case SBGrid.DEF.Sbgrid_Node.ENTITY_REFERENCE_NODE:d=e;break;case SBGrid.DEF.Sbgrid_Node.PROCESSING_INSTRUCTION_NODE:d=g.createProcessingInstruction(e.target,e.data);break;case SBGrid.DEF.Sbgrid_Node.TEXT_NODE:case SBGrid.DEF.Sbgrid_Node.CDATA_SECTION_NODE:case SBGrid.DEF.Sbgrid_Node.COMMENT_NODE:d=g.createTextNode(e.nodeValue);break;case SBGrid.DEF.Sbgrid_Node.DOCUMENT_NODE:case SBGrid.DEF.Sbgrid_Node.DOCUMENT_TYPE_NODE:case SBGrid.DEF.Sbgrid_Node.NOTATION_NODE:case SBGrid.DEF.Sbgrid_Node.ENTITY_NODE:throw"can not import "+e.tagName;break}return d};SBGrid.UT.XmlLib.setTextValue=function(b,d,a){if(b.hasChildNodes()&&(SBGrid.DEF.Sbgrid_Node.TEXT_NODE==b.firstChild.nodeType||SBGrid.DEF.Sbgrid_Node.CDATA_SECTION_NODE==b.firstChild.nodeType)&&!a){b.firstChild.nodeValue=d}else{var c=null;if(a){c=b.ownerDocument.createCDATASection(d)}else{c=b.ownerDocument.createTextNode(d)}b.appendChild(c)}};SBGrid.UT.XmlLib.createCDATASection=function(a,d){var b=a.ownerDocument;var c=b.createCDATASection(d);a.appendChild(c)};SBGrid.UT.XmlLib.transformToHTMLElement=function(a,d,c){try{if(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11){jQuery(a).html(d.transformNode(c))}else{var g=new XSLTProcessor();g.importStylesheet(c);var b=g.transformToFragment(d,document);a.appendChild(b.firstChild);g.reset();return}}catch(f){window.alert(f+" SBGridSbgrid : transformToHTMLElement")}};SBGrid.UT.XmlLib.selectSingleNode=function(a,c){if(null==a||c.isEmpty()){return null}var b=null;b=a.selectSingleNode(c);return b};SBGrid.UT.XmlLib.selectNodes=function(b,d){if(typeof(d)!="string"){return null}if(null==b||d.isEmpty()){return null}var a=null;try{a=b.selectNodes(d)}catch(c){}return a};SBGrid.UT.XmlLib.hasChildNodesExceptText=function(c){if(c.hasChildNodes()){var d=c.childNodes;for(var a=0;a<d.length;a++){var b=d[a];if(SBGrid.DEF.Sbgrid_Node.TEXT_NODE!=b.nodeType&&SBGrid.DEF.Sbgrid_Node.CDATA_SECTION_NODE!=b.nodeType){return true}}}return false};SBGrid.UT.XmlLib.getRootElementNode=function(e){var a;if(null!=e){if(SBGrid.DEF.Sbgrid_Node.DOCUMENT_NODE==e.nodeType){var d=e.childNodes;for(var b=0;b<d.length;b++){var c=d[b];if(SBGrid.DEF.Sbgrid_Node.PROCESSING_INSTRUCTION_NODE!=c.nodeType){a=c;break}}}else{if(SBGrid.DEF.Sbgrid_Node.PROCESSING_INSTRUCTION_NODE!=c.nodeType){a=c}}}return a};if(!SBGrid.DEF.Sbgrid_Node){SBGrid.DEF.Sbgrid_Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}var objNSResolver=null;if(document.implementation.hasFeature("XPath","3.0")){if(document.createNSResolver){objNSResolver=document.createNSResolver(document.documentElement)}XMLDocument.prototype.selectNodes=function(a,g){try{if(!g){g=this}var d=new SBGrid.DS.DOMNodeList();if(this.createNSResolver){var b=this.evaluate(a,g,objNSResolver,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var c=0;c<b.snapshotLength;c++){d.add(b.snapshotItem(c))}b=null}return d}catch(f){SBGrid.DEF.errorMsg(f+" SBGridSbgrid : selectNodes")}};Element.prototype.selectNodes=function(a){if(this.ownerDocument.selectNodes){return this.ownerDocument.selectNodes(a,this)}else{throw"Web Browser not Support Element.selectNodes()"}};XMLDocument.prototype.selectSingleNode=function(a,d){try{if(!d){d=this}if(this.createNSResolver){var b=this.evaluate(a,d,objNSResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null);return b.singleNodeValue}return null}catch(c){SBGrid.DEF.errorMsg(c+" SBGridSbgrid : selectSingleNode")}};Element.prototype.selectSingleNode=function(a){if(this.ownerDocument.selectSingleNode){return this.ownerDocument.selectSingleNode(a,this)}else{throw"Web Browser not Support Element.selectSingleNode()"}}}SBGrid.UT.HtmlLib=function(){};SBGrid.UT.HtmlLib.getStyle=function(c,a){if(null!=c&&null!=a&&0<a.length){switch(a){case"left":return SBGrid.DEF.is_ie?c.currentStyle.left:window.getComputedStyle(c,null).left;case"right":return SBGrid.DEF.is_ie?c.currentStyle.right:window.getComputedStyle(c,null).right;case"top":return SBGrid.DEF.is_ie?c.currentStyle.top:window.getComputedStyle(c,null).top;case"bottom":return SBGrid.DEF.is_ie?c.currentStyle.bottom:window.getComputedStyle(c,null).bottom;case"width":return SBGrid.DEF.is_ie?c.currentStyle.width:window.getComputedStyle(c,null).width;case"height":return SBGrid.DEF.is_ie?c.currentStyle.height:window.getComputedStyle(c,null).height;case"font-family":return SBGrid.DEF.is_ie?c.currentStyle.fontFamily:window.getComputedStyle(c,null).fontFamily;case"font-size":return SBGrid.DEF.is_ie?c.currentStyle.fontSize:window.getComputedStyle(c,null).fontSize;case"font-weight":return SBGrid.DEF.is_ie?c.currentStyle.fontWeight:window.getComputedStyle(c,null).fontWeight;case"font-style":return SBGrid.DEF.is_ie?c.currentStyle.fontStyle:window.getComputedStyle(c,null).fontStyle;case"text-decoration":return SBGrid.DEF.is_ie?c.currentStyle.textDecoration:window.getComputedStyle(c,null).textDecoration;case"color":return SBGrid.DEF.is_ie?c.currentStyle.color:window.getComputedStyle(c,null).color;case"text-align":return SBGrid.DEF.is_ie?c.currentStyle.textAlign:window.getComputedStyle(c,null).textAlign;case"vertical-align":return SBGrid.DEF.is_ie?c.currentStyle.verticalAlign:window.getComputedStyle(c,null).verticalAlign;case"word-wrap":return SBGrid.DEF.is_ie?c.currentStyle.wordWrap:window.getComputedStyle(c,null).wordWrap;case"line-spacing":return SBGrid.DEF.is_ie?c.currentStyle.lineSpacing:window.getComputedStyle(c,null).lineSpacing;case"letter-spacing":return SBGrid.DEF.is_ie?c.currentStyle.letterSpacing:window.getComputedStyle(c,null).letterSpacing;case"padding":return SBGrid.DEF.is_ie?c.currentStyle.padding:window.getComputedStyle(c,null).padding;case"padding-left":return SBGrid.DEF.is_ie?c.currentStyle.paddingLeft:window.getComputedStyle(c,null).paddingLeft;case"padding-top":return SBGrid.DEF.is_ie?c.currentStyle.paddingTop:window.getComputedStyle(c,null).paddingTop;case"padding-right":return SBGrid.DEF.is_ie?c.currentStyle.paddingRight:window.getComputedStyle(c,null).paddingRight;case"padding-bottom":return SBGrid.DEF.is_ie?c.currentStyle.paddingBottom:window.getComputedStyle(c,null).paddingBottom;case"background-color":return SBGrid.DEF.is_ie?c.currentStyle.backgroundColor:window.getComputedStyle(c,null).backgroundColor;case"background-image":return SBGrid.DEF.is_ie?c.currentStyle.backgroundImage:window.getComputedStyle(c,null).backgroundImage;case"background-repeat":return SBGrid.DEF.is_ie?c.currentStyle.backgroundRepeat:window.getComputedStyle(c,null).backgroundRepeat;case"background-position":var b=SBGrid.DEF.is_ie?c.currentStyle.backgroundPosition:window.getComputedStyle(c,null).backgroundPosition;if("left center"==b){b="center left"}else{if("right center"==b){b="center right"}}return b;case"border-color":return SBGrid.DEF.is_ie?c.currentStyle.borderColor:window.getComputedStyle(c,null).borderColor;case"border-left-color":return SBGrid.DEF.is_ie?c.currentStyle.borderLeftColor:window.getComputedStyle(c,null).borderLeftColor;case"border-top-color":return SBGrid.DEF.is_ie?c.currentStyle.borderTopColor:window.getComputedStyle(c,null).borderTopColor;case"border-right-color":return SBGrid.DEF.is_ie?c.currentStyle.borderRightColor:window.getComputedStyle(c,null).borderRightColor;case"border-bottom-color":return SBGrid.DEF.is_ie?c.currentStyle.borderBottomColor:window.getComputedStyle(c,null).borderBottomColor;case"border-width":return SBGrid.DEF.is_ie?c.currentStyle.borderWidth:window.getComputedStyle(c,null).borderWidth;case"border-left-width":return SBGrid.DEF.is_ie?c.currentStyle.borderLeftWidth:window.getComputedStyle(c,null).borderLeftWidth;case"border-top-width":return SBGrid.DEF.is_ie?c.currentStyle.borderTopWidth:window.getComputedStyle(c,null).borderTopWidth;case"border-right-width":return SBGrid.DEF.is_ie?c.currentStyle.borderRightWidth:window.getComputedStyle(c,null).borderRightWidth;case"border-bottom-width":return SBGrid.DEF.is_ie?c.currentStyle.borderBottomWidth:window.getComputedStyle(c,null).borderBottomWidth;case"border-style":return SBGrid.DEF.is_ie?c.currentStyle.borderStyle:window.getComputedStyle(c,null).borderStyle;case"border-left-style":return SBGrid.DEF.is_ie?c.currentStyle.borderLeftStyle:window.getComputedStyle(c,null).borderLeftStyle;case"border-top-style":return SBGrid.DEF.is_ie?c.currentStyle.borderTopStyle:window.getComputedStyle(c,null).borderTopStyle;case"border-right-style":return SBGrid.DEF.is_ie?c.currentStyle.borderRightStyle:window.getComputedStyle(c,null).borderRightStyle;case"border-bottom-style":return SBGrid.DEF.is_ie?c.currentStyle.borderBottomStyle:window.getComputedStyle(c,null).borderBottomStyle;case"margin":return SBGrid.DEF.is_ie?c.currentStyle.margin:window.getComputedStyle(c,null).margin;case"margin-left":return SBGrid.DEF.is_ie?c.currentStyle.marginLeft:window.getComputedStyle(c,null).marginLeft;case"margin-top":return SBGrid.DEF.is_ie?c.currentStyle.marginTop:window.getComputedStyle(c,null).marginTop;case"margin-right":return SBGrid.DEF.is_ie?c.currentStyle.marginRight:window.getComputedStyle(c,null).marginRight;case"margin-bottom":return SBGrid.DEF.is_ie?c.currentStyle.marginBottom:window.getComputedStyle(c,null).marginBottom;case"opacity":return SBGrid.DEF.is_ie?c.currentStyle.opacity*100:window.getComputedStyle(c,null).opacity*100;case"overflow":return SBGrid.DEF.is_ie?c.currentStyle.oveflow:window.getComputedStyle(c,null).oveflow;case"clip":return;case"gradient":return;case"cursor":return SBGrid.DEF.is_ie?c.currentStyle.cursor:window.getComputedStyle(c,null).cursor;case"focus-rect":return;case"unloadmark":return}}return null};SBGrid.UT.HtmlLib.setStyle=function(g,c,f){try{if(null!=g&&null!=c&&0<c.length&&null!=f){if(typeof f!="string"){f=f.toString()}switch(c){case"width":if(-1==f.indexOf("%")){f=isFinite(f)?f+"px":f}g.style.width=f;break;case"height":if(-1==f.indexOf("%")){f=isFinite(f)?f+"px":f}g.style.height=f;break;case"left":g.style.left=isFinite(f)?f+"px":f;break;case"right":if(-1!=f.indexOf("%")){f=(100-parseFloat(f))+"%";g.style.right=f;break}g.style.right=isFinite(f)?f+"px":f;break;case"top":g.style.top=isFinite(f)?f+"px":f;break;case"bottom":if(-1!=f.indexOf("%")){f=(100-parseFloat(f))+"%";g.style.bottom=f;break}g.style.bottom=isFinite(f)?f+"px":f;break;case"font-family":g.style.fontFamily=f;break;case"font-size":f=isFinite(f)?f+"pt":f;g.style.fontSize=f;break;case"font-weight":g.style.fontWeight=f;break;case"font-style":g.style.fontStyle=f;break;case"text-decoration":g.style.textDecoration=f;break;case"color":f=""==f?"":f;g.style.color=f;break;case"text-align":g.style.textAlign=f;break;case"vertical-align":g.style.verticalAlign=f;break;case"word-wrap":g.style.wordWrap=f;break;case"line-spacing":g.style.lineSpacing=f;break;case"line-height":g.style.lineHeight=f;break;case"letter-spacing":g.style.letterSpacing=f;break;case"padding":g.style.padding=f;break;case"padding-left":g.style.paddingLeft=f;break;case"padding-top":g.style.paddingTop=f;break;case"padding-right":g.style.paddingRight=f;break;case"padding-bottom":g.style.paddingBottom=f;break;case"background-color":g.style.backgroundColor=f;break;case"background-image":if(""==f.trim()){g.style.backgroundImage=f;break}if(f.trim().substring(0,4)!="url("){f="url("+f+")"}g.style.backgroundImage=f;break;case"background-repeat":g.style.backgroundRepeat=f;break;case"background-position":if(""!=f){var b="";if(-1!=f.indexOf("left")){b="left"}else{if(-1!=f.indexOf("right")){b="right"}}var a="";if(-1!=f.indexOf("top")){a="top"}else{if(-1!=f.indexOf("bottom")){a="bottom"}}if(-1!=f.indexOf("center")){if("center"==f){if(""==b){b="center"}if(""==a){a="center"}}}if(""!=b&&""!=a){f=b+" "+a}else{if(""!=b&&""==a){f=b}else{if(""==b&&""!=a){f=a}else{if(""==b&&""==a){f="left center"}}}}}g.style.backgroundPosition=f;break;case"border-color":g.style.borderColor=f;break;case"border-left-color":g.style.borderLeftColor=f;break;case"border-top-color":g.style.borderTopColor=f;break;case"border-right-color":g.style.borderRightColor=f;break;case"border-bottom-color":g.style.borderBottomColor=f;break;case"border-width":g.style.borderWidth=f;break;case"border-left-width":g.style.borderLeftWidth=f;break;case"border-top-width":g.style.borderTopWidth=f;break;case"border-right-width":g.style.borderRightWidth=f;break;case"border-bottom-width":g.style.borderBottomWidth=f;break;case"border-style":g.style.borderStyle=f;break;case"border-left-style":g.style.borderLeftStyle=f;break;case"border-top-style":g.style.borderTopStyle=f;break;case"border-right-style":g.style.borderRightStyle=f;break;case"border-bottom-style":g.style.borderBottomStyle=f;break;case"margin":g.style.margin=f;break;case"margin-left":g.style.marginLeft=f;break;case"margin-top":g.style.marginTop=f;break;case"margin-right":g.style.marginRight=f;break;case"margin-bottom":g.style.marginBottom=f;break;case"opacity":if(SBGrid.DEF.is_ie){g.style.filter="alpha(opacity="+f+")"}else{if(1<f){var e=parseFloat(f)/100;f=e}g.style.opacity=f}break;case"overflow":g.style.overflow=f;break;case"clip":break;case"gradient":break;case"cursor":if("arrow"==f){f="default"}else{if("drag-move"==f){f="pointer"}else{if("h-resize"==f){f="col-resize"}else{if("v-resize"==f){f="row-resize"}else{if("no"==f){f="no-drop"}else{if("hand"==f){if(SBGrid.DEF.is_ie){f="hand"}else{f="pointer"}}else{if(""==f){f=""}else{f="default"}}}}}}}g.style.cursor=f;break;case"focus-rect":break;case"unloadmark":break}}}catch(d){}};SBGrid.UT.HtmlLib.setStyleFront=function(t,n,e){if(t){if("margin"==n){var p=t.style.marginLeft;var o=t.style.marginTop;var d=t.style.marginRight;var q=t.style.marginBottom;SBGrid.UT.HtmlLib.setStyle(t,n,e);if(""!=p){t.style.marginLeft=p}if(""!=o){t.style.marginTop=o}if(""!=d){t.style.marginRight=d}if(""!=q){t.style.marginBottom=q}}else{if("border-width"==n){var c=t.style.borderLeftWidth;var r=t.style.borderTopWidth;var a=t.style.borderRightWidth;var f=t.style.borderBottomWidth;SBGrid.UT.HtmlLib.setStyle(t,n,e);if(""!=c){t.style.borderLeftWidth=c}if(""!=r){t.style.borderTopWidth=r}if(""!=a){t.style.borderRightWidth=a}if(""!=f){t.style.borderBottomWidth=f}}else{if("border-style"==n){var l=t.style.borderLeftStyle;var u=t.style.borderTopStyle;var g=t.style.borderRightStyle;var m=t.style.borderBottomStyle;SBGrid.UT.HtmlLib.setStyle(t,n,e);if(""!=l){t.style.borderLeftStyle=l}if(""!=u){t.style.borderTopStyle=u}if(""!=g){t.style.borderRightStyle=g}if(""!=m){t.style.borderBottomStyle=m}}else{if("border-color"==n){var h=t.style.borderLeftColor;var s=t.style.borderTopColor;var b=t.style.borderRightColor;var i=t.style.borderBottomColor;SBGrid.UT.HtmlLib.setStyle(t,n,e);if(""!=h){t.style.borderLeftColor=h}if(""!=s){t.style.borderTopColor=s}if(""!=b){t.style.borderRightColor=b}if(""!=i){t.style.borderBottomColor=i}}else{if("padding"==n){var p=t.style.paddingLeft;var o=t.style.paddingTop;var d=t.style.paddingRight;var q=t.style.paddingBottom;SBGrid.UT.HtmlLib.setStyle(t,n,e);if(""!=p){t.style.paddingLeft=p}if(""!=o){t.style.paddingTop=o}if(""!=d){t.style.paddingRight=d}if(""!=q){t.style.paddingBottom=q}}}}}}}};SBGrid.UT.HttpClient=function(){this.m_objSubmit;this.m_objHttpFactory;this.m_objHttpRequest};SBGrid.UT.HttpClient.prototype.status=function(){if(4==this.m_objHttpRequest.readyState){return this.m_objHttpRequest.status}else{return null}};SBGrid.UT.HttpClient.prototype.post=function(h,a,f,c,b,g,e,d){return this._sendHttpRequest("POST",h,a,f,c,b,g,e,d)};SBGrid.UT.HttpClient.prototype.get=function(e,d,b,a,c){return this._sendHttpRequest("GET",e,null,d,b,a,false,null,c)};SBGrid.UT.HttpClient.prototype.put=function(e,a,d,c,b){return this._sendHttpRequest("PUT",e,a,d,c,b,false,null)};SBGrid.UT.HttpClient.prototype.deleteMethod=function(e,a,d,c,b){return this._sendHttpRequest("DELETE",e,a,d,c,b,false,null)};SBGrid.UT.HttpClient.prototype._sendHttpRequest=function(h,b,g,c,a,i,d,f,e){if(null==c){c=false}if(null==a||a.isEmpty()){a="application/x-www-form-urlencoded"}if(null==i||i.isEmpty()||!SBGrid.DEF.is_ie){i="UTF-8"}this.m_objHttpRequest=this._makeHttpRequest();if(c){if(null==e){this.m_objHttpRequest.m_objSubmit=this.m_objSubmit;this.m_objHttpRequest.onreadystatechange=SBGrid.UT.HttpClient.handleASyncHttpResponse}else{this.m_objHttpRequest.strId=this.id;this.m_objHttpRequest.onAfterSend=this.onAfterSend;this.m_objHttpRequest.onResponse=this.onResponse;this.m_objHttpRequest.onError=this.onError;this.m_objHttpRequest.onreadystatechange=SBGrid.UT.HttpClient.responseFunction}}this.m_objHttpRequest.open(h,b,c);if(d){this.m_objHttpRequest.setRequestHeader("Content-Type",a+"; boundary="+f)}else{this.m_objHttpRequest.setRequestHeader("Content-Type",a+";charset="+i)}this.m_objHttpRequest.send(g);if(!c){return this._handleSyncHttpResponse(b)}};SBGrid.UT.HttpClient.prototype._handleSyncHttpResponse=function(a){if(4==this.m_objHttpRequest.readyState){if(typeof error=="undefined"){window.error={}}error.errorCode=this.m_objHttpRequest.status;error.description=this.m_objHttpRequest.statusText;if(200==this.m_objHttpRequest.status){if("text/html"==this.m_objHttpRequest.getResponseHeader("Content-Type")){}else{if(null!=window.console){if(!SBGrid.DEF.is_smartphone){if(null!=window.console){console.log(" Connect URL : "+a);console.log(" Connect STATUS : "+this.m_objHttpRequest.status);console.log(" Connect STATUS TEXT : "+this.m_objHttpRequest.statusText)}}else{if(null!=window.console){console.log(this.m_objHttpRequest.status+","+this.m_objHttpRequest.statusText+","+a)}}}return this.m_objHttpRequest.responseText}}else{if(!SBGrid.DEF.is_smartphone){if(null!=window.console){console.log(" Connect URL : "+a);console.log(" Connect STATUS : "+this.m_objHttpRequest.status);console.log(" Connect STATUS TEXT : "+this.m_objHttpRequest.statusText)}}else{if(null!=window.console){console.log(this.m_objHttpRequest.status+","+this.m_objHttpRequest.statusText+","+a)}}return null}}};SBGrid.UT.HttpClient.prototype._makeHttpRequest=function(){if(null!=this.m_objHttpFactory){return this.m_objHttpFactory()}for(var a=0;a<SBGrid.UT.HttpClient._HttpFactories.length;a++){try{var b=SBGrid.UT.HttpClient._HttpFactories[a];var d=b();if(null!=d){this.m_objHttpFactory=b;return d}}catch(c){continue}}SBGrid.UT.HttpClient._HttpFactories=function(){throw new Error("HttpRequest not supported")};SBGrid.UT.HttpClient._HttpFactories()};SBGrid.UT.HttpClient._HttpFactories=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];SBGrid.UT.HttpClient.handleASyncHttpResponse=function(){if(4==this.readyState){if(200==this.status){var a=this.responseText;if(null!=a&&!a.isEmpty()){var d=this.m_objSubmit.attribute.add;var h=this.m_objSubmit.attribute.type;var f=this.m_objSubmit.attribute.replace;var g=this.m_objSubmit.attribute.resultref;var c=false;if("/"==g.charAt(g.length-1)){g=g.substring(0,g.length-1);c=true}a=a.trim();if("custom"==h){var b=a;try{a=onaftersend(b);a=null==a?b:a}catch(e){a=b}}xnResultDoc=SBGrid.UT.XmlLib.loadXMLFromString(a);if(null!=xnResultDoc){if(null==xnResultDoc.firstChild||("root"!=xnResultDoc.firstChild.nodeName&&"xml"!=xnResultDoc.firstChild.nodeName)){}else{SBGrid.DS.XMLStorage.getUniqueStorage().updateData(SBGrid.UT.XmlLib.getRootElementNode(xnResultDoc),g,d,f,c);if(this.m_objSubmit.m_refresh){SBGrid.DS.XMLStorage.getUniqueStorage().refreshCurrentModel()}}}}this.m_objSubmit.m_objEndFunction()}else{throw new Error(this.status)}}};SBGrid.UT.HttpClient.prototype.send=function(objData){if(null==this.mediaType||null==this.method||null==this.URL){if(this.onError){try{eval(this.onError+"('"+this.id+"','')");return}catch(e){}}}var bIsJson=null==objData.ownerDocument;var strData;if("application/x-www-form-urlencoded"==this.mediaType){if(bIsJson){strData=SBGrid.DS.JsonStorage.getUniqueStorage()._getbSyncPostDataJson(objData,true,"","UTF-8",this.mediaType)}else{strData=SBGrid.DS.XMLStorage.getUniqueStorage()._getPostDataNode(objData,true,"","UTF-8",this.mediaType)}}else{if("application/xml"==this.mediaType||"text/xml"==this.mediaType||"application/json"==this.mediaType){if(bIsJson){strData=JSON.stringify(objData)}else{strData=SBGrid.UT.XmlLib.serializeToString(objData)}}else{return}}if("get"==this.method.toLowerCase()){strResult=this.get(this.URL+"?"+strData,true,this.mediaType,null,true)}else{if("post"==this.method.toLowerCase()){strResult=this.post(this.URL,strData,true,this.mediaType,null,false,null,true)}}};SBGrid.UT.HttpClient.responseFunction=function(){if(4==this.readyState){var strId=this.strId;var strOnError=this.onError;var strOnResponse=this.onResponse;var strOnAfterSend=this.onAfterSend;if(200==this.status){var strResult=this.responseText.trim();if(strOnResponse){strOnResponse=strOnResponse.trim();if(strOnAfterSend){strOnAfterSend=strOnAfterSend.trim()}var fnOnAfterSend=eval("window."+strOnAfterSend);var fnOnResponse=eval("window."+strOnResponse);try{var strReturnData=null;if(null!=fnOnAfterSend){strReturnData=fnOnAfterSend(strId,strResult,"");fnOnResponse(strId,strReturnData,"")}else{fnOnResponse(strId,strResult,"")}}catch(e){}}}else{if(strOnError){strOnError=strOnError.trim();var fnOnError=eval("window."+strOnError);try{if(null!=fnOnError){fnOnError(strId,"","")}}catch(e){}}}}};SBGrid.UT.Format=function(heControlId,strFormatData,bDecimalFormatInsert,strMaxLength){this.m_heCtrl=heControlId;this.m_strFormat;this.m_bIsDecimalFormatInsert=eval(bDecimalFormatInsert);this.m_nLength;this.m_bExistFormat=true;this.m_bIsDecimalFormatted=false;this.m_bExistMoneyUnitFormat=false;this.m_nMoneyUnitFormatPattern=0;this.m_strInputRealityData;this.m_strInputMaskData;this.m_nCaretStart;this.m_nCaretEnd;this.m_nMaxLength="-1"==strMaxLength?2147483647:Number(strMaxLength);this.m_bIsMaxLength="-1"==strMaxLength?false:true;this.m_strFormatYear;this.m_FormatManth;this.m_strDotZero="";this.m_bDeleteZero=false;this.init(strFormatData);this.m_bChangeClipboad=false};SBGrid.UT.Format.prototype.init=function(a,c){this.m_bChangeClipboad=false;if(/\-|\/|\:|\$|\%|\ /.test(a.charAt(0))){a="'"+a.charAt(0)+"'"+a.substring(1,a.length)}this.m_strFormat=a;this.m_nLength=this.m_strFormat.length;if(null==c){c=false}if(0==this.m_nLength){this.m_bExistFormat=false;if(null==this.m_heCtrl.style.imeMode||""==this.m_heCtrl.style.imeMode){this.m_heCtrl.style.imeMode="auto"}this.m_heCtrl.maxLength=this.m_nMaxLength;return}else{this.m_bExistFormat=true;this.m_heCtrl.style.imeMode="disabled";this.m_strSelectionTypeMask="";if(this.m_bExistSelectionTypeMask=/\((\D+)\)/.test(this.m_strFormat)){this.m_strSelectionTypeMask=this.m_strFormat.substring(this.m_strFormat.indexOf("("),this.m_strFormat.indexOf(")")+1);this.m_strFormat=this.m_strFormat.substring(this.m_strSelectionTypeMask.length,this.m_strFormat.length);this.m_nLength=this.m_strFormat.length}this.m_strAppearTypeMask="";if(/\'(\D+)\'/.test(this.m_strFormat)){this.m_strAppearTypeMask=this.m_strFormat.substring(this.m_strFormat.indexOf("'"),this.m_strFormat.lastIndexOf("'")+1);this.m_strFormat=this.m_strFormat.substring(this.m_strAppearTypeMask.length,this.m_strFormat.length);this.m_nLength=this.m_strFormat.length;this.m_strAppearMask=this.m_strAppearTypeMask.substring(1,this.m_strAppearTypeMask.length-1)}this.m_bIsMasked=false;this.m_strMask="";if(null==this.m_strInputRealityData){this.m_strInputRealityData=""}else{if((""==this.m_strInputRealityData&&""!=this.m_heCtrl.value)||c){this.m_strInputRealityData=this.m_heCtrl.value}else{this.m_strInputRealityData=this.m_heCtrl.value}}this.m_strMask=-1!=this.m_strSelectionTypeMask.indexOf(this.m_strInputRealityData.charAt(0))?this.m_strInputRealityData.charAt(0):"";if(""!=this.m_strMask){this.m_bIsMasked=true}if(this.m_strFormat.indexOf("9#")){this.m_strFormat=this.m_strFormat.replace("9#","#")}if("-1"==this.m_strFormat.indexOf("#")&&"-1"==this.m_strFormat.indexOf("0")){this.m_bExistMoneyUnitFormat=false;this.m_heCtrl.maxLength=this.m_strFormat.length;if(window.event){if(window.event.keyCode!=SBGrid.EVT.TAB){this.inputValidateCheck()}}}else{this.m_bExistMoneyUnitFormat=true;this.m_heCtrl.maxLength=this.m_nMaxLength;var b=this.m_strFormat.indexOf(".");this.m_nMoneyUnitFormatPattern="-1"!=this.m_strFormat.indexOf(",")?1:0;this.m_nMoneyUnitFormatPattern="-1"!=b?(this.m_nMoneyUnitFormatPattern+2):this.m_nMoneyUnitFormatPattern;switch(this.m_nMoneyUnitFormatPattern){case 2:case 3:this.m_bIsDecimalFormatted=true;break;case 0:case 1:this.m_bIsDecimalFormatted=false;break}if(-1!=b){this.m_strDotZero="";while("0"==this.m_strFormat.charAt((b+1))){this.m_strDotZero+="0";b++}}else{if(-1!=this.m_strInputRealityData.indexOf(".")){this.m_strInputRealityData=this.m_strInputRealityData.substring(0,this.m_strInputRealityData.indexOf("."))}}this.inputMoneyUnitValidateCheck()}}};SBGrid.UT.Format.prototype.stopKeyEvent=function(a){if(SBGrid.DEF.is_ie){a.m_browserEvent.returnValue=false}else{a.m_browserEvent.preventDefault()}};SBGrid.UT.Format.prototype.moneyKeyCheck=function(b){if(8==b.keyCode||46==b.keyCode){var d=this.m_heCtrl.value;var l=SBGrid.DEF.getCaretPosition(this.m_heCtrl);this.m_nCaretStart=l.start;this.m_nCaretEnd=l.end;var f=d.substring(0,this.m_nCaretStart);var c=f.split(",").length-1;var g=d.split(",").length-1;var e=this.m_nCaretStart!=this.m_nCaretEnd?true:false;var m=this.m_nCaretStart-c;var i=this.m_nCaretEnd-c;if(this.m_strInputRealityData.length<m){if(8==b.keyCode){m=this.m_strInputRealityData.length;this.m_nCaretStart=m+c;i=this.m_strInputRealityData.length;this.m_nCaretEnd=i+c}else{this.stopKeyEvent(b);return}}var h=false;if(!e){if(8==b.keyCode){if(","==d.charAt(this.m_nCaretStart-1)){this.m_nCaretStart--}this.m_nCaretStart--;m--}else{if(46==b.keyCode){if(","==d.charAt(this.m_nCaretEnd)){this.m_nCaretEnd++;h=true}i++}}}if(e){var a=d.substring(this.m_nCaretStart,this.m_nCaretEnd);g-=a.split(",").length-1;i-=a.split(",").length-1;if(","==a.charAt(a.length-1)){g++;h=true}}if(","==d.charAt(this.m_nCaretEnd+1)){this.m_nCaretStart++}f=this.m_strInputRealityData.substring(0,m);strLastString=this.m_strInputRealityData.substring(i,this.m_strInputRealityData.length);this.m_strInputRealityData=f+strLastString;this.m_nCaretStart-=g;if(h){this.m_nCaretStart++}if(-1==this.m_strInputRealityData.indexOf(this.m_strMask)){this.m_strMask="";this.m_bIsMasked=false}this.stopKeyEvent(b);this.inputMoneyUnitValidateCheck();SBGrid.DEF.setCaretPosition(this.m_heCtrl,this.m_nCaretStart,this.m_nCaretStart)}else{this.stopKeyEvent(b)}};SBGrid.UT.Format.prototype.keypressFormatting=function(b){if(this.m_bExistFormat){var g=this.m_heCtrl.value;var l=g.length;var o=SBGrid.DEF.getCaretPosition(this.m_heCtrl);this.m_nCaretStart=o.start;this.m_nCaretEnd=o.end;if(this.m_bExistSelectionTypeMask&&!this.m_bIsMasked&&0==this.m_nCaretStart){this.m_strMask=-1!=this.m_strSelectionTypeMask.indexOf(String.fromCharCode(b.keyCode))?String.fromCharCode(b.keyCode):"";if(""!=this.m_strMask){this.m_strFormat=this.m_strMask+this.m_strFormat;this.m_nLength=this.m_strFormat.length;this.m_bIsMasked=true}}var h=this.m_nCaretStart!=this.m_nCaretEnd?true:false;var m="";var q="";var c=0;if(8==b.keyCode){if(h){this.stopKeyEvent(b);m=g.substring(0,this.m_nCaretStart);q=g.substring(this.m_nCaretEnd,l).replace(/\W/g,"")}else{if("9"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"y"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"m"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"d"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"h"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"n"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"s"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"A"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"a"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"C"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"L"!=this.m_strFormat.charAt(this.m_nCaretStart-1)){this.m_nCaretStart--}this.stopKeyEvent(b);c--;m=g.substring(0,this.m_nCaretStart-1);q=g.substring(this.m_nCaretStart,l).replace(/\W/g,"")}if(0==this.m_nCaretStart&&""!=this.m_strMask){this.m_strFormat=this.m_strFormat.substring(1,this.m_strFormat.length);this.m_nLength=this.m_strFormat.length;this.m_strMask="";this.m_bIsMasked=false}}else{if(46==b.keyCode){if(h){this.stopKeyEvent(b);m=g.substring(0,this.m_nCaretStart);q=g.substring(this.m_nCaretEnd,l).replace(/\W/g,"")}else{var r=0;if("9"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"y"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"m"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"d"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"h"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"n"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"s"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"A"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"a"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"C"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"L"!=this.m_strFormat.charAt(this.m_nCaretStart)){if(0!=this.m_nCaretStart&&""==this.m_strMask){r++}}this.stopKeyEvent(b);m=g.substring(0,this.m_nCaretStart);q=g.substring(this.m_nCaretStart+r+1,l).replace(/\W/g,"")}if(0==this.m_nCaretStart&&""!=this.m_strMask){r--;this.m_strFormat=this.m_strFormat.substring(1,this.m_strFormat.length);this.m_nLength=this.m_strFormat.length;this.m_strMask="";this.m_bIsMasked=false}}else{m=g.substring(0,this.m_nCaretStart);q=g.substring(this.m_nCaretEnd,l);var s=true;if("9"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"y"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"m"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"d"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"h"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"n"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"s"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"A"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"a"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"C"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"L"!=this.m_strFormat.charAt(this.m_nCaretStart)){if(this.m_strFormat.charAt(this.m_nCaretStart)==String.fromCharCode(b.keyCode)){s=false;m+=this.m_strFormat.charAt(this.m_nCaretStart)}else{s=true;m+=this.m_strFormat.charAt(this.m_nCaretStart);this.m_nCaretStart++}}var p=this.validateFormat(this.m_nCaretStart,String.fromCharCode(b.keyCode),b);this.stopKeyEvent(b);if(""==p&&s){return}m+=p;this.m_nCaretStart++}}var f=0;var a="";for(var n=this.m_nCaretStart+c;n<this.m_nLength;n++){if("9"!=this.m_strFormat.charAt(n)&&"y"!=this.m_strFormat.charAt(n)&&"m"!=this.m_strFormat.charAt(n)&&"d"!=this.m_strFormat.charAt(n)&&"h"!=this.m_strFormat.charAt(n)&&"n"!=this.m_strFormat.charAt(n)&&"s"!=this.m_strFormat.charAt(n)&&"A"!=this.m_strFormat.charAt(n)&&"a"!=this.m_strFormat.charAt(n)&&"C"!=this.m_strFormat.charAt(n)&&"L"!=this.m_strFormat.charAt(n)){a+=this.m_strFormat.charAt(n)}else{if(""!=q.charAt(f)){var d=this.validateFormat(n,q.charAt(f),b);if(""!=d){a+=d;m+=a;f++;a=""}else{break}}else{break}}}var e=this.dayFormatCheck(m);if(e||8==b.keyCode||46==b.keyCode){this.m_heCtrl.value=m;if(""!=this.m_strMask){m=m.substring(1,m.length);if("C"!=this.m_strFormat.charAt(this.m_nCaretStart)){m=m.replace(/\W/g,"")}m=this.m_strMask+m}else{if("C"!=this.m_strFormat.charAt(this.m_nCaretStart)){m=m.replace(/\W/g,"")}}this.m_strInputRealityData=m;if(8==b.keyCode){this.m_nCaretStart--}SBGrid.DEF.setCaretPosition(this.m_heCtrl,this.m_nCaretStart,this.m_nCaretStart)}}};SBGrid.UT.Format.prototype.keypressMoneyUnitFormatting=function(p){if(this.m_bExistFormat){if(SBGrid.DEF.is_firefox){p.keyCode=p.m_browserEvent.keyCode>p.m_browserEvent.charCode?p.m_browserEvent.keyCode:p.m_browserEvent.charCode;if(0==p.m_browserEvent.charCode){return}}if(SBGrid.DEF.is_opera){p.keyCode=p.m_browserEvent.keyCode>p.m_browserEvent.which?p.m_browserEvent.keyCode:p.m_browserEvent.which;if(0==p.m_browserEvent.which){return}}var g=SBGrid.DEF.getCaretPosition(this.m_heCtrl);this.m_nCaretStart=g.start;this.m_nCaretEnd=g.end;var n=this.m_nCaretStart!=this.m_nCaretEnd?true:false;if(typeof this.m_strAppearMask!="undefined"){if(""!=this.m_strAppearMask&&this.m_nCaretStart<this.m_strAppearMask.length){this.m_nCaretStart=this.m_strAppearMask.length}}if("."==this.m_strInputRealityData.charAt(0)&&/\d/.test(this.m_strInputRealityData.charAt(1))){this.m_nCaretStart--;this.m_nCaretEnd--}var f=false;if(0==this.m_nCaretStart&&(this.m_nCaretStart!=this.m_nCaretEnd?true:false)){this.m_bIsMasked=false;if(""!=this.m_strAppearMask){this.m_bIsAppearMaskDel=true}}var e=this.m_heCtrl.value.replace(this.m_strAppearMask,"");var h=-1!=this.m_heCtrl.value.indexOf(this.m_strAppearMask)?this.m_strAppearMask.length:0;if(this.m_bIsMasked){h=-1!=this.m_heCtrl.value.indexOf(this.m_strMask)?this.m_strMask.length:h}this.m_nCaretStart-=h;this.m_nCaretEnd-=h;if(this.m_bExistSelectionTypeMask&&!this.m_bIsMasked&&(0==this.m_nCaretStart||0==parseFloat(e.length==0?0:e))){this.m_strMask=-1!=this.m_strSelectionTypeMask.indexOf(String.fromCharCode(p.keyCode))?String.fromCharCode(p.keyCode):"";if(""!=this.m_strMask){this.m_bIsMasked=true;f=true}}if((p.keyCode>=48&&p.keyCode<=57)||p.keyCode==46||f){var u="";if(n==false){u=this.m_strInputRealityData}var b=u.length;var m=this.m_heCtrl.value.split(",").length-1;var o=e.substring(0,this.m_nCaretEnd).split(",").length-1;var d=this.m_nCaretStart-o;var l=this.m_nCaretEnd-o;if(u.indexOf("-")!=-1){d++;l++}if(((-1!=u.indexOf(".")&&-1==u.substring(d,l).indexOf("."))||!this.m_bIsDecimalFormatted)&&"."==String.fromCharCode(p.keyCode)){this.stopKeyEvent(p);return}m-=(e.substring(this.m_nCaretStart,this.m_nCaretEnd).split(",").length-1);if(d>b){d=b;this.m_nCaretStart=b+m}if(l>b){l=b;this.m_nCaretEnd=b+m}var s=String.fromCharCode(p.keyCode);if(/\D/.test(s)&&f){this.m_nCaretStart=0}this.m_nCaretStart++;this.m_nCaretStart-=m;var r=u.substring(0,d);var c=u.substring(l,b);if(-1!=r.indexOf(".")){if(this.m_bIsDecimalFormatInsert){u=r+s+c.substring(1,c.length)}else{u=r+s+c}if(""!=this.m_strDotZero){u=u.substring(0,u.indexOf(".")+1+this.m_strDotZero.length)}}else{u=r+s+c}if("."==u.charAt(0)){this.m_nCaretStart++}var t=false;if("00"==u.substring(0,2)&&(0!=this.m_nMoneyUnitFormatPattern&&2!=this.m_nMoneyUnitFormatPattern)){u=u.substring(1,u.length);this.m_nCaretStart--}else{if(0!=this.m_nMoneyUnitFormatPattern&&2!=this.m_nMoneyUnitFormatPattern){var a=-1;for(var q=0;q<u.length;q++){if("0"==u.charAt(q)){a++}else{break}}if(-1<a&&"."!=u.charAt(1)){u=u.substring(a+1,u.length);if(""==u){u="0"}else{t=true}}}}this.m_strInputRealityData=u;this.inputMoneyUnitValidateCheck();this.m_nCaretStart+=h;this.m_nCaretEnd+=h;if(","==this.m_heCtrl.value.charAt(this.m_nCaretStart-1)){this.m_nCaretStart--}if(t){this.m_nCaretStart--}this.stopKeyEvent(p);if(this.m_bIsAppearMaskDel){this.m_nCareteStart++;this.m_bIsAppearMaskDel=false}SBGrid.DEF.setCaretPosition(this.m_heCtrl,this.m_nCaretStart,this.m_nCaretStart)}else{this.stopKeyEvent(p)}}};SBGrid.UT.Format.prototype.inputMoneyUnitValidateCheckPattern1=function(c){var b="";var d=c.length;d=0==this.m_strDotZero.length?c.length:this.m_strDotZero.length;for(var a=0;a<d;a++){if(""!=c.charAt(a)){b+=c.charAt(a);continue}else{b+="0"}}return b};SBGrid.UT.Format.prototype.inputMoneyUnitValidateCheckPattern2=function(c){var g="";c=c.replace(/\D/g,"");var f=c.length;var a=f%3;var e=(f/2)-1;var l=0;var d=0;var h=false;for(var b=0;b<f;b++){if(0==b&&c.charCodeAt(b)==48){g=c.charAt(b)}else{if(a==l){if(f>3&&a!=0){this.m_nCaretStart++;g=g+",";h=true}else{if(f>3){h=true}}}if(3==d){this.m_nCaretStart++;g=g+",";d=0}g+=c.charAt(b);l++;if(h){d++}}}if(""==g&&this.m_bIsDecimalFormatted&&""!=this.m_strDotZero){g="0"}if(","==g.charAt(this.m_nCaretStart-1)){this.m_nCaretStart--}return g};SBGrid.UT.Format.prototype.inputMoneyUnitValidateCheckPattern3=function(d){var c="";d=d.replace(/[^\.\d]/g,"");var f=0==this.m_strDotZero.length?0:this.m_strDotZero.length;var e=d.length;for(var b=0;b<e;b++){c+=d.charAt(b)}if(""==c&&"0"==this.m_strFormat.replace(/[^\.\d]/g,"").charAt(0)){c="0"}if(-1!=d.indexOf(".")){var a=d.substring(d.indexOf("."),e).length;for(var b=a;b<=f;b++){c+="0"}}else{if(0<f){c+=".";for(var b=0;b<f;b++){c+="0"}}}return c};SBGrid.UT.Format.prototype.inputMoneyUnitValidateCheck=function(){var e="";var d=this.m_strInputRealityData;var b=0;d=d.replace(/[^.\d]/g,"");if("9#"!=this.m_strFormat){for(var c=0;c<d.length;c++){if("0"!=d.charAt(c)){b=c;if(0!=c&&"."==d.charAt(c)){b--}break}}}d=d.substring(b,d.length);var f=d.length;switch(this.m_nMoneyUnitFormatPattern){case 0:e=this.inputMoneyUnitValidateCheckPattern3(d);break;case 1:e=this.inputMoneyUnitValidateCheckPattern2(d);break;case 2:e=this.inputMoneyUnitValidateCheckPattern3(d);break;case 3:if(-1==this.m_strInputRealityData.indexOf(".")){e=this.inputMoneyUnitValidateCheckPattern2(d);if(""!=this.m_strDotZero){e+="."+this.m_strDotZero}}else{var a=d.indexOf(".");e+=this.inputMoneyUnitValidateCheckPattern2(d.substring(0,a));e+=".";var g=this.inputMoneyUnitValidateCheckPattern1(d.substring(a+1,f));e+=g}break}if((this.m_bIsMasked&&""!=this.m_strMask)||d.indexOf()){e=this.m_strMask+e}if(null!=this.m_strAppearMask&&""!=this.m_strAppearMask){e=this.m_strAppearMask+e}this.m_strInputMaskData=e;this.m_heCtrl.value=e};SBGrid.UT.Format.prototype.inputValidateCheck=function(){var e="";var b="";this.m_strInputRealityData="";this.m_strInputMaskData="";var f=0;var g=0;var d=this.m_heCtrl.value;var a=d.length;reSpecialChar=/\s/g;d=d.replace(reSpecialChar,"");this.m_nCaretStart=this.m_nCaretStart-(a-d.length);reSpecialChar=/\W/g;d=d.replace(reSpecialChar,"");for(var c=0;c<this.m_nLength;c++){if(f!=this.m_nLength&&""!=d.charAt(g)){if("9"!=this.m_strFormat.charAt(f)&&"y"!=this.m_strFormat.charAt(f)&&"m"!=this.m_strFormat.charAt(f)&&"d"!=this.m_strFormat.charAt(f)&&"h"!=this.m_strFormat.charAt(f)&&"n"!=this.m_strFormat.charAt(f)&&"s"!=this.m_strFormat.charAt(f)&&"A"!=this.m_strFormat.charAt(f)&&"a"!=this.m_strFormat.charAt(f)&&"C"!=this.m_strFormat.charAt(f)&&"L"!=this.m_strFormat.charAt(f)){e=e+this.m_strFormat.charAt(f);f++}else{for(;g<d.length;g++){b=this.validateFormat(f,d.charAt(g));if(""!=b){e=e+b;this.m_strInputRealityData=this.m_strInputRealityData+b;g++;if("9"!=this.m_strFormat.charAt(f+1)&&"y"!=this.m_strFormat.charAt(f+1)&&"m"!=this.m_strFormat.charAt(f+1)&&"d"!=this.m_strFormat.charAt(f+1)&&"h"!=this.m_strFormat.charAt(f+1)&&"n"!=this.m_strFormat.charAt(f+1)&&"s"!=this.m_strFormat.charAt(f+1)&&"A"!=this.m_strFormat.charAt(f+1)&&"a"!=this.m_strFormat.charAt(f+1)&&"C"!=this.m_strFormat.charAt(f+1)&&"L"!=this.m_strFormat.charAt(f+1)){e=e+this.m_strFormat.charAt(f+1);f++;if(this.m_nCaretStart==f||this.m_nCaretStart==this.m_heCtrl.value.length){this.m_nCaretStart++}}break}else{this.m_nCaretStart--}}f++}}}if(""!=this.m_bIsMasked){this.m_strInputRealityData=this.m_strMask+this.m_strInputRealityData;this.m_strFormat=this.m_strMask+this.m_strFormat;e=this.m_strMask+e}this.m_strInputMaskData=e;this.m_heCtrl.value=e};SBGrid.UT.Format.prototype.dayFormatCheck=function(l){if(-1!=this.m_strFormat.indexOf("yyyy")&&-1!=this.m_strFormat.indexOf("mm")&&-1!=this.m_strFormat.indexOf("dd")){var g={};var m=this.m_strFormat.split(/\W/g);var h=l.split(/\W/g);for(var e=0;e<m.length;e++){g[m[e]]=null!=h[e]?h[e]:"0"}if(0!=g.mm){var f=parseInt(parseFloat(g.yyyy));var d=parseInt(parseFloat(g.mm));var c=parseInt(parseFloat(g.dd));var b="312931303130313130313031";var a=b.substring(((d-1)*2),((d-1)*2+2));if(g.yyyy.length>3&&(d==2)&&!((((f%4==0)&&(f%100!=0))||(f%400==0)))){a="28"}if(c<=parseInt(parseFloat(a))){return true}else{return false}}}return true};SBGrid.UT.Format.prototype.validateFormat=function(a,d,b){var c;if(""==d){c=b.keyCode;if(c>=96&&c<=105){c=c-48}}else{c=d.charCodeAt(0)}switch(this.m_strFormat.charAt(a)){case"9":if(c>=48&&c<=57){return String.fromCharCode(c)}return"";case"y":if("y"==this.m_strFormat.charAt(a-3)&&"0"==this.m_heCtrl.value.charAt(a-1)&&"0"==this.m_heCtrl.value.charAt(a-2)&&"0"==this.m_heCtrl.value.charAt(a-3)){if(c>=49&&c<=57){return String.fromCharCode(c)}}else{if(c>=48&&c<=57){return String.fromCharCode(c)}}return"";case"m":if("m"==this.m_strFormat.charAt(a+1)){if(c>=48&&c<=49){return String.fromCharCode(c)}}else{if("m"==this.m_strFormat.charAt(a-1)&&"1"==this.m_strInputRealityData.charAt(this.m_strInputRealityData.length-1)){if(c>=48&&c<=50){return String.fromCharCode(c)}}else{if(c>=49&&c<=57){return String.fromCharCode(c)}}}return"";case"d":if("d"==this.m_strFormat.charAt(a+1)){if("m"==this.m_strFormat.charAt(a-2)&&"2"==this.m_strInputRealityData.charAt(this.m_strInputRealityData.length-1)&&(("m"==this.m_strFormat.charAt(a-3)&&"0"==this.m_strInputRealityData.charAt(this.m_strInputRealityData.length-2))||"m"!=this.m_strFormat.charAt(a-3))){if(c>=48&&c<=50){return String.fromCharCode(c)}}else{if(c>=48&&c<=51){return String.fromCharCode(c)}}}else{if("d"==this.m_strFormat.charAt(a-1)&&"3"!=this.m_strInputRealityData.charAt(this.m_strInputRealityData.length-1)){if(c>=48&&c<=57){return String.fromCharCode(c)}}else{if("d"==this.m_strFormat.charAt(a-1)&&"3"==this.m_strInputRealityData.charAt(this.m_strInputRealityData.length-1)){if(c>=48&&c<=49){return String.fromCharCode(c)}}else{if(c>=48&&c<=57){return String.fromCharCode(c)}}}}return"";case"h":if("h"==this.m_strFormat.charAt(a+1)){if(c>=48&&c<=50){return String.fromCharCode(c)}}else{if("h"==this.m_strFormat.charAt(a-1)&&"2"==this.m_heCtrl.value.charAt(a-1)){if(c>=48&&c<=57){return String.fromCharCode(c)}}else{if(c>=48&&c<=57){return String.fromCharCode(c)}}}return"";case"n":if("n"==this.m_strFormat.charAt(a+1)){if(c>=48&&c<=53){return String.fromCharCode(c)}}else{if(c>=48&&c<=57){return String.fromCharCode(c)}}return"";case"s":if("s"==this.m_strFormat.charAt(a+1)){if(c>=48&&c<=53){return String.fromCharCode(c)}}else{if(c>=48&&c<=57){return String.fromCharCode(c)}}return"";case"A":if((c>=48&&c<=57)||(c>=65&&c<=90)||(c>=97&&c<=129)){return d}return"";case"a":if((c==32)||(c>=48&&c<=57)||(c>=65&&c<=90)||(c>=97&&c<=129)){return d}return"";case"C":return d;case"L":if((c>=65&&c<=90)||(c>=97&&c<=129)){return d}return"";default:return""}};SBGrid.UT.Format.prototype.getLength=function(){return this.m_nLength};SBGrid.UT.Format.prototype.getFormatString=function(){return this.m_strFormat};SBGrid.UT.Format.prototype.getFormatInputData=function(){return this.m_strInputRealityData};SBGrid.UT.Format.prototype.getFormatInputMaskData=function(){return this.m_strInputMaskData};SBGrid.UT.Format.prototype.getFormatExist=function(){return this.m_bExistFormat};SBGrid.UT.Format.prototype.setFormatExist=function(a){return this.m_bExistFormat=a};SBGrid.UT.Format.prototype.getMoneyUnitFormatExist=function(){return this.m_bExistMoneyUnitFormat};SBGrid.UT.Format.prototype.setChangeClipboad=function(a){this.m_bChangeClipboad=a};SBGrid.UT.Format.prototype.getChangeClipboad=function(){return this.m_bChangeClipboad};SBGrid.UT.Format.prototype.removeMask=function(a){if(this.m_strFormat=="#,###"){return a.replaceAll(",","")}else{return this.inputValidateCheckData(a)}return a};SBGrid.UT.Format.prototype.inputValidateCheckData=function(h){var l="";var a="";var b=0;var f=0;var g=h;var e=0;var c=g.length;reSpecialChar=/\s/g;g=g.replace(reSpecialChar,"");reSpecialChar=/\W/g;g=g.replace(reSpecialChar,"");for(var d=0;d<h.length;d++){if(b!=h.length&&""!=g.charAt(f)){if("9"!=this.m_strFormat.charAt(b)&&"y"!=this.m_strFormat.charAt(b)&&"m"!=this.m_strFormat.charAt(b)&&"d"!=this.m_strFormat.charAt(b)&&"h"!=this.m_strFormat.charAt(b)&&"n"!=this.m_strFormat.charAt(b)&&"s"!=this.m_strFormat.charAt(b)&&"A"!=this.m_strFormat.charAt(b)&&"a"!=this.m_strFormat.charAt(b)&&"C"!=this.m_strFormat.charAt(b)&&"L"!=this.m_strFormat.charAt(b)){l=l+this.m_strFormat.charAt(b);b++}else{for(;f<g.length;f++){a=this.validateFormat(b,g.charAt(f));if(""!=a){l=l+a;f++;if("9"!=this.m_strFormat.charAt(b+1)&&"y"!=this.m_strFormat.charAt(b+1)&&"m"!=this.m_strFormat.charAt(b+1)&&"d"!=this.m_strFormat.charAt(b+1)&&"h"!=this.m_strFormat.charAt(b+1)&&"n"!=this.m_strFormat.charAt(b+1)&&"s"!=this.m_strFormat.charAt(b+1)&&"A"!=this.m_strFormat.charAt(b+1)&&"a"!=this.m_strFormat.charAt(b+1)&&"C"!=this.m_strFormat.charAt(b+1)&&"L"!=this.m_strFormat.charAt(b+1)){l=l+this.m_strFormat.charAt(b+1);b++;if(e==b||e==h.length){e++}}break}else{e--}}b++}}}return l};SBGrid.UT.ConvertGroup=function(g,o){var h={};var w=g.groupColumns;var p=g.dataColumns;if(!w.length){return null}for(var u=0;u<o.length;u++){for(var r=0;r<w.length;r++){var z="";var c=o[u];for(var q=0;q<=r;q++){z+=c[w[q]]+"^!^"}var m=null;if(h[z]==null){m={};m.SBGrid_KEY=z;m[g.groupColumnName]=c[w[r]];m[g.groupLevelColumnName]=r+1;for(var y=0;y<p.length;y++){var e="";var a="";e=c[p[y]];if(typeof(e)=="string"){e=e.replace("$","");e=e.replace(",","");e=e.replace("(","");e=e.replace(")","");e=parseInt(e)}if(g.categoryColumns){a=c[g.categoryColumns]+"_";a=a.replace(" ","")}m[a+p[y]]=e}h[z]=m}else{m=h[z];for(var y=0;y<p.length;y++){var e="";var a="";e=c[p[y]];if(typeof(e)=="string"){e=e.replace("$","");e=e.replace(",","");e=e.replace("(","");e=e.replace(")","");e=parseInt(e)}if(g.categoryColumns){a=c[g.categoryColumns]+"_";a=a.replace(" ","")}if(m[a+p[y]]==undefined){m[a+p[y]]=parseInt(e)}else{m[a+p[y]]+=parseInt(e)}}}}}var l=g.calculates;for(var u=0;u<l.length;u++){for(var r in h){var n=h[r];n[l[u].calculateColumnName]=l[u].calculate.call(this,n)}}var d=[];var b=0;var t=null;var s=g.bMakeTotal;var f=g.groupLevelColumnName;for(var r in h){var n=h[r];d[b++]=n;if(s){if(n[f]==1){var x=false;if(t==null){t={};x=true}for(var v in n){if(x){t[v]=n[v]}else{t[v]+=n[v]}}}}}d.sort(function(A,i){if(A.SBGrid_KEY<i.SBGrid_KEY){return -1}else{if(A.SBGrid_KEY>i.SBGrid_KEY){return 1}else{return 0}}});if(s){t[g.groupColumnName]=g.totalName;t[g.groupLevelColumnName]=0;d.splice(0,0,t)}return d};function xPathOperation(strOperation,xnNode){var strCalculation=strOperation;strCalculation=strCalculation.replaceAll("&quot;",'"');var strReg=/(([a-z]|\d|\)|\'|\"|\s)\=([a-z]|\d|\/|\(|\'|\"|\s))/g;var alOperator=strCalculation.match(strReg);if(null!=alOperator){for(var i=0;i<alOperator.length;i++){var strOperatorTempData=alOperator[i];strOperatorTempData=strOperatorTempData.replace(/\=/g,"==");strCalculation=strCalculation.replaceAll(alOperator[i],strOperatorTempData)}}while(true){var rePattern=/(([a-z]+)\-([a-z]+)\-(([a-z]+)(\s+|))\(((([A-Za-z]|\d|\&\&|\|\||\%|\/|\+|\-||\=\=|\!\=|\*|\<|\<\=|\>|\>|\'|\"|\,|\.|\s)+)|)\))|(([a-z]+)\-(([a-z]+)(\s+|))\(((([A-Za-z]|\d|\&\&|\|\||\%|\/|\+|\-||\=\=|\!\=|\*|\<|\<\=|\>|\>|\'|\"|\,|\.|\s)+)|)\))|((([a-z]+)(\s+|))\(((([A-Za-z]|\d|\&\&|\|\||\%|\/|\+|\-||\=\=|\!\=|\*|\<|\<\=|\>|\>|\'|\"|\,|\.|\s)+)|)\))/g;var alFunctionResult=strCalculation.match(rePattern);if(null!=alFunctionResult){alFunctionResult=SBGrid.DEF.fextractDupArr(alFunctionResult);for(var i=0;i<alFunctionResult.length;i++){try{var strTransValue=alFunctionResult[i].replaceAll("-","_");if(-1!=strTransValue.indexOf("/")){var bXpathNodeFunctionExist=false;if(strTransValue.isRegular(/(avg|min|max|sum|position|last|count|text|node|namespace\_uri|local\_name|name)(\s+|)\(/g)){bXpathNodeFunctionExist=true}var strRefPattern=/(\.\.|(\/(\w+(\[\d\]|))))+/g;var alRefAddress=strTransValue.match(strRefPattern);if(null!=alRefAddress){alRefAddress=SBGrid.DEF.fextractDupArr(alRefAddress);for(var j=0;j<alRefAddress.length;j++){if(!bXpathNodeFunctionExist){if(null!=xnNode&&alRefAddress[j].isRegular(/\.\.\//g)){var strTempData=SBGrid.UT.XmlLib.getTextValue(xnNode.selectSingleNode(alRefAddress[j]))}else{var strTempData=SBGrid.DS.XMLStorage.getUniqueStorage().getValue(alRefAddress[j])}}else{var strTempData=alRefAddress[j]}if(!isFinite(strTempData)){strTempData='"'+strTempData+'"'}strTransValue=strTransValue.replaceAll(alRefAddress[j],strTempData)}}}var resultValue=window.eval("xPath_"+strTransValue.trim());strCalculation=strCalculation.replaceAll(alFunctionResult[i],String(resultValue))}catch(e){if(-1!=strOperation.indexOf("count(")){return"0"}else{return""}}}}else{break}}if(strCalculation.isRegular(/(\s|\))(and|or|mod|div)(\s|\()/g)){var alTransMathMark=strCalculation.match(/(\s|\))(and|or|mod|div)(\s|\()/g);alTransMathMark=SBGrid.DEF.fextractDupArr(alTransMathMark);for(var i=0;i<alTransMathMark.length;i++){strCalculation=strCalculation.replaceAll(alTransMathMark[i],alTransMathMark[i].replace(/and/g," && ").replace(/or/g," || ").replace(/mod/g," % ").replace(/div/g," / "))}}var bOperation=false;if(strCalculation.isRegular(/(\&\&)|(\|\|)|(\%)|(\/)|(\+)|(\-)|(\=\=)|(\!\=)|(\*)|(\<)|(\<\=)|(\>)|(\>\=)/g)){bOperation=true}rePattern=/(\.\.|(\/(\w+(\[\d\]|))))+/g;var alXpathResult=strCalculation.match(rePattern);if(null!=alXpathResult){alXpathResult=SBGrid.DEF.fextractDupArr(alXpathResult);for(var i=0;i<alXpathResult.length;i++){if(-1!=alXpathResult[i].indexOf("/")){if(null!=xnNode&&alXpathResult[i].isRegular(/\.\.\//g)){var resultValue=SBGrid.UT.XmlLib.getTextValue(xnNode.selectSingleNode(alXpathResult[i]))}else{var resultValue=SBGrid.DS.XMLStorage.getUniqueStorage().getValue(alXpathResult[i])}if(bOperation){if(resultValue.isEmpty()){strCalculation=strCalculation.replaceAll(alXpathResult[i],"0")}else{strCalculation=strCalculation.replaceAll(alXpathResult[i],resultValue)}}else{strCalculation=strCalculation.replaceAll(alXpathResult[i],resultValue)}}}}var reStringNumberPattern=/(\"|\')(\d+)(\"|\')/g;var alStringNumberResult=strCalculation.match(reStringNumberPattern);if(null!=alStringNumberResult){alStringNumberResult=SBGrid.DEF.fextractDupArr(alStringNumberResult);for(var j=0;j<alStringNumberResult.length;j++){strCalculation=strCalculation.replaceAll(alStringNumberResult[j],alStringNumberResult[j].replace(/\'|\"/g,""))}}if(bOperation){try{var strEnddingCalculate=window.eval(strCalculation);if(strCalculation.isRegular(/\&\&|\|\|/g)){if(Number(strEnddingCalculate)){return Number(strEnddingCalculate)?true:false}else{return strEnddingCalculate}}else{return strEnddingCalculate}}catch(e){if(-1!=strOperation.indexOf("count(")){return"0"}else{return""}}}else{return strCalculation}}function xPath_name(a){var b=a.split(/\//g);return String(b[b.length-1])}function xPath_local_name(a){var b=a.split(/\//g);return String(b[b.length-1])}function xPath_count(b){var a=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,b);return String(a.length)}function xPath_boolean(a){strTransString=xPath_string(a);if("0"!=strTransString&&"false"!=strTransString){return true}else{return false}}function xPath_not(a){if(a){return false}else{return true}}function xPath_true(){return true}function xPath_false(){return false}function xPath_string(a){if(a){var b=String(a);return b}return""}function xPath_string_length(a){if(a){a=xPath_string(a);return a.length}return 0}function xPath_concat(){var b="";for(var a=0;a<arguments.length;a++){b+=xPath_string(arguments[a])}return b}function xPath_starts_with(a,b){a=xPath_string(a);b=xPath_string(b);if(0==a.indexOf(b)){return true}else{return false}}function xPath_contains(a,b){a=xPath_string(a);b=xPath_string(b);if(-1!=a.indexOf(b)){return true}else{return false}}function xPath_substring(a,b,c){a=xPath_string(a);return a.substring(b-1,c)}function xPath_substring_before(b,a){b=xPath_string(b);strsecondData=xPath_string(strsecondData);var c=b.indexOf(a);return b.substring(0,c)}function xPath_substring_after(b,a){b=xPath_string(b);strsecondData=xPath_string(strsecondData);var c=b.indexOf(a);return b.substring(c+1,b.length)}function xPath_normalize_space(a){a=xPath_string(a);return a.trim()}function xPath_translate(b,a,c){b=xPath_string(b);strsecondData=xPath_string(strsecondData);c=xPath_string(c);return b.replaceAll(a,c)}function xPath_number(a){a=xPath_string(a);return Number(a)}function xPath_ceiling(a){return Math.ceil(xPath_number(a))}function xPath_floor(a){return Math.floor(xPath_number(a))}function xPath_round(a){return Math.round(xPath_number(a))}function xPath_avg(b){var c=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,b);var e=0;for(var a=0;a<c.length;a++){var d=SBGrid.UT.XmlLib.getTextValue(c.item(a));if(""!=d){if(isFinite(d)){e+=Number(d)}}}return String((e/alRefNode.length))}function xPath_min(b){var c=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,b);var e=0;for(var a=0;a<c.length;a++){var d=SBGrid.UT.XmlLib.getTextValue(c.item(a));if(""!=d){if(isFinite(d)){e=e<=Number(d)?e:Number(d)}}}return String(e)}function xPath_max(b){var c=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,b);var e=0;for(var a=0;a<c.length;a++){var d=SBGrid.UT.XmlLib.getTextValue(c.item(a));if(""!=d){if(isFinite(d)){e=e>=Number(d)?e:Number(d)}}}return String(e)}function xPath_sum(b){var c=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,b);var e=0;for(var a=0;a<c.length;a++){var d=SBGrid.UT.XmlLib.getTextValue(c.item(a));if(""!=d){if(isFinite(d)){e+=Number(d)}}}return String(e)}function xPath_days_from_date(a){if(a.isRegular(/[0-9][0-9][0-9][0-9]\-[0-9][0-9]\-[0-9][0-9]/g)){a=a.replace(/\-/g,"/");return String(Math.round(Math.abs(Date.parse(a)/1000/60/60/24)))}else{return""}}function xPath_seconds_from_datetime(a){if(a.isRegular(/[0-9][0-9][0-9][0-9]\-[0-9][0-9]\-[0-9][0-9]/g)){a=a.replace(/\-/g,"/");return String(Math.round(Math.abs(Date.parse(a)/1000)))}else{return""}}function xPath_seconds(a){}function xPath_months(a){}function xPath_luhn(b){b=xPath_string(b);if(12<=b.length&&19>=b.length){for(var a=0;a<b.length;a++){if(isNaN(b.substring(a,a+1))){return false}}return true}else{return false}}function xPath_if(c,b,a){if(c){return xPath_string(b)}else{return xPath_string(a)}}function xPath_boolean_from_string(a){strTransString=xPath_string(a);if("0"==strTransString||"false"==strTransString){return false}else{if("1"==strTransString||"true"==strTransString){return true}}return""}function xPath_power(a,b){strBase=xPath_string(a);strExponent=xPath_string(b);return Math.pow(Number(strBase),Number(strExponent))}function xPath_now(){var c=new Date();var f=c.getUTCFullYear();var g=c.getMonth();g=9>(g)?"0"+(g+1):(g+1);var b=c.getDate();b=10>(b)?"0"+(b):(b);var a=c.getHours();a=10>(a)?"0"+(a):(a);var d=c.getMinutes();d=10>(d)?"0"+(d):(d);var e=c.getSeconds();e=10>(e)?"0"+(e):(e);return f+"-"+g+"-"+b+"T"+a+":"+d+":"+e+"Z"}SBGrid.CT.ElementBase=function(b,d,c){if(!d){return}this.children=new SBGrid.DS.Collection();this.elementName=c;this.parent;this.id=d;this.tag=c;this.text;this.parentId=b;this.m_strLocalTag=c;var a=this.m_strLocalTag.indexOf(":");if(-1!=a){this.m_strLocalTag=this.m_strLocalTag.substr(a+1)}this.m_objElement=null;this.setParent(b);SBGrid.DEF.__appendAll(d,this)};SBGrid.CT.ElementBase.prototype.getElement=function(){if(this.m_objElement){this.m_objElement.setRefElement(this)}return this.m_objElement};SBGrid.CT.ElementBase.prototype.setElement=function(a){this.m_objElement=a};SBGrid.CT.ElementBase.prototype.getAttribute=function(a){return null};SBGrid.CT.ElementBase.prototype.setAttribute=function(a,b){return};SBGrid.CT.ElementBase.prototype.getId=function(){return this.getAttribute("id")};SBGrid.CT.ElementBase.prototype.getTag=function(){return this.tag};SBGrid.CT.ElementBase.prototype.getLocalTag=function(){return this.m_strLocalTag};SBGrid.CT.ElementBase.prototype.getParent=function(){return this.parent};SBGrid.CT.ElementBase.prototype.setParent=function(a){if(this instanceof SBGrid.CT.ElementBase){var b=document.SBHE_allElement.m_htCollection[a];this.parent=b;if(b instanceof SBGrid.CT.ElementBase){if(this instanceof SBGrid.DS.XMLStorage){if(b.children.exists(this.id)){return}}b.setChild(this.id,this)}}};SBGrid.CT.ElementBase.prototype.setChild=function(b,a){this.children.add(b,a)};SBGrid.CT.ElementBase.prototype.getElementName=function(){return this.elementName};SBGrid.CT.ElementBase.prototype.getText=function(){return this.text};SBGrid.CT.ElementBase.prototype.setText=function(a){this.text=a;this.attribute.text=a};SBGrid.CT.ElementBase.prototype.isChild=function(b){var a=document.SBHE_allElement.m_htCollection[b];if(!a){return false}return(this==a.parent)};SBGrid.CT.ElementBase.prototype.isDescendants=function(d,a){var c=document.SBHE_allElement.m_htCollection[d];if(!c){return false}var b;if(a){b=c}else{b=c.parent}while(b){if(this==b){return true}b=b.parent}return false};SBGrid.CT.Attribute=function(a,c,b){if(!c){return}SBGrid.CT.ElementBase.call(this,a,c,b);this.attribute={};this.m_initStyleList={};this.attribute.id=c;this.attribute.tag=b;this.m_htHoverStyle=null;this.m_htDownStyle=null;this.m_htFocusStyle=null;this.m_htDisableStyle=null;this.m_htSelectStyle=null};SBGrid.CT.Attribute.prototype=new SBGrid.CT.ElementBase;SBGrid.CT.Attribute.prototype.initStyle=function(a){if(null!=this.m_initStyleList[a]){SBGrid.UT.HtmlLib.setStyle(this.m_heCtrl,a,this.m_initStyleList[a]);this.attribute[a]=this.m_initStyleList[a]}else{SBGrid.UT.HtmlLib.setStyle(this.m_heCtrl,a,"");this.attribute[a]=""}};SBGrid.CT.Attribute.prototype.getAttribute=function(a){return this.attribute[a]};SBGrid.CT.Attribute.prototype.setAttribute=function(c,a){if(SBGrid.DEF.SB_STYLELIST[c]){SBGrid.UT.HtmlLib.setStyle(this.m_heCtrl,c,a)}else{if("style"==c){var e=a.split(";");for(var b=0;b<e.length-1;b++){var d=e[b].split(":");this.setAttribute(d[0].replace(" ",""),d[1].replace(" ",""))}return}}this.attribute[c]=a};SBGrid.CT.Attribute.prototype.applyDefaultStyle=function(){};SBGrid.CT.Attribute.prototype.setChildStyle=function(){};SBGrid.CT.Attribute.prototype.setNotObjToChildStyle=function(){if(!this.parent||!this.parent.m_heCtrl){return}if(!this.attribute["font-family"]){this.setAttribute("font-family",this.parent.m_heCtrl.style.fontFamily)}if(!this.attribute["font-size"]){this.setAttribute("font-size",this.parent.m_heCtrl.style.fontSize)}if(!this.attribute["font-weight"]){this.setAttribute("font-weight",this.parent.m_heCtrl.style.fontWeight)}if(!this.attribute["font-style"]){this.setAttribute("font-style",this.parent.m_heCtrl.style.fontStyle)}if(!this.attribute["text-decoration"]){this.setAttribute("text-decoration",this.parent.m_heCtrl.style.textDecoration)}if(!this.attribute.color){this.setAttribute("color",this.parent.m_heCtrl.style.color)}if(!this.attribute["line-height"]){this.setAttribute("line-height",this.parent.m_heCtrl.style.lineHeight)}if(!this.attribute["letter-spacing"]){this.setAttribute("line-height",this.parent.m_heCtrl.style.letterSpacing)}if(!this.attribute["background-repeat"]){this.setAttribute("line-height",this.parent.m_heCtrl.style.backgroundRepeat)}if(!this.attribute.cursor){this.setAttribute("line-height",this.parent.m_heCtrl.style.cursor)}};SBGrid.CT.Attribute.createAttribute=function(b,a){return b};SBGrid.CT.Attribute.prototype.checkDefaultStyle=function(a){if(this.m_heCtrl){for(var b in a){if(this.attribute[b]==undefined){this.attribute[b]=SBGrid.UT.HtmlLib.getStyle(this.m_heCtrl,b)}}}};SBGrid.CT.Attribute.prototype.checkDefaultAttributeStyle=function(a){if(this.m_heCtrl){if(this.attribute[a]==undefined){this.attribute[a]=SBGrid.UT.HtmlLib.getStyle(this.m_heCtrl,a)}}};SBGrid.CT.Attribute.prototype.setHoverStyle=function(a){this.checkDefaultStyle(a);this.m_htHoverStyle=a};SBGrid.CT.Attribute.prototype.getHoverAttribute=function(b){var a=null;if(null!=this.m_htHoverStyle){return this.m_htHoverStyle[b]}return a};SBGrid.CT.Attribute.prototype.setHoverAttribute=function(b,a){if(null==this.m_htHoverStyle){this.m_htHoverStyle={}}this.checkDefaultAttributeStyle(b);this.m_htHoverStyle[b]=a};SBGrid.CT.Attribute.prototype.setDownStyle=function(a){this.checkDefaultStyle(a);this.m_htDownStyle=a};SBGrid.CT.Attribute.prototype.getDownAttribute=function(b){var a=null;if(null!=this.m_htDownStyle){return this.m_htDownStyle[b]}return a};SBGrid.CT.Attribute.prototype.setDownAttribute=function(b,a){if(null==this.m_htDownStyle){this.m_htDownStyle={}}this.checkDefaultAttributeStyle(b);this.m_htDownStyle[b]=a};SBGrid.CT.Attribute.prototype.setFocusStyle=function(a){this.checkDefaultStyle(a);this.m_htFocusStyle=a};SBGrid.CT.Attribute.prototype.getFocusAttribute=function(b){var a=null;if(null!=this.m_htFocusStyle){return this.m_htFocusStyle[b]}return a};SBGrid.CT.Attribute.prototype.setFocusAttribute=function(b,a){if(null==this.m_htFocusStyle){this.m_htFocusStyle={}}this.checkDefaultAttributeStyle(b);this.m_htFocusStyle[b]=a};SBGrid.CT.Attribute.prototype.setDisableStyle=function(a){this.checkDefaultStyle(a);this.m_htDisableStyle=a};SBGrid.CT.Attribute.prototype.getDisableAttribute=function(b){var a=null;if(null!=this.m_htDisableStyle){return this.m_htDisableStyle[b]}return a};SBGrid.CT.Attribute.prototype.setDisableAttribute=function(b,a){if(null==this.m_htDisableStyle){this.m_htDisableStyle={}}this.checkDefaultAttributeStyle(b);this.m_htDisableStyle[b]=a};SBGrid.CT.Attribute.prototype.setSelectStyle=function(a){this.checkDefaultStyle(a);this.m_htSelectStyle=a};SBGrid.CT.Attribute.prototype.getSelectAttribute=function(b){var a=null;if(null!=this.m_htSelectStyle){return this.m_htSelectStyle[b]}return a};SBGrid.CT.Attribute.prototype.setSelectAttribute=function(b,a){if(null==this.m_htSelectStyle){this.m_htSelectStyle={}}this.checkDefaultAttributeStyle(b);this.m_htSelectStyle[b]=a};SBGrid.CT.Attribute.prototype.getSelectAttribute=function(a){if(null==this.m_htSelectStyle){return""}return this.m_htSelectStyle[a]};SBGrid.CT.Element=function(a,c,b){if(!c){return}SBGrid.CT.Attribute.call(this,a,c,b);this.m_hmEvent={};this.m_objRefElement=null};SBGrid.CT.Element.prototype=new SBGrid.CT.Attribute;SBGrid.CT.Element.prototype.init=function(){};SBGrid.CT.Element.prototype.getElement=function(){return this};SBGrid.CT.Element.prototype.getRefElement=function(){return this.m_objRefElement};SBGrid.CT.Element.prototype.setRefElement=function(a){this.m_objRefElement=a};SBGrid.CT.Element.prototype.isCSSValid=function(b){var a=false;if((null==this.attribute[b]||""==this.attribute[b])&&(null==SBGrid.UT.HtmlLib.getStyle(this.m_heCtrl,b)||""==SBGrid.UT.HtmlLib.getStyle(this.m_heCtrl,b))){a=true}return a};SBGrid.CT.Element.prototype.createChild=function(strElementName,strAttribute){strAttribute=strAttribute.trim();if(";"==strAttribute.charAt(strAttribute.length-1)){strAttribute=strAttribute.substring(0,strAttribute.length-1)}var arAttribute=strAttribute.split(";");var strStyle="";var clAttribute=new SBGrid.DS.Collection();var strAttributeName;var strAttributeValue;for(var i=0;i<arAttribute.length;i++){if(null!=arAttribute[i]&&""!=arAttribute[i]){var arAttributeUnit=arAttribute[i].split(":");if(3==arAttributeUnit.length){arAttributeUnit[1]=arAttributeUnit[1]+":"+arAttributeUnit[2];arAttributeUnit.splice(2,1)}else{if(2!=arAttributeUnit.length){continue}}strAttributeName=arAttributeUnit[0].trim();strAttributeValue=arAttributeUnit[1].trim();if(null!=strAttributeValue&&""!=strAttributeValue){if(SBGrid.DEF.SB_STYLELIST[strAttributeName]){strStyle+=strAttributeName+":"+strAttributeValue+";"}else{clAttribute.add(strAttributeName,strAttributeValue)}}}}if(this.m_clCSSName){var cObj=this.m_clCSSName.getCollection();for(var i in cObj){clAttribute.add(i,cObj[i])}cObj=null}var objChild;var strId=clAttribute.item("id");if(document.SBHE_allElement.m_htCollection[strId]){if(strElementName!="softbowl:selectitem"&&strElementName!="softbowl:calendar"){return document.SBHE_allElement.m_htCollection[strId]}}if(null==strId){if(null==this.m_nChildCount){this.m_nChildCount=1}clAttribute.add("id",this.id+"_children"+this.m_nChildCount);this.m_nChildCount++}if("softbowl:input"==strElementName){objChild=SBGrid.CT.Input.create(this.id,clAttribute,strStyle)}else{if("softbowl:inputbutton"==strElementName){objChild=SBGrid.CT.InputButton.create(this.id,clAttribute,strStyle)}else{if("softbowl:calendar"==strElementName){objChild=SBGrid.CT.Calendar.create(this.id,clAttribute,strStyle)}else{if("softbowl:caption"==strElementName){objChild=SBGrid.CT.Caption.create(this.id,clAttribute,strStyle)}else{if("softbowl:output"==strElementName){objChild=SBGrid.CT.Output.create(this.id,clAttribute,strStyle)}else{if("softbowl:secret"==strElementName){objChild=SBGrid.CT.Secret.create(this.id,clAttribute,strStyle)}else{if("softbowl:textarea"==strElementName){objChild=SBGrid.CT.TextArea.create(this.id,clAttribute,strStyle)}else{if("softbowl:button"==strElementName){objChild=SBGrid.CT.Button.create(this.id,clAttribute,strStyle)}else{if("softbowl:select"==strElementName){objChild=SBGrid.CT.Select.create(this.id,clAttribute,strStyle)}else{if("softbowl:select1"==strElementName){objChild=SBGrid.CT.Select1.create(this.id,clAttribute,strStyle)}else{if("softbowl:selectitem"==strElementName){objChild=SBGrid.CT.SelectItem.create(this.id,clAttribute,strStyle)}else{if("softbowl:comboinput"==strElementName){objChild=SBGrid.CT.Input.create(this.id,clAttribute,strStyle)}else{if("softbowl:combobutton"==strElementName){objChild=SBGrid.CT.Button.create(this.id,clAttribute,strStyle)}else{if("softbowl:img"==strElementName){objChild=SBGrid.CT.Img.create(this.id,clAttribute,strStyle)}else{if("softbowl:group"==strElementName){objChild=SBGrid.CT.Group.create(this.id,clAttribute,strStyle)}else{if("softbowl:datagrid"==strElementName){}else{if("softbowl:gridfixedcell"==strElementName){objChild=SBGrid.CT.GridFixedCell.create(this.id,clAttribute,strStyle)}else{if("softbowl:col"==strElementName){objChild=SBGrid.CT.GridCol.create(this.id,clAttribute,strStyle)}else{if("softbowl:gridinput"==strElementName){objChild=SBGrid.CT.GridInput.create(this.id,clAttribute,strStyle)}else{if("softbowl:gridtextarea"==strElementName){objChild=SBGrid.CT.GridTextarea.create(this.id,clAttribute,strStyle)}else{if("softbowl:choices"==strElementName){objChild=SBGrid.DS.Choices.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:itemset"==strElementName){objChild=SBGrid.DS.Itemset.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:label"==strElementName){objChild=SBGrid.DS.Label.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:value"==strElementName){objChild=SBGrid.DS.Value.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:depth"==strElementName){objChild=SBGrid.DS.Depth.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:image"==strElementName){objChild=SBGrid.CT.Image.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:selectedimage"==strElementName){objChild=SBGrid.CT.SelectedImage.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:expandedimage"==strElementName){objChild=SBGrid.CT.ExpandedImage.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:DIV"==strElementName){objChild=SBGrid.CT.DIV.create(this.id,clAttribute,strStyle);return objChild}else{return null}}}}}}}}}}}}}}}}}}}}}}}}}}}}}if(objChild){objChild.init();if(48<=objChild.id.charCodeAt(0)&&objChild.id.charCodeAt(0)<=57){SBGrid.DEF.errorMsg("동적 생성하려는 control 의 id 가 숫자로 시작됩니다. ["+objChild.id+"]")}else{if(-1==objChild.id.indexOf(".")){window.eval("try{window."+objChild.id+" = document.SBHE_allElement.item('"+objChild.id+"');}catch(e){}")}}}return objChild};SBGrid.CT.Element.prototype.removeChild=function(h){var l=this.children.item(h);if(!h||!l){return}var a=l.children;if(null!=a){var c=a.count();for(var d=0;d<c;d++){var g=a.item(0).id;l.removeChild(g)}}var m=l.m_heCtrl;if(m){var b=m.parentNode;if(b){if("IFRAME"==l.m_heCtrl.tagName){try{l.m_heCtrl.src=""}catch(f){}}b.removeChild(l.m_heCtrl)}}if(document.getElementById("SBHE_"+h+"_allitem")){document.getElementById("SBHE_"+h+"_allitem").parentNode.removeChild(document.getElementById("SBHE_"+h+"_allitem"));SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=false}this.children.remove(h);document.SBHE_allElement.remove(h)};SBGrid.CT.Element.prototype.getAbility=function(){return 0};SBGrid.CT.Element.prototype.isEnable=function(){return true};SBGrid.CT.Element.prototype.getAttribute=function(a){var b="";if(this.m_objRefElement){b=this.m_objRefElement.getAttribute(a)}if(null==b||""==b||-1<a.indexOf("align")||-1<a.indexOf("font")){b=SBGrid.CT.Attribute.prototype.getAttribute.call(this,a);if(null==b){b=""}}return b};SBGrid.CT.Element.prototype.setAttribute=function(b,a){SBGrid.CT.Attribute.prototype.setAttribute.call(this,b,a)};SBGrid.CT.Element.prototype.setText=function(a){SBGrid.CT.ElementBase.prototype.setText.call(this,a);this.attribute.text=a};SBGrid.CT.Element.prototype.dispatch=function(o,d,f,n){if(!SBGrid.DEF.bSBUx&&o.indexOf("SBUx")>=0){return}var c=SBGrid.DEF._W_getCurrentEvent();var g=c.name;var m=c.target;var e=c.currentTarget;var a=c.description;var h=c.propagate;var l=c.defaultAction;c.name=o;c.target=this.getId();c.currentTarget=c.target;if(null!=d){c.description=d}if(null!=f){c.propagate=f}if(null!=n){c.defaultAction=n}if(SBGrid.DEF.is_smartphone&&"onclick"==o){if(SBGrid.DEF.isSmartPhoneDblClick(this.getId())){SBGrid.DEF.removePrevClickInfo();this.dispatch("ondblclick");return}else{var b=new Date();SBGrid.DEF.setPrevClickInfo(this.getId(),b.getTime())}}c.m_nRef++;if(c.m_nRef>32){c.m_nRef--;return}if(""!=c.capture){var i=document.SBHE_allElement.m_htCollection[c.capture];if(null!=i&&SBGrid.DEF.SBEA_HSB_AS_EVENT&i.getAbility()){if("cancel"!=c.defaultAction){i.onCapture(c)}}}this.internalDispatch(o);c.name=g;c.target=m;c.currentTarget=e;c.description=a;c.propagate=h;c.defaultAction=l;c.m_nRef--};SBGrid.CT.Element.prototype.addEventListener=function(i,b,a,f,h,e,d){var g=new SBGrid.EVT();g.name=i;g.handler=b;g.propagate=a;g.defaultAction=f;var c=this.m_hmEvent[i];if(c){if(-1==c[0].handler.indexOf("_model")){return}else{if(1<c.length){return}}c.push(g)}else{c=new Array();c.push(g);this.m_hmEvent[i]=c}};SBGrid.CT.Element.prototype.eventAddAttribute=function(b,a){b.handler=a.handler;b.propagate=a.propagate;b.defaultAction=a.defaultAction;return b};SBGrid.CT.Element.prototype.internalDispatch=function(f){var d=SBGrid.DEF._W_getCurrentEvent();d.name=f;d.currentTarget=this.getId();d.propagate="";d.defaultAction="";this.preTranslateEvent(d);if(SBGrid.DEF.bSBUx){var e="";if(d.name){e=d.name;e=e.replaceAll("-","_")}if(!("stop"==d.propagate)){this.fireEvent(e,d)}}var c=this.m_hmEvent[f];if(c&&"stop"!=d.propagate){for(var b=0;b<c.length;b++){var a=c[b];this.runAction(this.eventAddAttribute(d,a))}}if("cancel"!=d.defaultAction){this.defaultAction(f,d)}if("stop"!=d.propagate){this.bubbles(f,d)}else{this.m_bStopPropagation=true}d.handler="";d.description="";d.propagate="";d.defaultAction=""};SBGrid.CT.Element.prototype.preTranslateEvent=function(a){};SBGrid.CT.Element.prototype.runAction=function(event){if(""!=event.handler){var strFunction="if (window."+event.handler+"){"+event.handler+"(event);}";eval(strFunction)}if(null!=this.getAttribute(event.name)){eval(this.getAttribute(event.name))}};SBGrid.CT.Element.getSelector=function(c,d,b){var a=c.split(".");if(1==a.length){return c}if(2==a.length){return a[0]}};SBGrid.CT.Element.createClassName=function(g,m){var o="";var n=SBGrid.DEF.cssName.split(";");var l="";if("select1"==m){if(g.exists("appearance")){var c=g.item("appearance");if("full"==c){l="radio"}else{if("minimal"==c){l="combo"}}}}else{if("select"==m){if(g.exists("appearance")){var c=g.item("appearance");if("full"==c){l="checkbox"}else{if("compact"==c){l="listbox"}}}}else{if("treeview"==m){l="treeitem"}else{if("input"==m){l="inputbutton"}}}}for(var e=0;e<n.length;e++){var h=n[e];if(""==h){continue}var d=h.split(":");var b=d[0].split("_");var f=b[0];var a=b[1];if(-1!=f.indexOf(".")){f=SBGrid.CT.Element.getSelector(f,m,g)}if("class"==f){if(m==a){if(g.exists("class")&&""!=g.item("class")){g.add("class",g.item("class")+" "+d[1])}else{g.add("class",d[1])}}else{if(l==a){if(g.exists("class")&&""!=g.item("class")){g.add("class",g.item("class")+" "+d[1])}else{g.add("class",d[1])}}}}else{if(m==f){g.add(d[0],d[1])}else{if(""!=l){if(l==f||l==f){g.add(d[0],d[1])}}}}}return g};SBGrid.CT.Element.prototype.bubbles=function(c,b){var a=this.parent;if(null!=a&&a instanceof SBGrid.CT.Element&&(a.getAbility()&SBGrid.DEF.SBEA_HSB_AS_EVENT)){a.internalDispatch(c,b)}};SBGrid.CT.Element.prototype.onCapture=function(){};SBGrid.CT.Element.createAttribute=function(b,a){b=SBGrid.CT.Attribute.createAttribute(b,a);return b};SBGrid.CT.Element.createParentDiv=function(b){var c=document.getElementById(b);if(!c){return}if(c.tagName=="BODY"){SBGrid.CT.DataGrid.initEngine(b,null)}else{if(c.tagName=="DIV"){var a="body";if(document.body.id!=null&&document.body.id!=""){a=document.body.id}else{document.body.id=a}SBGrid.CT.DataGrid.initEngine(a,null);SBGrid.DS.SBBody.createChild("softbowl:DIV","id:"+b)}}};SBGrid.DS.XMLStorage=function(a,d,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b);this.attribute.autocdata=d=false;this.autocdata;this.instances=new SBGrid.DS.Collection();this.property={};this.propertyReg;this.registry;this.m_objTabIndex=new Array();this.m_objHttpClient=new SBGrid.UT.HttpClient();this.m_objCurrentSubmission;this.m_bDoneUnload=false;this.m_hmInstanceData=null;this.m_bHasUploadFile=false;this.m_strSessionId="";this.m_resetRoot=null;if(SBGrid.DS.XMLStorage.isEmptyUniqueStorage()){SBGrid.DS.XMLStorage.setUniqueStorage(this)}};SBGrid.DS.XMLStorage.prototype=new SBGrid.CT.Element;SBGrid.DS.XMLStorage.m_UniqueStorage=null;SBGrid.DS.XMLStorage.isEmptyUniqueStorage=function(){return SBGrid.DS.XMLStorage.m_UniqueStorage==null};SBGrid.DS.XMLStorage.getUniqueStorage=function(){if(SBGrid.DS.XMLStorage.isEmptyUniqueStorage()){var a="body";if(document.body.id!=null&&document.body.id!=""){a=document.body.id}else{document.body.id=a}SBGrid.CT.DataGrid.initEngine(a,"");if(SBGrid.DS.XMLStorage.isEmptyUniqueStorage()){new SBGrid.DS.XMLStorage("head",false,"model1","softbowl:model");new SBGrid.DS.Instance("model1","instance1",false,"softbowl:instance","","","<root></root>")}}return SBGrid.DS.XMLStorage.m_UniqueStorage};SBGrid.DS.XMLStorage.setUniqueStorage=function(a){SBGrid.DS.XMLStorage.m_UniqueStorage=a};SBGrid.DS.XMLStorage.prototype.getId=function(){return this.id};SBGrid.DS.XMLStorage.prototype.alert=function(c,a,b){if(b){if(32|4==b){return true==confirm(c)?6:7}}else{window.alert(c)}return 1};SBGrid.DS.XMLStorage.prototype.copyNode=function(c,e){var a=null;if("string"==typeof(c)){a=this.getInstanceSinglePart(null,c)}else{a=c}var g=null;if("string"==typeof(e)){g=this.getInstanceSinglePart(null,e)}else{g=e}if(null!=a&&null!=g){var f=a.childNodes;if(null!=f){for(var b=f.length-1;b>=0;b--){var d=f[b];if(null!=d){a.removeChild(f[b])}}}f=g.childNodes;if(null!=f){for(var b=0;b<f.length;b++){var d=f[b];if(null!=d){a.appendChild(d.cloneNode(true))}}}}};SBGrid.DS.XMLStorage.prototype.destroy=function(b){var c=null;if("string"==typeof(b)){c=this.getInstanceSinglePart(null,b)}else{c=b}if(null!=c){var a=c.parentNode;if(null!=a){a.removeChild(c)}}};SBGrid.DS.XMLStorage.prototype.duplicate=function(c,d,g){var f=null;if("string"==typeof(c)){f=this.getInstanceSinglePart(null,c)}else{f=c}var b=null;if("string"==typeof(d)){b=this.getInstanceSinglePart(null,d)}else{b=d}if(null!=f&&null!=b){var e=b.cloneNode(true);if(null==g||g.isEmpty()){f.appendChild(e)}else{var a=SBGrid.UT.XmlLib.selectSingleNode(f,g);if(null!=f){f.insertBefore(e,a)}}}};SBGrid.DS.XMLStorage.prototype.getValue=function(b){if("string"==typeof(b)){var c=this.getInstance();if(null!=c){var a=c.documentElement;if(null!=a){var d=SBGrid.UT.XmlLib.selectSingleNode(a,b);if(null!=d){return SBGrid.UT.XmlLib.getTextValue(d)}}}return""}else{return SBGrid.UT.XmlLib.getTextValue(b)}};SBGrid.DS.XMLStorage.prototype.getXPathValue=function(b){if(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11){return xPathOperation(b)}else{var a=SBGrid.DS.XMLStorage.getUniqueStorage().getInstance().documentElement.evaluate(b,instance1.documentElement,null,XPathResult.STRING_TYPE,null);return a.stringValue}};SBGrid.DS.XMLStorage.prototype.makeNodeSearch=function(i,n,a){if(null==i||""==i){return false}var m=this.getInstanceDocument();if(!m){return null}var d=m.selectSingleNode(i);if(d){if(null!=i&&""!=i&&null!=n){if(a){SBGrid.UT.XmlLib.createCDATASection(d,n)}else{SBGrid.UT.XmlLib.setTextValue(d,n)}}return null}else{var c=i.lastIndexOf("/");var h=i.substring(c+1,i.length);var g="";if(-1==c){g="/root"}else{g=i.substring(0,c)}var e=null;var o=h.indexOf("[");if(-1!=o){var b=o+1;var p=h.indexOf("]");e=h.substring(b,p);if(isFinite(e)){e=parseInt(e);h=h.substr(0,o)}}var f=m.createElement(h);if(null!=i&&""!=i){if(null!=n){if(a){SBGrid.UT.XmlLib.createCDATASection(f,n)}else{SBGrid.UT.XmlLib.setTextValue(f,n)}}}var l=m.selectSingleNode(g);if(l){l.appendChild(f);return f}else{return this.makeNodeSearch(g).appendChild(f)}}};SBGrid.DS.XMLStorage.prototype.makeNode=function(g){if(null==g||""==g){return false}g=g.trim();var e="";var l=false;if(0==g.indexOf("instance('")){e=g.substr("instance('".length);var a=e.indexOf("'");if(0>a){return false}e=e.substring(a+1);l=true}var h=this.getInstanceDocument();if(!h){return false}var c=h.firstChild;var d=c.childNodes;var f;var b;var m;var i=g;if(!l){if(-1!=a){this.makeNodeSearch(g)}}return true};SBGrid.DS.XMLStorage.prototype.searchNode=function(g,f){var c=null;if(!g){return null}if(-1!=f.indexOf("[")){var h=f.indexOf("[");var a=f.indexOf("]");if(isFinite(f.substring(h+1,a))){c=Number(f.substring(h+1,a));f=f.substr(0,h)}}var e=0;for(var b=0;b<g.length;b++){var d=g.item(b);if(null!=d&&f==d.nodeName){e++;if(null==c){return d}else{if(e==c){return d}}}}return null};SBGrid.DS.XMLStorage.prototype.makeValue=function(i,m,a){if(null==i||""==i){return false}i=i.trim();var f="";var o=false;var h=this.getInstance();if(0==i.indexOf("instance('")){f=i.substr("instance('".length);var b=f.indexOf("'");if(0>b){return false}f=f.substring(b+1);o=true}var l=this.getInstanceDocument();if(!l){return false}var d=l.firstChild;var e=d.childNodes;var g;var c;var p;var n=i;if(!o){if(-1!=b){this.makeNodeSearch(i,m,a)}}};SBGrid.DS.XMLStorage.prototype.propertynames=function(d){var b="";if(null==d){d=""}var c=0;for(var a in this.property){b+=(a+d);c++}if(0<c){b=b.substr(0,b.length-d.length)}return b};SBGrid.DS.XMLStorage.prototype.refreshCurrentModel=function(a){if(null==a){a=true}if(a){this.dispatch("SBUx_recalculate");this.dispatch("SBUx_refresh")}else{this.refresh()}};SBGrid.DS.XMLStorage.prototype.recalculate=function(){var b=this.children.getCollection();for(var a in b){var c=b[a];if(c instanceof SBGrid.CT.Bind){c.bindExecute()}}b=null};SBGrid.DS.XMLStorage.prototype.refresh=function(){var d=this.children.getCollection();for(var c in d){var a=d[c];if(null!=a){if(a.refresh){a.refresh()}}}d=null;var b=SBGrid.DS.SBBody;if(null==b){b=document.SBHE_allElement("body")}if(null!=b){b.refresh()}};SBGrid.DS.XMLStorage.prototype.refreshpart=function(){var a=this.instances.item("instance1");if(null!=a){if(0<arguments.length){var e=arguments[0];var c=document.SBHE_controls.getCollection();for(var b in c){var d=c[b];if(0==d.getAttribute("ref").indexOf(e)||0==d.getAttribute("nodeset").indexOf(e)){d.refresh()}}c=null}}};SBGrid.DS.XMLStorage.prototype.removenode=function(a){this.removeNode(a)};SBGrid.DS.XMLStorage.prototype.removeNode=function(a){var d=this.getInstanceDocument();if(null!=d){var b=SBGrid.UT.XmlLib.selectSingleNode(d,a);if(null!=b){var c=b.parentNode;if(null!=c){c.removeChild(b)}}}};SBGrid.DS.XMLStorage.prototype.selectSingleNode=function(a){var c=this.getInstanceDocument();var b=null;if(null!=c){b=SBGrid.UT.XmlLib.selectSingleNode(c,a)}return b};SBGrid.DS.XMLStorage.prototype.selectNodes=function(b){var c=this.getInstanceDocument();var a=null;if(null!=c){a=SBGrid.UT.XmlLib.selectNodes(c,b)}return a};SBGrid.DS.XMLStorage.prototype.removeNodeset=function(a){var f=this.getInstanceDocument();if(null!=f){var c=SBGrid.UT.XmlLib.selectNodes(f,a);for(var b=0;b<c.length;b++){var d=c.item(b);if(null!=d){var e=d.parentNode;if(null!=e){e.removeChild(d)}}}}};SBGrid.DS.XMLStorage.prototype.resetInstanceNode=function(a){if(null==a||""==a){return}var f=this.getInstanceDocument();if(null!=f){var e;var g;var c=SBGrid.UT.XmlLib.selectNodes(f,a);for(var b=0;b<c.length;b++){var d=c.item(b);if(null!=d){if(0==b){SBGrid.CF.xnTextNodeDelete(d)}else{e=d.parentNode;if(null!=e){e.removeChild(d)}}}}}};SBGrid.DS.XMLStorage.prototype.getAttribute=function(a){switch(a){case"id":break;default:return"";break}};SBGrid.DS.XMLStorage.prototype.setAttribute=function(b,a){SBGrid.CT.Element.prototype.setAttribute.call(this,b,a)};SBGrid.DS.XMLStorage.prototype.makeLightGridObject=function(strResult,strLightgridId){var strHeader;var strColDefine;var strLightGridData;var arTemp;var arLightGridRowData=new Array();var arLightGridColData;var arCellData;var objLigthGrid;var objRowData;var strLightGridRowData;var nDataColIdx=0;try{arTemp=strResult.split("|");strHeader=arTemp[0];strColDefine=arTemp[1];objLightGrid=document.SBHE_controls.item(strLightgridId);if(objLightGrid.m_bRowHeader){nDataColIdx=1}if(arTemp.length>2){for(var i=2;i<arTemp.length-1;i++){arLightGridColData=arTemp[i].split("^");for(var j=0;j<objLightGrid.m_arColumn.length-nDataColIdx;j++){if(j<arLightGridColData.length){arCellData=arLightGridColData[j].split("!")}else{arCellData=["",""]}arCellData[0]=arCellData[0].replaceAll('"','\\"').replaceAll("\r","\\\r").replaceAll("\n","\\\n");if(j==0){strLightGridRowData=objLightGrid.m_arColumn[j+nDataColIdx].attribute.ref+':"'+arCellData[0]+'"'}else{strLightGridRowData=strLightGridRowData+","+objLightGrid.m_arColumn[j+nDataColIdx].attribute.ref+':"'+arCellData[0]+'"'}}strLightGridRowData="{"+strLightGridRowData+"}";eval("objRowData = "+strLightGridRowData+";");arLightGridRowData.push(objRowData)}eval(strLightgridId+"_delimeterData = arLightGridRowData;");objLightGrid.refreshForHasInstance()}}catch(e){throw new Error("LightGrid Data Make Error")}};SBGrid.DS.XMLStorage.prototype.setValue=function(b,f,d){if(null==d||""==d){d=false}var c=this.getInstance();if(null!=c){var a=c.documentElement;if(null!=a){if(typeof(b)!="string"){SBGrid.UT.XmlLib.setTextValue(b,f,d);c.synchronize()}else{var e=SBGrid.UT.XmlLib.selectSingleNode(a,b);if(null!=e){SBGrid.UT.XmlLib.setTextValue(e,f,d);c.synchronize()}}}}};SBGrid.DS.XMLStorage.prototype.setXPathValue=function(a,b){this.setValue(a,xPathOperation(b))};SBGrid.DS.XMLStorage.prototype.urlencode=function(b,a){return SBGrid.UT.URIEncoder.encode(b,a)};SBGrid.DS.XMLStorage.prototype.isProcessAutoCdata=function(a){a=a+"";if(a.indexOf("&")>0||a.indexOf("<")>0||a.indexOf(">")>0||a.indexOf("'")>0||a.indexOf('"')>0){return true}return false};SBGrid.DS.XMLStorage.prototype.getInstancePart=function(c,b){var a=this.getInstanceDocument(c);return SBGrid.UT.XmlLib.selectNodes(a,b)};SBGrid.DS.XMLStorage.prototype.getInstanceSinglePart=function(c,b){var a=this.getInstanceDocument(c);if(null!=a){var d=SBGrid.UT.XmlLib.selectSingleNode(a,b);return d}return null};SBGrid.DS.XMLStorage.prototype.getInstance=function(d){var c=null;if(0!=this.instances.count()){if(null==d||""==d){var b=this.instances.getCollection();for(var a in b){c=b[a];if(null!=c){break}}b=null}else{c=this.instances.item(d)}}return c};SBGrid.DS.XMLStorage.prototype.getInstanceDocument=function(b){var c=null;var a=this.getInstance(b);if(null!=a){c=a.documentElement}return c};SBGrid.DS.XMLStorage.prototype.initChildren=function(){var b=this.children.getCollection();for(var a in b){var c=b[a];if(null!=c&&c.init){c.init()}}b=null;SBGrid.DEF.__initControls()};SBGrid.DS.XMLStorage.prototype.getTabIndex=function(){return this.m_objTabIndex};SBGrid.DS.XMLStorage.prototype.initTabIndex=function(){for(var a=0;a<this.m_objTabIndex.length;a++){if(this.m_objTabIndex[a]&&this.m_objTabIndex[a].m_heCtrl){this.m_objTabIndex[a].m_TabIndex=a;this.m_objTabIndex[a].m_heCtrl.tabIndex=a+1}}};SBGrid.DS.XMLStorage.prototype.replaceTabIndex=function(c,b,a){if(null!=c){this.removeTabIndex(c)}this.addTabIndex(b,a);this.initTabIndex()};SBGrid.DS.XMLStorage.prototype.removeTabIndex=function(a){this.m_objTabIndex.splice(a,1)};SBGrid.DS.XMLStorage.prototype.addTabIndex=function(c,a){if(-1!=c){if(0==this.m_objTabIndex.length){this.m_objTabIndex.push(a);return}for(var b=0;b<this.m_objTabIndex.length;b++){if(c<this.m_objTabIndex[b].navIndex){this.m_objTabIndex.splice(b,0,a);return}}this.m_objTabIndex.push(a)}};SBGrid.DS.XMLStorage.prototype._synchronizeInstances=function(){var c=this.instances.getCollection();for(var b in c){var a=c[b];if(null!=a){a.synchronize()}}c=null};SBGrid.DS.XMLStorage.prototype.setParentData=function(h,b){if(!h){return}else{if(SBGrid.DEF.Sbgrid_Node.DOCUMENT_NODE==h.nodeType){h=h.firstChild}}var l=this.getInstanceDocument();if(null!=l){var a=SBGrid.UT.XmlLib.selectSingleNode(l,b);if(a&&h){var e=a.childNodes;if(e){var g=e.length;for(var c=0;c<g;c++){a.removeChild(a.lastChild)}}var f=h.childNodes;if(f){for(var c=0;c<f.length;c++){var d=f[c];a.appendChild(d.cloneNode(true))}this._synchronizeInstances()}}}};SBGrid.DS.XMLStorage.prototype.cloneInstances=function(){if(0!=this.instances.count()){var c=this.instances.getCollection();for(var b in c){var a=c[b];if(null!=a){a.cloneInstances()}}c=null}};SBGrid.DS.XMLStorage.prototype.defaultAction=function(b,a){switch(b){case"SBUx_recalculate":this.recalculate();break;case"SBUx_refresh":this.refresh();break}};SBGrid.DS.XMLStorage.appendInstance=function(f,d,b){var h=document.SBHE_allElement.m_htCollection[b];if(!h){h=model}if(h.instances.exists(f)){var a=h.instances.item(f);if(null!=a){var g=d.root.childNodes;for(var c=0;c<g.length;c++){var e=g[c];SBGrid.UT.XmlLib.importChildNode(a.root,e,true)}}}else{h.instances.add(f,d)}};SBGrid.DS.XMLStorage.prototype.loadXML=function(b){var a=this.getInstance();if(null!=a){a.loadXML(b)}};SBGrid.DS.XMLStorage.onload=function(){if(SBGrid.DEF.m_nSync_Iviewer==SBGrid.DEF.m_nLoading_Count){SBGrid.DS.XMLStorage.m_model_play();SBGrid.DEF.m_nSync_Iviewer=false}else{if(false!=SBGrid.DEF.m_nSync_Iviewer){SBGrid.DEF.m_nLoading_Count++}}};SBGrid.DEF.loadScript=function(b,c){var a=document.createElement("script");a.type="text/javascript";if(a.readyState){a.onreadystatechange=function(){if(a.readyState=="loaded"||a.readyState=="complete"){a.onreadystatechange=null;c()}}}else{a.onload=function(){c()}}a.src=b;document.getElementsByTagName("head")[0].appendChild(a)};SBGrid.DS.XMLStorage.arSyncJS=new Array();SBGrid.DS.XMLStorage.m_model_play=function(){if(0!=SBGrid.DS.XMLStorage.arSyncJS.length){var strScript="";for(var i=0;i<SBGrid.DS.XMLStorage.arSyncJS.length;i++){strScript+="SBGrid.DEF.loadScript('"+SBGrid.DS.XMLStorage.arSyncJS[i]+"', function(){"}strScript+="SBGrid.DS.XMLStorage.m_model_event();";for(var i=0;i<SBGrid.DS.XMLStorage.arSyncJS.length;i++){strScript+="});"}window.eval(strScript)}else{SBGrid.DS.XMLStorage.m_model_event()}};SBGrid.DS.XMLStorage.m_model_event=function(){SBGrid.DEF.m_arGlobalEventFireList=SBGrid.DEF.makeGlobalEventFireList();if(window.SBUx_model_construct||window.SBUx_model_construct_model||null!=SBGrid.DS.XMLStorage.getUniqueStorage().attribute.SBUx_model_construct||(typeof SBGrid.DS.XMLStorage.getUniqueStorage().m_hmEvent!="undefined"&&SBGrid.DS.XMLStorage.getUniqueStorage().m_hmEvent.SBUx_model_construct!=null)){var d=SBGrid.DEF._W_getCurrentEvent();var e=d.name;var g=d.target;var b=d.currentTarget;var a=d.description;var c=d.propagate;var f=d.defaultAction;SBGrid.DS.XMLStorage.getUniqueStorage().dispatch("SBUx_model_construct");d.name=e;d.target=g;d.currentTarget=b;d.description=a;d.propagate=c;d.defaultAction=f}if(window.SBUx_model_construct_done||window.SBUx_model_construct_done_model||null!=SBGrid.DS.XMLStorage.getUniqueStorage().attribute.SBUx_model_construct_done||(typeof SBGrid.DS.XMLStorage.getUniqueStorage().m_hmEvent!="undefined"&&SBGrid.DS.XMLStorage.getUniqueStorage().m_hmEvent.SBUx_model_construct_done!=null)){var d=SBGrid.DEF._W_getCurrentEvent();var e=d.name;var g=d.target;var b=d.currentTarget;var a=d.description;var c=d.propagate;var f=d.defaultAction;SBGrid.DS.XMLStorage.getUniqueStorage().dispatch("SBUx_model_construct_done");d.name=e;d.target=g;d.currentTarget=b;d.description=a;d.propagate=c;d.defaultAction=f}window.m_bReady=true;if(window.SBUx_ready||window.SBUx_ready_model||null!=SBGrid.DS.XMLStorage.getUniqueStorage().attribute.SBUx_ready||(typeof SBGrid.DS.XMLStorage.getUniqueStorage().m_hmEvent!="undefined"&&SBGrid.DS.XMLStorage.getUniqueStorage().m_hmEvent.SBUx_ready!=null)){var d=SBGrid.DEF._W_getCurrentEvent();var e=d.name;var g=d.target;var b=d.currentTarget;var a=d.description;var c=d.propagate;var f=d.defaultAction;SBGrid.DS.XMLStorage.getUniqueStorage().dispatch("SBUx_ready");d.name=e;d.target=g;d.currentTarget=b;d.description=a;d.propagate=c;d.defaultAction=f}};SBGrid.DS.XMLStorage.prototype.send=function(f,l,E,x,w){var c=new Date();var K=c.getTime();var A=this.children.item(f);if(null!=A&&A instanceof SBGrid.CT.Submission){if(null==l){l=true}if(null==E){E=false}if(null==x){x=false}if(null!=w){A.m_objEndFunction=w}if(x){A.m_refresh=l}var a=A.attribute.action;var y=A.attribute.add;var I=A.attribute.encoding;var g=A.attribute.mediatype;var u=A.attribute.method;var o=A.attribute.ref;var h=A.attribute.replace;var F=A.attribute.resultref;var b=false;var r="";if("/"==F.charAt(F.length-1)){F=F.substring(0,F.length-1);b=true}for(var C=0;C<SBGrid.DEF.m_arLightgrid.length;C++){if(SBGrid.DEF.m_arLightgrid[C].nodeset==F){r=SBGrid.DEF.m_arLightgrid[C].id}}var z=A.attribute.type;var s;var d;if("application/x-www-form-urlencoded"==g){s=this._getPostDataAll(o,true,z,I,g)}else{if("multipart/form-data"==g){this.m_hmInstanceData={};this.m_bHasUploadFile=false;s=this._getPostDataAll(o,false,z,I,g);d="KKPK"+String(new Date().getTime());var B="--"+d+"\r\n";var H="--"+d+"--\r\n";var n=["\r\n"];for(var J in this.m_hmInstanceData){var G=this.m_hmInstanceData[J];if(undefined!=G){n.push('Content-Disposition: form-data; name="'+J+'"\r\n\r\n'+G+"\r\n")}}if(this.m_bHasUploadFile){var q=window.getHostURL();if(0!=a.indexOf(q)&&0!=a.indexOf("http://")&&0!=a.indexOf("HTTP://")){a=q+a}n.push('Content-Disposition: form-data; name="__TF_Action"\r\n\r\n'+a+"\r\n");n.push('Content-Disposition: form-data; name="__TF_Boundary"\r\n\r\n'+d+"\r\n");A.attribute.action=a;a=__getAppName()+"FileAttach.tfs"}s=n.join(B)+H}else{if("application/xml"==g||"text/xml"==g||"application/json"==g){s=this._getPostDataXmlAll(o)}}}if("custom"==z&&"post"==A.attribute.method){var t=s;try{s=onbeforesend(t,A);if(this.m_bHasUploadFile){var p=A.attribute.action.split("?")[1];if(null!=p){a+="?"+p}}else{a=A.attribute.action}s=null==s?t:s}catch(m){s=t}}var D;if("get"==u){D=A.m_objHttpClient.get(a+"?"+s,x,g,I)}else{if("post"==u){D=A.m_objHttpClient.post(a,s,x,g,I,false)}else{if("form-data-post"==u){D=A.m_objHttpClient.post(a,s,x,g,I,true,d)}}}var v=null;if(null==D){D=""}D=D.trim();if("custom"==z&&"post"==A.attribute.method){var e=D;try{D=onaftersend(e);D=null==D?e:D}catch(m){D=e}}v=SBGrid.UT.XmlLib.loadXMLFromString(D);if(null!=v){if((null==v.firstChild&&r!="")||(null!=v.firstChild&&"root"!=v.firstChild.nodeName&&"xml"!=v.firstChild.nodeName)){this.makeLightGridObject(D,r)}else{this.updateData(SBGrid.UT.XmlLib.getRootElementNode(v),F,y,h,b);if(l){SBGrid.DS.XMLStorage.getUniqueStorage().refreshCurrentModel()}}}this.setResultKM(v,A.m_objHttpClient);if(window.SBUx_submit_done){window.SBUx_submit_done()}if(x){return null}else{return A.m_objHttpClient.status()}}};SBGrid.DS.XMLStorage.prototype.setResultKM=function(e,d){if(null!=e){if("200"==d.status(0)){for(var b=0;b<e.getElementsByTagName("resultKM").length;b++){var f=e.getElementsByTagName("resultKM").item(b);var c=new Collection();for(var a=0;a<f.attrs.length;a++){var g=f.attrs.item(a);c.add(g.name,g.value)}if("alert"==c.item("type")){alert(c.item("description"))}else{this.dispatch("onerror")}if("true"==c.item("clear")){}}}}};SBGrid.DS.XMLStorage.prototype._getPostDataXmlAll=function(d){var f="";if(null!=d&&!d.isEmpty()){var a=d.split(",");for(var c=0;c<a.length;c++){var b=a[c];if(null!=b&&!b.isEmpty()){b=b.trim();var e=this.getInstanceSinglePart(null,b);if(null!=e){f+=SBGrid.UT.XmlLib.serializeToString(e)}}}}return f};SBGrid.DS.XMLStorage.prototype._getPostDataAll=function(f,c,b,m,e){var l="";if(null!=f&&""!=f){var a=f.split(",");for(var d=0;d<a.length;d++){var g=a[d];if(null!=g&&""!=g){g=g.trim()}var h=this._getPostData(g,c,b,m,e);if("error"==h){return h}l+=h}}return l};SBGrid.DS.XMLStorage.prototype._getPostData=function(f,b,a,m,e){var l="";if(null!=f&&""!=f){var g=this.getInstanceDocument();if("/"==f||"."==f){this._getPostDataNode(g,b,a,m,e)}else{var c=SBGrid.UT.XmlLib.selectNodes(g,f);for(var d=0;d<c.length;d++){var h=c.item(d);l+=this._getPostDataNode(h,b,a,m,e)}}}return l};SBGrid.DS.XMLStorage.prototype._getPostDataNode=function(m,c,n,u,d){var h="";if(!SBGrid.UT.XmlLib.hasChildNodesExceptText(m)){var l;var s;var o=m.nodeType;if(SBGrid.DEF.Sbgrid_Node.ELEMENT_NODE==o){l=m.nodeName;s=SBGrid.UT.XmlLib.getTextValue(m);if(!c){var r=SBGrid.CT.Document.getBindControlsByNode(m);var t;for(var p=0;p<r.length;p++){t=r[p];var v=t.attribute.tag;if("softbowl:file"==v){var f=s.split("?");var a="";for(var p=0;p<f.length;p++){var g=f[p].split("|");if(a!=""){a+="?"}a+=g[0];if(g[1]){a+="|";a+=g[1];this.m_bHasUploadFile=true}}if(f.length>1){this.m_bHasUploadFile=true}if(this.m_bHasUploadFile){l="__TF_Upload_"+l}s=a;break}else{if("softbowl:img"==v&&"true"==t.attribute.upload){var f=s.split("|");var a=f[0];if(f[1]){a+="|";a+=f[1];this.m_bHasUploadFile=true;l="__TF_Upload_"+l}s=a;break}}}this.m_hmInstanceData[l]=s;return""}if("secure"==n){return l+"="+s+"&"}else{return SBGrid.UT.URIEncoder.encode(l,u)+"="+SBGrid.UT.URIEncoder.encode(s,u)+"&"}}}else{var b=m.childNodes;for(var p=0;p<b.length;p++){var e=b[p];var q=this._getPostDataNode(e,c,n,u);if("error"==q){return q}h+=q}}return h};SBGrid.DS.XMLStorage.prototype.updateDataForASync=function(xnResult){if(null!=this.m_objCurrentSubmission){var strResultRef=this.m_objCurrentSubmission.attribute.resultref;var strAdd=this.m_objCurrentSubmission.attribute.add;var strReplace=this.m_objCurrentSubmission.attribute.replace;this.updateData(xnResult,strResultRef,strAdd,strReplace);if(this.m_objCurrentSubmission.m_refresh){SBGrid.DS.XMLStorage.getUniqueStorage().refreshCurrentModel()}if(-1!=this.m_objCurrentSubmission.attribute["function"].indexOf("(")){try{window.eval(this.m_objCurrentSubmission.attribute["function"])}catch(e){}}else{try{window.eval(this.m_objCurrentSubmission.attribute["function"]+"();")}catch(e){}}}};SBGrid.DS.XMLStorage.prototype.updateData=function(d,m,l,p,c){if(!d){return}if(null==l||""==l){l="none"}if(null==p||""==p){p="instance"}var r=this.getInstanceDocument();if(null!=r){var a=SBGrid.UT.XmlLib.selectSingleNode(r,m);var g;var s;if(c){if(null==a){model.makeNode(m);a=SBGrid.UT.XmlLib.selectSingleNode(r,m)}}else{if(a){g=a.nodeName;s=a.parentNode;if("top"!=l&&"bottom"!=l){var f=s.childNodes;var h=0;while(h<f.length){var q=f[h];if(g==q.nodeName){s.removeChild(q)}else{h++}}}}else{var b=m.lastIndexOf("/");m=m.substring(0,b);s=SBGrid.UT.XmlLib.selectSingleNode(r,m)}}var n=d.childNodes;if(c){for(var h=0;h<n.length;h++){var o=n[h];a.appendChild(o.cloneNode(true))}this._synchronizeInstances()}else{if(n&&s){for(var h=0;h<n.length;h++){var o=n[h];if("top"==l){var e=s.firstChild;s.insertBefore(o.cloneNode(true),e)}else{s.appendChild(o.cloneNode(true))}}this._synchronizeInstances()}}}};SBGrid.DS.JsonStorage=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b);this.instances=new SBGrid.DS.Collection();this.property={};this.propertyReg;this.registry;this.m_objTabIndex=new Array();this.m_objHttpClient=new SBGrid.UT.HttpClient();this.m_objCurrentSubmission;this.m_bDoneUnload=false;this.m_hmInstanceData=null;this.m_bHasUploadFile=false;this.m_strSessionId="";this.m_resetRoot=null;if(SBGrid.DS.JsonStorage.isEmptyUniqueStorage()){SBGrid.DS.JsonStorage.setUniqueStorage(this)}};SBGrid.DS.JsonStorage.prototype=new SBGrid.CT.Element;SBGrid.DS.JsonStorage.m_UniqueStorage=null;SBGrid.DS.JsonStorage.isEmptyUniqueStorage=function(){return SBGrid.DS.JsonStorage.m_UniqueStorage==null};SBGrid.DS.JsonStorage.getUniqueStorage=function(){if(SBGrid.DS.JsonStorage.isEmptyUniqueStorage()){var a="body";if(document.body.id!=null&&document.body.id!=""){a=document.body.id}else{document.body.id=a}SBGrid.CT.DataGrid.initEngine(a,"");new SBGrid.DS.JsonStorage("head","json1","softbowl:json")}return SBGrid.DS.JsonStorage.m_UniqueStorage};SBGrid.DS.JsonStorage.setUniqueStorage=function(a){SBGrid.DS.JsonStorage.m_UniqueStorage=a};SBGrid.DS.JsonStorage.prototype.getId=function(){return this.id};SBGrid.DS.JsonStorage.prototype.copyJson=function(d,c){d.splice(0,d.length);var b=JSON.parse(JSON.stringify(c));for(var a=0;a<b.length;a++){d[a]=b[a]}};SBGrid.DS.JsonStorage.prototype.removeJson=function(b,a){if(a==null||a<0||b.length<a){a=-1}b.splice(a,1)};SBGrid.DS.JsonStorage.prototype.destroy=function(b){var c=null;if("string"==typeof(b)){c=this.getInstanceSinglePart(null,b)}else{c=b}if(null!=c){var a=c.parentNode;if(null!=a){a.removeChild(c)}}};SBGrid.DS.JsonStorage.prototype.duplicate=function(c,d,g){var f=null;if("string"==typeof(c)){f=this.getInstanceSinglePart(null,c)}else{f=c}var b=null;if("string"==typeof(d)){b=this.getInstanceSinglePart(null,d)}else{b=d}if(null!=f&&null!=b){var e=b.cloneNode(true);if(null==g||g.isEmpty()){f.appendChild(e)}else{var a=SBGrid.UT.XmlLib.selectSingleNode(f,g);if(null!=f){f.insertBefore(e,a)}}}};SBGrid.DS.JsonStorage.prototype.getValue=function(strRef){if(strRef!=""&&strRef!=null){try{var strTemp=eval(strRef);return strTemp+""}catch(e){return""}}return""};SBGrid.DS.JsonStorage.prototype.cloneJson=function(a){if(a!=null){return JSON.parse(JSON.stringify(a))}};SBGrid.DS.JsonStorage.prototype.appendJson=function(f,m,l,e){if(l==null||l==""||0>l||f.length<l){l=f.length}var c;var b=JSON.stringify(f);if(b.charAt(0)!="["){c=JSON.parse("["+b+"]")}else{c=JSON.parse(b)}var g=this.cloneJson(m);c.splice(l,0,g);for(var d=0;d<c.length;d++){f[d]=c[d]}if(null!=e){var a=e.m_arUpdateDeleteList;var h=new Array();for(var d=e.fixedRows;d<e.m_nRealRows;d++){h[d]=e.getRowStatus(d)}e.refresh();e.m_arUpdateDeleteList=a;for(var d=e.fixedRows;d<e.m_nRealRows;d++){if(d<l+1){e.setRowStatus(d,h[d]);continue}else{if(d==l+1){e.setRowStatus(d,1);continue}}e.setRowStatus(d+1,h[d-1])}}};SBGrid.DS.JsonStorage.prototype.propertynames=function(d){var b="";if(null==d){d=""}var c=0;for(var a in this.property){b+=(a+d);c++}if(0<c){b=b.substr(0,b.length-d.length)}return b};SBGrid.DS.JsonStorage.prototype.recalculate=function(){var a=this.children.getCollection();for(var c in a){var b=a[c];if(b instanceof SBGrid.CT.Bind){b.bindExecute()}}a=null};SBGrid.DS.JsonStorage.prototype.refresh=function(){var d=this.children.getCollection();for(var c in d){var a=d[c];if(null!=a){if(a.refresh){a.refresh()}}}d=null;var b=SBGrid.DS.SBBody;if(null==b){b=document.SBHE_allElement("body")}if(null!=b){b.refresh()}};SBGrid.DS.JsonStorage.prototype.getAttribute=function(a){};SBGrid.DS.JsonStorage.prototype.setAttribute=function(b,a){};SBGrid.DS.JsonStorage.prototype.makeLightGridObject=function(strResult,strMediaTypes){try{if("application/json"==strMediaTypes){return jQuery.parseJSON(strResult)}var objLightGridData={status:null,column:null,data:null};var arResult=strResult.substring(0,strResult.length-1).split("|");var strHeader=arResult[0];strHeader=strHeader.replaceAll("\\^","__SB_CAP_");var arHeader=strHeader.split("^");objLightGridData.status={row:parseInt(arHeader[1]),col:parseInt(arHeader[2])};var arCaptionNames=arHeader[3].split("__SB_CAP_");var arColumnWidths=arHeader[4].split(",");var arColumnTypes=new Array();var arColumnStyles=new Array();var arColumnInfo=arResult[1].split("^");for(var i=0;i<parseInt(arHeader[2]);i++){var strColumnStyle=arColumnInfo[i].split("!")[1];strColumnStyle=(""==strColumnStyle&&null==strColumnStyle)?"":strColumnStyle;arColumnStyles.push(strColumnStyle);var strColumnType=arColumnInfo[i].split("!")[0];strColumnType=(""==strColumnType&&null==strColumnType)?"":strColumnType;arColumnTypes.push(strColumnType)}var strCaptionData="objLightGridData.column = [";for(var i=0;i<parseInt(arHeader[2]);i++){strCaptionData+="{";strCaptionData+="width:"+parseInt(arColumnWidths[i])+", style:'"+arColumnStyles[i]+"', type:'"+arColumnTypes[i]+"', caption:'"+arCaptionNames[i];if(i!=parseInt(arHeader[2])-1){strCaptionData+="'}, "}else{strCaptionData+="'}"}}eval(strCaptionData+"]");var strBodyData="objLightGridData.data = [";for(var i=2;i<arResult.length;i++){var strRowData=arResult[i].substring(0,arResult[i].length-1);var arColData=strRowData.split("^");strBodyData+="[";for(var j=0;j<parseInt(arHeader[2]);j++){var strColData=(""==arColData[j]||null==arColData[j])?"":arColData[j];strBodyData+="{D:'"+strColData;if(j!=parseInt(arHeader[2])-1){strBodyData+="'}, "}else{strBodyData+="'}"}}if(i!=arResult.length-1){strBodyData+="], "}else{strBodyData+="]"}}eval(strBodyData+="]");return objLightGridData}catch(e){return null}};SBGrid.DS.JsonStorage.prototype.setValue=function(strRef,strValue){if(strRef!=""&&strRef!=null){var arrTemp=strValue.split("\r\n");strTemp=arrTemp.join("\\n");eval(strRef+"='"+strTemp+"';")}};SBGrid.DS.JsonStorage.prototype.initChildren=function(){var b=this.children.getCollection();for(var a in b){var c=b[a];if(null!=c&&c.init){c.init()}}b=null;SBGrid.DEF.__initControls()};SBGrid.DS.JsonStorage.prototype.getTabIndex=function(){return this.m_objTabIndex};SBGrid.DS.JsonStorage.prototype.initTabIndex=function(){for(var a=0;a<this.m_objTabIndex.length;a++){if(this.m_objTabIndex[a]&&this.m_objTabIndex[a].m_heCtrl){this.m_objTabIndex[a].m_TabIndex=a;this.m_objTabIndex[a].m_heCtrl.tabIndex=a+1}}};SBGrid.DS.JsonStorage.prototype.replaceTabIndex=function(c,b,a){if(null!=c){this.removeTabIndex(c)}this.addTabIndex(b,a);this.initTabIndex()};SBGrid.DS.JsonStorage.prototype.removeTabIndex=function(a){this.m_objTabIndex.splice(a,1)};SBGrid.DS.JsonStorage.prototype.addTabIndex=function(c,a){if(-1!=c){if(0==this.m_objTabIndex.length){this.m_objTabIndex.push(a);return}for(var b=0;b<this.m_objTabIndex.length;b++){if(c<this.m_objTabIndex[b].navIndex){this.m_objTabIndex.splice(b,0,a);return}}this.m_objTabIndex.push(a)}};SBGrid.DS.JsonStorage.prototype.defaultAction=function(b,a){switch(b){case"SBUx_recalculate":this.recalculate();break;case"SBUx_refresh":this.refresh();break}};SBGrid.DS.JsonStorage.prototype.refreshCurrentModel=function(a){if(null==a){a=true}if(a){this.dispatch("SBUx_recalculate");this.dispatch("SBUx_refresh")}else{this.refresh()}};SBGrid.DS.WebDatabase=function(b,c,g,h,d,f,l,a,m){if(!c){return}SBGrid.CT.Element.call(this,b,c,g);this.attribute.name=h;this.attribute.version=d;this.attribute.displayName=f;this.attribute.estimatedSize=l;this.query={};if(!(SBGrid.DEF.is_ie||SBGrid.DEF.is_firefox)){this.database=openDatabase(h,d,f,l,SBGrid.DS.WebDatabase.onError);this.database.transaction(function(n){for(var o=0;o<a.length;o++){n.executeSql(a[o],[],null,SBGrid.DS.WebDatabase.onError)}});for(var e=0;e<m.length;e++){this.query[m[e].strId]=m[e]}}else{SBGrid.DEF.errorMsg("WebDatabase을 지원하지 않습니다.")}};SBGrid.DS.WebDatabase.prototype=new SBGrid.CT.Element;SBGrid.DS.WebDatabase.prototype.execQueryString=function(strQuery,arParam,strJsonRef,strReturnType,objData,bIsCtrl){this.database.transaction(function(tx){tx.executeSql(strQuery,arParam,function(tx,results){var nLength=results.rows.length;if(null!=strJsonRef&&""!=strJsonRef){if(0==nLength){if("object"==strReturnType){eval(strJsonRef+"= null; ")}else{eval(strJsonRef+"= new Array(); ")}}else{if("object"==strReturnType){eval(strJsonRef+" = jQuery.extend({},results.rows.item(0));")}else{eval(strJsonRef+"= new Array();");for(var i=0;i<nLength;i++){eval(strJsonRef+"["+i+"]= jQuery.extend({},results.rows.item("+i+")); ")}}}}if(null!=objData){if(bIsCtrl){objData.refresh()}else{eval(objData+"();")}}},SBGrid.DS.WebDatabase.onError)})};SBGrid.DS.WebDatabase.prototype.execQueryStringToControl=function(d,b,e,c,a){this.execQueryString(d,b,e,c,a,true)};SBGrid.DS.WebDatabase.prototype.execQueryStringToFunction=function(d,a,e,b,c){this.execQueryString(d,a,e,b,c,false)};SBGrid.DS.WebDatabase.prototype.execQuery=function(strQueryId,objData,bIsCtrl){if(null!=this.query[strQueryId]){var objQueryData=this.query[strQueryId];this.database.transaction(function(tx){tx.executeSql(objQueryData.strQuertString,eval(objQueryData.strParam),function(tx,results){var nLength=results.rows.length;if(null!=objQueryData.strJsonRef&&""!=objQueryData.strJsonRef){if(0==nLength){if("object"==objQueryData.strReturnType){eval(objQueryData.strJsonRef+"= null; ")}else{eval(objQueryData.strJsonRef+"= new Array(); ")}}else{if("object"==objQueryData.strReturnType){eval(objQueryData.strJsonRef+"= jQuery.extend({},results.rows.item(0));")}else{eval(objQueryData.strJsonRef+"= new Array();");for(var i=0;i<nLength;i++){eval(objQueryData.strJsonRef+"["+i+"]= jQuery.extend({},results.rows.item("+i+")); ")}}}}if(null!=objData){if(bIsCtrl){objData.refresh()}else{eval(objData+"();")}}},SBGrid.DS.WebDatabase.onError)})}};SBGrid.DS.WebDatabase.prototype.execQueryToControl=function(b,a){this.execQuery(b,a,true)};SBGrid.DS.WebDatabase.prototype.execQueryToFunction=function(b,a){this.execQuery(b,a,false)};SBGrid.DS.WebDatabase.onError=function(a,b){SBGrid.DEF.errorMsg(b.message)};SBGrid.DS.Instance=function(c,f,e,d,a,b,g){if(!f){return}SBGrid.CT.Element.call(this,c,f,d);g=this._restore(g);this.attribute.preservewhitespace=e;this.preserveWhitespace=e;this.encoding=a;this.documentElement=SBGrid.UT.XmlLib.loadXMLFromString(g,e);if(this.documentElement!=null){this.root=this.documentElement.firstChild}this.version=b;this.xml=g;this.m_docClone;SBGrid.DS.XMLStorage.appendInstance(f,this,c)};SBGrid.DS.Instance.prototype=new SBGrid.CT.Element;SBGrid.DS.Instance.prototype.getXml=function(){return this.xml=SBGrid.UT.XmlLib.serializeToString(this.documentElement)};SBGrid.DS.Instance.prototype.getAbility=function(){return SBGrid.DEF.SBEA_HSB_AS_DOM};SBGrid.DS.Instance.prototype.synchronize=function(){this.xml=SBGrid.UT.XmlLib.serializeToString(this.documentElement);this.root=this.documentElement.firstChild};SBGrid.DS.Instance.prototype.createAttribute=function(){};SBGrid.DS.Instance.prototype.createElement=function(a){if(null!=a&&""!=a){return this.documentElement.createElement(a)}};SBGrid.DS.Instance.prototype.createNode=function(d,b,a){var c=null;if("element"==d){c=this.createElement(b)}else{if("attribute"==d){c=this.createAttribute(b)}}return c};SBGrid.DS.Instance.prototype.getElementsByTagName=function(){};SBGrid.DS.Instance.prototype.getXPathString=function(){};SBGrid.DS.Instance.prototype.load=function(){};SBGrid.DS.Instance.prototype.loadXML=function(a){this.xml=a;this.documentElement=SBGrid.UT.XmlLib.loadXMLFromString(a);this.root=this.documentElement.firstChild};SBGrid.DS.Instance.prototype.selectNodes=function(a){return SBGrid.UT.XmlLib.selectNodes(this.documentElement,a)};SBGrid.DS.Instance.prototype.selectNodesXml=function(a){var d="";var c=SBGrid.UT.XmlLib.selectNodes(this.documentElement,a);if(null!=c){for(var b=0;b<c.length;b++){d+=SBGrid.UT.XmlLib.serializeToString(c.item(b))}}return d};SBGrid.DS.Instance.prototype.selectSingleNode=function(a){return SBGrid.UT.XmlLib.selectSingleNode(this.documentElement,a)};SBGrid.DS.Instance.prototype.cloneInstances=function(){};SBGrid.DS.Instance.prototype.getXml=function(){this.synchronize();return this.xml};SBGrid.DS.Instance.prototype._restore=function(a){a=a.split("__SB_N").join("\n");a=a.split("__SB_T").join("\t");a=a.split("__SB_R").join("\r");return a};SBGrid.CT.Bind=function(b,l,f,h,i,m,a,c,e,d,g){if(!l){return}SBGrid.CT.Element.call(this,b,l,f);this.attribute.ref=h;this.attribute.calculate=i;this.attribute.constraint=m;this.attribute.readonly=a;this.attribute.relevant=c;this.attribute.required=e;this.attribute.type=d;this.attribute.script=g;this.bindExecute()};SBGrid.CT.Bind.prototype=new SBGrid.CT.Element;SBGrid.CT.Bind.prototype.bindExecute=function(){if(""!=this.attribute.ref){var strBaseRef=this.attribute.ref;var xlRefNode=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,strBaseRef);if(null!=xlRefNode){for(var i=0;i<xlRefNode.length;i++){if(""!=this.attribute.calculate){if(1==xlRefNode.length){SBGrid.DS.XMLStorage.getUniqueStorage().setValue(this.attribute.ref,String(this.bindCalculate(this.transRefDot("calculate"))))}else{SBGrid.UT.XmlLib.setTextValue(xlRefNode.item(i),String(this.bindCalculate(this.attribute.calculate,xlRefNode.item(i))))}}if(""!=this.attribute.constraint){var nConstraintValue;if(1==xlRefNode.length){var nConstraintValue=this.bindCalculate(this.transRefDot("calculate"))}else{var nConstraintValue=this.bindCalculate(this.attribute.calculate,xlRefNode.item(i))}var bBindBoolValue=("0"!=nConstraintValue&&"false"!=nConstraintValue&&""!=nReadonlyValue)?true:false;if(bBindBoolValue){var cObj=document.SBHE_allElement.getCollection();for(var strChildName in cObj){var objChild=cObj[strChildName];if(!(objChild instanceof SBGrid.CT.Bind)){if(this.attribute.ref==objChild.attribute.ref){if(this.booleanCheckType(this.attribute.type,this.attribute.ref)){objChild.dispatch("onvalid");objChild.dispatch("SBUx_valid")}else{objChild.dispatch("oninvalid");objChild.dispatch("SBUx_invalid")}}}}cObj=null}else{var cObj=document.SBHE_allElement.getCollection();for(var strChildName in cObj){var objChild=cObj[strChildName];if(!(objChild instanceof SBGrid.CT.Bind)){if(this.attribute.ref==objChild.attribute.ref){objChild.dispatch("oninvalid");objChild.dispatch("SBUx_invalid")}}}cObj=null}}if(""!=this.attribute.readonly){var nReadonlyValue;if(1==xlRefNode.length){var nReadonlyValue=this.bindCalculate(this.transRefDot("readonly"))}else{var nReadonlyValue=this.bindCalculate(this.attribute.readonly,xlRefNode.item(i))}if("0"!=nReadonlyValue&&"false"!=nReadonlyValue&&""!=nReadonlyValue){var cObj=document.SBHE_allElement.getCollection();for(var strChildName in cObj){var objChild=cObj[strChildName];if(!(objChild instanceof SBGrid.CT.Bind)){if(this.attribute.ref==objChild.attribute.ref){objChild.dispatch("onreadonly");objChild.dispatch("SBUx_readonly");objChild.setDisabled(true)}}}cObj=null}else{var cObj=document.SBHE_allElement.getCollection();for(var strChildName in cObj){var objChild=cObj[strChildName];if(!(objChild instanceof SBGrid.CT.Bind)){if(this.attribute.ref==objChild.attribute.ref){objChild.dispatch("onreadwrite");objChild.dispatch("SBUx_readwrite");objChild.setDisabled(false)}}}cObj=null}}if(""!=this.attribute.relevant){var nRelevantValue;if(1==xlRefNode.length){var nRelevantValue=this.bindCalculate(this.transRefDot("relevant"))}else{var nRelevantValue=this.bindCalculate(this.attribute.relevant,xlRefNode.item(i))}if("0"!=nRelevantValue&&"false"!=nRelevantValue&&""!=nReadonlyValue){var arKeyset=document.SBHE_allElement.keys();for(var j=0;j<arKeyset.length;j++){var strChildName=arKeyset[j];var objChild=document.SBHE_allElement.item(strChildName);if(!(objChild instanceof SBGrid.CT.Bind)){if(this.attribute.ref==objChild.attribute.ref){objChild.setVisible(true)}}}}else{var cObj=document.SBHE_allElement.getCollection();for(var strChildName in cObj){var objChild=cObj[strChildName];if(!(objChild instanceof SBGrid.CT.Bind)){if(this.attribute.ref==objChild.attribute.ref){objChild.setVisible(false)}}}cObj=null}}if(""!=this.attribute.required){var nRequiredValue;if(1==xlRefNode.length){var nRequiredValue=this.bindCalculate(this.transRefDot("required"))}else{var nRequiredValue=this.bindCalculate(this.attribute.required,xlRefNode.item(i))}var bBindBoolValue=("0"!=nRequiredValue&&"false"!=nRequiredValue&&""!=nReadonlyValue)?true:false;if(bBindBoolValue){var cObj=document.SBHE_allElement.getCollection();for(var strChildName in cObj){var objChild=cObj[strChildName];if(!(objChild instanceof SBGrid.CT.Bind)){if(this.attribute.ref==objChild.attribute.ref){if(null!=objChild.attribute.required&&objChild.attribute.required){objChild.dispatch("onrequired");objChild.dispatch("SBUx_required")}else{if(null!=objChild.attribute.required&&!objChild.attribute.required){objChild.dispatch("onoptional");objChild.dispatch("SBUx_optional")}}}}}cObj=null}}}}this.attribute.ref=strBaseRef;if(""!=this.attribute.script){try{window.eval(this.attribute.script)}catch(e){return}}}};SBGrid.CT.Bind.prototype.transRefDot=function(c){var a=this.attribute.ref;var b=this.attribute[c];a=a.substring(0,a.lastIndexOf("/")+1);b=b.replace(/\.\.\//g,a);return b};SBGrid.CT.Bind.prototype.bindCalculate=function(b,a){return xPathOperation(b,a)};SBGrid.CT.Bind.prototype.booleanCheckType=function(b,a){var c=SBGrid.DS.XMLStorage.getUniqueStorage().getValue(a);switch(b){case"xsd:anyURI":return true;break;case"xsd:base64Binary":break;case"xsd:boolean":if("true"==c||"1"==c){return true}else{return false}break;case"xsd:byte":if(""!=c){return true}else{return false}break;case"xsd:date":break;case"xsd:dateTime":break;case"xsd:decimal":break;case"xsd:double":if(Number(c)){return true}else{return false}break;case"xsd:float":if(Number(c)){return true}else{return false}break;case"xsd:gDay":break;case"xsd:gMonth":break;case"xsd:gMonthDay":break;case"xsd:gYear":break;case"xsd:gYearMonth":break;case"xsd:hexBinary":break;case"xsd:int":if(Number(c)){return true}else{return false}break;case"xsd:integer":if(Number(c)){return true}else{return false}break;case"xsd:long":if(Number(c)){return true}else{return false}break;case"xsd:negativeInteger":break;case"xsd:nonNegativeInteger":break;case"xsd:nonPositiveInteger":break;case"xsd:positiveInteger":break;case"xsd:short":break;case"xsd:string":if(""!=String(c)){if(!Number(c)){return true}else{return false}}else{return false}break;case"xsd:time":break;case"xsd:unsignedByte":break;case"xsd:unsignedInt":break;case"xsd:unsignedLong":break;case"xsd:unsignedShort":break;default:return true;break}};SBGrid.CT.Bind.prototype.setAttribute=function(b,a){SBGrid.CT.Element.prototype.setAttribute.call(this,b,a);switch(b){case"ref":this.attribute.ref=a;break;case"calculate":this.attribute.calculate=a;break;case"constraint":this.attribute.constraint=a;break;case"readonly":this.attribute.readonly=a;break;case"relevant":this.attribute.relevant=a;break;case"required":this.attribute.required=a;break;case"type":this.attribute.type=a;break;case"script":this.attribute.script=a;break}};SBGrid.CT.Bind.create=function(a,b,c){var d=null;return SBGrid.CT.Bind.createObject(a,d,b,c)};SBGrid.CT.Bind.createObject=function(d,q,r,t){var a="";var s="softbowl:bind";var e="";var b="";var c="";var h="";var n="";var p="";var i="";var l="";var g="";var o=r.getCollection();for(var f in o){switch(f){case"id":a=o[f];break;case"calculate":e=o[f];break;case"constraint":b=o[f];break;case"readonly":c=o[f];break;case"ref":h=o[f];break;case"relevant":n=o[f];break;case"type":p=o[f];break;case"script":i=o[f];break;case"required":g=o[f];break;default:if(!SBGrid.DEF.SB_STYLELIST[f]){l+=f+":"+o[f]+"; "}break}}o=null;var m=new SBGrid.CT.Bind(d,a,s,h,e,b,c,n,g,p,i,l);return m};SBGrid.CT.HtmlBind=function(a,i,d,f,c,l,g,b,h,e){if(i==null||i==""){return}this.m_strId=i;this.m_strJsonref=d;this.m_strJsonnodeset=f;this.m_strLabelref=c;this.m_strValueref=l;this.m_strSrcref=g;this.m_strTextref=b;this.m_strSubjectref=h;this.m_strTbodyControls=e;this.m_strTbodyInnerHtml="";this.m_heCtrl=document.getElementById(this.m_strId);if(null!=this.m_strTbodyControls&&undefined!=this.m_strTbodyControls&&""!=this.m_strTbodyControls){this.m_strTbodyControls=this.m_strTbodyControls.substring(0,this.m_strTbodyControls.length-1);this.tbodyControls=this.m_strTbodyControls.split("|")}this.m_heCtrl.htmlbind=this;if(this.m_heCtrl.attachEvent){if(this.m_heCtrl.type=="radio"){this.m_heCtrl.attachEvent("onclick",function(){SBGrid.CT.HtmlBind.setRadioValue(event,d)})}else{if(this.m_heCtrl.type=="checkbox"){this.m_heCtrl.attachEvent("onclick",function(){SBGrid.CT.HtmlBind.setCheckboxValue(event,d)})}else{if(this.m_heCtrl.nodeName=="INPUT"&&this.m_heCtrl.type=="range"){this.m_heCtrl.attachEvent("onmouseup",function(){SBGrid.CT.HtmlBind.setValue(event,l)});this.m_heCtrl.attachEvent("onkeyup",function(){SBGrid.CT.HtmlBind.setValue(event,l)});this.m_heCtrl.attachEvent("onmousewheel",function(){SBGrid.CT.HtmlBind.setValue(event,l)})}else{if(this.m_heCtrl.nodeName=="INPUT"){this.m_heCtrl.attachEvent("onblur",function(){SBGrid.CT.HtmlBind.setValue(event,l)})}else{if(this.m_heCtrl.nodeName=="TEXTAREA"){this.m_heCtrl.attachEvent("onblur",function(){SBGrid.CT.HtmlBind.setText(event,d)})}}}}}}else{if(this.m_heCtrl.type=="radio"){this.m_heCtrl.addEventListener("click",function(){SBGrid.CT.HtmlBind.setRadioValue(event,d)},false)}else{if(this.m_heCtrl.type=="checkbox"){this.m_heCtrl.addEventListener("click",function(){SBGrid.CT.HtmlBind.setCheckboxValue(event,d)},false)}else{if(this.m_heCtrl.nodeName=="INPUT"&&this.m_heCtrl.type=="range"){this.m_heCtrl.addEventListener("mouseup",function(){SBGrid.CT.HtmlBind.setValue(event,l)},false);this.m_heCtrl.addEventListener("mousedown",function(){SBGrid.CT.HtmlBind.setValue(event,l)},false);this.m_heCtrl.addEventListener("mousewheel",function(){SBGrid.CT.HtmlBind.setValue(event,l)},false)}else{if(this.m_heCtrl.nodeName=="INPUT"){this.m_heCtrl.addEventListener("blur",function(){SBGrid.CT.HtmlBind.setValue(event,l)},false)}else{if(this.m_heCtrl.nodeName=="TEXTAREA"){this.m_heCtrl.addEventListener("blur",function(){SBGrid.CT.HtmlBind.setValue(event,b)},false)}}}}}}this.rebuild()};SBGrid.CT.HtmlBind.prototype.makeLegend=function(){if(this.m_strSubjectref!=""&&this.m_heCtrl.nodeName=="FIELDSET"){jQuery(this.m_heCtrl.firstChild.nextSibling).html(eval(this.m_strSubjectref))}};SBGrid.CT.HtmlBind.prototype.makeRadio=function(){if(this.m_strJsonnodeset!=""&&this.m_heCtrl.nodeName=="INPUT"&&this.m_heCtrl.type=="radio"){var objNodeset=eval(this.m_strJsonnodeset);var strElement="";var xnPNode=this.m_heCtrl.parentNode;arrObj=window.document.getElementsByName(this.m_strId);jQuery(xnPNode).html("");for(var i=0;i<objNodeset.length;i++){var h_rdo=document.createElement("input");h_rdo.type="radio";h_rdo.id=this.m_strId;h_rdo.name=this.m_strId;h_rdo.value=eval(this.m_strJsonnodeset+"["+i+"]."+this.m_strValueref);h_rdo.htmlbind=this;h_rdo.htmlbind.m_heCtrl=h_rdo;var strJsonRef=this.m_strJsonref;if(h_rdo.value==eval(strJsonRef)){h_rdo.checked=true}if(h_rdo.attachEvent){h_rdo.attachEvent("onclick",function(){SBGrid.CT.HtmlBind.setRadioValue(event,strJsonRef)})}else{h_rdo.addEventListener("click",function(){SBGrid.CT.HtmlBind.setRadioValue(event,strJsonRef)},false)}var strText=document.createTextNode(eval(this.m_strJsonnodeset+"["+i+"]."+this.m_strLabelref)+"");xnPNode.appendChild(h_rdo);xnPNode.appendChild(strText)}}};SBGrid.CT.HtmlBind.prototype.makeCheckbox=function(){if(this.m_strJsonnodeset!=""&&this.m_heCtrl.nodeName=="INPUT"&&this.m_heCtrl.type=="checkbox"){var objNodeset=eval(this.m_strJsonnodeset);var strElement="";var xnPNode=this.m_heCtrl.parentNode;arrObj=window.document.getElementsByName(this.m_strId);jQuery(xnPNode).html("");for(var i=0;i<objNodeset.length;i++){var h_chk=document.createElement("input");h_chk.type="checkbox";h_chk.id=this.m_strId;h_chk.name=this.m_strId;h_chk.value=eval(this.m_strJsonnodeset+"["+i+"]."+this.m_strValueref);h_chk.htmlbind=this;h_chk.htmlbind.m_heCtrl=h_chk;var strJsonRef=this.m_strJsonref;var chkedVals=" "+eval(strJsonRef)+" ";if(-1!=chkedVals.indexOf(h_chk.value)){h_chk.checked=true}if(h_chk.attachEvent){h_chk.attachEvent("onclick",function(){SBGrid.CT.HtmlBind.setCheckboxValue(event,strJsonRef)})}else{h_chk.addEventListener("click",function(){SBGrid.CT.HtmlBind.setCheckboxValue(event,strJsonRef)},false)}var strText=document.createTextNode(eval(this.m_strJsonnodeset+"["+i+"]."+this.m_strLabelref)+"");xnPNode.appendChild(h_chk);xnPNode.appendChild(strText)}}};SBGrid.CT.HtmlBind.prototype.makeOption=function(){if(this.m_strJsonnodeset!=""&&(this.m_heCtrl.nodeName=="SELECT"||this.m_heCtrl.nodeName=="DATALIST")){var xnPNode=this.m_heCtrl;jQuery(xnPNode).html("");try{var objNodeset=eval(this.m_strJsonnodeset);for(var i=0;i<objNodeset.length;i++){var h_optn=document.createElement("OPTION");if(this.m_heCtrl.nodeName=="DATALIST"&&""!=this.m_strLabelref){h_optn.label=eval(this.m_strJsonnodeset+"["+i+"]."+this.m_strLabelref)}else{h_optn.text=eval(this.m_strJsonnodeset+"["+i+"]."+this.m_strLabelref)}h_optn.value=eval(this.m_strJsonnodeset+"["+i+"]."+this.m_strValueref);if(h_optn.value==eval(this.m_strJsonref)){h_optn.selected=true}this.m_heCtrl.appendChild(h_optn)}}catch(e){SBGrid.DEF.errorMsg("jsonref를 이용한 itemset 구성 오류")}}};SBGrid.CT.HtmlBind.prototype.makeTbody=function(){if(this.m_strJsonref!=""&&this.m_heCtrl.nodeName=="TABLE"){var heChilds=this.m_heCtrl.children;var heTbody;var strTbodyUnit;for(var i=0;i<heChilds.length;i++){var heChild=heChilds.item(i);if("TBODY"==heChild.nodeName){heTbody=heChild;if(this.m_strTbodyInnerHtml==""){this.m_strTbodyInnerHtml=jQuery(heTbody).html()}strTbodyUnit=this.m_strTbodyInnerHtml;for(var j=heChild.childNodes.length-1;j>=0;j--){heChild.removeChild(heChild.childNodes.item(j))}break}}var objNodeset=eval(this.m_strJsonref);var strTbodyContent="";var strTbodyUnitTmp="";for(var i=0;i<objNodeset.length;i++){strTbodyUnitTmp=strTbodyUnit;strTbodyUnitTmp=strTbodyUnit.replace(/id=\"(\w+)\"/g,'id="$1_'+(i+1)+'" name="$1_'+(i+1)+'"');strTbodyContent+=strTbodyUnitTmp}jQuery(heTbody).append(strTbodyContent);if(null!=this.tbodyControls&&undefined!=this.tbodyControls){for(var i=0;i<objNodeset.length;i++){for(var j=0;j<this.tbodyControls.length;j++){var tbodyControl=this.tbodyControls[j];var tbodyControlValArr=tbodyControl.split("^");var strParentId=this.m_heCtrl.id;var strId=tbodyControlValArr[1]+"_"+(i+1);var strJsonRef=tbodyControlValArr[2];var strJsonNodeSet=tbodyControlValArr[3];var strLabelRef=tbodyControlValArr[4];var strValueRef=tbodyControlValArr[5];var strSrcRef=tbodyControlValArr[6];var strTextRef=tbodyControlValArr[7];if(""!=strJsonRef){strJsonRef=this.m_strJsonref+"["+i+"]."+strJsonRef}if(!("INPUT"==document.getElementById(strId).nodeName&&("checkbox"==document.getElementById(strId).type||"radio"==document.getElementById(strId).type))){if(""!=strLabelRef){strLabelRef=this.m_strJsonref+"["+i+"]."+strLabelRef}if(""!=strValueRef){strValueRef=this.m_strJsonref+"["+i+"]."+strValueRef}}if(""!=strSrcRef){strSrcRef=this.m_strJsonref+"["+i+"]."+strSrcRef}if(""!=strTextRef){strTextRef=this.m_strJsonref+"["+i+"]."+strTextRef}new SBGrid.CT.HtmlBind(strParentId,strId,strJsonRef,strJsonNodeSet,strLabelRef,strValueRef,strSrcRef,strTextRef,"")}}}}};SBGrid.CT.HtmlBind.prototype.assignSource=function(){if(this.m_strJsonref!=""&&(this.m_heCtrl.nodeName=="VIDEO"||this.m_heCtrl.nodeName=="AUDIO")){var strSeparator="";if(this.m_heCtrl.nodeName=="VIDEO"){strSeparator="video/"}else{strSeparator="audio/"}var heChilds=this.m_heCtrl.children;if(this.m_strJsonref!=""){for(var i=0;i<heChilds.length;i++){var heChild=heChilds.item(i);if("SOURCE"==heChild.nodeName){var heChildType=heChild.type;var heChildTypeExt="";if(-1==heChildType.indexOf(";")){heChildTypeExt=heChildType.substring(heChildType.indexOf(strSeparator)+strSeparator.length,heChildType.length)}else{if(heChildType.indexOf(strSeparator)<heChildType.indexOf(";")){heChildTypeExt=heChildType.substring(heChildType.indexOf(strSeparator)+strSeparator.length,heChildType.indexOf(";"))}else{heChildTypeExt=heChildType.substring(heChildType.indexOf(strSeparator)+strSeparator.lengths,heChildType.indexOf('"')).replaceAll(";","")}}heChildTypeExt=heChildTypeExt.trim()}try{heChild.src=eval(this.m_strJsonref+"."+heChildTypeExt)}catch(e){}}}else{heControl.src=""}}};SBGrid.CT.HtmlBind.prototype.init=function(){this.refresh()};SBGrid.CT.HtmlBind.prototype.refresh=function(){if(this.m_heCtrl.nodeName=="INPUT"){if(this.m_heCtrl.type=="text"||this.m_heCtrl.type==""||this.m_heCtrl.type=="select-one"||this.m_heCtrl.type=="range"||this.m_heCtrl.type=="number"||this.m_heCtrl.type=="date"||this.m_heCtrl.type=="month"||this.m_heCtrl.type=="time"||this.m_heCtrl.type=="datetime"||this.m_heCtrl.type=="datetime-local"||this.m_heCtrl.type=="week"){if(this.m_strJsonref!=""){try{this.m_heCtrl.value=eval(this.m_strJsonref)}catch(e){}}else{this.m_heCtrl.value=""}}}else{if(this.m_heCtrl.nodeName=="IMG"||this.m_heCtrl.nodeName=="IFRAME"){if(this.m_strSrcref!=""){try{this.m_heCtrl.src=eval(this.m_strSrcref)}catch(e){}}}else{if(this.m_heCtrl.nodeName=="A"){if(this.m_strSrcref!=""){try{this.m_heCtrl.href=eval(this.m_strSrcref)}catch(e){}}if(this.m_strTextref!=""){try{jQuery(this.m_heCtrl).html(eval(this.m_strTextref))}catch(e){}}}else{if(this.m_heCtrl.nodeName=="BUTTON"||this.m_heCtrl.nodeName=="SPAN"||this.m_heCtrl.nodeName=="TEXTAREA"){if(this.m_strJsonref!=""){try{jQuery(this.m_heCtrl).html(eval(this.m_strJsonref))}catch(e){}}}else{if(this.m_heCtrl.nodeName=="VIDEO"||this.m_heCtrl.nodeName=="AUDIO"){this.assignSource();this.m_heCtrl.load()}}}}}};SBGrid.CT.HtmlBind.prototype.rebuild=function(){if(this.m_heCtrl.nodeName=="INPUT"){if(this.m_heCtrl.type=="radio"){this.makeRadio()}else{if(this.m_heCtrl.type=="checkbox"){this.makeCheckbox()}else{this.refresh()}}}else{if(this.m_heCtrl.nodeName=="FIELDSET"){this.makeLegend()}else{if(this.m_heCtrl.nodeName=="SELECT"||this.m_heCtrl.nodeName=="DATALIST"){this.makeOption()}else{if(this.m_heCtrl.nodeName=="TABLE"){this.makeTbody()}else{this.refresh()}}}}};SBGrid.CT.HtmlBind.refresh=function(strId,strValueRef){var objControl=document.getElementById(strId);if(objControl.nodeName=="INPUT"||objControl.nodeName=="SELECT"){if(objControl.type=="text"||objControl.type==""||objControl.type=="select-one"||objControl.type=="range"||objControl.type=="number"||objControl.type=="date"||objControl.type=="month"||objControl.type=="time"||objControl.type=="datetime"||objControl.type=="datetime-local"||objControl.type=="week"){if(strValueRef!=""){try{objControl.value=eval(strValueRef)}catch(e){}}else{objControl.value=""}}}else{if(objControl.nodeName=="IMG"||objControl.nodeName=="IFRAME"){if(strJsonRef!=""){try{objControl.src=eval(strJsonRef)}catch(e){}}}else{if(objControl.nodeName=="A"){if(strJsonRef!=""){try{objControl.href=eval(strJsonRef)}catch(e){}}if(strTextRef!=""){try{jQuery(objControl).html(eval(strJsonRef))}catch(e){}}}else{if(objControl.nodeName=="BUTTON"||objControl.nodeName=="SPAN"||objControl.nodeName=="TEXTAREA"){if(strJsonRef!=""){try{jQuery(objControl).html(eval(strJsonRef))}catch(e){}}}else{if(objControl.nodeName=="VIDEO"||objControl.nodeName=="AUDIO"){this.assignSource();objControl.load()}}}}}};SBGrid.CT.HtmlBind.setValue=function(event,strJsonRef){if(strJsonRef!=""){var objControl=event.srcElement;if(objControl.nodeName=="INPUT"||objControl.nodeName=="SELECT"||objControl.nodeName=="FIELDSET"){if(objControl.type=="text"||objControl.type==""||objControl.type=="select-one"||objControl.type=="range"||objControl.type=="number"||objControl.type=="date"||objControl.type=="month"||objControl.type=="time"||objControl.type=="datetime"||objControl.type=="datetime-local"||objControl.type=="week"){eval(strJsonRef+"= '"+objControl.value+"';")}}}};SBGrid.CT.HtmlBind.setText=function(event,strJsonRef){if(strTextRef!=""){var objControl=event.srcElement;if(objControl.nodeName=="TEXTAREA"){eval(strTextRef+"= '"+jQuery(objControl).html().replaceAll("\n","\\n")+"';")}}};SBGrid.CT.HtmlBind.setRadioValue=function(event,strJsonRef){eval(strJsonRef+" = "+event.srcElement.value+";")};SBGrid.CT.HtmlBind.setCheckboxValue=function(event,strJsonRef){var chkTagName=event.srcElement.name;var chkTagNameArr=document.getElementsByName(chkTagName);var chkVals="";for(var i=0;i<chkTagNameArr.length;i++){if(true==chkTagNameArr.item(i).checked){chkVals+=chkTagNameArr.item(i).value+" "}}eval(strJsonRef+' = "'+chkVals.substring(0,chkVals.length-1)+'";')};SBGrid.CT.Control=function(b,h,m,n,c,d,e,l,o,a,f,i,g){if(!l){return}SBGrid.CT.Element.call(this,b,l,f);this.attribute.alert=h;this.attribute.help=m;this.attribute.hint=n;this.attribute.accesskey=c;this.attribute["class"]=d;this.attribute.disabled=String(e);this.attribute.id=l;this.attribute.navindex=String(o);this.attribute.tag=f;this.attribute.visibility=i;this.disabled=e;this.hint=n;this.navIndex=o;this.visible=("hidden"!=i)?true:false;this.m_Resize=false;this.m_strClass=d;this.m_heCtrl;this.m_strStyle=a;this.m_clCSSName=new SBGrid.DS.Collection();this.m_strUserDefineAttrib=g;this.m_bDown=false;this.m_bDragStart=false;this.m_bLButtonDown=false;this.m_dwState=0;this.m_TabIndex;this.m_bDependentCtl=false;SBGrid.DEF.__appendControl(l,this);this.m_arCSSUnitSet=new Array();this.m_jsonCssEvent={normal:"",down:"",focus:"",select:"",deselect:"",disable:"",dedisable:""};SBGrid.DS.XMLStorage.getUniqueStorage().addTabIndex(o,this)};SBGrid.CT.Control.prototype=new SBGrid.CT.Element;SBGrid.CT.Control.prototype.init=function(){if(null==this.m_heCtrl){this.m_heCtrl=document.getElementById("SBHE_"+this.id)}var f=null!=this.m_heCtrl?true:false;this.setStyleToAttribute();this.setUserDefineAttribute();if(SBGrid.DEF.is_ie7&&null!=this.m_heCtrl){var h="";var p="";var q="";var d=this.m_heCtrl.className;if(""!=d&&null!=d){var l=d.trim().split(" ");for(var m=0;m<l.length;m++){var n=l[m];if(-1!=n.indexOf("sbgrid_")){continue}var a=document.styleSheets;for(var g=1;g<a.length;g++){var c=a.item(g).rules;for(var e=0;e<c.length;e++){var b=c.item(e);var o=b.selectorText;if("*."+n+":focus"==o){p=b.style.cssText}else{if("*."+n+":active"==o){h=b.style.cssText}else{if("*."+n+":disable"==o){q=b.style.cssText}}}}}}this.m_jsonCssEvent.down=h;this.m_jsonCssEvent.focus=p;this.m_jsonCssEvent.disable=q}}this.m_jsonCssEvent.normal=this.m_strStyle;if(null!=this.attribute["z-index"]&&null!=this.m_heCtrl){this.m_heCtrl.style.zIndex=this.attribute["z-index"]}if(f){this.m_heCtrl.title=this.hint;if(1==this.navIndex){window.setTimeout("SBGrid.DEF.setFocus('"+this.id+"');",0)}if(!this.visible){this.m_heCtrl.style.visibility="hidden"}}this.disabled=false};SBGrid.CT.Control.prototype.setStyleToAttribute=function(){if(null!=this.m_strStyle&&""!=this.m_strStyle){var b="";this.m_strStyle=this.m_strStyle.trim();if(";"==this.m_strStyle.charAt(this.m_strStyle.length-1)){this.m_strStyle=this.m_strStyle.substring(0,this.m_strStyle.length-1)}var e=this.m_strStyle.split(";");for(var c=0;c<e.length;c++){if(null!=e[c]&&""!=e[c]&&e[c].indexOf("undefined")==-1){var d=e[c].split(":");var a=d[0];var g="";if(2<d.length){for(var c=1;c<d.length;c++){g+=d[c]+":"}g=g.substring(0,g.length-1)}else{g=d[1]}if(-1!=a.indexOf("background-image")&&-1==g.indexOf("url(")){g="url("+g+")"}b+=a+":"+g+";";this.attribute[d[0].trim()]=d[1].trim();this.m_initStyleList[d[0].trim()]=g}}this.m_strStyle=b;if(SBGrid.DEF.bSBUx&&this.m_heCtrl!=null){var f="";if(this.getAttribute("class_bottom")!=""){f=" "+this.getAttribute("class_bottom")}if(this.getAttribute("class_left")!=""){f=" "+this.getAttribute("class_left")}if(this.getAttribute("class_right")!=""){f=" "+this.getAttribute("class_right")}if(this.getAttribute("class_top")!=""){f=" "+this.getAttribute("class_top")}if(f!=""){jQuery(this.m_heCtrl).addClass(f)}}}};SBGrid.CT.Control.prototype.setUserDefineAttribute=function(){if(null!=this.m_strUserDefineAttrib&&""!=this.m_strUserDefineAttrib){this.m_strUserDefineAttrib=this.m_strUserDefineAttrib.trim();if(";"==this.m_strUserDefineAttrib.charAt(this.m_strUserDefineAttrib.length-1)){this.m_strUserDefineAttrib=this.m_strUserDefineAttrib.substring(0,this.m_strUserDefineAttrib.length-1)}var g=this.m_strUserDefineAttrib.split(";");for(var f=0;f<g.length;f++){if(null!=g[f]&&""!=g[f]){var d=g[f].split(":");var e=d[0].trim();var a=d[1].trim();var c=this.elementName.substring(9);if(-1!=e.indexOf("class_")){this.m_clCSSName.add(e.replace("class_",c+"_"),a)}else{if(-1!=e.indexOf(c+"_")){this.m_clCSSName.add(e,a)}else{if(-1!=e.indexOf("select.")){var b=g[f].trim().substring(7);var h=this.m_jsonCssEvent.select;h=(""==h)?"":h+";";this.m_jsonCssEvent={select:h+b}}}}this.attribute[e]=a;e=null;a=null}}}};SBGrid.CT.Control.prototype.setClassName=function(){};SBGrid.CT.Control.prototype.isIndepandent=function(){return true};SBGrid.CT.Control.prototype.getAbility=function(){return SBGrid.DEF.SBEA_CONTROL};SBGrid.CT.Control.prototype.isEnable=function(){var a=this;while(null!=a&&(SBGrid.DEF.SBEA_CONTROL_BASE&a.getAbility())){if(a.getState(SBGrid.DEF.SB_CS_DISABLE)){return false}a=a.parent}return true};SBGrid.CT.Control.prototype.setRefElement=function(a){SBGrid.CT.Element.prototype.setRefElement.call(this,a);this.m_heCtrl=a.m_heCtrl};SBGrid.CT.Control.prototype.getClass=function(){return this.attribute["class"]};SBGrid.CT.Control.prototype.getHtmlElement=function(){return this.m_heCtrl};SBGrid.CT.Control.prototype.setHtmlElement=function(a){this.m_heCtrl=a};SBGrid.CT.Control.prototype.refresh=function(){if("true"==this.attribute.disabled){this.setDisabled(true)}};SBGrid.CT.Control.prototype.adjustDIVSize=function(){if(!SBGrid.DEF.is_ie&&this.m_heCtrl&&this.m_heCtrl.tagName.toLowerCase()=="div"){var d=this.attribute.width;if(d&&d.lastIndexOf("%")<0){var c=parseInt(this.attribute.width.replace("px",""));var e=this.m_heCtrl.offsetWidth-this.m_heCtrl.clientWidth;this.m_heCtrl.style.width=(c-e)+"px"}var a=this.attribute.height;if(a&&a.lastIndexOf("%")<0){var b=parseInt(this.attribute.height.replace("px",""));var e=this.m_heCtrl.offsetHeight-this.m_heCtrl.clientHeight;this.m_heCtrl.style.height=(b-e)+"px"}}};SBGrid.CT.Control.prototype.getBindingType=function(){return SBGrid.DEF.SB_NONE};SBGrid.CT.Control.prototype.setDisabled=function(d,c){var f=this;if(-1!=this.attribute.tag.indexOf("iviewer")){if(null==this.window){return}f=this.window.body;if(null==f){return}}if(null==c&&f.disabled==d){return}if(null==c){f.m_bThisDisabled=d}if(null==c&&!d){f.m_bThisDisabled=null}if(f.m_bThisDisabled&&c&&!d){return}f.disabled=d;f.attribute.disabled=String(d);if(null!=f.m_heCtrl){f.m_heCtrl.disabled=d;if(d){f.m_heCtrl.setAttribute("disabled",String(d))}else{f.m_heCtrl.removeAttribute("disabled")}}f.setState(SBGrid.DEF.SB_CS_DISABLE,d);f.m_strPDisabled=d?f.id:null;for(var b=0;b<f.children.count();b++){var e=f.children.item(b);var a=e.elementName;if(e instanceof SBGrid.CT.Control){if(-1!=e.id.indexOf("fixed-cell")){continue}e.setDisabled(d,true)}f.setChildDisabled(e,d)}};SBGrid.CT.Control.prototype.setChildDisabled=function(b,a){var c=null;if(this instanceof SBGrid.CT.Calendar){c=document.getElementById("SBHE_"+b.id)}else{if(this instanceof SBGrid.CT.Select){c=document.getElementById("SBHE_"+b.id)}}if(null!=c){if(a){c.setAttribute("disabled",String(a))}else{c.removeAttribute("disabled")}}};SBGrid.CT.Control.prototype.setHint=function(a){this.attribute.hint=a;this.hint=a;this.m_heCtrl.title=a;if("softbowl:select1"==this.tag){for(var b=0;b<this.children.count();b++){if(-1!=this.children.item(b).id.indexOf(".input")||-1!=this.children.item(b).id.indexOf(".button")){this.children.item(b).m_heCtrl.title=a}}}if("softbowl:calendar"==this.tag){for(var b=0;b<this.children.count();b++){var c="item"==this.children.item(b).id.substring(this.children.item(b).id.length-4,this.children.item(b).id.length);if(-1!=this.children.item(b).id.indexOf(".header")||-1!=this.children.item(b).id.indexOf(".prevyear")||-1!=this.children.item(b).id.indexOf(".prevmonth")||-1!=this.children.item(b).id.indexOf(".nextyear")||-1!=this.children.item(b).id.indexOf(".nextmonth")||-1!=this.children.item(b).id.indexOf(".today")||c){if(null!=this.children.item(b).m_heCtrl&&!c){this.children.item(b).m_heCtrl.title=a}this.children.item(b).hint=a}}this.init(true)}};SBGrid.CT.Control.prototype.setNavIndex=function(a){if(this.navIndex==a){return}else{SBGrid.DS.XMLStorage.getUniqueStorage().replaceTabIndex(this.m_TabIndex,a,this);this.navIndex=a;this.attribute.navindex=String(a)}};SBGrid.CT.Control.prototype.setVisible=function(a,b){this.visible=a;if(a){this.attribute.visibility="visible";if(null!=this.m_heCtrl){if(b){this.m_heCtrl.style.visibility="visible";return}this.m_heCtrl.style.visibility=""}if(this.parent instanceof SBGrid.CT.Input){this.setDisabled(this.parent.disabled)}}else{this.attribute.visibility="hidden";if(null!=this.m_heCtrl){this.m_heCtrl.style.visibility="hidden"}}return};SBGrid.CT.Control.prototype.initStyle=function(strStyle){if(null!=this.m_heCtrl){if(null!=strStyle){if("softbowl:bool"==this.attribute.tag&&"background-image"==strStyle){return}var strAttrStyle=strStyle;if("color"==strStyle||"width"==strStyle||"left"==strStyle||"right"==strStyle||"top"==strStyle||"bottom"==strStyle){if(0!=this.m_strStyle.indexOf(strStyle)){strStyle="[^\\-]"+strStyle}}var arFilter=eval(this.id+".m_strStyle.match(/"+strStyle+"\\:(\\s|)([^\\;]+)/)");var strInitStyle=null;if(null!=arFilter){strInitStyle=arFilter[0].split(":")[1].trim();this.setAttribute(strAttrStyle,strInitStyle)}else{this.setAttribute(strAttrStyle,"")}}}};SBGrid.CT.Control.prototype.refreshCurrentModel=function(c){if(SBGrid.DEF.__useBinding){var b=(null==c||-1!=c.indexOf("/"))?true:false;if(null==b){b=true}if(b){SBGrid.DS.XMLStorage.getUniqueStorage().dispatch("SBUx_recalculate");SBGrid.DS.XMLStorage.getUniqueStorage().dispatch("SBUx_refresh")}else{SBGrid.DS.XMLStorage.getUniqueStorage().refresh()}}else{var a=c;if(null!=a&&!a.isEmpty()){if(null!=SBGrid.DEF.SB_REF_ATTR[a]){for(strHtKey in SBGrid.DEF.SB_REF_ATTR[a]){if("parseJSON"!=strHtKey&&"toJSONString"!=strHtKey){SBGrid.DEF.SB_REF_ATTR[a][strHtKey].refresh()}}return}this.refresh(true)}else{this.refresh(true)}}};SBGrid.CT.Control.prototype.setPosition=function(a){this.m_heCtrl.style.top=a.getY()+"px";this.m_heCtrl.style.left=a.getX()+"px";this.m_heCtrl.style.width=a.getWidth()+"px";this.m_heCtrl.style.height=a.getHeight()+"px"};SBGrid.CT.Control.prototype.focus=function(){};SBGrid.CT.Control.prototype.setAttribute=function(a,b){SBGrid.CT.Element.prototype.setAttribute.call(this,a,b);switch(a){case"alert":this.attribute.alert=b;break;case"help":this.attribute.help=b;break;case"hint":this.attribute.hint=b;this.setHint(b);break;case"accesskey":this.attribute.accesskey=b;this.m_heCtrl.accessKey=b;break;case"class":if(this.elementName=="softbowl:caption"){jQuery(this.m_heCtrlText).removeClass(this.m_strClass).addClass(b)}else{jQuery(this.m_heCtrl).removeClass(this.m_strClass).addClass(b)}this.m_strClass=b;break;case"disabled":if("boolean"==typeof(b)){b=b+""}if("true"==b){this.setDisabled(true)}else{if("false"==b){this.setDisabled(false)}}break;case"navindex":this.setNavIndex(parseInt(b));break;case"visibility":if("visible"==b){this.visible=true;this.attribute.visibility=b;this.m_heCtrl.style.visibility=""}else{if("hidden"==b){this.visible=false;this.attribute.visibility=b;this.m_heCtrl.style.visibility="hidden"}}break;case"z-index":this.m_heCtrl.style.zIndex=b}};SBGrid.CT.Control.prototype.onFocus=function(a){if(!this.getState(SBGrid.DEF.SB_CS_ACTIVE)){this.setState(SBGrid.DEF.SB_CS_ACTIVE,true,a);this.dispatch("onactivate")}if(a.target==this.getId()){this.setState(SBGrid.DEF.SB_CS_FOCUS,true,a);if(null!=this.m_heCtrl){if(this.isFocusValid()){if(("minimal"==this.parent.getAttribute("appearance")&&""==this.parent.getAttribute("editmode"))){this.parent.focus()}else{this.focus()}}}}};SBGrid.CT.Control.prototype.onActivate=function(a){};SBGrid.CT.Control.prototype.onBlur=function(a){if(this.getState(SBGrid.DEF.SB_CS_ACTIVE)){this.setState(SBGrid.DEF.SB_CS_ACTIVE,false,a);this.dispatch("ondeactivate")}if(a.target==this.getId()){this.setState(SBGrid.DEF.SB_CS_FOCUS,false,a)}a.focus=""};SBGrid.CT.Control.prototype.onClick=function(a){if(null==SBGrid.DEF.m_nDelayTime){SBGrid.DEF.m_nDelayTime=window.setTimeout("var objElement = document.SBHE_allElement.m_htCollection['"+this.id+"'];if (null != objElement){objElement.dispatch('ondelayclick');};",500)}};SBGrid.CT.Control.prototype.onDelayClick=function(a){window.clearTimeout(SBGrid.DEF.m_nDelayTime);SBGrid.DEF.m_nDelayTime=null};SBGrid.CT.Control.prototype.onCursor=function(a){};SBGrid.CT.Control.prototype.onDblClick=function(a){window.clearTimeout(SBGrid.DEF.m_nDelayTime);SBGrid.DEF.m_nDelayTime=null;if(SBGrid.EVT.BUTTON_LEFT==a.button){this.setState(SBGrid.DEF.SB_CS_DOWN,true,a);m_bDown=0}};SBGrid.CT.Control.prototype.onKeyDown=function(a){if(a.target==this.getId()){if(!a.ctrlKey&&SBGrid.EVT.TAB==a.keyCode){if(!a.shiftKey){if(a.defaultAction!="cancel"){this.dispatch("onnext")}a.defaultAction="cancel"}else{this.dispatch("onprevious");a.defaultAction="cancel"}}else{if(SBGrid.EVT.F1==a.keyCode){this.dispatch("SBUx_help")}}}};SBGrid.CT.Control.prototype.onKeyUp=function(a){if("softbowl:comboinput"==this.tag&&this.parent.m_heItemList){if(SBGrid.EVT.UP!=a.keyCode&&SBGrid.EVT.DOWN!=a.keyCode&&SBGrid.EVT.ENTER!=a.keyCode&&SBGrid.EVT.ESC!=a.keyCode){this.parent.itemValidCheck(a)}}};SBGrid.CT.Control.prototype.onKeyPress=function(a){};SBGrid.CT.Control.prototype.compareStyle=function(b){var g=this.m_heCtrl.style.cssText;var l=g;if(""!=b&&null!=b){var f=g.split(";");var e=b.split(";");for(var d=0;d<e.length;d++){var a=false;var h=e[d].split(":");for(var c=0;c<f.length;c++){var m=f[c].split(":");if(m[0]==h[0]){l=l.replace(f[d],e[c]);a=true;break}}if(!a){l+="; "+e[d]}}}return l};SBGrid.CT.Control.prototype.onMouseDown=function(b){if(SBGrid.DEF.is_ie7){if(null!=this.m_jsonCssEvent.down&&""!=this.m_jsonCssEvent.down){strResultCssText=this.compareStyle(this.m_jsonCssEvent.down);this.m_heCtrl.style.cssText=strResultCssText}}var a=["input","textarea"];a=a.join("|");var c=SBGrid.DEF.is_firefox?b.m_browserEvent.target:b.m_browserEvent.srcElement;if(a.indexOf(c.tagName.toLowerCase())==-1||c.type=="checkbox"||c.type=="radio"){SBGrid.DS.SBBody.m_heCtrl.onselectstart=new Function("return false")}var c=SBGrid.DEF.is_firefox?b.m_browserEvent.target:b.m_browserEvent.srcElement;if(!SBGrid.DEF.is_smartphone){if("combo"==c.getAttribute("U_D_C_S")){c=null;return}}if(b.target==this.getId()){if(SBGrid.EVT.BUTTON_LEFT==b.button){this.setState(SBGrid.DEF.SB_CS_DOWN,true,b);this.m_bDown=true}SBGrid.DEF.setFocus(this.getId(),b)}this.m_bDragStart=false};SBGrid.CT.Control.prototype.onMouseEnter=function(a){if(a.target==this.getId()){if(!this.getState(SBGrid.DEF.SB_CS_HOVER)){this.setState(SBGrid.DEF.SB_CS_HOVER,true,a)}}SBGrid.DEF.m_event.hint="ready"};SBGrid.CT.Control.prototype.onMouseUp=function(g){if(this.m_heCtrl==null){return}if(SBGrid.DEF.is_ie7){if(this.parent.elementName!="xhtml:body"&&this.elementName!="xhtml:body"){if(null!=this.m_jsonCssEvent.focus){this.m_heCtrl.style.cssText=this.m_heCtrl.style.cssText+"; "+this.m_jsonCssEvent.focus}else{if(null!=this.m_jsonCssEvent.normal){this.m_heCtrl.style.cssText=this.m_jsonCssEvent.normal}}}}var e=["input","textarea"];e=e.join("|");var h=SBGrid.DEF.is_firefox?g.m_browserEvent.target:g.m_browserEvent.srcElement;if(e.indexOf(h.tagName.toLowerCase())==-1||h.type=="checkbox"||h.type=="radio"){SBGrid.DS.SBBody.m_heCtrl.onselectstart=""}if(SBGrid.DEF.bDragDrop){SBGrid.DEF.bDragDrop=false;var b=null;for(var d=0;d<document.SBHE_controls.count();d++){b=document.SBHE_controls.item(d);b.setAttribute("cursor",b.getAttribute("cursor"))}var f=document.getElementById("dragstyle");if(null!=f){var a=f.parentNode;a.removeChild(f)}if(null!=g.validEnter&&g.validEnter){g.validEnter=false;this.dispatch("ondragleave");this.dispatch("ondrop")}}if(SBGrid.EVT.BUTTON_LEFT==g.button){var c=(g.down==this.getId())&&this.m_bDown;if(this.getState(SBGrid.DEF.SB_CS_DOWN)&&this.m_bDown){this.setState(SBGrid.DEF.SB_CS_DOWN,false,g);this.m_bDown=false}if(g.target==this.getId()&&c){this.dispatch("onclick")}}};SBGrid.CT.Control.prototype.onMouseMove=function(d){if(!d.capture.isEmpty()){return}if(null!=this.m_heCtrl){if(d.down&&SBGrid.DEF.bDragDrop){var f=document.SBHE_allElement.m_htCollection[this.getId()];var e=false;if(null!=f){if((f instanceof SBGrid.CT.Cell)||(f instanceof SBGrid.CT.DataGridCell)||(f instanceof SBGrid.CT.SelectCell)||(f instanceof SBGrid.CT.SelectItem)){var b=f.parent;if(null!=b){if(""!=b.getAttribute("dropmode")&&"false"!=b.getAttribute("dropmode")){e=true}}}else{if(""!=this.getAttribute("dropmode")&&"false"!=this.getAttribute("dropmode")){e=true}}if(null==document.getElementById("dragstyle")){var c=document.createElement("style");c.setAttribute("id","dragstyle");if(e){c.innerTEXT=".sbgrid_caption_td{cursor:pointer;}.sbgrid_calendar_body{cursor:pointer;}.sbgrid_combo_itemlist_table{cursor:pointer;}"}else{c.innerTEXT=".sbgrid_caption_td{cursor:not-allowed;}.sbgrid_calendar_body{cursor:not-allowed;}.sbgrid_combo_itemlist_table{cursor:not-allowed;}"}document.body.appendChild(c)}if(e){this.m_heCtrl.style.cursor="pointer";this.dispatch("ondragover")}else{this.m_heCtrl.style.cursor="not-allowed"}}this.dispatch("ondrag")}}if(d.target==this.getId()){if(d.hover!=this.getId()){if(!d.hover.isEmpty()){var a=document.SBHE_allElement.item(d.hover);if(null!=a){a=a.getElement();a.dispatch("onmouseout");SBGrid.DEF.m_event.hint="none";SBGrid.DEF.m_event.cursorOver="none";if(SBGrid.DEF.m_event.hinting){SBGrid.DEF.m_event.hinting=false;window.clearTimeout(SBGrid.DEF.m_event.showHint);a.dispatch("onhidehint")}}this.dispatch("onmouseenter")}this.dispatch("onmouseover")}}};SBGrid.CT.Control.prototype.onMouseOut=function(a){if(a.target==this.getId()&&this.getState(SBGrid.DEF.SB_CS_HOVER)){this.setState(SBGrid.DEF.SB_CS_HOVER,false,a)}if(SBGrid.DEF.bDragDrop){if(null!=a.validEnter&&a.validEnter){a.validEnter=false}}};SBGrid.CT.Control.prototype.onMouseOver=function(b){if(b.target==this.getId()){if(SBGrid.DEF.bDragDrop){var c=document.SBHE_allElement.m_htCollection[b.target];if(null!=c){if((c instanceof SBGrid.CT.Cell)||(c instanceof SBGrid.CT.DataGridCell)||(c instanceof SBGrid.CT.SelectCell)||(c instanceof SBGrid.CT.SelectItem)){var a=c.parent;if(null!=a){if("false"!=a.getAttribute("dropmode")){this.dispatch("ondragenter");b.validEnter=true;this.dispatch("ondragover")}}}if((c instanceof SBGrid.CT.Input)||(c instanceof SBGrid.CT.TextArea)||(c instanceof SBGrid.CT.Img)||(c instanceof SBGrid.CT.Select1&&"minimal"==c.attribute.appearance)){if("false"!=c.getAttribute("dropmode")){this.dispatch("ondragenter");b.validEnter=true;this.dispatch("ondragover")}}}}this.dispatch("oncursor");if(!this.getState(SBGrid.DEF.SB_CS_HOVER)){this.setState(SBGrid.DEF.SB_CS_HOVER,true,b)}SBGrid.DEF.m_event.hint="ready";SBGrid.DEF.m_event.cursorOver="on"}};SBGrid.CT.Control.prototype.onNext=function(e){if(e.target==this.getId()){var b=SBGrid.DS.XMLStorage.getUniqueStorage().getTabIndex();var a=SBGrid.DEF.arrFind_Value(b,this);if(0>a){if(null!=this.parent){a=SBGrid.DEF.arrFind_Value(b,this.parent)}}if(-1<=a){var f;for(var d=a;d<b.length;d++){if(d+1<b.length){for(var c=d;c<b.length;c++){f=b[c+1];if(f==null||typeof f=="undefined"){continue}if("hidden"==f.getAttribute("visibility")){f=b[0];continue}else{break}}}else{f=b[0]}if(null!=f&&(f.id!=e.target)){if(true==f.disabled){continue}SBGrid.DEF.setFocus(f.id);break}else{SBGrid.DEF.setFocus("body")}}}if(e.m_browserEvent.cancelable===undefined){e.m_browserEvent.returnValue=false}else{if(e.m_browserEvent.cancelable){e.m_browserEvent.preventDefault()}}this.dispatch("SBUx_next")}};SBGrid.CT.Control.prototype.onPrevious=function(c){if(c.target==this.getId()){var b=SBGrid.DS.XMLStorage.getUniqueStorage().getTabIndex();var a=SBGrid.DEF.arrFind_Value(b,this);if(0>a){if(null!=this.parent){a=SBGrid.DEF.arrFind_Value(b,this.parent)}}var d;if(0<=a-1){d=b[a-1]}else{if(0<=b.length-1){d=b[b.length-1]}}if(null!=d&&(d.id!=c.target)){SBGrid.DEF.setFocus(d.id)}else{SBGrid.DEF.setFocus("body")}if(c.m_browserEvent.cancelable===undefined){c.m_browserEvent.returnValue=false}else{if(c.m_browserEvent.cancelable){c.m_browserEvent.preventDefault()}}this.dispatch("SBUx_previous")}};SBGrid.CT.Control.prototype.onScroll=function(a){};SBGrid.CT.Control.prototype.onScrollDown=function(a){};SBGrid.CT.Control.prototype.onScrollUp=function(a){};SBGrid.CT.Control.prototype.onMouseWheel=function(a){};SBGrid.CT.Control.prototype.onHint=function(a){};SBGrid.CT.Control.prototype.onInvalid=function(a){};SBGrid.CT.Control.prototype.onOptional=function(a){};SBGrid.CT.Control.prototype.onReadonly=function(a){};SBGrid.CT.Control.prototype.onReadWrite=function(a){};SBGrid.CT.Control.prototype.onRequired=function(a){};SBGrid.CT.Control.prototype.onvalid=function(a){};SBGrid.CT.Control.prototype.onDragStart=function(a){};SBGrid.CT.Control.prototype.onDragEnter=function(a){a.validEnter=true;if("softbowl:input"==this.tag||"softbowl:textarea"==this.tag){var b=SBGrid.DEF.getCaretPosition(this.m_heCtrl);this.m_nCaretEnd=b.end;SBGrid.DEF.setCaretPosition(this.m_heCtrl,this.m_nCaretEnd,this.m_nCaretEnd)}};SBGrid.CT.Control.prototype.onDragOver=function(a){};SBGrid.CT.Control.prototype.onDragLeave=function(a){a.validEnter=false;if("softbowl:input"==this.tag||"softbowl:textarea"==this.tag){this.m_heCtrl.blur()}};SBGrid.CT.Control.prototype.onDrop=function(a){};SBGrid.CT.Control.prototype.onDrag=function(a){};SBGrid.CT.Control.prototype.onShowHint=function(a){};SBGrid.CT.Control.prototype.onHideHint=function(a){};SBGrid.CT.Control.prototype.setState=function(b,d,c,e,a){if(d){switch(b){case SBGrid.DEF.SB_CS_HOVER:c.hover=this.getId();this.setAttribute("hover",true);break;case SBGrid.DEF.SB_CS_DOWN:c.down=this.getId();this.setAttribute("down",true);break;case SBGrid.DEF.SB_CS_FOCUS:c.focus=this.getId();this.setAttribute("focus",true);break;case SBGrid.DEF.SB_CS_SELECT:this.attribute.select="true";break;case SBGrid.DEF.SB_CS_DISABLE:this.attribute.disable="true";break}this.m_dwState|=b}else{switch(b){case SBGrid.DEF.SB_CS_HOVER:c.hover="";this.setAttribute("hover",false);break;case SBGrid.DEF.SB_CS_DOWN:c.down="";this.setAttribute("down",false);break;case SBGrid.DEF.SB_CS_FOCUS:c.focus="";this.setAttribute("focus",false);break;case SBGrid.DEF.SB_CS_SELECT:this.attribute.select="false";break;case SBGrid.DEF.SB_CS_DISABLE:this.attribute.disable="false";break}this.m_dwState&=~b}if(typeof SBUx!="undefined"){this.resetStyle(this.m_dwState,d)}if(a){this.onStateChange(b,d)}};SBGrid.CT.Control.prototype.resetStyle=function(b,e){var a=null;if(SBGrid.DEF.SB_CS_NORMAL==b){a=this.attribute}else{if(b&SBGrid.DEF.SB_CS_DISABLE){if(b&SBGrid.DEF.SB_CS_SELECT){a=this.m_htSelectStyle}if(b&SBGrid.DEF.SB_CS_DISABLE){a=this.m_htDisableStyle}}else{if(b&SBGrid.DEF.SB_CS_HOVER){a=this.m_htHoverStyle}if(b&SBGrid.DEF.SB_CS_SELECT){a=this.m_htSelectStyle}if(b&SBGrid.DEF.SB_CS_FOCUS){a=this.m_htFocusStyle}if(b&SBGrid.DEF.SB_CS_DOWN){a=this.m_htDownStyle}}}if(null!=a){for(var f in a){if(!SBGrid.DEF.SB_STYLELIST[f]){continue}var d=a[f];if(!e){d=this.attribute[f]}SBGrid.UT.HtmlLib.setStyle(this.m_heCtrl,f,d)}}else{if(null!=this.m_heCtrl){if(b&SBGrid.DEF.SB_CS_DISABLE){var c=this.getEditControls();if(1==c){if(!e){this.m_heCtrl.style.color=null!=this.attribute.color?this.attribute.color:"#000000";this.m_heCtrl.style.backgroundColor=null!=this.attribute["background-color"]?this.attribute["background-color"]:""}else{if(this.attribute.color==null){this.attribute.color=SBGrid.UT.HtmlLib.getStyle(this.m_heCtrl,"color")}if(this.attribute["background-color"]==null){this.attribute["background-color"]=SBGrid.UT.HtmlLib.getStyle(this.m_heCtrl,"background-color")}this.m_heCtrl.style.color=null!=this.attribute["disable.color"]?this.attribute["disable.color"]:"#808080";this.m_heCtrl.style.backgroundColor=null!=this.attribute["disable.background-color"]?this.attribute["disable.background-color"]:"#F0F0F0"}}else{if(2==c){if(!e){this.m_heCtrl.style.color=null!=this.attribute.color?this.attribute.color:"#000000"}else{if(this.attribute.color==null){this.attribute.color=SBGrid.UT.HtmlLib.getStyle(this.m_heCtrl,"color")}this.m_heCtrl.style.color=null!=this.attribute["disable.color"]?this.attribute["disable.color"]:"#808080"}}}}}}};SBGrid.CT.Control.prototype.getState=function(a){return this.m_dwState&a};SBGrid.CT.Control.prototype.isFocusValid=function(a){var b=this.m_heCtrl;while(null!=b&&"HTML"!=b.tagName&&"SBHE_body"!=b.id){if("hidden"==b.style.visibility||"none"==b.style.display||true==b.disabled){return false}if(SBGrid.DEF.is_firefox){b=b.parentNode}else{b=b.parentElement}}return true};SBGrid.CT.Control.prototype.getEditControls=function(){var a=this.elementName;if("softbowl:input"==a||"softbowl:comboinput"==a||"softbowl:output"==a||"softbowl:secret"==a||"softbowl:textarea"==a){a=null;return SBGrid.DEF.SBCT_EDIT}else{if("softbowl:select1"==a||"minimal"==this.attribute.appearance){a=null;return SBGrid.DEF.SBCT_EDIT}else{if("softbowl:button"==a){a=null;return SBGrid.DEF.SBCT_BUTTON}else{a=null;return SBGrid.DEF.SBCT_VIEW}}}};SBGrid.CT.Control.prototype.defaultAction=function(b,a){if("onaccesskey"==b){this.dispatch("DOMActivate");this.dispatch("SBUx_activate")}if(!this.isEnable()){return}switch(b){case"onactivate":this.onActivate(a);break;case"onmouseactivate":this.onMouseActivate(a);break;case"onmousemove":this.onMouseMove(a);break;case"onmousedown":this.onMouseDown(a);break;case"onmouseenter":this.onMouseEnter(a);break;case"onmouseup":this.onMouseUp(a);break;case"oncursor":this.onCursor(a);break;case"onmouseover":this.onMouseOver(a);break;case"onmouseout":this.onMouseOut(a);break;case"onclick":this.onClick(a);break;case"ondelayclick":this.onDelayClick(a);break;case"ondblclick":this.onDblClick(a);break;case"onfocus":this.onFocus(a);break;case"onblur":this.onBlur(a);break;case"onkeypress":this.onKeyPress(a);break;case"onkeydown":this.onKeyDown(a);break;case"onkeyup":this.onKeyUp(a);break;case"onscrolldown":this.onScrollDown(a);break;case"onscrollup":this.onScrollUp(a);break;case"onscrollpagedown":this.onScrollPageDown(a);break;case"onscrollpageup":this.onScrollPageUp(a);break;case"onscrollpos":this.onScrollPos(a);break;case"onscrolltrack":this.onScrollTrack(a);break;case"onscrolltrackdown":this.onScrollTrackDown(a);break;case"onscrolltrackup":this.onScrollTrackUp(a);break;case"onscroll":this.onScroll(a);break;case"onmousewheel":this.onMouseWheel(a);break;case"ontimer":this.onTimer(a);break;case"onnext":this.onNext(a);break;case"onprevious":this.onPrevious(a);break;case"SBUx_hint":this.onHint(a);break;case"SBUx_invalid":this.onInvalid(a);break;case"SBUx_optional":this.onOptional(a);break;case"SBUx_readonly":this.onReadonly(a);break;case"SBUx_readwrite":this.onReadWrite(a);break;case"SBUx_required":this.onRequired(a);break;case"SBUx_valid":this.onvalid(a);break;case"SBUx_enabled":this.onEnabled(a);break;case"SBUx_disabled":this.onDisabled(a);break;case"ondragenter":this.onDragEnter(a);break;case"ondragleave":this.onDragLeave(a);break;case"ondrop":this.onDrop(a);break;case"ondrag":this.onDrag(a);break;case"ondragover":this.onDragOver(a);break;case"ondragstart":this.onDragStart(a);break;case"onscrollmax":this.onScrollMax(a);break;case"onscrollmin":this.onScrollMin(a);break;case"onhint":this.onHint(a);break;case"onshowhint":this.onShowHint(a);break;case"onhidehint":this.onHideHint(a);break;case"onresize":this.onResize(a);break}};SBGrid.CT.Control.prototype.getClientLeft=function(a){var b=0;var c=this.m_heCtrl;while(null!=c){b+=c.offsetLeft;if(c!=this.m_heCtrl){b+=c.clientLeft}if(a&&c!=document.body){b-=(SBGrid.DEF.is_android?0:c.scrollLeft)}c=c.offsetParent}return b};SBGrid.CT.Control.prototype.getClientTop=function(a){var c=0;var b=this.m_heCtrl;while(null!=b){c+=b.offsetTop;if(b!=this.m_heCtrl){c+=b.clientTop}if(a&&b!=document.body){c-=(SBGrid.DEF.is_android?0:b.scrollTop)}b=b.offsetParent}return c};SBGrid.CT.Control.prototype.preTranslateEvent=function(a){a.x=0;a.y=0;return};SBGrid.CT.Control.prototype.hide=function(){var a=arguments;switch(a.length){case 1:jQuery(this.m_heCtrl).hide(a[0]);break;case 2:jQuery(this.m_heCtrl).hide(a[0],a[1]);break;case 3:jQuery(this.m_heCtrl).hide(a[0],a[1],a[2]);break;default:jQuery(this.m_heCtrl).hide();break}};SBGrid.CT.Control.prototype.show=function(){var a=arguments;switch(a.length){case 1:jQuery(this.m_heCtrl).show(a[0]);break;case 2:jQuery(this.m_heCtrl).show(a[0],a[1]);break;case 3:jQuery(this.m_heCtrl).show(a[0],a[1],a[2]);break;default:jQuery(this.m_heCtrl).show();break}};SBGrid.CT.Control.prototype.fadeIn=function(){var a=arguments;switch(a.length){case 1:jQuery(this.m_heCtrl).fadeIn(a[0]);break;case 2:jQuery(this.m_heCtrl).fadeIn(a[0],a[1]);break;case 3:jQuery(this.m_heCtrl).fadeIn(a[0],a[1],a[2]);break;default:jQuery(this.m_heCtrl).fadeIn();break}};SBGrid.CT.Control.prototype.fadeOut=function(){var a=arguments;switch(a.length){case 1:jQuery(this.m_heCtrl).fadeOut(a[0]);break;case 2:jQuery(this.m_heCtrl).fadeOut(a[0],a[1]);break;case 3:jQuery(this.m_heCtrl).fadeOut(a[0],a[1],a[2]);break;default:jQuery(this.m_heCtrl).fadeOut();break}};SBGrid.CT.Control.prototype.slideUp=function(){var a=arguments;switch(a.length){case 1:jQuery(this.m_heCtrl).slideUp(a[0]);break;case 2:jQuery(this.m_heCtrl).slideUp(a[0],a[1]);break;case 3:jQuery(this.m_heCtrl).slideUp(a[0],a[1],a[2]);break;default:jQuery(this.m_heCtrl).slideUp();break}};SBGrid.CT.Control.prototype.slideDown=function(){var a=arguments;switch(a.length){case 1:jQuery(this.m_heCtrl).slideDown(a[0]);break;case 2:jQuery(this.m_heCtrl).slideDown(a[0],a[1]);break;case 3:jQuery(this.m_heCtrl).slideDown(a[0],a[1],a[2]);break;default:jQuery(this.m_heCtrl).slideDown();break}};SBGrid.CT.Control.prototype.animate=function(){var a=arguments;switch(a.length){case 1:jQuery(this.m_heCtrl).animate(a[0]);break;case 2:jQuery(this.m_heCtrl).animate(a[0],a[1]);break;case 3:jQuery(this.m_heCtrl).animate(a[0],a[1],a[2]);break;case 4:jQuery(this.m_heCtrl).animate(a[0],a[1],a[2],a[3]);break;default:jQuery(this.m_heCtrl).animate();break}};SBGrid.CT.Control.createAttribute=function(d,a){var b=new Array();for(var c in a.m_htCollection){switch(c){case"id":d.setAttribute("id","SBHE_"+a.item("id"));break;case"disabled":break;case"clsid":d.setAttribute("CLASSID","clsid:"+a.item("clsid"));break;case"class":jQuery(d).addClass(a.item("class"));break;default:if(SBGrid.DEF.SB_STYLELIST[c]){b.push(c+":"+a.item(c)+";")}else{if(SBGrid.DEF.bSBUx&&SBGrid.DEF.SB_CSSLIST[c]){if(c=="class_disable"){}}else{d.setAttribute(c,a.item(c))}}}}d.style.cssText=b.join("");d=SBGrid.CT.Element.createAttribute(d,a);return d};SBGrid.CT.Control.prototype.getTypeName=function(b){if(typeof b=="string"){var a=b.indexOf(":");return b.substring(a+1)}else{return null}};SBGrid.CT.Control.prototype.GenerateID=function(b){var a;var d=this.getTypeName(b);if(d!=null){for(var c=0;;c++){a=d+String(c);if(this.findElement(a)==-1){break}}}else{a=null}return a};SBGrid.CT.Control.prototype.findElement=function(c){var a;for(var b=0;b<document.SBHE_controls.count();b++){a=document.SBHE_controls.item(b);if(a==undefined){break}else{if(a.id==c){return b}}}return -1};SBGrid.CT.Control.prototype.onScrollMax=function(a){};SBGrid.CT.Control.prototype.onScrollMin=function(a){};SBGrid.CT.Control.prototype.onResize=function(a){if(document.SBHE_SBUxComponent){if(this.elementName=="softbowl:select1"){if(this.m_bShowItemList==true){this.showItemList(false);this.showItemListBar(false);this.m_bShowItemList=false}}}};SBGrid.CT.Control.prototype.resize=function(){clearTimeout(this.resizeEvt);this.resizeEvt=setTimeout("if(typeof SBUx != 'undefined' && SBUx.getComponent('"+this.id+"')){SBUx.getComponent('"+this.id+"').dispatch('onresize');}",0)};SBGrid.CT.BindableControl=function(b,l,p,q,d,c,e,g,o,r,m,f,a,h,n,i){if(!o){return}SBGrid.CT.Control.call(this,b,l,p,q,d,e,g,o,r,a,h,n,i);this.value="";this.attribute.bind=c;if(this.parent){if(""!=this.parent.jsonref&&null!=this.parent.jsonref){this.attribute.jsonref=f}else{this.attribute.ref=m}}else{this.attribute.jsonref="";this.attribute.ref=""}if(""==this.attribute.ref){this.attribute.jsonref=f}this.attribute.required=null;this.m_xlRefNode=null;this.m_bBinded=false;this.m_bCanBind=true;this.m_bBase64=false;var c=this.getAttribute("bind");if(null!=c&&!c.isEmpty()){this.m_bBinded=true}var m;m=this.getAttribute("jsonref");if(m==""||m==null){if(SBGrid.DEF.SB_SINGLE==this.getBindingType()){m=this.getAttribute("ref")}else{if(SBGrid.DEF.SB_MULTIPLE==this.getBindingType()){m=this.getAttribute("nodeset")}}}if(null!=m&&!m.isEmpty()){if(null==SBGrid.DEF.SB_REF_ATTR[m]){SBGrid.DEF.SB_REF_ATTR[m]={};SBGrid.DEF.SB_REF_ATTR[m][this.id]=this}else{SBGrid.DEF.SB_REF_ATTR[m][this.id]=this}this.m_bBinded=true}};SBGrid.CT.BindableControl.prototype=new SBGrid.CT.Control;SBGrid.CT.BindableControl.prototype.init=function(){SBGrid.CT.Control.prototype.init.call(this);this.m_xlRefNode=this.getControlNodeList()};SBGrid.CT.BindableControl.prototype.refresh=function(){SBGrid.CT.Control.prototype.refresh.call(this);this.m_xlRefNode=this.getControlNodeList()};SBGrid.CT.BindableControl.prototype.getRefNode=function(){var a=this.attribute.jsonref;if(null!=a&&!a.isEmpty()){return this.m_xlRefNode}else{return"string"==typeof(this.m_xlRefNode)?null:this.m_xlRefNode}};SBGrid.CT.BindableControl.prototype.setRefNode=function(a){this.m_xlRefNode=a};SBGrid.CT.BindableControl.prototype.isBinded=function(){return this.m_bBinded};SBGrid.CT.BindableControl.prototype.setBinded=function(a){this.m_bBinded=a};SBGrid.CT.BindableControl.prototype.isCanBind=function(){return this.m_bCanBind};SBGrid.CT.BindableControl.prototype.setCanBind=function(a){this.m_bCanBind=a};SBGrid.CT.BindableControl.prototype.getValue=function(){if(false){}else{var strJsonRef=this.attribute.jsonref;if(null!=strJsonRef&&!strJsonRef.isEmpty()){try{if(eval("typeof "+strJsonRef)!="undefined"){var strValue=String(eval(strJsonRef));if(null!=strValue){return strValue}}}catch(e){return""}}this.m_xlRefNode=this.getControlNodeList();if(null!=this.m_xlRefNode&&0<this.m_xlRefNode.length){return SBGrid.UT.XmlLib.getTextValue(this.m_xlRefNode.item(0))}if("softbowl:caption"==this.getElementName()){return this.getText()}else{if("softbowl:button"==this.getElementName()){return this.getText()}else{if("softbowl:treeview"==this.getElementName()){return this.getText()}}}return""}};SBGrid.CT.BindableControl.prototype.setValue=function(d){if(this.attribute.jsonref!=""&&this.attribute.jsonref!=null){try{SBGrid.DS.JsonStorage.getUniqueStorage().setValue(this.attribute.jsonref,d);this.refreshCurrentModel(this.attribute.jsonref)}catch(c){return}}else{if(null!=this.m_xlRefNode&&0<this.m_xlRefNode.length){var a=this.m_xlRefNode.item(0);var b=SBGrid.DS.XMLStorage.getUniqueStorage().attribute.autocdata;var f=SBGrid.DS.XMLStorage.getUniqueStorage().isProcessAutoCdata(d);if(b&&f){}else{SBGrid.UT.XmlLib.setTextValue(a,d)}}else{this.setText(d)}this.refreshCurrentModel(this.attribute.ref)}};SBGrid.CT.BindableControl.prototype.getControlNodeList=function(){if(null==SBGrid.DS.XMLStorage.getUniqueStorage()){return null}if(this.getElementName()=="softbowl:col"){return null}var strBind=this.getAttribute("bind");if(null!=strBind&&!strBind.isEmpty()){this.m_bBinded=true}else{var strRef;strRef=this.getAttribute("jsonref");if(strRef==""||strRef==null){if(SBGrid.DEF.SB_SINGLE==this.getBindingType()){strRef=this.getAttribute("ref")}else{if(SBGrid.DEF.SB_MULTIPLE==this.getBindingType()){strRef=this.getAttribute("nodeset")}}if(null!=strRef&&!strRef.isEmpty()){this.m_bBinded=true;return SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,strRef)}}else{this.m_bBinded=true;try{var strReturn=eval(this.getAttribute("jsonref"));return strReturn}catch(e){return""}}}return null};SBGrid.CT.BindableControl.prototype.setAttribute=function(b,c){SBGrid.CT.Control.prototype.setAttribute.call(this,b,c);switch(b){case"bind":this.attribute.bind=c;break;case"ref":var a=this.attribute.ref;if(null!=a&&!a.isEmpty()){if(null!=SBGrid.DEF.SB_REF_ATTR[a]){SBGrid.DEF.SB_REF_ATTR[a][this.id]=null}}this.attribute.ref=c;if(null!=c&&!c.isEmpty()){if(null==SBGrid.DEF.SB_REF_ATTR[c]){SBGrid.DEF.SB_REF_ATTR[c]={};SBGrid.DEF.SB_REF_ATTR[c][this.id]=this}else{SBGrid.DEF.SB_REF_ATTR[c][this.id]=this}}this.m_bBinded=true;break;case"jsonref":var d=this.attribute.jsonref;if(null!=a&&!a.isEmpty()){if(null!=SBGrid.DEF.SB_REF_ATTR[d]){SBGrid.DEF.SB_REF_ATTR[d][this.id]=null}}this.attribute.jsonref=c;if(null!=c&&!c.isEmpty()){if(null==SBGrid.DEF.SB_REF_ATTR[c]){SBGrid.DEF.SB_REF_ATTR[c]={};SBGrid.DEF.SB_REF_ATTR[c][this.id]=this}else{SBGrid.DEF.SB_REF_ATTR[c][this.id]=this}}this.m_bBinded=true;break}};SBGrid.CT.BindableControl.prototype.isBindControlByNode=function(c){this.m_xlRefNode=this.getControlNodeList();if(null!=this.m_xlRefNode){for(var b=0;b<this.m_xlRefNode.length;b++){var a=this.getAttribute("jsonref");if(a==""||a==null){var d=this.m_xlRefNode.item(b)}else{return false}if(c==d){return true}}}return false};SBGrid.CT.BindableControl.prototype.isBindControlByXPath=function(b){var a;a=this.getAttribute("jsonref");if(a==""||a==null){if(SBGrid.DEF.SB_SINGLE==this.getBindingType()){a=this.getAttribute("ref")}else{if(SBGrid.DEF.SB_MULTIPLE==this.getBindingType()){a=this.getAttribute("nodeset")}}}return(a==b)};SBGrid.CT.BindableControl.createAttribute=function(b,a){b=SBGrid.CT.Control.createAttribute(b,a);return b};SBGrid.CT.BindableControl.prototype.isJsonRef=function(){if(this.jsonref!=null&&this.jsonref!=""){return true}else{return false}};SBGrid.CT.Caption=function(d,h,e,u,t,o,v,l,n,r,m,c,a,s,f,b,g,q,x,w,p,i){if(!a){return}SBGrid.CT.BindableControl.call(this,d,h,e,u,o,l,n,r,a,s,f,b,x,w,p,i);t=t.split("__SB_STR_N").join("\\n");t=t.split("__SB_STR_T").join("\\t");t=t.split("__SB_STR_R").join("\\r");t=t.split("__SB_N").join("\n");t=t.split("__SB_T").join("\t");t=t.split("__SB_R").join("\r");this.attribute.text=t;this.attribute.autoresize=String(v);this.attribute.ellipsis=String(m);this.attribute.format=c;this.attribute.roundmode=g;this.attribute.roundposition=String(q);this.ellipsis=m;this.label=t;this.m_heCtrlText=document.getElementById("SBHE_"+this.id+"_TEXT")};SBGrid.CT.Caption.prototype=new SBGrid.CT.BindableControl;SBGrid.CT.Caption.prototype.init=function(){SBGrid.CT.BindableControl.prototype.init.call(this);if("softbowl:caption"==this.attribute.tag||"softbowl:output"==this.attribute.tag||"softbowl:button"==this.attribute.tag){if("true"!=this.attribute.autoresize){if("softbowl:button"==this.attribute.tag){this.m_heCtrl.style.textOverflow="";this.m_heCtrl.style.overflow="hidden"}else{this.m_heCtrlText.style.textOverflow="";this.m_heCtrlText.style.overflow="hidden"}if(""!=this.attribute.ellipsis){this.setEllipsis(this.attribute.ellipsis)}}else{if("softbowl:button"==this.attribute.tag){this.m_heCtrlText.style.overflow="visible"}else{this.m_heCtrl.style.overflow="visible";this.m_heCtrl.style.width="";this.m_heCtrl.style.height=""}}}};SBGrid.CT.Caption.prototype.getAbility=function(){return SBGrid.DEF.SBEA_CONTROL|SBGrid.DEF.SBEA_HSB_AS_FORMAT|SBGrid.DEF.SBEA_HSB_AS_TEXT};SBGrid.CT.Caption.prototype.refresh=function(){if(null!=this.m_heCtrl){var b="";if(this.m_bBinded){b=this.getValue()}else{b=this.getAttribute("text")}this.value=b;var a=SBGrid.DEF.formatStatus(this.attribute.format);if(0!=a){if(null==b){b=""}b=b.formatting(this.attribute.format);if(4==a&&""!=this.attribute.roundmode&&""!=this.attribute.roundposition){b=SBGrid.DEF.getRoundMode(b,this.attribute.roundmode,this.attribute.roundposition)}}if(null!=this.m_heCtrlText){if(null==b){b=""}b=b.newlineCharConvert();jQuery(this.m_heCtrlText).html(b);this.label=jQuery(this.m_heCtrlText).html()}}};SBGrid.CT.Caption.prototype.getBindingType=function(){return SBGrid.DEF.SB_SINGLE};SBGrid.CT.Caption.prototype.setText=function(a){if("number"==typeof(a)){a=a+""}if(null!=this.m_heCtrlText){SBGrid.CT.BindableControl.prototype.setText.call(this,a);if(null==a){a=""}jQuery(this.m_heCtrlText).html(a.newlineCharConvert())}};SBGrid.CT.Caption.prototype.setAttribute=function(b,c){SBGrid.CT.BindableControl.prototype.setAttribute.call(this,b,c);switch(b){case"text":if("softbowl:caption"==this.attribute.tag||"softbowl:output"==this.attribute.tag){this.text=c;this.attribute.text=c;this.setText(c);break}case"autoresize":if("true"==c.toString()){if("false"==this.attribute.autoresize){jQuery(this.m_heCtrl.firstChild).removeClass("sbgrid_table_fixed")}this.attribute.autoresize="true";this.m_heCtrl.style.overflow="visible";this.m_heCtrl.style.width="";this.m_heCtrl.style.height=""}else{if("false"==c){if("true"==this.attribute.autoresize){jQuery(this.m_heCtrl.firstChild).addClass("sbgrid_table_fixed")}this.attribute.autoresize="false";this.m_heCtrl.style.overflow="hidden";this.m_heCtrl.style.width=this.attribute.width;this.m_heCtrl.style.height=this.attribute.height}}break;case"ellipsis":var a="true"==c;this.setEllipsis(a);break;case"format":this.attribute.format=c;break;case"roundmode":this.attribute.roundmode=c;break;case"roundposition":this.attribute.roundposition=c;break}};SBGrid.CT.Caption.prototype.setEllipsis=function(a){a=String(a);this.ellipsis=a;this.attribute.ellipsis=a;var b=this.attribute.tag;if("softbowl:button"!=b){if("true"==a){this.m_heCtrlText.style.textOverflow="ellipsis";this.m_heCtrlText.style.whiteSpace="nowrap";if(SBGrid.DEF.is_ie7){this.m_heCtrlText.noWrap="nowrap"}}else{this.m_heCtrlText.style.textOverflow="clip";this.m_heCtrlText.style.whiteSpace="normal";if(SBGrid.DEF.is_ie7){this.m_heCtrlText.noWrap=""}}}else{if("true"==a){if(null!=this.m_heCtrlText){this.m_heCtrlText.style.textOverflow="ellipsis"}else{this.m_heCtrl.style.textOverflow="ellipsis"}this.m_heCtrlText.style.whiteSpace="nowrap";if(SBGrid.DEF.is_ie7){this.m_heCtrlText.noWrap=true}}else{if(null!=this.m_heCtrlText){this.m_heCtrlText.style.textOverflow="clip";this.m_heCtrlText.style.whiteSpace="normal"}this.m_heCtrl.style.textOverflow="clip";this.m_heCtrl.style.whiteSpace="normal";if(SBGrid.DEF.is_ie7){this.m_heCtrl.noWrap=false}}}};SBGrid.CT.Caption.create=function(a,c,d){c=SBGrid.CT.Element.createClassName(c,"caption");var e=SBGrid.CT.Caption.createMainNode(c);var b=document.getElementById(a);if(b==null){b=document.getElementById("SBHE_"+a)}if(b==null){return}b.appendChild(e);e=SBGrid.CT.Caption.createSubNodes(e,c);return SBGrid.CT.Caption.createObject(a,e,c,d)};SBGrid.CT.Caption.createMainNode=function(a){var b=document.createElement("span");jQuery(b).addClass("sbgrid_caption_div sbgrid_boxsizing");b=SBGrid.CT.Caption.createAttribute(b,a);return b};SBGrid.CT.Caption.createSubNodes=function(g,d){var f=d.item("id");var h=document.createElement("table");h.cellspacing="0";h.cellpadding="0";h.onclick=function(){};h.ondbclick=function(){};h.onmousedown=function(){};h.onmousemove=function(){};h.onmouseup=function(){};g.appendChild(h);var e=document.createElement("tbody");h.appendChild(e);var a=document.createElement("tr");var b=document.createElement("td");jQuery(e).addClass("sbgrid_caption_tbody");g=SBGrid.CT.BindableControl.createAttribute(g,d);var c=d.item("autoresize");if(null!=c){if("true"==c){jQuery(h).addClass("sbgrid_caption_table")}else{jQuery(h).addClass("sbgrid_caption_table sbgrid_table_fixed")}}else{jQuery(h).addClass("sbgrid_caption_table sbgrid_table_fixed")}jQuery(b).addClass("sbgrid_caption_td");b.setAttribute("id","SBHE_"+f+"_TEXT");if(g.getAttribute("text")){jQuery(b).text(g.getAttribute("text").newlineCharConvert())}a.appendChild(b);e.appendChild(a);return g};SBGrid.CT.Caption.createObject=function(e,c,y,B){var l="";var f="";var A="";var z="";var t="";var p=false;var n="";var s="";var w=false;var r=false;var d="";var a="";var x=9007199254740992;var h="";var b="";var i="";var v=0;var u="visible";var m="";var q=y.getCollection();for(var g in q){switch(g){case"alert":l=q[g];break;case"help":f=q[g];break;case"hint":A=q[g];break;case"text":z=q[g];break;case"accesskey":t=q[g];break;case"autoreisze":if("true"==q[g]){p=true}break;case"bind":n=q[g];break;case"class":s=q[g];break;case"disabled":if("true"==q[g]){w=true}break;case"ellipsis":if("true"==q[g]){r=true}break;case"format":d=q[g];break;case"id":a=q[g];break;case"navindex":x=parseInt(q[g]);break;case"ref":h=q[g];break;case"jsonref":b=q[g];break;case"roundmode":i=q[g];break;case"roundposition":v=parseInt(q[g]);break;case"visibility":u=q[g];break;default:if(!SBGrid.DEF.SB_STYLELIST[g]){m+=g+":"+q[g]+"; "}break}}q=null;var o=new SBGrid.CT.Caption(e,l,f,A,z,t,p,n,s,w,r,d,a,x,h,b,i,v,B,"softbowl:caption",u,m);return o};SBGrid.CT.Caption.createAttribute=function(b,a){b=SBGrid.CT.BindableControl.createAttribute(b,a);b.cellSpacing=0;b.cellPadding=0;return b};SBGrid.CT.Group=function(d,h,e,t,o,m,n,r,b,s,a,f,g,c,l,q,v,u,p,i){if(!b){return}SBGrid.CT.BindableControl.call(this,d,h,e,t,o,m,n,r,b,s,g,c,v,u,p,i);this.m_winPopup=null;this.m_bApplyPadding=false;this.attribute.overflow=a;this.attribute.popup=String(f);this.attribute.scroll=l;this.attribute.showeffect=q;this.selected;this.m_nSelectedRow=-1;this.m_nSelectedCol=-1;this.m_bScoll=false;if(SBGrid.DEF.is_smartphone){this.bIsExpansion=false}};SBGrid.CT.Group.prototype=new SBGrid.CT.BindableControl;SBGrid.CT.Group.prototype.init=function(){SBGrid.CT.BindableControl.prototype.init.call(this);if("xhtml:body"!=this.tag){var a=this.getAttribute("appearance");if("softbowl:input"!=this.tag&&"softbowl:comboinput"!=this.tag&&"minimal"!=a){if(null!=this.m_heCtrl){this.m_heCtrl.setAttribute("onscroll","SBGrid.DEF._W_onProcessEvent(window.event, 'onscroll', this.id.replace('SBHE_', ''))")}}}this.vscroll=new SBGrid.CT.ScrollBar(this.id,this.id+"_vscroll","softbowl:scrollbar","vscroll",-1!=this.attribute.tag.indexOf("datagrid"));this.hscroll=new SBGrid.CT.ScrollBar(this.id,this.id+"_hscroll","softbowl:scrollbar","hscroll",-1!=this.attribute.tag.indexOf("datagrid"));if(null!=this.m_heCtrl){this.vscroll.init();this.hscroll.init();if("softbowl:datagrid"!=this.tag){this.setAttribute("overflow",this.attribute.overflow);if("scroll"==this.attribute.overflow){this.setScroll(this.attribute.scroll)}}var c=this;while(c&&"xhtml:body"!=c.elementName){if("softbowl:datagrid"==c.elementName){bIsDataGrid=true;break}c=c.parent}if("softbowl:group"==this.attribute.tag){if(SBGrid.DEF.is_ie9){jQuery(this.m_heCtrl).removeClass("sbgrid_boxsizing");this.resizing()}}}if(SBGrid.DEF.is_smartphone){if(null!=this.m_heCtrl){this.m_nOriginWidth=this.m_heCtrl.offsetWidth;this.m_nOriginHeight=this.m_heCtrl.offsetHeight;var b=this.elementName;if("softbowl:group"==b){this.makeGroupExpansion()}}}};SBGrid.CT.Group.prototype.resizing=function(){var i=this.m_heCtrl;if(null!=i){var a=SBGrid.DEF.is_ie?i.currentStyle.width:window.getComputedStyle(i,null).width;if(-1==a.indexOf("%")){var e=SBGrid.DEF.is_ie?i.currentStyle.borderLeftWidth:window.getComputedStyle(i,null).borderLeftWidth;var d=SBGrid.DEF.is_ie?i.currentStyle.borderRightWidth:window.getComputedStyle(i,null).borderRightWidth;var f=(parseInt(a)-parseInt(e)-parseInt(d));i.style.width=1>f?parseInt(a):f+"px"}var g=SBGrid.DEF.is_ie?i.currentStyle.height:window.getComputedStyle(i,null).height;if(-1==g.indexOf("%")){var b=SBGrid.DEF.is_ie?i.currentStyle.borderTopWidth:window.getComputedStyle(i,null).borderTopWidth;var c=SBGrid.DEF.is_ie?i.currentStyle.borderBottomWidth:window.getComputedStyle(i,null).borderBottomWidth;var h=(parseInt(g)-parseInt(b)-parseInt(c));i.style.height=1>h?parseInt(g):h+"px"}}};SBGrid.CT.Group.prototype.applyDefaultStyle=function(){};SBGrid.CT.Group.prototype.getAbility=function(){return SBGrid.DEF.SBEA_GROUP};SBGrid.CT.Group.prototype.getPopup=function(){return this.m_winPopup};SBGrid.CT.Group.prototype.isApplyPadding=function(){return this.m_bApplyPadding};SBGrid.CT.Group.prototype.setApplyPadding=function(a){this.m_bApplyPadding=a};SBGrid.CT.Group.prototype.refresh=function(){SBGrid.CT.BindableControl.prototype.refresh.call(this);var b=this.children.getCollection();if(SBGrid.DEF.is_chrome){var d=document.SBHE_allElement.getCollection();for(var e in b){var c=d[e];if(null!=c&&c instanceof SBGrid.CT.Element&&c.refresh){c.refresh()}}b=null}else{var b=this.children.getCollection();for(var a in b){var c=b[a];if(null!=c&&c instanceof SBGrid.CT.Element&&c.refresh){c.refresh()}c=null}b=null}};SBGrid.CT.Group.prototype.setAttribute=function(a,b){SBGrid.CT.BindableControl.prototype.setAttribute.call(this,a,b);switch(a){case"width":if("softbowl:group"==this.attribute.tag){this.resizing()}break;case"height":if("softbowl:group"==this.attribute.tag){this.resizing()}break;case"overflow":this.attribute.overflow=b;this.setOverflow(b);break;case"scroll":this.attribute.scroll=b;this.setScroll(b);break}};SBGrid.CT.Group.prototype.setSelected=function(a){if(a){this.onSelect()}else{this.onDeSelect()}};SBGrid.CT.Group.prototype.onSelect=function(a){this.selected=true;if(null!=this.m_jsonCssEvent.select){var b=this.compareStyle(this.m_jsonCssEvent.select);this.m_heCtrl.style.cssText=b}};SBGrid.CT.Group.prototype.onDeSelect=function(a){this.selected=false;if(null!=this.m_jsonCssEvent.normal){this.m_heCtrl.style.cssText=this.m_jsonCssEvent.normal}};SBGrid.CT.Group.prototype.setScroll=function(a){if("softbowl:datagrid"==this.tag){this.setScrollGrid(a);return}switch(a){case"vertical":this.m_heCtrl.style.overflowX="hidden";this.m_heCtrl.style.overflowY="scroll";break;case"horizontal":this.m_heCtrl.style.overflowX="scroll";this.m_heCtrl.style.overflowY="hidden";break;case"both":this.m_heCtrl.style.overflowX="scroll";this.m_heCtrl.style.overflowY="scroll";break;case"autovscroll":this.m_heCtrl.style.overflowX="hidden";this.m_heCtrl.style.overflowY="auto";break;case"autohscroll":this.m_heCtrl.style.overflowX="auto";this.m_heCtrl.style.overflowY="hidden";break;case"none":this.m_heCtrl.style.overflowX="visible";this.m_heCtrl.style.overflowY="visible";break;default:if(SBGrid.DEF.is_chrome){this.m_heCtrl.style.overflowX="";this.m_heCtrl.style.overflowY=""}else{this.m_heCtrl.style.overflowX="auto";this.m_heCtrl.style.overflowY="auto";if("softbowl:textarea"==this.tag){this.m_heCtrl.style.overflowX="hidden";this.m_heCtrl.style.overflowY="auto"}}break}};SBGrid.CT.Group.prototype.setOverflow=function(a){if("softbowl:datagrid"==this.tag){this.setOverflowGrid(a);return}switch(a){case"visible":this.m_heCtrl.style.overflowX="visible";this.m_heCtrl.style.overflowY="visible";break;case"hidden":this.m_heCtrl.style.overflowX="hidden";this.m_heCtrl.style.overflowY="hidden";break;case"scroll":this.m_heCtrl.style.overflowX="auto";this.m_heCtrl.style.overflowY="auto";break;default:break}};SBGrid.CT.Group.prototype.overflow=function(){var g=0;var b=0;var a=this;while("xhtml:body"!=a.elementName){if(null!=a.m_heCtrl){g+=a.m_heCtrl.offsetLeft;b+=a.m_heCtrl.offsetTop}a=a.parent}g+=this.m_heCtrl.offsetWidth;b+=this.m_heCtrl.offsetHeight;a=this.parent;if("xhtml:html"==a.elementName){return}var f=0;var d=0;while("xhtml:body"!=a.elementName){if("softbowl:group"==a.elementName&&("visible"==a.getAttribute("overflow"))){if(null!=a.m_heCtrl){f=a.m_heCtrl.offsetLeft+a.m_heCtrl.offsetWidth;f=a.m_heCtrl.offsetTop+a.m_heCtrl.offsetHeight;var e=(g>f)?g:f;var c=(b>d)?b:d;a.setAttribute("width",e-a.m_heCtrl.offsetLeft);a.setAttribute("height",c-a.m_heCtrl.offsetTop)}}a=a.parent}};SBGrid.CT.Group.prototype.childReturnObj=function(b){var a=this.children.item(b);if(null!=a){return a}else{return null}};SBGrid.CT.Group.prototype.isChild=function(b){var a=this.children.item(b);if(null!=a){return true}else{return false}};SBGrid.CT.Group.prototype.isDescendants=function(d,a){if(null==a){a=false}var c=document.SBHE_allElement.item(d);if(null!=c){if(true==a){if(c==this){return true}}var b=c.parent;while(null!=b){if(b==this){return true}b=b.parent}return false}return false};SBGrid.CT.Group.prototype.setSelectedRow=function(a){this.m_nSelectedRow=a;this.attribute.row=a};SBGrid.CT.Group.prototype.setSelectedCol=function(a){this.m_nSelectedCol=a;this.attribute.col=a};SBGrid.CT.Group.prototype.getCellById=function(a){return this.children.m_htCollection[a]};SBGrid.CT.Group.prototype.getCell=function(a,c){var b=this.id+"_"+a+"_"+c;return this.children.m_htCollection[b]};SBGrid.CT.Group.prototype.isCell=function(b){var a=this.children.item(b);if(null!=a){return(this==a.parent)}return false};SBGrid.CT.Group.prototype.isScrollBar=function(c){var b=this.getClientLeft()+this.m_heCtrl.offsetWidth;var a=this.getClientTop()+this.m_heCtrl.offsetHeight;if(this._isVScroll()&&b-15<=c.clientX&&c.clientX<=b){return true}if(this._isHScroll()&&a-15<=c.clientY&&c.clientY<=a){return true}return false};SBGrid.CT.Group.prototype.isDragCellSelect=function(c,d,b){if(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11){return}if(b.selected){var a=this.getCellContentRect(c,d);if((a.getBottom()-6)<=SBGrid.DEF.m_event.y){return true}}return false};SBGrid.CT.Group.prototype._isVScroll=function(){return this.m_heCtrl.clientHeight<this.m_heCtrl.scrollHeight};SBGrid.CT.Group.prototype._isHScroll=function(){return this.m_heCtrl.clientWidth<this.m_heCtrl.scrollWidth};SBGrid.CT.Group.prototype.getMouseRow=function(){return this.getAttribute("row")};SBGrid.CT.Group.prototype.setMouseRow=function(a){this.setAttribute("row",a)};SBGrid.CT.Group.prototype.getMouseCol=function(){return this.getAttribute("col")};SBGrid.CT.Group.prototype.setMouseCol=function(a){this.setAttribute("col",a)};SBGrid.CT.Group.create=function(a,d,e){d=SBGrid.CT.Element.createClassName(d,"group");var c=SBGrid.CT.Group.createMainNode(d);var b=document.getElementById(a);if(!b){b=document.getElementById("SBHE_"+a)}if(!b){return}b.appendChild(c);c=SBGrid.CT.Group.createSubNodes(c,d);return SBGrid.CT.Group.createObject(a,c,d,e)};SBGrid.CT.Group.createMainNode=function(b){var a=document.createElement("div");a=SBGrid.CT.Group.createAttribute(a,b);jQuery(a).addClass("sbgrid_group");jQuery(a).addClass("sbgrid_boxsizing");return a};SBGrid.CT.Group.createSubNodes=function(a,b){return a};SBGrid.CT.Group.createObject=function(c,l,x,z){var i="";var d="";var y="";var s="";var o="";var r="";var v=false;var a="";var w=9007199254740992;var h="scroll";var f=false;var g="";var b="";var n="auto";var u="blend 300";var t="visible";var m="";var p=x.getCollection();for(var e in p){switch(e){case"alert":i=p[e];break;case"help":d=p[e];break;case"hint":y=p[e];break;case"accesskey":s=p[e];break;case"bind":o=p[e];case"class":r=p[e];break;case"disabled":if("true"==p[e]){v=true}break;case"id":a=p[e];break;case"navindex":w=parseInt(p[e]);break;case"overflow":h=p[e];break;case"popup":if("true"==p[e]){f=true}break;case"ref":g=p[e];break;case"jsonref":b=p[e];break;case"scroll":n=p[e];break;case"showeffect":u=p[e];break;case"visibility":t=p[e];break;default:if(!SBGrid.DEF.SB_STYLELIST[e]){m+=e+":"+p[e]+"; "}break}}p=null;var q=new SBGrid.CT.Group(c,i,d,y,s,o,r,v,a,w,h,f,g,b,n,u,z,"softbowl:group",t,m);return q};SBGrid.CT.Group.createAttribute=function(b,a){b=SBGrid.CT.BindableControl.createAttribute(b,a);return b};SBGrid.CT.Group.prototype.makeGroupExpansion=function(){var a=document.getElementById("__GROUP_EXPANSION_"+this.id);if(null==a){a=document.createElement("image");a.setAttribute("onclick",'SBGrid.CT.Group.onClickExpansion(event, "'+this.id+'")');a.setAttribute("id","__GROUP_EXPANSION_"+this.id);a.setAttribute("src",SBGrid.DEF.__getAppName()+SBGrid.DEF.imgGolbalExpansion);a.style.position="absolute";a.style.top=(this.m_heCtrl.offsetTop+this.m_heCtrl.offsetHeight-20)+"px";a.style.left=(this.m_heCtrl.offsetLeft+this.m_heCtrl.offsetWidth-20)+"px";if("visible"==this.getAttribute("overflow")||"hidden"==this.getAttribute("overflow")){a.style.display="none"}document.body.appendChild(a)}};SBGrid.CT.Group.prototype.getOffsetLeft=function(){var a=this.elementName;var b=this;var c=0;while("xhtml:body"!=a){c+=b.m_heCtrl.offsetLeft;b=b.parent;a=b.elementName}return c};SBGrid.CT.Group.prototype.getOffsetTop=function(){var a=this.elementName;var c=this;var b=0;while("xhtml:body"!=a){b+=c.m_heCtrl.offsetTop;c=c.parent;a=c.elementName}return b};SBGrid.CT.Group.prototype.moveGroupExpansion=function(){if(SBGrid.DEF.is_smartphone){if(this.bIsExpansion){var d=document.getElementById("__GROUP_EXPANSION_"+this.id);if(null!=d){var g=this.getOffsetLeft()+this.m_heCtrl.offsetWidth;var e=this.getOffsetTop()+this.m_heCtrl.offsetHeight;var b=window.scrollX+window.innerWidth;var h=window.scrollY+window.innerHeight;var f=this.m_heCtrl.offsetLeft;var a=this.m_heCtrl.offsetTop;var c=(g>b)?b:g;var i=(e>h)?h:e;c=(f<c)?c:f;i=(a<i)?i:a;d.style.top=(i-20)+"px";d.style.left=(c-20)+"px"}}}};SBGrid.CT.Group.onClickExpansion=function(a,h){var g=document.SBHE_allElement.item(h);var m=document.getElementById("SBHE_"+h);var d=document.getElementById("__GROUP_EXPANSION_"+h);if(null!=m){if(!g.bIsExpansion){var f=(g.m_nOriginWidth>m.scrollWidth)?g.m_nOriginWidth:m.scrollWidth;var o=(g.m_nOriginHeight>m.scrollHeight)?g.m_nOriginHeight:m.scrollHeight;m.style.width=f+"px";m.style.height=o+"px";g.setAttribute("overflow","visible");g.bIsExpansion=true;d.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgGlobalReturn;var b=window.scrollX+window.innerWidth;var l=window.scrollY+window.innerHeight;var i=g.m_heCtrl.offsetLeft+m.offsetWidth;var e=g.m_heCtrl.offsetTop+m.offsetHeight;var c=((i>b)?b:i);var n=((e>l)?l:e);d.style.left=((c-20)<0)?"0px":(c-20)+"px";d.style.top=((n-20)<0)?"0px":(n-20)+"px"}else{m.style.width=g.m_nOriginWidth+"px";m.style.height=g.m_nOriginHeight+"px";g.setAttribute("overflow","hidden");g.bIsExpansion=false;d.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgGlobalExpansion;d.style.left=(g.m_heCtrl.offsetLeft+m.offsetWidth-20)+"px";d.style.top=(g.m_heCtrl.offsetTop+m.offsetHeight-20)+"px"}}};SBGrid.CT.ScrollBar=function(a,e,c,d,b){if(!a){return}SBGrid.CT.Control.call(this,a,"","","","","",false,e,10000,"",c,"","");this.attribute.min="0";this.attribute.max="0";this.attribute.pos="0";this.is_bGrid=b;this.m_strType=d;this.m_targetControl=null;this.nPrevScrollPositon=0;this.nPrevMax=0};SBGrid.CT.ScrollBar.prototype=new SBGrid.CT.Control;SBGrid.CT.ScrollBar.prototype.init=function(){if(null!=this.parent){if(null!=this.parent.m_heCtrl){if(!this.is_bGrid){this.m_targetControl=this.parent.m_heCtrl}else{this.m_targetControl=document.getElementById("SBHE_DATAGRID_WHOLE_"+this.parent.id)}if(null!=this.m_targetControl){if("vscroll"==this.m_strType){this.attribute.max=parseInt(this.m_targetControl.scrollHeight-this.m_targetControl.clientHeight);this.attribute.pos=parseInt(this.m_targetControl.scrollTop)}else{this.attribute.max=parseInt(this.m_targetControl.scrollWidth-this.m_targetControl.clientWidth);this.attribute.pos=parseInt(this.m_targetControl.scrollLeft)}}}}};SBGrid.CT.ScrollBar.prototype.setAttribute=function(a,b){switch(a){case"pos":this.attribute.pos=b;if(null!=this.m_targetControl){if("vscroll"==this.m_strType){this.m_targetControl.scrollTop=parseInt(b)}else{this.m_targetControl.scrollLeft=parseInt(b)}}break}};SBGrid.CT.ScrollBar.prototype.refresh=function(){if(null==this.m_targetControl){this.init();return}if(null!=this.m_targetControl){if("vscroll"==this.m_strType){this.attribute.max=parseInt(this.m_targetControl.scrollHeight-this.m_targetControl.clientHeight);this.attribute.pos=parseInt(this.m_targetControl.scrollTop)}else{this.attribute.max=parseInt(this.m_targetControl.scrollWidth-this.m_targetControl.clientWidth);this.attribute.pos=parseInt(this.m_targetControl.scrollLeft)}}};SBGrid.CT.ScrollBar.prototype.getScrollPosition=function(){return this.attribute.pos};SBGrid.CT.ScrollBar.prototype.getScrollMax=function(){return this.attribute.max};SBGrid.CT.ScrollBar.prototype.setScrollPosition=function(a){this.attribute.pos=parseInt(a);if(a!=this.nPrevScrollPositon){if(a<this.nPrevScrollPositon){this.dispatch("onscrollup")}else{this.dispatch("onscrolldown")}this.nPrevScrollPositon=a}};SBGrid.CT.ScrollBar.prototype.setScrollMax=function(a){this.attribute.max=parseInt(a)};SBGrid.CT.ScrollBar.prototype.getPrevScrollPosition=function(){return this.nPrevScrollPositon};SBGrid.CT.DIV=function(d,h,e,u,q,n,p,s,b,t,a,f,o,c,g,m,l,i,w,v,r){if(!b){return}SBGrid.CT.Group.call(this,d,h,e,u,q,"",p,s,b,t,a,"","","",i,"",w,v,r);this.m_bShowPopupMenu=true;this.m_bSetPopupMenu=false};SBGrid.CT.DIV.prototype=new SBGrid.CT.Group;SBGrid.CT.DIV.prototype.init=function(){if(null==this.m_heCtrl){this.m_heCtrl=document.getElementById(this.id)}SBGrid.CT.Group.prototype.init.call(this);if(this.m_strClass&&this.m_strClass!=""){if(this.m_heCtrl){var a=jQuery(this.m_heCtrl);a.addClass("sb_div");a=null}}};SBGrid.CT.DIV.create=function(b,m,a){var g="";var p="";var q="";var c="";var d="";var e=false;var n="";var s=9007199254740992;var i="none";var l="visible";var f="";var h=m.getCollection();for(var o in h){switch(o){case"alert":g=h[o];break;case"help":p=h[o];break;case"hint":q=h[o];break;case"accesskey":c=h[o];break;case"class":d=h[o];break;case"disabled":if("true"==h[o]){e=true}break;case"id":n=h[o];break;case"navindex":s=parseInt(h[o]);break;case"visibility":l=h[o];break;default:if(!SBGrid.DEF.SB_STYLELIST[o]){f+=o+":"+h[o]+"; "}break}}h=null;var r=new SBGrid.CT.DIV(b,g,p,q,c,true,d,e,n,s,"","","","","","","",i,a,"softbowl:DIV",l);return r};SBGrid.CT.DIV.createAttribute=function(b,a){b=SBGrid.CT.Group.createAttribute(b,a);return b};SBGrid.CT.DataGridCell=function(a,e,d,b,c){this.elementName=c;this.id=d;this.tag=c;this.col=e;this.row=b;this.parent=a;this.attribute={};this.rowstatus=SBGrid.DEF.SBGS_NEW;this.colstatus=true;this.mergeType=SBGrid.DEF.SBSM_NORMAL;this.mergeParentId=null;this.m_bMerge=true;this.m_nRowSpan=1;this.m_nColSpan=1;this.m_fixedInputType=SBGrid.DEF.SBIT_OUTPUT;this.m_fixedCheckStatus=false;this.m_xnNodeElement;this.m_jsonObject;this.m_bIsSubTotal=false;this.m_heCtrl=null;this.m_heDCtrl=null;this.m_objElement=null;this.attribute.id=d;this.attribute.tag=c;this.editing=false;this.selected=false;this.isReadOnly=false;this.disabled=false;this.m_bIsHidden=false;this.m_bMergeByFree=false;this.setParent();a=null;e=null;d=null;b=null;c=null};SBGrid.CT.DataGridCell.prototype.setParent=function(){this.parent.children.add(this.id,this);document.SBHE_allElement.add(this.id,this)};SBGrid.CT.DataGridCell.prototype.getHtmlElement=function(){return this.m_heCtrl};SBGrid.CT.DataGridCell.prototype.setHtmlElement=function(a){this.m_heCtrl=a};SBGrid.CT.DataGridCell.prototype.getNodeElement=function(){return this.m_xnNodeElement};SBGrid.CT.DataGridCell.prototype.setIndex=function(a){this.index=a};SBGrid.CT.DataGridCell.prototype.getElement=function(){if(this.m_objElement){this.m_objElement.setRefElement(this)}return this.m_objElement};SBGrid.CT.DataGridCell.prototype.setElement=function(a){this.m_objElement=a};SBGrid.CT.DataGridCell.prototype.getAttribute=function(a){return this.attribute[a]};SBGrid.CT.DataGridCell.prototype.setAttribute=function(a,b){this.attribute[a]=b};SBGrid.CT.DataGridCell.prototype.getId=function(){return this.attribute.id};SBGrid.CT.DataGridCell.prototype.getClientLeft=function(a){var b=0;var c=this.m_heCtrl;while(null!=c){b+=c.offsetLeft;if(c!=this.m_heCtrl){b+=c.clientLeft}if(a&&c!=document.body){b-=(SBGrid.DEF.is_android?0:c.scrollLeft)}c=c.offsetParent}return b};SBGrid.CT.DataGridCell.prototype.getClientTop=function(a){var c=0;var b=this.m_heCtrl;while(null!=b){c+=b.offsetTop;if(b!=this.m_heCtrl){c+=b.clientTop}if(a&&b!=document.body){c-=(SBGrid.DEF.is_android?0:b.scrollTop)}b=b.offsetParent}return c};SBGrid.CT.DataGridCell.prototype.getDisabled=function(){return this.disabled};SBGrid.CT.DataGridCell.prototype.setDisabled=function(a){this.disabled=a};SBGrid.CT.DataGridCell.prototype.getHidden=function(){return this.m_bIsHidden};SBGrid.CT.DataGridCell.prototype.setHidden=function(a){this.m_bIsHidden=a};SBGrid.CT.DataGridCell.prototype.getNodeElement=function(){return this.m_xnNodeElement};SBGrid.CT.DataGridCell.prototype.setNodeElement=function(a){this.m_xnNodeElement=a};SBGrid.CT.DataGridCell.prototype.setImage=function(h,c,e,b,d,i){var a=this.getElement();if(this.m_heDCtrl){if(null==h){h=""}else{var g=0;d="max-width:"+this.parent.getColWidth(this.col).toString()+"px;"+d;if(isNaN(this.parent.getRowHeight(this.row))){d="max-height:"+(this.parent.dataHeight-1).toString()+"px;"+d}else{d="max-height:"+(this.parent.getRowHeight(this.row)-1).toString()+"px;"+d}if(h!=""&&h!="undefined"){var f="<img src='"+h+"' align='center' height='"+b+"' width='"+e+"' style='"+d+"' alt='"+i+"'";if(c!=""&&c!="undefined"&&c!=null){f+="onclick='"+c+"();'"}f+="title='"+i+"'/>";jQuery(this.m_heDCtrl).html(f)}else{var f="<div style='margin: 0 auto; height: "+b+"; width:"+e+"; '";if(c!=""&&c!="undefined"&&c!=null){f+="onclick='"+c+"();'"}f+=">&nbsp;</div>";jQuery(this.m_heDCtrl).html(f)}}}};SBGrid.CT.DataGridCell.prototype.setWindowText=function(h,c,g){var b=this.getElement();if(this.m_heDCtrl){if(null==h){h=""}if(c){if(null==h){h=""}h=h.formatting(g)}else{if(null==h){h=""}g=b.getAttribute("format");var i=this.parent.m_htCellFormat[this.id];g=null!=i?i:g;i=null;if(g!=""){var e=b.attribute.defaultValue;if(""==h&&-1!=g.indexOf("0.0")){if(null==e){h="0".formatting(g)}}else{if(null==e){h=h.formatting(g)}else{var f=h.formatting(g);if(""!=f){h=f}}}if(4==SBGrid.DEF.formatStatus(g)){if(""!=b.attribute.roundmode&&""!=b.attribute.roundposition){h=SBGrid.DEF.getRoundMode(h,b.attribute.roundmode,b.attribute.roundposition)}}}}if(b.m_fnRenderer){h=b.m_fnRenderer.call(this,b.parent.id,this.row,this.col,h,this.m_jsonObject);var a=jQuery(this.m_heDCtrl);a.html('<span style="white-space:nowrap;">'+h+"</span>");a=null;if(b.m_fnAfterRenderer){b.m_fnAfterRenderer.call(this,b.parent.id,this.row,this.col,h,this.m_jsonObject)}}else{if(this.parent.autoResize){var a=jQuery(this.m_heDCtrl);a.html(h.newlineCharConvert());a=null}else{if(this.m_heDCtrl.childNodes!=null){var d=this.m_heDCtrl.childNodes.item(0);if(d!=null){if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7||SBGrid.DEF.is_ie8||(document.documentMode&&document.documentMode<9)){h=h.replace(new RegExp("\n","gi")," ");if(d.innerText!=h){d.innerText=h}}else{if(d.textContent!=h){d.textContent=h}}d=null}}}}}};SBGrid.CT.DataGridCell.prototype.setWindowTextGroup=function(h,d,g){var f=this.getElement();if(this.m_heDCtrl){if(null==h){h=""}if(d){if(null==h){h=""}h=h.formatting(g)}else{if(null==h){h=""}g=f.getAttribute("format");var c=this.parent.m_htCellFormat[this.id];g=null!=c?c:g;c=null;if(g!=""){var b=f.attribute.defaultValue;if(""==h&&-1!=g.indexOf("0.0")){if(null==b){h="0".formatting(g)}}else{if(null==b){h=h.formatting(g)}else{var a=h.formatting(g);if(""!=a){h=a}}}if(4==SBGrid.DEF.formatStatus(g)){if(""!=f.attribute.roundmode&&""!=f.attribute.roundposition){h=SBGrid.DEF.getRoundMode(h,f.attribute.roundmode,f.attribute.roundposition)}}}}if(f.m_fnRenderer){h=f.m_fnRenderer.call(this,f.parent.id,this.row,this.col,h,this.m_jsonObject);var e=jQuery(this.m_heDCtrl);e.html('<span style="white-space:nowrap;">'+h+"</span>");e=null;if(f.m_fnAfterRenderer){f.m_fnAfterRenderer.call(this,f.parent.id,this.row,this.col,h,this.m_jsonObject)}return}var e=jQuery(this.m_heDCtrl);if(this.parent.autoResize){e.html(h.newlineCharConvert())}else{e.html('<span style="white-space:nowrap;">'+h+"</span>")}e=null}};SBGrid.CT.DataGridCell.prototype.setBoolState=function(f,c,a,e){this.boolstate=f;if(c){SBGrid.CF.GridSetText(this,strValue)}if(null!=this.m_heCtrl){var b=this.m_heCtrl.firstChild;if(b){var d=this.m_objElement;if(SBGrid.DEF.SBIT_CHECK==d.getInputType()){if(this.disabled){b.src=this.boolstate?d.getAttribute("checkdisabledimage"):d.getAttribute("uncheckdisabledimage")}else{b.src=this.boolstate?d.getAttribute("checkimage"):d.getAttribute("uncheckimage")}}else{if(SBGrid.DEF.SBIT_RADIO==d.getInputType()){if(this.disabled){b.src=this.boolstate?d.getAttribute("selectdisabledimage"):d.getAttribute("unselectdisabledimage")}else{b.src=this.boolstate?d.getAttribute("selectimage"):d.getAttribute("unselectimage")}}}d=null}b=null}};SBGrid.CT.DataGridCell.prototype.getStatus=function(){return this.rowstatus};SBGrid.CT.DataGridCell.prototype.setStatus=function(a){this.rowstatus=a};SBGrid.CT.DataGridCell.prototype.getColStatus=function(){return this.colstatus};SBGrid.CT.DataGridCell.prototype.setColStatus=function(a){this.colstatus=a};SBGrid.CT.DataGridCell.prototype.setEditingMode=function(a){this.editing=a};SBGrid.CT.DataGridCell.prototype.getJsonObject=function(){return this.m_jsonObject};SBGrid.CT.DataGridCell.prototype.setJsonObject=function(a){this.m_jsonObject=a};SBGrid.CT.DataGridCell.prototype.getIsReadOnly=function(){return this.isReadOnly||this.disabled};SBGrid.CT.DataGridCell.prototype.getMergeByFree=function(){return this.m_bMergeByFree};SBGrid.CT.SelectCell=function(a,e,d,b,c){this.elementName=c;this.id=d;this.tag=c;this.col=e;this.row=b;this.parent=a;this.attribute={};this.m_heCtrl=null;this.m_objElement=null;this.attribute.id=d;this.attribute.tag=c;this.selected=false;a=null;e=null;d=null;b=null;c=null};SBGrid.CT.SelectCell.prototype.setIndex=function(a){this.index=a};SBGrid.CT.SelectCell.prototype.getElement=function(){if(this.m_objElement){this.m_objElement.setRefElement(this)}return this.m_objElement};SBGrid.CT.SelectCell.prototype.setElement=function(a){this.m_objElement=a};SBGrid.CT.SelectCell.prototype.getAttribute=function(a){return this.attribute[a]};SBGrid.CT.SelectCell.prototype.getId=function(){return this.id};SBGrid.CT.SelectCell.prototype.getClientLeft=function(a){var b=0;var c=this.m_heCtrl;while(null!=c){b+=c.offsetLeft;if(c!=this.m_heCtrl){b+=c.clientLeft}if(a&&c!=document.body){b-=(SBGrid.DEF.is_android?0:c.scrollLeft)}c=c.offsetParent}return b};SBGrid.CT.SelectCell.prototype.getClientTop=function(a){var c=0;var b=this.m_heCtrl;while(null!=b){c+=b.offsetTop;if(b!=this.m_heCtrl){c+=b.clientTop}if(a&&b!=document.body){c-=(SBGrid.DEF.is_android?0:b.scrollTop)}b=b.offsetParent}return c};SBGrid.CT.SelectCell.prototype.getDisabled=function(){return this.disable};SBGrid.CT.SelectCell.prototype.setDisabled=function(a){this.disable=a};SBGrid.CT.SelectCell.prototype.getAttribute=function(a){return this.attribute[a]};SBGrid.CT.SelectCell.prototype.setAttribute=function(b,c){if(SBGrid.DEF.SB_STYLELIST[b]){this.attribute[b]=c;var a=SBGrid.DEF.findToMakeStyleSheet(this.id+"_Attr");SBGrid.UT.HtmlLib.setStyle(a,b,c)}};SBGrid.CT.SelectCell.prototype.initStyle=function(a){if(SBGrid.DEF.SB_STYLELIST[a]){this.attribute[a]="";var b=SBGrid.DEF.findToMakeStyleSheet(this.id+"_Attr");SBGrid.UT.HtmlLib.setStyle(b,a,"")}};SBGrid.CT.Cell=function(a,e,d,b,c){if(!a){return}SBGrid.CT.Attribute.call(this,a,d,c);this.col=e;this.row=b;this.rowstatus=SBGrid.DEF.SBGS_NEW;this.colstatus=true;this.mergeType=SBGrid.DEF.SBSM_NORMAL;this.mergeParentId=null;this.m_nRowSpan=1;this.m_nColSpan=1;this.m_fixedInputType=SBGrid.DEF.SBIT_OUTPUT;this.m_fixedCheckStatus=false;this.m_xnNodeElement;this.m_jsonObject;this.m_heCtrl;this.m_heDCtrl=null;this.m_objOldCellStyle={};this.m_objCellStyle={};this.m_bIsSubTotal=false;this.editing=false;this.down=false;this.disable=false;this.hover=false;this.selected=false;this.isReadOnly=false;this.m_bIsHidden=false;this.expanded=0;this.checked=0;this.m_nChildNumber=-1;this.m_strRecursion="";this.index=-1;this.text=""};SBGrid.CT.Cell.prototype=new SBGrid.CT.Attribute;SBGrid.CT.Cell.prototype.init=function(){this.m_heCtrl=document.getElementById("SBHE_"+this.id);var b=document.getElementById(this.id+"_data");if(b){this.m_heDCtrl=b;b=null}var c=this.getElement();if("softbowl:col"!=c.elementName&&"softbowl:gridfixedcell"!=c.elementName){for(var a in c.attr){if(SBGrid.DEF.SB_STYLELIST[a]){this.setAttribute(a,c.attribute[a])}}}};SBGrid.CT.Cell.prototype.unInit=function(){this.m_heCtrl=null;this.m_heDCtrl=null};SBGrid.CT.Cell.prototype.applyDefaultStyle=function(){};SBGrid.CT.Cell.prototype.getInputType=function(){if(null!=this.m_objElement){return this.m_objElement.getInputType()}return SBGrid.DEF.SBIT_OUTPUT};SBGrid.CT.Cell.prototype.getMergeType=function(){return this.mergeType};SBGrid.CT.Cell.prototype.getHtmlElement=function(){return this.m_heCtrl};SBGrid.CT.Cell.prototype.setHtmlElement=function(a){this.m_heCtrl=a};SBGrid.CT.Cell.prototype.getNodeElement=function(){return this.m_xnNodeElement};SBGrid.CT.Cell.prototype.setNodeElement=function(a){this.m_xnNodeElement=a};SBGrid.CT.Cell.prototype.getJsonObject=function(){return this.m_jsonObject};SBGrid.CT.Cell.prototype.setJsonObject=function(a){this.m_jsonObject=a};SBGrid.CT.Cell.prototype.getText=function(){if(this.m_jsonObject){return this.m_jsonObject[this.m_objElement.attribute.ref]+""}else{if(this.m_xnNodeElement){return SBGrid.UT.XmlLib.getTextValue(this.m_xnNodeElement)}else{var a=SBGrid.CT.Caption.prototype.getText.call(this);if(a){return a}}}return""};SBGrid.CT.Cell.prototype.getIsReadOnly=function(){return this.isReadOnly||this.disable};SBGrid.CT.Cell.prototype.getHidden=function(){return this.m_bIsHidden};SBGrid.CT.Cell.prototype.setText=function(a){if(this.m_jsonObject){this.m_jsonObject[this.m_objElement.attribute.ref]=a+""}else{if(this.m_xnNodeElement){SBGrid.UT.XmlLib.setTextValue(this.m_xnNodeElement,a)}else{SBGrid.CT.ElementBase.prototype.setText.call(this,a)}}};SBGrid.CT.Cell.prototype.setFixedWindowText=function(b){if(null==this.m_heCtrl){return}var a=this.m_heCtrl.lastChild;if(a){if(this.parent.autoResize){jQuery(a).html(b)}else{if("NOBR"==a.tagName){jQuery(a).html(b)}else{jQuery(a).html('<span style="white-space:nowrap;">'+b+"</span>")}}}a=null};SBGrid.CT.Cell.prototype.getWindowText=function(){return jQuery(this.m_heCtrl).text()};SBGrid.CT.Cell.prototype.setWindowText=function(l,c,h){var b=this.getElement();if(this.m_heDCtrl){if(null==l){l=""}if(c){if(null==l){l=""}l=l.formatting(h)}else{if(null==l){l=""}h=this.m_objElement.getAttribute("format");l=l.formatting(h)}if(l==jQuery(this.m_heDCtrl).text()){return}if(""!=l&&(-1!=b.attribute.secretendposition||-1!=b.attribute.secretstartposition)){var d=-1==b.attribute.secretstartposition?0:b.attribute.secretstartposition;var a=-1==b.attribute.secretendposition?l.length:b.attribute.secretendposition;if(a>d){var m=b.attribute.secretmark;var g=l.substr(0,d);var e=l.substr(a,l.length);for(var f=d;f<a;f++){g+=m}l=g+e}}if(this.parent.autoResize){jQuery(this.m_heDCtrl).html(l)}else{jQuery(this.m_heDCtrl).html('<span style="white-space:nowrap;">'+l+"</span>")}}};SBGrid.CT.Cell.prototype.setImage=function(b){var a=this.getElement();if(this.m_heDCtrl){if(null==b){b=""}else{jQuery(this.m_heDCtrl).html("<img src='"+b+"'/>")}}};SBGrid.CT.Cell.prototype.setTextRefresh=function(a){var d=a;if(null!=a){var c=this.getElement();if(SBGrid.DEF.SBIT_CHECK==this.getInputType()||SBGrid.DEF.SBIT_RADIO==this.getInputType()){if(c){var f=(a==c.getTrueValue())?true:false;var e=f?c.getTrueValue():c.getFalseValue();if(f){c.m_nBeforeSelectRow=this.row}this.setBoolState(f);this.setWindowText(a)}}else{if(SBGrid.DEF.SBIT_COMBO==this.getInputType()){if(c){if(c.m_bIsCellCombo&&c.m_objCombo.isnodeset){var b=this.getAttribute("nodeset");if(null!=b){c.m_objCombo.nodeset=b;c.m_objCombo.reBuild()}else{if(null!=c.m_strComboNodeSet&c.m_strComboNodeSet!=c.m_objCombo.nodeset){c.m_objCombo.nodeset=c.m_strComboNodeSet;c.m_objCombo.reBuild()}}}d=c.m_objCombo.getLableByValue(a);this.setWindowText(d)}}else{if(SBGrid.DEF.SBIT_IMAGE==this.getInputType()){this.setImage(a)}else{this.setWindowText(a)}}}}if("label"==this.parent.m_strTooltip){if(null!=this.m_heCtrl){this.m_heCtrl.title=d}}else{if("true"==this.parent.m_strTooltip){if(null!=this.m_heCtrl){this.m_heCtrl.title=a}}}};SBGrid.CT.Cell.prototype.getSelect=function(){return this.selected};SBGrid.CT.Cell.prototype.setSelect=function(a){this.selected=a;if(this.parent instanceof SBGrid.CT.DataGrid){}else{var b=this.getElement();if(null!=b){b.setSelect(a)}}};SBGrid.CT.Cell.prototype.getDisabled=function(){return this.disable};SBGrid.CT.Cell.prototype.setDisabled=function(a){if(null!=this.m_heCtrl){this.m_heCtrl.setAttribute("disabled",String(a))}this.disable=a};SBGrid.CT.Cell.prototype.getBoolState=function(){var c=this.getText();var b=this.m_objElement.getTrueValue();var a=this.m_objElement.getFalseValue();if(c==b){this.boolstate=true}else{if(c==a){this.boolstate=false}}return this.boolstate};SBGrid.CT.Cell.prototype.setBoolState=function(e,c,a,d){this.boolstate=e;if(c){this.setText(strValue)}var b=this.m_heCtrl.firstChild;if(b){if(SBGrid.DEF.SBIT_CHECK==this.getInputType()){b.src=this.boolstate?this.m_objElement.getAttribute("checkimage"):this.m_objElement.getAttribute("uncheckimage")}else{if(SBGrid.DEF.SBIT_RADIO==this.getInputType()){b.src=this.boolstate?this.m_objElement.getAttribute("selectimage"):this.m_objElement.getAttribute("unselectimage")}}}};SBGrid.CT.Cell.prototype.getStatus=function(){return this.rowstatus};SBGrid.CT.Cell.prototype.setStatus=function(a){this.rowstatus=a};SBGrid.CT.Cell.prototype.getColStatus=function(){return this.colstatus};SBGrid.CT.Cell.prototype.setColStatus=function(a){this.colstatus=a};SBGrid.CT.Cell.prototype.setEditingMode=function(a){this.editing=a};SBGrid.CT.Cell.prototype.changeRowHeadUpdate=function(b){var a=this.m_heCtrl.firstChild;if(null!=a){switch(b){case SBGrid.DEF.SBGS_INSERT:case SBGrid.DEF.SBGS_INSERTANDNEW:a.src=this.parent.m_strInsertFlagImage;break;case SBGrid.DEF.SBGS_UPDATE:a.src=this.parent.m_strUpdateFlagImage;break;case SBGrid.DEF.SBGS_DELETE:case SBGrid.DEF.SBGS_DELETEANDUPDATE:a.src=this.parent.m_strDeleteFlagImage;break;default:a.src=this.parent.m_strNormalFlagImage;break}}};SBGrid.CT.Cell.prototype.getClientLeft=function(a){var b=0;var c=this.m_heCtrl;while(null!=c){b+=c.offsetLeft;if(c!=this.m_heCtrl){b+=c.clientLeft}if(a&&c!=document.body){b-=(SBGrid.DEF.is_android?0:c.scrollLeft)}c=c.offsetParent}return b};SBGrid.CT.Cell.prototype.getClientTop=function(a){var c=0;var b=this.m_heCtrl;while(null!=b){c+=b.offsetTop;if(b!=this.m_heCtrl){c+=b.clientTop}if(a&&b!=document.body){c-=(SBGrid.DEF.is_android?0:b.scrollTop)}b=b.offsetParent}return c};SBGrid.CT.Cell.prototype.setFixedCheck=function(b){if(SBGrid.DEF.SBIT_CHECK==this.m_objElement.getInputType()){var a=b?this.m_objElement.getTrueValue():this.m_objElement.getFalseValue();this.setBoolState(b);this.setText(a)}};SBGrid.CT.Cell.prototype.setFixedInputType=function(a){this.m_fixedInputType=a};SBGrid.CT.Cell.prototype.getFixedInputType=function(){return this.m_fixedInputType};SBGrid.CT.Cell.prototype.getLabel=function(){return this.m_heCtrl.getAttribute("label")};SBGrid.CT.Cell.prototype.setLabel=function(a){return this.m_heCtrl.setAttribute("label",a)};SBGrid.CT.Cell.prototype.setLabelChange=function(a){return this.m_heCtrl.innerHTML=a};SBGrid.CT.Cell.prototype.getValue=function(){if(null!=this.m_heCtrl){return this.m_heCtrl.getAttribute("value")}else{return""}};SBGrid.CT.Cell.prototype.setAttribute=function(b,a){SBGrid.CT.Attribute.prototype.setAttribute.call(this,b,a);switch(b){case"color":if(this.m_heDCtrl){SBGrid.UT.HtmlLib.setStyle(this.m_heDCtrl,b,a)}}};SBGrid.CT.Cell.prototype.setValue=function(a){return this.m_heCtrl.setAttribute("value",a)};SBGrid.CT.Cell.prototype.setMergeType=function(a){if(a){this.mergeType=SBGrid.DEF.SBSM_NORMAL}else{this.mergeType=SBGrid.DEF.SBSM_LOCK}};SBGrid.CT.Cell.prototype.setIndex=function(a){this.index=a};SBGrid.CT.Cell.prototype.getState=function(){var a=SBGrid.DEF.SB_CS_NORMAL;if(this.disable){a|=SBGrid.DEF.SB_CS_DISABLE}if(this.m_bHover){a|=SBGrid.DEF.SB_CS_HOVER}if(this.selected){a|=SBGrid.DEF.SB_CS_SELECT}if(this.m_bFocus){a|=SBGrid.DEF.SB_CS_FOCUS}if(this.down){a|=SBGrid.DEF.SB_CS_DOWN}return a};SBGrid.CT.Cell.prototype.setExpand=function(a){this.expanded=a};SBGrid.CT.Cell.prototype.getExpand=function(){return this.expanded};SBGrid.CT.Cell.prototype.haschilditem=function(){return this.m_nChildNumber};SBGrid.CT.Cell.prototype.setChecked=function(e){if(this.checked!=e){this.checked=e;var b=document.getElementById("SBHE_"+this.id+"_check");if(null==b){return}var f=null;for(var a=0;a<b.childNodes.length;a++){var f=b.childNodes.item(a);if("IMG"==f.nodeName){break}}if(null==f){return}if(1==this.checked){var d=this.parent.getAttribute("checkimage");if(""==d||null==d){d=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgTreeCheck}f.src=d}else{var c=this.parent.getAttribute("uncheckimage");if(""==c||null==c){c=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgTreeUnCheck}f.src=c}}};SBGrid.CT.Cell.prototype.getChecked=function(){return this.checked};SBGrid.CT.Cell.prototype.getParentIndex=function(){return this.getElement().getParentIndex(this)};SBGrid.CT.HtmlHtml=function(b,d,c,a){if(!d){return}this.convertMode=a;SBGrid.CT.Element.call(this,b,d,c)};SBGrid.CT.HtmlHtml.prototype=new SBGrid.CT.Element;SBGrid.CT.HtmlHead=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b)};SBGrid.CT.HtmlHead.prototype=new SBGrid.CT.Element;SBGrid.CT.HtmlBody=function(d,h,e,u,q,n,p,s,b,t,a,f,o,c,g,m,l,i,w,v,r){if(!b){return}SBGrid.CT.Group.call(this,d,h,e,u,q,"",p,s,b,t,a,"","","",i,"",w,v,r);this.m_bShowPopupMenu=true;this.m_bSetPopupMenu=false;this.attribute.autorefresh=n;this.attribute["print-bottommargin"]=f;this.attribute["print-leftmargin"]=o;this.attribute["print-rightmargin"]=c;this.attribute["print-topmargin"]=g;this.attribute.pagewidth=""==m?null:m;this.attribute.pageheight=""==l?null:l};SBGrid.CT.HtmlBody.prototype=new SBGrid.CT.Group;SBGrid.CT.HtmlBody.prototype.refresh=function(){var cObj=this.children.getCollection();for(var strId in cObj){if(typeof SBUx!="undefined"&&SBGrid.DEF.is_chrome){eval("try{SBUx.getComponent('"+strId+"').refresh()}catch(e){}")}else{if(SBGrid.DEF.is_chrome){eval("try{"+strId+".refresh()}catch(e){}")}else{var objChild=cObj[strId];if(null!=objChild&&objChild instanceof SBGrid.CT.Element&&objChild.refresh){objChild.refresh()}}}}cObj=null};SBGrid.CT.HtmlBody.prototype.init=function(){this.m_heCtrl=document.body;SBGrid.CT.Group.prototype.init.call(this)};SBGrid.CT.HtmlBody.prototype.onMouseDown=function(a){SBGrid.CT.Group.prototype.onMouseDown.call(this,a);if(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11){return}var i=window;var m=0;var l=0;while(window.top!=i&&null!=i){var g=i.frameElement;while(null!=g){m+=g.offsetLeft;l+=g.offsetTop;if(g!=i.frameElement&&g!=i.document.body){m+=g.clientLeft;l+=g.clientTop}m-=(SBGrid.DEF.is_android?0:g.scrollLeft);l-=(SBGrid.DEF.is_android?0:g.scrollTop);g=g.offsetParent}i=i.parent}m=m+a.x+window.top.document.body.scrollLeft;l=l+a.y+window.top.document.body.scrollTop;var h=false;if(window.top.document.getElementById("SBHE___SB_ContextMenu")){var c=window.top.document.getElementById("SBHE___SB_ContextMenu");var d=c.offsetLeft-window.top.document.body.scrollLeft;var b=c.offsetTop-window.top.document.body.scrollTop;var f=d+c.offsetWidth;var e=b+c.offsetHeight;if(m<d||m>f||l<b||l>e){window.top.document.body.removeChild(c)}else{h=true}}if(a.button==3){if(this.m_bShowPopupMenu&&!this.m_bSetPopupMenu&&!h){window.top.document.oncontextmenu=null;if(window!=window.top){document.oncontextmenu=null}}else{window.top.document.oncontextmenu=new Function("return false");if(window!=window.top){document.oncontextmenu=new Function("return false")}}if(this.m_bShowPopupMenu&&this.m_bSetPopupMenu&&!h){document.SBHE_allElement.item("__SB_ContextMenu").createContextMenu(m,l)}}};SBGrid.DEF.Lan_Year="년 ";SBGrid.DEF.Lan_Month="월";SBGrid.DEF.Lan_Day="일";SBGrid.DEF.Lan_Monday="월";SBGrid.DEF.Lan_Tuesday="화";SBGrid.DEF.Lan_Wednesday="수";SBGrid.DEF.Lan_Thursday="목";SBGrid.DEF.Lan_Friday="금";SBGrid.DEF.Lan_Saturday="토";SBGrid.DEF.Lan_Sunday="일";SBGrid.DEF.Lan_Today="오늘";SBGrid.DEF.Lan_DefaultFontFamily="gulim, arial";if(typeof SBGrid.DEF.__LANGUAGE!="undefined"&&"jp"==SBGrid.DEF.__LANGUAGE){SBGrid.DEF.Lan_Year="年 ";SBGrid.DEF.Lan_Month="月";SBGrid.DEF.Lan_Day="日";SBGrid.DEF.Lan_Monday="月";SBGrid.DEF.Lan_Tuesday="火";SBGrid.DEF.Lan_Wednesday="水";SBGrid.DEF.Lan_Thursday="木";SBGrid.DEF.Lan_Friday="金";SBGrid.DEF.Lan_Saturday="土";SBGrid.DEF.Lan_Sunday="日";SBGrid.DEF.Lan_Today="今日";SBGrid.DEF.Lan_DefaultFontFamily="MS Gothic, arial"}else{if(typeof SBGrid.DEF.__LANGUAGE!="undefined"&&"us"==SBGrid.DEF.__LANGUAGE){SBGrid.DEF.Lan_Year=".";SBGrid.DEF.Lan_Month="";SBGrid.DEF.Lan_Day="";SBGrid.DEF.Lan_Monday="Mon";SBGrid.DEF.Lan_Tuesday="Tue";SBGrid.DEF.Lan_Wednesday="Wed";SBGrid.DEF.Lan_Thursday="Thu";SBGrid.DEF.Lan_Friday="Fri";SBGrid.DEF.Lan_Saturday="Sat";SBGrid.DEF.Lan_Sunday="Sun";SBGrid.DEF.Lan_Today="Today";SBGrid.DEF.Lan_DefaultFontFamily="arial"}}SBGrid.CT.CalendarItem=function(c,g,d,t,s,n,u,i,m,q,l,b,a,r,e,f,p,w,v,o,h){if(!a){return}SBGrid.CT.Caption.call(this,c,g,d,t,s,n,u,i,m,q,l,b,a,r,e,"",f,p,w,v,o,h);this.label};SBGrid.CT.CalendarItem.prototype=new SBGrid.CT.Caption;SBGrid.CT.CalendarItem.prototype.init=function(){SBGrid.CT.Caption.prototype.init.call(this);this.label=jQuery(this.m_heCtrl).html()};SBGrid.CT.Calendar=function(e,h,f,s,n,l,m,q,c,r,a,g,d,i,p,b,u,t,o){if(!c){return}SBGrid.CT.Group.call(this,e,h,f,s,n,l,m,q,c,r,a,"",g,d,i,p,u,t,o);this.m_strChoosedPosition;this.attribute.showtoday=String(b);this.day;this.month;this.year;this.dayItem=new Array();this.header;this.prevyear;this.prevmonth;this.nextmonth;this.nextyear};SBGrid.CT.Calendar.prototype=new SBGrid.CT.Group;SBGrid.CT.Calendar.prototype.refresh=function(){this.makeCalendar(parseInt(this.year),parseInt(this.month),parseInt(this.day))};SBGrid.CT.Calendar.prototype.item=function(c,d){if(d==null){for(var b=0;b<7;b++){for(var a=0;a<7;a++){if(jQuery("#SBHE_"+this.id+"_item"+b+a).html()==c){c=b;d=a;break}}if(d!=null){break}}}return this.dayItem[c][d]};SBGrid.CT.Calendar.prototype.init=function(e){SBGrid.CT.Group.prototype.init.call(this);this.header=new SBGrid.CT.CalendarHeader(this.id,"","",this.hint,SBGrid.DEF.Lan_Year+SBGrid.DEF.Lan_Month,"","","","",false,"","",this.id+".header",-1,"","","","","softbowl:caption","visible","");this.header.m_bDependentCtl=true;this.header.init();this.prevyear=new SBGrid.CT.Button(this.id,"","",this.hint,"","",false,"","",false,false,"","","",this.id+".prevyear",-1,"","","",-1,false,"","softbowl:button","visible","");this.prevyear.m_bDependentCtl=true;this.prevyear.init();this.prevmonth=new SBGrid.CT.Button(this.id,"","",this.hint,"","",false,"","",false,false,"","","",this.id+".prevmonth",-1,"","","",-1,false,"","softbowl:button","visible","");this.prevmonth.m_bDependentCtl=true;this.prevmonth.init();this.nextmonth=new SBGrid.CT.Button(this.id,"","",this.hint,"","",false,"","",false,false,"","","",this.id+".nextmonth",-1,"","","",-1,false,"","softbowl:button","visible","");this.nextmonth.m_bDependentCtl=true;this.nextmonth.init();this.nextyear=new SBGrid.CT.Button(this.id,"","",this.hint,"","",false,"","",false,false,"","","",this.id+".nextyear",-1,"","","",-1,false,"","softbowl:button","visible","");this.nextyear.m_bDependentCtl=true;this.nextyear.init();this.calendaritem=new SBGrid.CT.CalendarItem(this.id,"","",this.hint,"","","","","",false,"","",this.id+"_item",-1,"","","","","softbowl:calendaritem","visible","");this.calendaritem.m_bDependentCtl=true;this.calendaritem.init();this.calendarToday=new SBGrid.CT.CalendarToday(this.id,"","",this.hint,"","","","","",false,"","",this.id+".today",-1,"","","","","softbowl:calendartoday","visible");this.calendarToday.m_bDependentCtl=true;this.calendarToday.init();for(var b=0;b<7;b++){var c=new Array();for(var a=0;a<7;a++){c[a]=new SBGrid.CT.Cell(this.id,a,this.id+"_item"+b+a,b,"softbowl:calendaritem");c[a].setElement(this.calendaritem);c[a].init()}this.dayItem[b]=c}if(!e){var d=new Date();this.year=d.getFullYear().toString();this.month=(d.getMonth()+1).toString();this.day=d.getDate()}this.makeCalendar(parseInt(this.year),parseInt(this.month),parseInt(this.day));if(!e){this.setShowToday()}if("true"==this.getAttribute("disabled")){this.setDisabled(true)}if(this.m_heCtrl.attachEvent){this.m_heCtrl.attachEvent("onmousedown",SBGrid.DEF._W_onProcessMouseEvent);this.m_heCtrl.attachEvent("onmousemove",SBGrid.DEF._W_onProcessMouseEvent);this.m_heCtrl.attachEvent("onmouseup",SBGrid.DEF._W_onProcessMouseEvent)}else{this.m_heCtrl.addEventListener("mousedown",SBGrid.DEF._W_onProcessMouseEvent,false);this.m_heCtrl.addEventListener("mousemove",SBGrid.DEF._W_onProcessMouseEvent,false);this.m_heCtrl.addEventListener("mouseup",SBGrid.DEF._W_onProcessMouseEvent,false)}};SBGrid.CT.Calendar.prototype.setShowToday=function(){var d=document.getElementById("SBHE_"+this.id+".today");if(null==d){return}if("true"==this.getAttribute("showtoday")){var g=(Number(this.month)<10)?"0"+this.month:String(this.month);var f=(Number(this.day)<10)?"0"+this.day:String(this.day);jQuery(d).html(SBGrid.DEF.Lan_Today+" : "+this.year+"-"+g+"-"+f);for(var b=0;b<this.dayItem.length;b++){var e=this.dayItem[b];for(var a=0;a<e.length;a++){var c=e[a];c.m_heCtrl.style.height="12.5%"}}d.style.textAlign="center";d.style.height="12.5%"}else{d.parentNode.removeChild(d)}};SBGrid.CT.Calendar.prototype.applyDefaultStyle=function(){};SBGrid.CT.Calendar.prototype.makeCalendar=function(m,e,c){var p=this.children.item(this.id+".header");p.attribute.text=m+SBGrid.DEF.Lan_Year+e+SBGrid.DEF.Lan_Month;jQuery("#SBHE_"+this.attribute.id+"Year").html(m);jQuery("#SBHE_"+this.attribute.id+"Month").html(e);var f=new Date(m,e-1,1);var g=f.getDay();var d="312831303130313130313031";var a=d.substring(((e-1)*2),((e-1)*2+2));if((e==2)&&(((m%4==0)&&(m%100!=0))||(m%400==0))){a="29"}var q=parseInt(a);var b=0;var o=1;for(var l=1;l<7;l++){for(var h=0;h<7;h++){var n;if(b<g||o>q){jQuery("#SBHE_"+this.attribute.id+"_item"+l+h).html("")}else{jQuery("#SBHE_"+this.attribute.id+"_item"+l+h).html(o);if(c==o){this.chooseDate(l.toString()+h.toString())}o=o+1}this.dayItem[l][h].label=jQuery(this.dayItem[l][h].m_heCtrl).html();b=b+1}}};SBGrid.CT.Calendar.prototype.chooseDate=function(b){jQuery("#SBHE_"+this.id+"_item tr").find("td").removeClass("sbgrid_calendar_item_focus");var a=document.getElementById("SBHE_"+this.attribute.id+"_item"+b);if(jQuery(a).html()==""||b.substring(0,1)=="0"){return}if(this.m_strChoosedPosition!=null){var c=document.getElementById("SBHE_"+this.attribute.id+"_item"+this.m_strChoosedPosition);c.style.color="";c.style.backgroundColor=""}this.day=jQuery(a).html();this.m_strChoosedPosition=b;jQuery(a).addClass("sbgrid_calendar_item_focus");a.style.backgroundColor=this.calendaritem.getSelectAttribute("background-color");a.style.color=this.calendaritem.getSelectAttribute("color")};SBGrid.CT.Calendar.prototype.moveCalendar=function(a){if(this.m_strChoosedPosition!=null){var e=document.getElementById("SBHE_"+this.attribute.id+"_item"+this.m_strChoosedPosition);e.style.color="";e.style.backgroundColor=""}this.m_strChoosedPosition=null;var b=jQuery("#SBHE_"+this.attribute.id+"Year").html();var d=jQuery("#SBHE_"+this.attribute.id+"Month").html();if(a=="prevYear"){this.year=((b)-1).toString();this.month=d}else{if(a=="nextYear"){this.year=(parseInt(b)+1).toString();this.month=d}else{if(a=="prevMonth"){if(d=="1"){this.year=(parseInt(b)-1).toString();this.month="12"}else{this.year=b;this.month=(parseInt(d)-1).toString()}}else{if(a=="nextMonth"){if(d=="12"){this.year=(parseInt(b)+1).toString();this.month="1"}else{this.year=b;this.month=(parseInt(d)+1).toString()}}}}}var c=new Date();if(this.year==c.getFullYear().toString()&&this.month==(c.getMonth()+1).toString()){this.day=c.getDate().toString()}else{this.day=""}this.makeCalendar(parseInt(this.year),parseInt(this.month),parseInt(this.day))};SBGrid.CT.Calendar.prototype.setToday=function(){var a=new Date();this.day=a.getDate().toString();this.month=(a.getMonth()+1).toString();this.year=a.getFullYear().toString();this.refresh()};SBGrid.CT.Calendar.prototype.onMouseDown=function(a){SBGrid.CT.Group.prototype.onMouseDown.call(this,a);if(!this.disabled){if(a.target.substring(0,this.id.length+5)==this.id+"_item"){this.chooseDate(a.target.substring(this.id.length+5,this.id.length+7));this.dispatch("ondayselect")}else{if(a.target==this.id+".today"){this.setToday();this.dispatch("ondayselect")}}a.propagate="stop"}};SBGrid.CT.Calendar.prototype.onClick=function(b){SBGrid.CT.Group.prototype.onClick.call(this,b);if(!this.disabled){var a=this.m_strChoosedPosition;var c=false;if(b.target==this.id+".prevyear"){this.dispatch("onprevyear");this.moveCalendar("prevYear");c=true}else{if(b.target==this.id+".prevmonth"){this.dispatch("onprevmonth");this.moveCalendar("prevMonth");c=true}else{if(b.target==this.id+".nextmonth"){this.dispatch("onnextmonth");this.moveCalendar("nextMonth");c=true}else{if(b.target==this.id+".nextyear"){this.dispatch("onnextyear");this.moveCalendar("nextYear");c=true}}}}if(c){this.setDeselect(a)}}};SBGrid.CT.Calendar.prototype.setDeselect=function(b){var a=document.getElementById("SBHE_"+this.id+"_item"+b);if(null!=a){a.style.backgroundColor="";a.style.color=""}};SBGrid.CT.Calendar.create=function(b,d,f){d=SBGrid.CT.Element.createClassName(d,"calendar");var a=SBGrid.CT.Calendar.createMainNode(d);var g=document.getElementById(b);if(g==null){g=document.getElementById("SBHE_"+b)}var c=document.SBHE_allElement.item(b);if(c instanceof SBGrid.CT.Input||c instanceof SBGrid.CT.GridCol){a.style.zIndex=100;var e=document.body;e.appendChild(a)}else{if(g==null){return}g.appendChild(a)}a=SBGrid.CT.Calendar.createSubNodes(a,d);return SBGrid.CT.Calendar.createObject(b,a,d,f)};SBGrid.CT.Calendar.createMainNode=function(b){var a=document.createElement("div");a=SBGrid.CT.Calendar.createAttribute(a,b);jQuery(a).addClass("sbgrid_calendar");jQuery(a).addClass("sbgrid_boxsizing");return a};SBGrid.CT.Calendar.createSubNodes=function(c,G){var a=G.item("id");var d=document.createElement("table");var y="";if(G.exists("calendar_header")){y=G.item("calendar_header")}jQuery(d).addClass("sbgrid_calendar_header "+y);d.setAttribute("id","SBHE_"+a+".header");d.cellPadding=0;d.cellSpacing=0;d.style.cssText="width:100%; height:20%;";var h=document.createElement("tbody");var E=document.createElement("tr");var v=document.createElement("td");v.style.cssText="width:17%; height:100%; text-align:right;";var q=document.createElement("button");q.setAttribute("id","SBHE_"+a+".prevyear");var D="";if(G.exists("calendar_prevyear")){D=G.item("calendar_prevyear")}jQuery(q).addClass("sbgrid_calendar_prevyear "+D);q.style.cssText="width:15px; height:15px; background-position:center;";v.appendChild(q);var u=document.createElement("td");u.style.cssText="width:13%; height:100%; text-align:right;";var H=document.createElement("button");H.setAttribute("id","SBHE_"+a+".prevmonth");var z="";if(G.exists("calendar_prevmonth")){z=G.item("calendar_prevmonth")}jQuery(H).addClass("sbgrid_calendar_prevmonth "+z);H.style.cssText="width:15px; height:15px; background-position:center;";u.appendChild(H);var s=document.createElement("td");s.setAttribute("id","SBHE_"+a+".header_TEXT");s.style.cssText="width:40%; height:100%; text-align:center;";var A=document.createElement("span");A.setAttribute("id","SBHE_"+a+"Year");if(y!=""){jQuery(A).addClass(y)}s.appendChild(A);jQuery(s).html(jQuery(s).html()+SBGrid.DEF.Lan_Year);var f=document.createElement("span");f.setAttribute("id","SBHE_"+a+"Month");if(y!=""){jQuery(f).addClass(y)}s.appendChild(f);jQuery(s).html(jQuery(s).html()+SBGrid.DEF.Lan_Month);var p=document.createElement("td");p.style.cssText="width:13%; height:100%;";var b=document.createElement("button");b.setAttribute("id","SBHE_"+a+".nextmonth");var r="";if(G.exists("calendar_nextmonth")){r=G.item("calendar_nextmonth")}jQuery(b).addClass("sbgrid_calendar_nextmonth "+r);b.style.cssText="width:15px; height:15px; background-position:center;";p.appendChild(b);var o=document.createElement("td");o.style.cssText="width:17%; height:100%; ";var n=document.createElement("button");n.setAttribute("id","SBHE_"+a+".nextyear");var x="";if(G.exists("calendar_nextyear")){x=G.item("calendar_nextyear")}jQuery(n).addClass("sbgrid_calendar_nextyear "+x);n.style.cssText="width:15px; height:15px; background-position:center;";o.appendChild(n);E.appendChild(v);E.appendChild(u);E.appendChild(s);E.appendChild(p);E.appendChild(o);h.appendChild(E);d.appendChild(h);c.appendChild(d);var e=document.createElement("table");e.setAttribute("id","SBHE_"+a+"_item");var m="";if(G.exists("calendar_item")){m=G.item("calendar_item")}jQuery(e).addClass("sbgrid_calendar_body "+m);e.cellPadding=0;e.cellSpacing=0;e.style.cssText="width:100%; height:80%;";e.onclick=function(){};e.ondbclick=function(){};e.onmousedown=function(){};e.onmousemove=function(){};e.onmouseup=function(){};var l=document.createElement("tbody");for(var C=0;C<7;C++){var g=document.createElement("tr");for(var B=0;B<7;B++){var t=document.createElement("td");t.setAttribute("id","SBHE_"+a+"_item"+C+B);t.style.cssText="width:12.5%; height:12.5%; text-align:center;";if(B==0){jQuery(t).addClass("sbgrid_calendar_item_sun")}else{if(B==6){jQuery(t).addClass("sbgrid_calendar_item_sat")}else{jQuery(t).addClass("sbgrid_calendar_item_day")}}if(C==0){if(B==0){jQuery(t).html(SBGrid.DEF.Lan_Sunday)}else{if(B==1){jQuery(t).html(SBGrid.DEF.Lan_Monday)}else{if(B==2){jQuery(t).html(SBGrid.DEF.Lan_Tuesday)}else{if(B==3){jQuery(t).html(SBGrid.DEF.Lan_Wednesday)}else{if(B==4){jQuery(t).html(SBGrid.DEF.Lan_Thursday)}else{if(B==5){jQuery(t).html(SBGrid.DEF.Lan_Friday)}else{if(B==6){jQuery(t).html(SBGrid.DEF.Lan_Saturday)}}}}}}}}g.appendChild(t)}l.appendChild(g)}if(G.item("showtoday")=="true"){var w=document.createElement("tr");var F=document.createElement("td");w.appendChild(F);F.setAttribute("colspan","7");F.setAttribute("id","SBHE_"+G.item("id")+".today");F.style.height=strDayHeight;l.appendChild(w)}e.appendChild(l);c.appendChild(e);return c};SBGrid.CT.Calendar.createObject=function(f,d,w,z){var l="";var g="";var y="";var s="";var o="";var r="";var u=false;var c="";var v=9007199254740992;var b="";var i="";var e="";var n="";var p="";var a="";var t="visible";var m="";var q=w.getCollection();for(var h in q){switch(h){case"alert":l=q[h];break;case"help":g=q[h];break;case"hint":y=q[h];break;case"accesskey":s=q[h];break;case"bind":o=q[h];break;case"class":r=q[h];break;case"disabled":if("true"==q[h]){u=true}break;case"id":c=q[h];break;case"navindex":v=parseInt(q[h]);break;case"overflow":b=q[h];break;case"ref":i=q[h];break;case"jsonref":e=q[h];case"scroll":n=q[h];break;case"showeffect":p=q[h];break;case"showtoday":if("true"==q[h]){a=true}break;case"visibility":t=q[h];break;default:if(!SBGrid.DEF.SB_STYLELIST[h]){m+=h+":"+q[h]+"; "}break}}q=null;var x=new SBGrid.CT.Calendar(f,l,g,y,s,o,r,u,c,v,b,i,e,n,p,a,z,"softbowl:calendar",t,m);return x};SBGrid.CT.Calendar.createAttribute=function(b,a){b=SBGrid.CT.Group.createAttribute(b,a);return b};SBGrid.CT.CalendarHeader=function(d,g,e,t,s,n,u,i,m,q,l,c,a,r,f,b,o,w,v,p,h){if(!a){return}SBGrid.CT.Caption.call(this,d,g,e,t,s,n,u,i,m,q,l,c,a,r,f,"",b,o,w,v,p,h)};SBGrid.CT.CalendarHeader.prototype=new SBGrid.CT.Caption;SBGrid.CT.CalendarHeader.prototype.isCSSValid=function(b){var a=false;if(null==this.attribute[b]||""==this.attribute[b]){a=true}return a};SBGrid.CT.CalendarToday=function(d,g,e,t,s,n,u,i,m,q,l,c,a,r,f,b,o,w,v,p,h){if(!a){return}SBGrid.CT.Caption.call(this,d,g,e,t,s,n,u,i,m,q,l,c,a,r,f,"",b,o,w,v,p,h)};SBGrid.CT.CalendarToday.prototype=new SBGrid.CT.Caption;SBGrid.CT.CalendarToday.prototype.isCSSValid=function(b){var a=false;if(null==this.attribute[b]||""==this.attribute[b]){a=true}return a};SBGrid.CT.Button=function(e,i,f,x,w,s,y,m,p,u,o,d,n,h,a,v,g,b,c,r,q,A,z,t,l){if(!a){return}SBGrid.CT.Caption.call(this,e,i,f,x,w,s,y,m,p,u,o,d,a,v,g,b,c,r,A,z,t,l);this.attribute.group=n;this.attribute.groupalign=h;this.attribute.selected=String(q);this.selected=q;this.m_heCtrl=document.getElementById("SBHE_"+this.id);this.m_strTargetGrid="";this.m_heLodExcelForm=null};SBGrid.CT.Button.prototype=new SBGrid.CT.Caption;SBGrid.CT.Button.prototype.refresh=function(){SBGrid.CT.BindableControl.prototype.refresh.call(this);with(this){if(null!=m_heCtrl){var strValue="";if(this.isBinded()){var strRef=attribute.jsonref;if(strRef==""||strRef==null){strRef=attribute.ref;strValue=(null!=strRef&&""!=strRef)?SBGrid.DS.XMLStorage.getUniqueStorage().getValue(strRef):this.getAttribute("text")}else{strValue=(null!=strRef&&""!=strRef)?SBGrid.DS.JsonStorage.getUniqueStorage().getValue(strRef):this.getAttribute("text")}}else{strValue=this.getAttribute("text")}if(null!=m_heCtrlText){jQuery(m_heCtrlText).html(strValue.newlineCharConvert())}this.value=strValue}}};SBGrid.CT.Button.prototype.getBindingType=function(){return SBGrid.DEF.SB_SINGLE};SBGrid.CT.Button.prototype.init=function(){SBGrid.CT.Caption.prototype.init.call(this);if(null!=this.m_heCtrlText){var f=this.getAttribute("text");jQuery(this.m_heCtrlText).html(f.newlineCharConvert())}if("softbowl:inputbutton"==this.attribute.tag||"softbowl:outputbutton"==this.attribute.tag){if(null!=this.parent){var i=0;var a=this.parent;var e=this.m_heCtrl;var g=a.m_heCtrl;var d=Number(a.attribute.left.split("px")[0]);var b=g.clientWidth;if(SBGrid.DEF.is_ie7){i+=parseInt(g.currentStyle.paddingLeft);i+=parseInt(g.currentStyle.paddingRight);i+=parseInt(g.currentStyle.borderLeftWidth);i+=parseInt(g.currentStyle.borderRightWidth)}var h=16>e.clientWidth?16:e.clientWidth;e.style.left=(d+b-h-i)+"px";e.style.height=a.m_heCtrl.clientHeight+"px";e=null;objParant=null;d=null;b=null;i=null;g=null;h=null}}this.m_strTargetGrid=this.getAttribute("loadexcelgrid");if(null!=this.m_strTargetGrid&&""!=this.m_strTargetGrid){this.createExcelButton()}if(""!=this.attribute.group){var c=this.attribute.group;if(null==document.m_htGroupButton){document.m_htGroupButton={};document.m_htGroupButton[c]={arTab:new Array(),selected:null};document.m_htGroupButton[c].arTab.push(this);this.m_nGroupNum=0}else{if(null!=document.m_htGroupButton[c]){this.m_nGroupNum=document.m_htGroupButton[c].arTab.length;document.m_htGroupButton[c].arTab.push(this)}else{document.m_htGroupButton[c]={arTab:new Array(),selected:null};document.m_htGroupButton[c].arTab.push(this);this.m_nGroupNum=0}}this.designButton(true);if(this.selected){this.setSelected(true)}}};SBGrid.CT.Button.prototype.createExcelButton=function(){if(null==this.m_heLodExcelForm){if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7||SBGrid.DEF.is_ie8){this.m_heLodExcelForm=document.createElement("<form encType='multipart/form-data'>")}else{this.m_heLodExcelForm=document.createElement("form");this.m_heLodExcelForm.setAttribute("enctype","multipart/form-data")}this.m_heLodExcelForm.action=SBGrid.DEF.__getAppName()+"LoadExcel.tfs";this.m_heLodExcelForm.method="post";this.m_heLodExcelForm.target="SBHE___SB_LoadExcel";this.m_heLodExcelForm.style.filter="alpha(opacity=0)";this.m_heLodExcelForm.style.opacity=0;this.m_heLodExcelForm.style.position="absolute";this.m_heLodExcelForm.style.top=this.getAttribute("top");this.m_heLodExcelForm.style.left=this.getAttribute("left");this.m_heLodExcelForm.style.width=this.getAttribute("width");this.m_heLodExcelForm.style.height=this.getAttribute("height");if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7){var b="<input type='hidden' name='nodeset'/>";b+="<input type='file' name='excel' onchange='"+this.id+".loadExcelGrid();' style='top:0px;left:0px;width:100%;height:100%;cursor:hand;' />";jQuery(this.m_heLodExcelForm).html(b)}else{var c=document.createElement("input");c.type="hidden";c.name="nodeset";var a=document.createElement("input");a.type="file";a.name="excel";a.style.top="0px";a.style.left="0px";a.style.width="100%";a.style.height="100%";a.style.cursor="pointer";a.setAttribute("onchange",this.id+".loadExcelGrid();");this.m_heLodExcelForm.appendChild(c);this.m_heLodExcelForm.appendChild(a)}if(null!=this.parent.m_heCtrl){this.parent.m_heCtrl.appendChild(this.m_heLodExcelForm)}}};SBGrid.CT.Button.prototype.loadExcelGrid=function(){var e=this.m_heLodExcelForm.lastChild.value;e=e.substring(e.lastIndexOf(".")+1,e.length).toLowerCase();if("xlsx"!=e&&"xls"!=e&&"cell"!=e){SBGrid.DEF.errorMsg("올바른 Excel File 형식이 아닙니다.");return}var g=document.SBHE_allElement.item(this.m_strTargetGrid);if(null!=g){var b=g.nodeset+"@";var f=true;for(var c=0;c<g.m_arColumn.length;c++){var a=g.m_arColumn[c].getAttribute("ref");if(""!=a.trim()){if(f){b+=a;f=false}else{b+=","+a}}}this.m_heLodExcelForm.firstChild.value=encodeURI(b+"@"+e)}else{SBGrid.DEF.errorMsg("Load Excel을 적용할 Target Grid가 존재하지 않습니다.");return}SBGrid.DEF.SBLE_GRID=this.m_strTargetGrid;SBGrid.DEF.SBLE_BUTTON=this;var d=document.getElementById("SBHE___SB_LoadExcel");if(d){d.setAttribute("targetGrid",this.m_strTargetGrid);if(d.attachEvent){d.attachEvent("onload",SBGrid.CT.Button.uploadComplete)}else{d.addEventListener("load",SBGrid.CT.Button.uploadComplete,false)}}this.m_heLodExcelForm.submit();this.m_heLodExcelForm.reset()};SBGrid.CT.Button.prototype.isCSSValid=function(b){var a=SBGrid.CT.Caption.prototype.isCSSValid.call(this);if("background-image"==b&&!a){if("softbowl:inputbutton"==this.getTag()||"softbowl:outputbutton"==this.getTag()){if("url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.imgButton+")"==SBGrid.UT.HtmlLib.getStyle(this.m_heCtrl,b)){return true}}else{if("softbowl:combobutton"==this.getTag()){if("url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.imgCombo+")"==SBGrid.UT.HtmlLib.getStyle(this.m_heCtrl,b)){return true}}}}return a};SBGrid.CT.Button.prototype.applyDefaultStyle=function(){if(null!=this.m_heCtrl){var a=this.m_heCtrl.style;a.backgroundColor=null!=this.attribute["background-color"]?this.attribute["background-color"]:"";a.backgroundImage=null!=this.attribute["background-image"]?this.attribute["background-image"]:"";a.borderStyle=null!=this.attribute["border-style"]?this.attribute["border-style"]:"";a.borderColor=null!=this.attribute["border-color"]?this.attribute["border-color"]:"";a.borderWidth=null!=this.attribute["border-width"]?this.attribute["border-width"]:"";a.color=null!=this.attribute.color?this.attribute.color:""}};SBGrid.CT.Button.prototype.setAttribute=function(a,b){if(""!=this.attribute.group&&"border-style"==a){return}SBGrid.CT.Caption.prototype.setAttribute.call(this,a,b);switch(a){case"text":this.attribute.text=b;this.refresh();break;case"group":this.attribute.group=b;""!=b?this.designButton(true):this.designButton(false);break;case"groupalign":this.attribute.groupalign=b;this.designButton(true);break;case"selected":break}};SBGrid.CT.Button.prototype.onMouseDown=function(a){SBGrid.CT.Caption.prototype.onMouseDown.call(this,a);if(a.target==this.getId()){var b=this.getAttribute("group");if(!b.isEmpty()){this.setSelected(true,a)}}};SBGrid.CT.Button.prototype.onClick=function(a){SBGrid.CT.Caption.prototype.onClick.call(this,a);if(a.target==this.getId()){var b=this.getAttribute("group");if(!b.isEmpty()){this.setSelected(true,a)}this.dispatch("DOMActivate");this.dispatch("SBUx_activate")}};SBGrid.CT.Button.prototype.onKeyPress=function(a){SBGrid.CT.Caption.prototype.onKeyPress.call(this,a);if(a.target==this.getId()&&(SBGrid.EVT.ENTER==a.keyCode||SBGrid.EVT.SPACE==a.keyCode)){var b=this.getAttribute("group");if(!b.isEmpty()){this.setSelected(true,a)}this.dispatch("DOMActivate");this.dispatch("SBUx_activate")}};SBGrid.CT.Button.prototype.defaultAction=function(b,a){SBGrid.CT.Group.prototype.defaultAction.call(this,b,a)};SBGrid.CT.Button.prototype.setSelected=function(b,a){var e=this.getAttribute("group");var d=document.m_htGroupButton[e];if(null!=d&&null!=d.selected){var c=d.arTab[d.selected];c.attribute.selected="false";c.selected=false;SBGrid.UT.HtmlLib.setStyle(c.m_heCtrl,"background-color",null!=c.attribute["background-color"]?c.attribute["background-color"]:"");SBGrid.UT.HtmlLib.setStyle(c.m_heCtrl,"background-image",null!=c.attribute["background-image"]?c.attribute["background-image"]:"");SBGrid.UT.HtmlLib.setStyle(c.m_heCtrl,"border-color",null!=c.attribute["border-color"]?c.attribute["border-color"]:"#000000");SBGrid.UT.HtmlLib.setStyle(c.m_heCtrl,"border-width",null!=c.attribute["border-width"]?c.attribute["border-width"]:"");SBGrid.UT.HtmlLib.setStyle(c.m_heCtrl,"color",null!=c.attribute.color?c.attribute.color:"");objXnButtons=null}this.attribute.selected=b.toString();this.selected=b;if(b){d.selected=this.m_nGroupNum;SBGrid.UT.HtmlLib.setStyle(this.m_heCtrl,"background-color",null!=this.attribute["select.background-color"]?this.attribute["select.background-color"]:"#FFE9D4");SBGrid.UT.HtmlLib.setStyle(this.m_heCtrl,"background-image",null!=this.attribute["select.background-image"]?this.attribute["select.background-image"]:"");SBGrid.UT.HtmlLib.setStyle(this.m_heCtrl,"border-color",null!=this.attribute["select.border-color"]?this.attribute["select.border-color"]:"#000000");SBGrid.UT.HtmlLib.setStyle(this.m_heCtrl,"border-width",null!=this.attribute["select.border-width"]?this.attribute["select.border-width"]:"");SBGrid.UT.HtmlLib.setStyle(this.m_heCtrl,"color",null!=this.attribute["select.color"]?this.attribute["select.color"]:"")}};SBGrid.CT.Button.prototype.onafterloadexcel=function(){};SBGrid.CT.Button.prototype.onafterloadexcelerror=function(){};SBGrid.CT.Button.prototype.designButton=function(b){var a=this.m_heCtrl;a.style.borderStyle="";a.style.borderColor="";if(b){a.hideFocus=true;if("user"==this.attribute.groupalign){SBGrid.UT.HtmlLib.setStyle(a,"border-style",null!=this.attribute["border-style"]?this.attribute["border-style"]:"none")}else{a.style.borderLeftStyle="solid";a.style.borderLeftColor="#000000";a.style.borderRightStyle="solid";a.style.borderRightColor="#000000";if("bottom"==this.attribute.groupalign){a.style.borderBottomStyle="solid";a.style.borderBottomColor="#000000";a.style.borderTopStyle="none";a.style.borderTopColor=""}else{if("top"==this.attribute.groupalign||""==this.attribute.groupalign){a.style.borderTopStyle="solid";a.style.borderTopColor="#000000";a.style.borderBottomStyle="none";a.style.borderBottomColor=""}}}}else{this.selected=false;this.attribute.selected="false";a.hideFocus=false;this.applyDefaultStyle()}};SBGrid.CT.Button.create=function(b,d,e){d=SBGrid.CT.Element.createClassName(d,"button");var a=SBGrid.CT.Button.createMainNode(d);var c=document.getElementById(b);if(c==null){c=document.getElementById("SBHE_"+b)}if(c==null){return}c.appendChild(a);a=SBGrid.CT.Button.createSubNodes(a,d);return SBGrid.CT.Button.createObject(b,a,d,e)};SBGrid.CT.Button.createMainNode=function(b){var a=document.createElement("button");a=SBGrid.CT.Button.createAttribute(a,b);a.removeAttribute("text");jQuery(a).addClass("sbgrid_button");return a};SBGrid.CT.Button.createSubNodes=function(a,c){var b=document.createElement("div");b.setAttribute("id","SBHE_"+c.item("id")+"_TEXT");b.setAttribute("class","sbgrid_button_div");if(a.getAttribute("text")){jQuery(a).html(a.getAttribute("text").newlineCharConvert())}a.appendChild(b);return a};SBGrid.CT.Button.createObject=function(d,z,E,H){var l="";var e="";var G="";var F="";var x="";var u="";var B=false;var t=false;var q="";var s="";var a="";var D=9007199254740992;var h="";var b="";var w=false;var y="visible";var m="";var p=E.getCollection();for(var g in p){switch(g){case"alert":l=p[g];break;case"help":e=p[g];break;case"hint":G=p[g];break;case"text":F=p[g];break;case"accesskey":x=p[g];break;case"class":u=p[g];break;case"disabled":if("true"==p[g]){B=true}break;case"ellipsis":if("true"==p[g]){t=true}break;case"group":q=p[g];break;case"groupalign":s=p[g];break;case"id":a=p[g];break;case"navindex":D=parseInt(p[g]);break;case"selected":if("true"==p[g]){w=true}break;case"visibility":y=p[g];break;case"background-image":var f=p[g].trim();if(-1==f.indexOf("url(")){f="url("+f+")";SBGrid.UT.HtmlLib.setStyle(z,"background-image",f)}default:if(!SBGrid.DEF.SB_STYLELIST[g]){m+=g+":"+p[g]+"; "}break}}p=null;var o=new SBGrid.CT.Button(d,l,e,G,F,x,false,"",u,B,t,"",q,s,a,D,h,b,"",-1,w,H,"softbowl:button",y,m);if(""!=m){var r={};var A={};var c=m.split(";");for(var v=0;v<c.length;v++){var n=c[v].split(":");if(-1!=n[0].trim().indexOf("select.")){var g=n[0].trim().substring(7);var C=n[1].trim();if(null!=C&&""!=C){r[g]=C}}else{if(-1!=n[0].trim().indexOf("hover.")){var g=n[0].trim().substring(6);var C=n[1].trim();if(null!=C&&""!=C){A[g]=C}}}}o.setSelectStyle(r);o.setHoverStyle(A)}return o};SBGrid.CT.Button.createAttribute=function(b,a){b=SBGrid.CT.Caption.createAttribute(b,a);return b};SBGrid.CT.Button.uploadComplete=function(){var p=document.getElementById("SBHE___SB_LoadExcel").contentWindow.strLoadXml;if(p){var b=SBGrid.UT.XmlLib.loadXMLFromString(p);if(!b.selectSingleNode("/root/SB_EXCEL_ERR")){var d=SBGrid.DEF.SBLE_BUTTON.getAttribute("exportfalserows");var o=d.isEmpty()?0:parseInt(d);var m=document.SBHE_allElement.item(SBGrid.DEF.SBLE_GRID);var h=m.nodeset.substring(0,m.nodeset.lastIndexOf("/"));var c=m.nodeset;if(null!=m){if(null!=SBGrid.DS.XMLStorage.getUniqueStorage()){var q=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceDocument();if(null!=q){var a=SBGrid.UT.XmlLib.getRootElementNode(b);var f=q.selectSingleNode(h);var r=SBGrid.UT.XmlLib.selectNodes(q,c);var g=r.length;for(var n=0;n<g;n++){f.removeChild(r.item(n))}var e=a.selectSingleNode(h);var l=e.childNodes.item(o);while(l){f.appendChild(l.cloneNode(true));l=l.nextSibling}}}m.refresh();SBGrid.DEF.SBLE_BUTTON.dispatch("onafterloadexcel")}}else{SBGrid.DEF.errorMsg("loadExcel 오류 : 잘못된 타입의 Excel 파일 입니다.");SBGrid.DEF.SBLE_BUTTON.dispatch("onafterloadexcelerror")}}};SBGrid.CT.TextArea=function(d,i,e,z,s,n,r,x,v,B,u,p,b,q,g,o,y,a,f,h,c,m,w,C,A,t,l){if(!b){return}SBGrid.CT.Group.call(this,d,i,e,z,s,n,r,x,b,y,a,"",h,c,m,w,C,A,t,l);this.m_strInputValue="";this.attribute.dragmode=String(v);this.attribute.dropmode=String(B);this.attribute.editable=String(u);this.attribute.editmenu=String(p);this.attribute.imemode=q;this.attribute.maxbyte=String(g);this.attribute.maxlength=String(o);this.attribute.pastemode=f;this.caretPosition=-1;this.label="";this.oldValue="";this.m_nCaretStart=0;this.m_strSelectionText="";this.m_nCaretEnd=0;this.m_nCaretStart;this.m_nCaretEnd;this.m_strUndo};SBGrid.CT.TextArea.prototype=new SBGrid.CT.Group;SBGrid.CT.TextArea.prototype.init=function(){SBGrid.CT.Group.prototype.init.call(this);if("softbowl:input"!=this.tag&&"softbowl:comboinput"!=this.tag){this.m_heCtrl.setAttribute("onscroll","SBGrid.DEF._W_onProcessEvent(window.event, 'onscroll', this.id.replace('SBHE_', ''))")}if(null!=this.m_heCtrl){if(-1!=parseInt(this.attribute.maxlength)){this.m_heCtrl.maxLength=parseInt(this.attribute.maxlength)}if(""!=this.attribute.imemode){if("hangul"==this.attribute.imemode){this.m_heCtrl.style.imeMode="active"}else{if("alpha"==this.attribute.imemode){this.m_heCtrl.style.imeMode="inactive"}else{this.m_heCtrl.style.imeMode="disabled"}}}if("false"==this.attribute.editable){this.m_heCtrl.readOnly=true}if(SBGrid.DEF.is_iphone&&null==this.m_isGridInput){this.m_heCtrl.setAttribute("onFocus",'SBGrid.DS.XMLStorage.getUniqueStorage().setFocus("'+this.id+")")}}};SBGrid.CT.TextArea.prototype.applyDefaultStyle=function(){};SBGrid.CT.TextArea.prototype.getAbility=function(){return SBGrid.CT.Group.prototype.getAbility.call(this)|SBGrid.DEF.SBEA_HSB_AS_TEXT};SBGrid.CT.TextArea.prototype.getBindingType=function(){return SBGrid.DEF.SB_SINGLE};SBGrid.CT.TextArea.prototype.setEditText=function(a){this.m_strUndo=this.getWindowText();this.setWindowText(a)};SBGrid.CT.TextArea.prototype.getWindowText=function(){return this.m_heCtrl.value};SBGrid.CT.TextArea.prototype.setWindowText=function(a){this.m_heCtrl.value=a};SBGrid.CT.TextArea.prototype.refresh=function(){if(null!=this.m_heCtrl){var a="";a=this.attribute.jsonref;if(null==a||""==a){a=this.attribute.ref}if(null!=a&&""!=a){var b=this.getValue(a);if(this.value!=b){this.oldValue=this.value;this.m_heCtrl.value=b;this.value=b;this.label=this.m_heCtrl.value}}this.vscroll.init();this.hscroll.init()}};SBGrid.CT.TextArea.prototype.getSelBegin=function(){return this.m_nCaretStart};SBGrid.CT.TextArea.prototype.setSelBegin=function(c){var b=null!=this.m_heCtrlInput?this.m_heCtrlInput:this.m_heCtrl;var a=SBGrid.DEF.getCaretPosition(b);c=parseInt(c);if(c<this.m_nCaretStart){this.m_nCaretStart=c}else{if(c>this.m_nCaretEnd){this.m_nCaretEnd=c}else{this.m_nCaretStart=c}}a.start=this.m_nCaretStart;a.end=this.m_nCaretEnd;SBGrid.DEF.setCaretPosition(b,this.m_nCaretStart,this.m_nCaretEnd)};SBGrid.CT.TextArea.prototype.getSelEnd=function(){return this.m_nCaretEnd};SBGrid.CT.TextArea.prototype.setSelEnd=function(c){var b=null!=this.m_heCtrlInput?this.m_heCtrlInput:this.m_heCtrl;var a=SBGrid.DEF.getCaretPosition(b);c=parseInt(c);if(c<this.m_nCaretStart){this.m_nCaretStart=c}else{if(c>this.m_nCaretEnd){this.m_nCaretEnd=c}else{this.m_nCaretStart=c}}a.start=this.m_nCaretStart;a.end=this.m_nCaretEnd;SBGrid.DEF.setCaretPosition(b,this.m_nCaretStart,this.m_nCaretEnd)};SBGrid.CT.TextArea.prototype.getSelectionText=function(){var a=null!=this.m_heCtrlInput?this.m_heCtrlInput:this.m_heCtrl;return SBGrid.DEF.getSelectionText(a)};SBGrid.CT.TextArea.prototype.setSelectionText=function(a){var d=null!=this.m_heCtrlInput?this.m_heCtrlInput:this.m_heCtrl;var c=d.value;var e=c.substring(0,this.m_nCaretEnd);var b=c.substring(this.m_nCaretEnd);this.m_strSelectionText=a;c=e+a+b;d.value=c;SBGrid.DEF.setCaretPosition(this.m_heCtrl,this.m_nCaretStart,this.m_nCaretEnd)};SBGrid.CT.TextArea.prototype.setAttribute=function(a,b){SBGrid.CT.Group.prototype.setAttribute.call(this,a,b);switch(a){case"dragmode":this.attribute.dragmode=b;break;case"dropmode":this.attribute.dropmode=b;break;case"editable":this.attribute.editable=b;if("false"==b){this.m_heCtrl.readOnly=true}else{this.m_heCtrl.readOnly=false}break;case"editmenu":this.attribute.editmenu=b;break;case"imemode":this.attribute.imemode=b;break;case"maxbyte":this.attribute.maxbyte=b;break;case"maxlength":this.attribute.maxlength=b;if("-1"!=b){this.m_heCtrl.maxLength=parseInt(b);if(null!=this.objFormat){this.objFormat.m_nMaxLength=parseInt(b)}}else{this.m_heCtrl.maxLength=2147483647;if(null!=this.objFormat){this.objFormat.m_nMaxLength=2147483647}}break;case"pastemode":this.attribute.pastemode=b;break;case"changeClipboard":if(this.objFormat){if(b=="true"){this.objFormat.setChangeClipboad(true)}else{this.objFormat.setChangeClipboad(false)}}}};SBGrid.CT.TextArea.prototype.existBlock=function(a){return(""!=this.getSelectionText(this.m_heCtrl))};SBGrid.CT.TextArea.prototype.onDragStart=function(a){this.m_bDragStart=true;if("softbowl:input"==this.tag||"softbowl:textarea"==this.tag){a.dropData=this.getSelectionText(this.m_heCtrl)}};SBGrid.CT.TextArea.prototype.onDrop=function(a){if("file"==a.dropDataType){return}if(a.dropData.isEmpty()){return}var c=this.getWindowText();if(null!=c&&!c.isEmpty()){var b=SBGrid.DEF.getCaretPosition(this.m_heCtrl);c=c.substring(0,b.start)+a.dropData+c.substring(b.end+1,c.length)}else{c=a.dropData}this.setWindowText(c)};SBGrid.CT.TextArea.prototype.onBlur=function(b,d){SBGrid.CT.Group.prototype.onBlur.call(this,b);var g=null!=this.m_heCtrlInput?this.m_heCtrlInput:this.m_heCtrl;var f=SBGrid.DEF.getCaretPosition(g);this.m_nCaretStart=f.start;this.m_nCaretEnd=f.end;var a=this.attribute.jsonref;if(a!=""&&a!=null){if("true"==this.attribute.editable){var c=this.getValue();var h=this.m_heCtrl.value;if(c!=h){this.setValue(h);this.setText(h);if(this.m_bBinded){this.refreshCurrentModel(a)}this.dispatch("onvaluechanged");this.dispatch("SBUx_value_changed")}}}else{var e=this.getRefNode();if(null!=e){if("true"==this.attribute.editable){var c=this.getValue();var h=this.m_heCtrl.value;if(c!=h){this.setValue(h);this.setText(h);if(this.m_bBinded){a=this.attribute.ref;this.refreshCurrentModel(a)}this.dispatch("onvaluechanged");this.dispatch("SBUx_value_changed")}}}}};SBGrid.CT.TextArea.prototype.onMouseDown=function(a){SBGrid.CT.Control.prototype.onMouseDown.call(this,a);if("false"==this.getAttribute("editable")){return}if(this.existBlock()){this.m_bLButtonDown=true}};SBGrid.CT.TextArea.prototype.onMouseMove=function(a){if(this.m_bLButtonDown&&""!=this.getAttribute("dragmode")&&"false"!=this.getAttribute("dragmode")&&!this.m_bDragStart){SBGrid.DEF.bDragDrop=true;this.m_bDragStart=true;a.capture="";a.drag=this.id;this.dispatch("ondragstart");if(this.m_bLButtonDown&&""!=this.getAttribute("dropmode")&&"false"!=this.getAttribute("dropmode")){this.dispatch("ondragenter");this.dispatch("ondragover")}}else{SBGrid.CT.Control.prototype.onMouseMove.call(this,a)}};SBGrid.CT.TextArea.prototype.onMouseUp=function(a){SBGrid.CT.Control.prototype.onMouseUp.call(this,a);this.m_bLButtonDown=false};SBGrid.CT.TextArea.prototype.onKeyDown=function(b){SBGrid.CT.Group.prototype.onKeyDown.call(this,b);if(-1!=parseInt(this.attribute.maxlength)&&"softbowl:textarea"==this.attribute.tag){if(this.m_heCtrl.value.length==parseInt(this.attribute.maxlength)){if(b.keyCode==SBGrid.EVT.BACKSPACE||b.keyCode==SBGrid.EVT.DELETE||b.keyCode==SBGrid.EVT.LEFT||b.keyCode==SBGrid.EVT.UP||b.keyCode==SBGrid.EVT.RIGHT||b.keyCode==SBGrid.EVT.DOWN){return}else{this.dispatch("onmaxlength");if(null!=SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1]){SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1].id)}else{SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[0].id)}}}}if(-1!=parseInt(this.attribute.maxbyte)&&"softbowl:textarea"==this.attribute.tag){var a=0;a=b.keyCode>227?2:1;if(this.m_heCtrl.value.getByte()+a>parseInt(this.attribute.maxbyte)){if(b.keyCode==SBGrid.EVT.BACKSPACE||b.keyCode==SBGrid.EVT.DELETE||b.keyCode==SBGrid.EVT.LEFT||b.keyCode==SBGrid.EVT.UP||b.keyCode==SBGrid.EVT.RIGHT||b.keyCode==SBGrid.EVT.DOWN){return}else{if(null!=SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1]){SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1].id)}else{SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[0].id)}}}}};SBGrid.CT.TextArea.prototype.onKeyUp=function(b){SBGrid.CT.Group.prototype.onKeyUp.call(this,b);if(!SBGrid.DEF.is_ie&&"softbowl:textarea"==this.attribute.tag){if(-1!=parseInt(this.attribute.maxlength)){if(this.m_heCtrl.value.length>parseInt(this.attribute.maxlength)){var a=this.m_heCtrl.value.substring(0,parseInt(this.attribute.maxlength));this.m_heCtrl.value=a}}if(-1!=parseInt(this.attribute.maxbyte)){if(this.m_heCtrl.value.getByte()+1>=parseInt(this.attribute.maxbyte)){var a=this.m_heCtrl.value.setByteWithStrLength(parseInt(this.attribute.maxbyte));this.m_heCtrl.value=a}}}var c=this.m_heCtrl.value;this.label=c};SBGrid.CT.TextArea.prototype.onScroll=function(a){SBGrid.CT.Group.prototype.onScroll.call(this,a);if("visible"==this.attribute.overflow&&"softbowl:textarea"==this.attribute.tag){if(null!=this.m_heCtrl){this.setAttribute("height",(this.m_heCtrl.scrollHeight+2)+"px")}}};SBGrid.CT.TextArea.create=function(a,c,d){c=SBGrid.CT.Element.createClassName(c,"textarea");var e=SBGrid.CT.TextArea.createMainNode(c);var b=document.getElementById(a);if(b==null){b=document.getElementById("SBHE_"+a)}if(b==null){return}b.appendChild(e);e=SBGrid.CT.TextArea.createSubNodes(e,c);return SBGrid.CT.TextArea.createObject(a,e,c,d)};SBGrid.CT.TextArea.createMainNode=function(a){var b=document.createElement("textarea");b.setAttribute("rows","1");b.setAttribute("cols","1");b=SBGrid.CT.TextArea.createAttribute(b,a);jQuery(b).addClass("sbgrid_textarea");return b};SBGrid.CT.TextArea.createSubNodes=function(b,a){return b};SBGrid.CT.TextArea.createObject=function(c,y,C,F){var m="";var d="";var D="";var u="";var p="";var t="";var A=false;var z=false;var g=false;var w=true;var x=true;var a="";var E="";var r=-1;var l=-1;var B=9007199254740992;var i="";var q="default";var h="";var b="";var o="";var v="visible";var n="";var s=C.getCollection();for(var e in s){switch(e){case"alert":m=s[e];break;case"help":d=s[e];break;case"hint":D=s[e];break;case"accesskey":u=s[e];break;case"bind":p=s[e];break;case"class":t=s[e];break;case"disabled":if("true"==s[e]){A=true}break;case"dragmode":if("true"==s[e]){z=true}case"dropmode":if("true"==s[e]){g=true}break;case"editable":if("false"==s[e]){w=false}break;case"editmenu":if("false"==s[e]){x=false}break;case"id":a=s[e];break;case"imemode":E=s[e];break;case"maxbyte":r=parseInt(s[e]);break;case"maxlength":nMaxlength=parseInt(s[e]);break;case"navindex":B=parseInt(s[e]);break;case"overflow":i=s[e];case"pastemode":strPastemode=s[e];break;case"ref":h=s[e];break;case"jsonref":b=s[e];break;case"scroll":o=s[e];case"validateformat":if("true"==s[e]){bValidateformat=true}break;case"visibility":v=s[e];break;default:if(!SBGrid.DEF.SB_STYLELIST[e]){n+=e+":"+s[e]+"; "}break}}s=null;var f=new SBGrid.CT.TextArea(c,m,d,D,u,p,t,A,z,g,w,x,a,E,r,l,B,i,q,h,b,o,"",F,"softbowl:textarea",v,n);return f};SBGrid.CT.TextArea.createAttribute=function(b,a){b=SBGrid.CT.Group.createAttribute(b,a);return b};SBGrid.CT.Input=function(t,u,r,o,l,E,P,g,K,p,i,b,H,s,f,d,m,N,A,n,C,q,M,F,h,z,L,a,v,J,I,y,G,e,x,D,O,B,w,c){if(!d){return}SBGrid.CT.TextArea.call(this,t,u,r,o,l,P,g,K,p,i,b,H,d,m,q,M,F,h,z,L,a,y,G,D,O,w,c);this.attribute.autonext=String(E);this.attribute.format=s;this.attribute.decimalformatinsert=String(f);this.attribute.inputtype=N;this.attribute.invalidcharaters=A;this.attribute.isemptyformatted=String(n);this.attribute.mask=C;this.attribute.required=String(v);this.attribute.roundmode=J;this.attribute.roundposition=String(I);this.attribute.showmask=String(e);this.attribute.showtoday=String(x);this.attribute.validateformat=String(B);this.inputType=N;this.m_bIsDotZero=false;this.m_heCtrlInput;this.m_nInputButtomPointX=0;this.m_nInputButtomPointY=0;this.m_strRoundModeMask="";this.m_strShowMask="";this.objFormat;this.m_objInputButton=null;this.m_objColorButton=null;this.m_objCalendar=null;this.m_objSpin=null};SBGrid.CT.Input.prototype=new SBGrid.CT.TextArea;SBGrid.CT.Input.prototype.init=function(){SBGrid.CT.TextArea.prototype.init.call(this);if(null!=this.m_heCtrl){this.m_heCtrlInput=this.m_heCtrl;if("button"==this.inputType){this.m_objInputButton=this.createChild("softbowl:inputbutton","id:"+this.id+"_button;cursor:pointer;")}else{if("date"==this.inputType){this.m_objInputButton=this.createChild("softbowl:inputbutton","id:"+this.id+"_button;cursor:pointer;");var b="";if(this.attribute.showtoday=="true"){b="showtoday:true;"}this.m_objCalendar=this.createChild("softbowl:calendar","id:"+this.id+"_input_calendar;visibility:hidden;"+b);var c="";if(this.m_clCSSName.exists("input_calendar")){jQuery(this.m_objCalendar.m_heCtrl).addClass(this.m_clCSSName.item("input_calendar"))}if(""==this.attribute.format){this.attribute.format="yyyy-mm-dd"}}else{if("spin"==this.inputType){}}}if(this.getAttribute("class_inputbutton")!=""){jQuery(this.m_objInputButton.m_heCtrl).addClass(this.getAttribute("class_inputbutton"))}this.objFormat=new SBGrid.UT.Format(this.m_heCtrlInput,this.attribute.format,this.attribute.decimalformatinsert,this.attribute.maxlength);if("true"==this.attribute.showmask){this.m_strShowMask=this.attribute.format.replace(/(\w)|(\#)/g,"_")}if(-1!=this.attribute.format.indexOf(".0")){this.m_bIsDotZero=true}if("button"==this.inputType||"date"==this.inputType){if(!this.visible){this.m_objInputButton.setAttribute("visibility","hidden")}if(this.disabled){this.m_objInputButton.setAttribute("disabled","true")}}if(SBGrid.DEF.is_iphone||SBGrid.DEF.is_ipad){var a=this.m_heCtrlInput.style.background;a=""==a?"transparent":a;this.m_heCtrlInput.style.background="-webkit-gradient(linear, 0% 0%, 0% 100%, from("+a+"), to("+a+"))";this.m_heCtrlInput.style.webkitBorderRadius="0px";if(null==this.getAttribute("padding-left")||""==this.getAttribute("padding-left")){this.m_heCtrlInput.style.paddingLeft="0px"}}}};SBGrid.CT.Input.prototype.getAbility=function(){return SBGrid.CT.TextArea.prototype.getAbility.call(this)|SBGrid.DEF.SBEA_HSB_AS_FORMAT};SBGrid.CT.Input.prototype.refresh=function(){SBGrid.CT.BindableControl.prototype.refresh.call(this);if(null!=this.m_heCtrlInput){var a=this.attribute.jsonref;if(null==a||""==a){a=this.attribute.ref}if(null!=a&&""!=a){var e=this.getValue();if(this.value!=e){this.oldValue=this.value;this.value=e;this.setWindowText(e)}else{if(""==e&&""!=this.m_strShowMask){this.m_heCtrlInput.value=this.m_strShowMask}else{if(""==e&&null!=this.attribute.format){if(-1!=this.attribute.format.indexOf("0.0")){this.m_heCtrlInput.value="0".formatting(this.attribute.format)}}}}if("secret"!=this.inputType){this.label=this.m_heCtrlInput.value}else{var d="";var b=this.m_heCtrlInput.value.length;for(var c=0;c<b;c++){d+="*"}this.label=d}}}};SBGrid.CT.Input.prototype.getValue=function(){if(this.m_bBinded){return SBGrid.CT.TextArea.prototype.getValue.call(this)}return this.value};SBGrid.CT.Input.prototype.setValue=function(a){if(this.m_bBinded){SBGrid.CT.TextArea.prototype.setValue.call(this,a)}else{this.value=a}};SBGrid.CT.Input.prototype.setAttribute=function(b,d){SBGrid.CT.TextArea.prototype.setAttribute.call(this,b,d);switch(b){case"left":if(null!=this.m_objInputButton){var c=parseInt(d);var e=parseInt(this.attribute.width);this.m_objInputButton.setAttribute("left",(c+e-18)+"px")}if("date"==this.inputType){if(null!=this.m_objCalendar){var a=isFinite(d)?d+"px":d;this.m_objCalendar.setAttribute("left",a)}}break;case"width":if(null!=this.m_objInputButton){var c=parseInt(this.attribute.left);var e=parseInt(d);this.m_objInputButton.setAttribute("left",(c+e-18)+"px")}break;case"top":if(null!=this.m_objInputButton){this.m_objInputButton.setAttribute("top",d)}break;case"height":if(null!=this.m_objInputButton){this.m_objInputButton.setAttribute("height",d)}break;case"autonext":this.attribute.autonext=d;break;case"format":this.attribute.format=d;if("true"==this.attribute.showmask){this.m_strShowMask=this.attribute.format.replace(/(\w)|(\#)/g,"_")}if(-1!=this.attribute.format.indexOf(".0")){this.m_bIsDotZero=true}else{this.m_bIsDotZero=false}this.objFormat.init(d);break;case"inputtype":this.attribute.inputtype=d;break;case"isemptyformatted":this.attribute.isemptyformatted=d;break;case"mask":this.attribute.mask=d;break;case"required":this.attribute.required=d;break;case"roundmode":this.attribute.roundmode=d;break;case"roundposition":this.attribute.roundposition=d;break;case"showmask":this.attribute.showmask=d;if("true"==this.attribute.showmask){this.m_strShowMask=this.attribute.format.replace(/(\w)|(\#)/g,"_")}break;case"validateformat":this.attribute.validateformat=d;break;case"visibility":if("button"==this.inputType||"date"==this.inputType){this.m_objInputButton.setAttribute("visibility",value)}else{if("spin"==this.inputType){}}case"datatype":if(null!=this.m_heCtrl){this.m_heCtrl.setAttribute("datatype",d)}}};SBGrid.CT.Input.prototype.setInputType=function(a){if(this.inputType==a||a=="secret"){return}if("button"==a||"date"==a){if(null==this.m_objInputButton){this.m_objInputButton=this.createChild("softbowl:inputbutton","id:"+this.id+".button;")}else{this.m_objInputButton.m_heCtrl.style.display="block"}}else{if(null!=this.m_objInputButton){this.m_objInputButton.m_heCtrl.style.display="none"}}if("date"==a){this.attribute.format="yyyy-mm-dd";if(null==this.m_objCalendar){this.m_objCalendar=this.createChild("softbowl:calendar","id:input.calendar;visibility:hidden;");if(this.m_clCSSName.exists("input_calendar")){jQuery(this.m_objCalendar.m_heCtrl).addClass(this.m_clCSSName.item("input_calendar"))}}else{this.m_objCalendar.m_heCtrl.style.display="block"}}else{this.attribute.format="";if(null!=this.m_objCalendar){this.m_objCalendar.m_heCtrl.style.display="none"}}if(!this.visible){this.m_objCalendar.m_heCtrl.style.display="none";this.m_objInputButton.m_heCtrl.style.display="none"}if(this.disabled){this.m_objCalendar.setAttribute("disabled","true");this.m_objInputButton.setAttribute("disabled","true")}this.attribute.inputtype=a;this.inputType=a};SBGrid.CT.Input.prototype.setVisible=function(a,b){SBGrid.CT.TextArea.prototype.setVisible.call(this,a,b);if("button"==this.inputType||"date"==this.inputType){this.m_objInputButton.setVisible(a,b)}else{if("spin"==this.inputType){}}};SBGrid.CT.Input.prototype.setWindowText=function(a){this.m_heCtrlInput.value=a;if(this.objFormat.getFormatExist()){this.objFormat.init(this.attribute.format,true);if("exclude"==this.attribute.mask){this.value=this.objFormat.getFormatInputData();if(""!=this.attribute.roundmode&&""!=this.attribute.roundposition){this.value=SBGrid.DEF.getRoundMode(this.m_heCtrlInput.value,this.attribute.roundmode,this.attribute.roundposition);this.m_heCtrlInput.value=this.value}}else{this.value=this.m_heCtrlInput.value;if(""!=this.attribute.roundmode&&""!=this.attribute.roundposition){this.value=SBGrid.DEF.getRoundMode(this.m_heCtrlInput.value,this.attribute.roundmode,this.attribute.roundposition);this.m_heCtrlInput.value=this.value}this.setValue(this.value)}}};SBGrid.CT.Input.prototype.setButtomPosition=function(){this.m_nInputButtomPointX=this.m_heCtrl.offsetLeft+this.m_heCtrl.clientWidth-18;this.m_nInputButtomPointY=this.m_heCtrl.offsetTop;var a=this.m_heCtrl;while(null!=a){if(SBGrid.DEF.is_firefox){a=a.parentNode}else{a=a.parentElement}this.m_nInputButtomPointX-=a.scrollLeft;this.m_nInputButtomPointY-=a.scrollTop;if("BODY"==a.tagName){break}}};SBGrid.CT.Input.prototype.setCaretPosition=function(a){this.m_nCaretStart=a;this.m_nCaretEnd=a;SBGrid.DEF.setCaretPosition(this.m_heCtrl,this.m_nCaretStart,this.m_nCaretStart)};SBGrid.CT.Input.prototype.getInputDateAttribute=function(){var a={};a.add("id","input_date");a.add("left",this.attribute.left);a.add("top",(Number(this.attribute.top.split("px")[0])+Number(this.attribute.height.split("px")[0]))+"px");a.add("width","190px");a.add("height","140px");a.add("navindex","-1");return a};SBGrid.CT.Input.prototype.showCalendar=function(h){if(h){this.m_objCalendar.parent=this;var l=nViewportHeight;var o=nViewportWidth;var c=0;var a=0;var e=this.m_heCtrl;if(null!=e){if(this.getClientLeft(true)+this.m_objCalendar.m_heCtrl.offsetWidth>o){a=(this.getClientLeft(true)-(this.m_objCalendar.m_heCtrl.offsetWidth-e.offsetWidth))}else{a=this.getClientLeft(true)}if(this.getClientTop(true)+e.offsetHeight+this.m_objCalendar.m_heCtrl.offsetHeight>l){c=(this.getClientTop(true)-this.m_objCalendar.m_heCtrl.offsetHeight)}else{c=(this.getClientTop(true)+e.offsetHeight)}}this.m_objCalendar.setAttribute("top",c+"px");this.m_objCalendar.setAttribute("left",a+"px");var n=this.getValue();if(""!=n){var i=this.getAttribute("format");i=i.replace(/\W/g,"");n=n.replace(/\W/g,"");var g=null;var d=null;var b=null;var m=i.indexOf("y");if(-1!=m&&"y"==i.charAt(m+3)){g=Number(n.substr(m,4))}var p=i.indexOf("m");if(-1!=p&&"m"==i.charAt(p+1)){d=Number(n.substr(p,2))}var f=i.indexOf("d");if(-1!=f&&"d"==i.charAt(f+1)){b=Number(n.substr(f,2))}if(null!=g&&g>99){this.m_objCalendar.year=g.toString()}if(null!=d&&d>0){this.m_objCalendar.month=d.toString()}if(null!=b&&b>0){this.m_objCalendar.day=b.toString()}this.m_objCalendar.refresh()}else{this.m_objCalendar.setToday()}}this.m_objCalendar.setVisible(h)};SBGrid.CT.Input.prototype.onBlur=function(a){var e=false;var l=this.attribute.format;var h=this.attribute.ref;if("true"==this.attribute.editable){var g=this.getValue();var m="";if(null!=l&&!l.isEmpty()){if("true"==this.attribute.showmask){this.m_heCtrlInput.value=this.m_heCtrlInput.value==this.m_strShowMask?"":this.m_heCtrlInput.value;this.m_heCtrlInput.value=this.m_heCtrlInput.value==""?this.m_strShowMask:this.m_heCtrlInput.value}if(this.m_bIsDotZero&&!this.objFormat.m_bIsEmptyFormatted&&"true"==this.attribute.isemptyformatted){this.m_heCtrlInput.value=this.m_heCtrlInput.value.replace(/\.(0+)/g,"")}if("exclude"==this.attribute.mask){this.objFormat.init(l);m=this.objFormat.getFormatInputData()}else{m=this.m_heCtrlInput.value;if(2==this.objFormat.m_nMoneyUnitFormatPattern&&!this.attribute.roundmode.isEmpty()&&!this.attribute.roundposition.isEmpty()){m=SBGrid.DEF.getRoundMode(m,this.attribute.roundmode,this.attribute.roundposition)}}if("true"==this.attribute.validateformat){this.dispatch("onbeforevalidation");if(this.objFormat.m_nLength==this.m_heCtrlInput.value.length){this.dispatch("onvalidformat")}else{if((!this.objFormat.m_bExistMoneyUnitFormat)||(this.objFormat.m_bExistMoneyUnitFormat&&0==this.m_heCtrlInput.value.length)){this.dispatch("oninvalidformat")}else{this.dispatch("onvalidformat")}}}}else{m=this.m_heCtrlInput.value}if(g!=m){if(m==this.m_strShowMask){m=""}if("softbowl:comboinput"==this.tag&&"search"==this.parent.getAttribute("editmode")){var b=false;if(null!=m&&!m.isEmpty()){for(var f=0;f<this.parent.m_nRows;f++){for(var d=0;d<this.parent.m_nCols;d++){var c=this.parent.getCell(f,d);if(null!=c&&c.label==m){b=true;break}}if(b){break}}}if(!b){m=""}}if("softbowl:comboinput"!=this.tag){this.setText(m)}this.setValue(m);if(this.m_bBinded){this.refreshCurrentModel(this.attribute.ref)}else{if(h.isEmpty()){this.setText(g);this.setValue(g);this.setWindowText(g)}}if(this.m_bIsDotZero&&!this.objFormat.m_bIsEmptyFormatted&&"true"==this.attribute.isemptyformatted){this.m_heCtrlInput.value=this.m_heCtrlInput.value.replace(/\.(0+)/g,"")}if(this.getAttribute("skipvaluechanged")!="true"){e=true}}else{if(this.m_bIsDotZero&&"true"==this.attribute.isemptyformatted){this.m_heCtrlInput.value=this.m_heCtrlInput.value.replace(/\.(0+)/g,"")}}if(2==this.objFormat.m_nMoneyUnitFormatPattern&&!this.attribute.roundmode.isEmpty()&&!this.attribute.roundposition.isEmpty()){this.m_strRoundModeMask=this.m_heCtrlInput.value;this.m_heCtrlInput.value=SBGrid.DEF.getRoundMode(this.m_strRoundModeMask,this.attribute.roundmode,this.attribute.roundposition)}if(this.m_objCalendar&&!this.m_objCalendar.isDescendants(a.relatedTarget,true)){this.showCalendar(false)}SBGrid.CT.Group.prototype.onBlur.call(this,a);if(this.getAttribute("skipvaluechanged")!="true"&&e){this.dispatch("onvaluechanged");this.dispatch("SBUx_value_changed")}}};SBGrid.CT.Input.prototype.onFocus=function(a){SBGrid.CT.TextArea.prototype.onFocus.call(this,a);if(a.target==this.id){var b=this.getAttribute("format");if(!b.isEmpty()){if(0==this.m_heCtrlInput.value.length&&"true"==this.attribute.showmask){this.m_heCtrlInput.value=this.m_strShowMask}else{if(this.m_bIsDotZero&&"true"==this.attribute.isemptyformatted){if(-1==this.m_heCtrlInput.value.indexOf(".")){this.objFormat.m_bIsEmptyFormatted=false;this.m_heCtrlInput.value+=".0"}}}if(2==this.objFormat.m_nMoneyUnitFormatPattern&&!this.attribute.roundmode.isEmpty()&&!this.attribute.roundposition.isEmpty()&&"exclude"==this.attribute.mask){if(""!=this.m_strRoundModeMask){this.m_heCtrlInput.value=this.m_strRoundModeMask}}}window.setTimeout("try{if (null != "+this.id+"){"+this.id+'.m_heCtrlInput.select();}else{document.SBHE_allElement.item("'+this.id+'").m_heCtrlInput.select();}}catch(e){}',0)}};SBGrid.CT.Input.prototype.onKeyDown=function(a){SBGrid.CT.TextArea.prototype.onKeyDown.call(this,a);var f=false;if(-1!=parseInt(this.attribute.maxlength)){var e=parseInt(this.attribute.maxlength);if(""!=this.attribute.format){if(this.objFormat.getMoneyUnitFormatExist()){if(-1!=this.attribute.format.indexOf(".")&&-1!=this.attribute.maxlength.indexOf(".")){var m=parseInt(this.attribute.maxlength.split(".")[0]);var n=this.objFormat.m_strInputRealityData;var g=-1!=n.indexOf(".")?n.indexOf("."):n.length;var c=SBGrid.DEF.getCaretPosition(this.m_heCtrl).start;var b=SBGrid.DEF.getCaretPosition(this.m_heCtrl).end;if(""!=this.objFormat.m_strDotZero){if(n.substring(g,n.length).length-1==this.objFormat.m_strDotZero.length&&c==b&&b==this.m_heCtrl.value.length){f=true}}if(m==g){if(((48<=a.keyCode&&a.keyCode<=57)||(96<=a.keyCode&&a.keyCode<=105))&&b==c&&(b<=this.m_heCtrl.value.indexOf(".")||(b>this.m_heCtrl.value.indexOf(".")&&-1==n.indexOf(".")&&110!=a.keyCode))){a.browserPreventDefault();a.browserStopPropagation();return}}}else{if(this.m_heCtrlInput.value.replaceAll(",","").replace(".","").length==e){f=true}}}else{if(this.m_heCtrlInput.value.length==e){f=true}}}else{if(this.m_heCtrlInput.value.length==e){f=true}}}else{if(""!=this.attribute.format){if(this.objFormat.getMoneyUnitFormatExist()&&""!=this.objFormat.m_strDotZero){var n=this.objFormat.m_strInputRealityData;var g=-1!=n.indexOf(".")?n.indexOf("."):n.length;var c=SBGrid.DEF.getCaretPosition(this.m_heCtrl).start;var b=SBGrid.DEF.getCaretPosition(this.m_heCtrl).end;if(n.substring(g,n.length).length-1==this.objFormat.m_strDotZero.length&&c==b&&b==this.m_heCtrl.value.length){f=true}}else{if(!this.objFormat.getMoneyUnitFormatExist()){if(this.m_heCtrlInput.value.length==this.attribute.format.length){f=true}}}}}if(a.keyCode==SBGrid.EVT.BACKSPACE||a.keyCode==SBGrid.EVT.DELETE){f=false}if(f){if(a.keyCode==SBGrid.EVT.LEFT||a.keyCode==SBGrid.EVT.UP||a.keyCode==SBGrid.EVT.RIGHT||a.keyCode==SBGrid.EVT.DOWN){return}else{this.dispatch("onmaxlength");if("true"==this.attribute.autonext){var l=SBGrid.DEF.getCaretPosition(this.m_heCtrl);if(l.start==l.end){if(null==this.m_isGridInput){if(null!=SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1]){var i=1;while(true){if(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+i].isEnable()){SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+i].id);a.browserPreventDefault();a.browserStopPropagation();break}i++}i=null}else{SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[0].id);a.browserPreventDefault();a.browserStopPropagation()}}else{this.m_bEndEdit=true}}}}}if(-1!=parseInt(this.attribute.maxbyte)){var h=0;var o=this.m_heCtrlInput.value;var d=SBGrid.DEF.SB_KOREAN.exec(o.substr(o.length-1,1));h=null!=d?2:1;if(this.m_heCtrlInput.value.getByte()+h>parseInt(this.attribute.maxbyte)){if(a.keyCode==SBGrid.EVT.BACKSPACE||a.keyCode==SBGrid.EVT.DELETE||a.keyCode==SBGrid.EVT.LEFT||a.keyCode==SBGrid.EVT.UP||a.keyCode==SBGrid.EVT.RIGHT||a.keyCode==SBGrid.EVT.DOWN){return}else{if("true"==this.attribute.autonext){var l=SBGrid.DEF.getCaretPosition(this.m_heCtrl);if(l.start==l.end){if(null==this.m_isGridInput){if(null!=SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1]){var i=1;while(true){if(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+i].isEnable()){SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+i].id);a.browserPreventDefault();a.browserStopPropagation();break}i++}i=null}else{SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[0].id);a.browserPreventDefault();a.browserStopPropagation()}}else{this.m_bEndEdit=true}}}}}}if(this.objFormat.getFormatExist()){if(a.keyCode==229){this.objFormat.stopKeyEvent(a)}if(8==a.keyCode||46==a.keyCode){if(!SBGrid.DEF.is_smartphone&&!this.objFormat.getMoneyUnitFormatExist()){this.objFormat.keypressFormatting(a)}else{if(!SBGrid.DEF.is_smartphone&&this.objFormat.getMoneyUnitFormatExist()){this.objFormat.moneyKeyCheck(a)}}}}};SBGrid.CT.Input.prototype.onKeyPress=function(a){SBGrid.CT.TextArea.prototype.onKeyPress.call(this,a);if(this.objFormat.getFormatExist()){if(a.keyCode!=229){if(!SBGrid.DEF.is_smartphone&&!this.objFormat.getMoneyUnitFormatExist()){this.objFormat.keypressFormatting(a)}else{if(!SBGrid.DEF.is_smartphone&&this.objFormat.getMoneyUnitFormatExist()){this.objFormat.keypressMoneyUnitFormatting(a)}else{if(SBGrid.DEF.is_smartphone){this.objFormat.keypressMoneyUnitFormatting(a)}}}}}};SBGrid.CT.Input.prototype.onKeyUp=function(b){SBGrid.CT.TextArea.prototype.onKeyUp.call(this,b);if(!SBGrid.DEF.is_ie){if(-1!=parseInt(this.attribute.maxbyte)){if(this.m_heCtrlInput.value.getByte()+1>=parseInt(this.attribute.maxbyte)){var n=this.m_heCtrlInput.value.setByteWithStrLength(parseInt(this.attribute.maxbyte));this.m_heCtrlInput.value=n}}}var e=false;if(-1!=parseInt(this.attribute.maxlength)){var d=parseInt(this.attribute.maxlength);if(""!=this.attribute.format){if(this.objFormat.getMoneyUnitFormatExist()){if(-1!=this.attribute.format.indexOf(".")&&-1!=this.attribute.maxlength.indexOf(".")){var i=parseInt(this.attribute.maxlength.split(".")[0]);var m=this.objFormat.m_strInputRealityData;var f=-1!=m.indexOf(".")?m.indexOf("."):m.length;var c=SBGrid.DEF.getCaretPosition(this.m_heCtrl).start;var a=SBGrid.DEF.getCaretPosition(this.m_heCtrl).end;if(""!=this.objFormat.m_strDotZero){if(m.substring(f,m.length).length-1==this.objFormat.m_strDotZero.length&&c==a&&a==this.m_heCtrl.value.length){e=true}}if(i==f){if(((48<=b.keyCode&&b.keyCode<=57)||(96<=b.keyCode&&b.keyCode<=105))&&a==c&&(a<=this.m_heCtrl.value.indexOf(".")||(a>this.m_heCtrl.value.indexOf(".")&&-1==m.indexOf(".")&&110!=b.keyCode))){b.browserPreventDefault();b.browserStopPropagation();return}}}else{if(this.m_heCtrlInput.value.replaceAll(",","").replace(".","").length==d){e=true}}}else{if(this.m_heCtrlInput.value.length==d){e=true}}}else{if(this.m_heCtrlInput.value.length==d){e=true}}}else{if(""!=this.attribute.format){if(this.objFormat.getMoneyUnitFormatExist()&&""!=this.objFormat.m_strDotZero){var m=this.objFormat.m_strInputRealityData;var f=-1!=m.indexOf(".")?m.indexOf("."):m.length;var c=SBGrid.DEF.getCaretPosition(this.m_heCtrl).start;var a=SBGrid.DEF.getCaretPosition(this.m_heCtrl).end;if(m.substring(f,m.length).length-1==this.objFormat.m_strDotZero.length&&c==a&&a==this.m_heCtrl.value.length){e=true}}else{if(!this.objFormat.getMoneyUnitFormatExist()){if(this.m_heCtrlInput.value.length==this.attribute.format.length){e=true}}}}}if(b.keyCode==SBGrid.EVT.BACKSPACE||b.keyCode==SBGrid.EVT.DELETE){e=false}if(e){if((b.keyCode==SBGrid.EVT.LEFT||b.keyCode==SBGrid.EVT.UP||b.keyCode==SBGrid.EVT.RIGHT||b.keyCode==SBGrid.EVT.DOWN)||b.keyCode==SBGrid.EVT.TAB||b.keyCode==SBGrid.EVT.SHIFT){return}else{this.dispatch("onmaxlength");if("true"==this.attribute.autonext){var h=SBGrid.DEF.getCaretPosition(this.m_heCtrl);if(h.start==h.end){if(null==this.m_isGridInput){if(null!=SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1]){var g=1;while(true){if(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+g].isEnable()){SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+g].id);b.browserPreventDefault();b.browserStopPropagation();break}g++}g=null}else{SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[0].id);b.browserPreventDefault();b.browserStopPropagation()}}else{this.m_bEndEdit=true}}}}}if(-1!=parseInt(this.attribute.maxbyte)){if(this.m_heCtrlInput.value.getByte()>=parseInt(this.attribute.maxbyte)){if(b.keyCode==SBGrid.EVT.BACKSPACE||b.keyCode==SBGrid.EVT.DELETE||b.keyCode==SBGrid.EVT.LEFT||b.keyCode==SBGrid.EVT.UP||b.keyCode==SBGrid.EVT.RIGHT||b.keyCode==SBGrid.EVT.DOWN){return}else{if("true"==this.attribute.autonext){var h=SBGrid.DEF.getCaretPosition(this.m_heCtrl);if(h.start==h.end){if(null==this.m_isGridInput){if(null!=SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1]){var g=1;while(true){if(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+g].isEnable()){SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+g].id);b.browserPreventDefault();b.browserStopPropagation();break}g++}g=null}else{SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[0].id);b.browserPreventDefault();b.browserStopPropagation()}}else{this.m_bEndEdit=true}}}}}}var l=this.m_heCtrl.value;this.label=l};SBGrid.CT.Input.prototype.onMouseDown=function(a){SBGrid.CT.TextArea.prototype.onMouseDown.call(this,a)};SBGrid.CT.Input.prototype.onMouseMove=function(a){SBGrid.CT.TextArea.prototype.onMouseMove.call(this,a)};SBGrid.CT.Input.prototype.onMouseUp=function(a){SBGrid.CT.TextArea.prototype.onMouseUp.call(this,a)};SBGrid.CT.Input.prototype.onDrop=function(a){SBGrid.CT.TextArea.prototype.onDrop.call(this,a)};SBGrid.CT.Input.prototype.onClick=function(a){SBGrid.CT.TextArea.prototype.onClick.call(this,a);if(("date"==this.inputType||"button"==this.inputType)&&null!=this.m_objInputButton&&this.m_objInputButton.getId()==a.target){this.dispatch("onbuttonclick");if("date"==this.inputType){this.showCalendar(!this.m_objCalendar.visible)}}else{if("colorpopup"==this.inputType&&null!=this.m_objColorButton&&this.m_objColorButton.getId()==a.target){this.dispatch("oncolorbuttonclick")}else{if("spin"==this.inputType&&null!=this.m_objSpin&&this.m_objSpin.getId()==a.target){}}}};SBGrid.CT.Input.prototype.onDblClick=function(a){SBGrid.CT.TextArea.prototype.onDblClick.call(this,a);if(!this.disabled&&""!=this.inputType){if("spin"==this.inputType){if(this.m_nInputButtomPointX<a.clientX){if(this.m_nInputButtomPointY+(this.m_heCtrl.clientHeight/2)>a.clientY){this.dispatch("onspindbup")}else{this.dispatch("onspindbdown")}}}}};SBGrid.CT.Input.prototype.onDaySelect=function(b){var c=this.getValue();var d=this.getAttribute("format");var e="";var f=d.match(/(y+)|(m+)|(d+)/g);if(""==this.m_objCalendar.day){return}for(var a=0;a<f.length;a++){if(-1!=f[a].indexOf("y")){e+=String(this.m_objCalendar.year)}else{if(-1!=f[a].indexOf("m")){e+=String(parseInt(this.m_objCalendar.month)>9?this.m_objCalendar.month:"0"+this.m_objCalendar.month)}else{e+=String(parseInt(this.m_objCalendar.day)>9?this.m_objCalendar.day:"0"+this.m_objCalendar.day)}}}if("include"==this.getAttribute("mask")){if(null==e){e=""}e=e.formatting(d)}if(c!=e){this.setWindowText(e);this.setValue(e);if(this.isBinded()){this.refreshCurrentModel(this.attribute.ref)}if("true"!=this.getAttribute("skipvaluechanged")){this.dispatch("onvaluechanged");this.dispatch("SBUx_value_changed")}}this.showCalendar(false)};SBGrid.CT.Input.prototype.defaultAction=function(b,a){SBGrid.CT.TextArea.prototype.defaultAction.call(this,b,a);switch(b){case"ondayselect":this.onDaySelect(a);break;case"oncolorselect":this.onColorSelect(a);break;case"onautomaticcolor":break;case"oncustomcolor":break;case"onhidepopup":break;case"onbeforevalidation":break;case"oninvalidformat":break;case"onspinupbuttonclick":break;case"onspindownbuttonclick":break}};SBGrid.CT.Input.create=function(a,c,d){SBGrid.CT.Element.createParentDiv(a);c=SBGrid.CT.Element.createClassName(c,"input");var e=SBGrid.CT.Input.createMainNode(c);var b=document.getElementById(a);if(b==null){b=document.getElementById("SBHE_"+a)}if(b==null){return}b.appendChild(e);e=SBGrid.CT.Input.createSubNodes(e,c);return SBGrid.CT.Input.createObject(a,e,c,d)};SBGrid.CT.Input.createMainNode=function(a){var c=document.createElement("input");var b=document.getElementById("SBHE_"+a.item("id"));if(b){jQuery(b).remove()}c=SBGrid.CT.Input.createAttribute(c,a);jQuery(c).addClass("sbgrid_input");jQuery(c).addClass("sbgrid_boxsizing");return c};SBGrid.CT.Input.createSubNodes=function(b,a){return b};SBGrid.CT.Input.createObject=function(v,O,A,I){var y="";var t="";var n="";var m="";var z=true;var Q="";var i="";var M=false;var q=false;var e=false;var b=true;var E=true;var u="";var h=false;var f="";var g="";var L="";var K="";var p=false;var H="exclude";var l=-1;var s=-1;var J=9007199254740992;var x="default";var N="";var a="";var B=false;var F="";var o=0;var P=false;var D=false;var G=false;var C="visible";var d="";var r=A.getCollection();for(var c in r){switch(c){case"alert":y=r[c];break;case"help":t=r[c];break;case"hint":n=r[c];break;case"accesskey":m=r[c];break;case"autonext":if("true"==r[c]){z=true}break;case"bind":Q=r[c];break;case"class":i=r[c];break;case"disabled":if("true"==r[c]){M=true}break;case"dragmode":if("true"==r[c]){q=true}case"dropmode":if("true"==r[c]){e=true}break;case"editable":if("false"==r[c]){b=false}break;case"editmenu":if("false"==r[c]){E=false}break;case"format":u=r[c];break;case"decimalformatinsert":h=r[c];break;case"id":f=r[c];break;case"imemode":g=r[c];break;case"inputtype":L=r[c];break;case"invalidcharacters":K=r[c];break;case"isemptyformatted":if("true"==r[c]){p=true}break;case"mask":H=r[c];break;case"maxbyte":nMaxbyte=parseInt(r[c]);break;case"maxlength":s=parseInt(r[c]);break;case"navindex":J=parseInt(r[c]);break;case"pastemode":strPastemode=r[c];break;case"ref":N=r[c];break;case"jsonref":a=r[c];break;case"required":if("true"==r[c]){B=true}break;case"roundmode":F=r[c];break;case"roundposition":o=parseInt(r[c]);break;case"showmask":if("true"==r[c]){P=true}break;case"showtoday":if("true"==r[c]){D=true}break;case"validateformat":if("true"==r[c]){G=true}break;case"visibility":C=r[c];break;default:if(!SBGrid.DEF.SB_STYLELIST[c]){d+=c+":"+r[c]+"; "}break}}r=null;var w=new SBGrid.CT.Input(v,y,t,n,m,z,Q,i,M,q,e,b,E,u,h,f,g,L,K,p,H,l,s,J,"",x,N,a,B,F,o,"none","",P,D,I,"softbowl:input",G,C,d);return w};SBGrid.CT.Input.createAttribute=function(b,a){b=SBGrid.CT.TextArea.createAttribute(b,a);return b};SBGrid.CT.Input.prototype.applyDefaultStyle=function(){};SBGrid.CT.Input.prototype.resize=function(){clearTimeout(this.resizeEvt);this.resizeEvt=setTimeout("if(typeof SBUx != 'undefined' && SBUx.getComponent('"+this.id+"')){SBUx.getComponent('"+this.id+"').dispatch('onresize');}",30)};SBGrid.CT.Input.prototype.onResize=function(a){if(this.inputType=="button"||this.inputType=="date"){if(this.m_objInputButton){this.m_objInputButton.reposition()}}};SBGrid.CT.InputButton=function(b,g,c,f,e,d,a){if(!f){return}SBGrid.CT.Button.call(this,b,"","","","","",false,"",g,c,false,"","","",f,"","","",-1,false,e,d,a)};SBGrid.CT.InputButton.prototype=new SBGrid.CT.Button;SBGrid.CT.InputButton.create=function(a,c,d){c=SBGrid.CT.Element.createClassName(c,"inputbutton");var e=SBGrid.CT.InputButton.createMainNode(a,c);if(null!=e){var b=document.getElementById("SBHE_"+a);b.parentNode.appendChild(e);SBGrid.DEF.__attachEventHandler(e.id);SBGrid.DEF.__attachBlurEventHandler(e.id);b.style.paddingRight="18px";return SBGrid.CT.InputButton.createObject(a,e,c,d)}return null};SBGrid.CT.InputButton.createMainNode=function(b,i){var a=document.SBHE_allElement.item(b);if(null!=a){var d=a.m_heCtrl.offsetWidth;var c=a.m_heCtrl.offsetHeight;var e=a.m_heCtrl.offsetLeft;var m=a.m_heCtrl.offsetTop;var f=document.createElement("button");SBGrid.CT.InputButton.createAttribute(f,i);var l="";if(i.exists("input_inputbutton")){l=i.item("input_inputbutton")}jQuery(f).addClass("sbgrid_inputbutton "+l);var h=SBGrid.UT.HtmlLib.getStyle(a.m_heCtrl,"border-width");var g=0;if(h==""){g=(c-jQuery(a.m_heCtrl).innerHeight())/2}else{g=parseInt(h.replace("px",""))}e=e+d-18-g;d=d-g;c=c-(g*2);SBGrid.UT.HtmlLib.setStyle(f,"left",e+"px");SBGrid.UT.HtmlLib.setStyle(f,"top",(m+g)+"px");SBGrid.UT.HtmlLib.setStyle(f,"width",18+"px");SBGrid.UT.HtmlLib.setStyle(f,"height",c+"px");return f}return null};SBGrid.CT.InputButton.createObject=function(b,f,i,a){var c="";var e=false;var m="";var l="visible";var g="";var h=i.getCollection();for(var n in h){switch(n){case"class":c=h[n];break;case"disabled":if("true"==h[n]){e=true}break;case"id":m=h[n];break;case"visibility":l=h[n];break;default:if(!SBGrid.DEF.SB_STYLELIST[n]){g+=n+":"+h[n]+"; "}break}}h=null;var d=new SBGrid.CT.InputButton(b,c,e,m,a,"softbowl:inputbutton",l,g);return d};SBGrid.CT.InputButton.createAttribute=function(b,a){b=SBGrid.CT.TextArea.createAttribute(b,a);return b};SBGrid.CT.InputButton.prototype.reposition=function(){if(!this.parent){return}var c=document.SBHE_allElement.item(this.parent.id);if(null!=c){var h=c.m_heCtrl.offsetWidth;var b=c.m_heCtrl.offsetHeight;var e=c.m_heCtrl.offsetLeft;var g=c.m_heCtrl.offsetTop;var f=this.m_heCtrl;var a=SBGrid.UT.HtmlLib.getStyle(c.m_heCtrl,"border-width");var d=0;if(a==""){d=(b-jQuery(c.m_heCtrl).innerHeight())/2}else{d=parseInt(a.replace("px",""))}e=e+h-18-d;h=h-d;b=b-(d*2);SBGrid.UT.HtmlLib.setStyle(f,"left",e+"px");SBGrid.UT.HtmlLib.setStyle(f,"top",(g+d)+"px");SBGrid.UT.HtmlLib.setStyle(f,"width",18+"px");SBGrid.UT.HtmlLib.setStyle(f,"height",b+"px")}};SBGrid.CT.InputSpin=function(b,g,c,f,e,d,a){if(!f){return}SBGrid.CT.Group.call(this,b,"","","","","",g,c,f,-1,"","","",false,"","","",e,"softbowl:spinupbutton",a)};SBGrid.CT.InputSpin.prototype=new SBGrid.CT.Group;SBGrid.CT.InputSpin.prototype.getBindingType=function(){return SBGrid.DEF.SB_NONE};SBGrid.CT.InputSpin.create=function(a,c,d){c=SBGrid.CT.Element.createClassName(c,"inputspin");var e=SBGrid.CT.InputSpin.createMainNode(a,c);if(null!=e){var b=document.getElementById("SBHE_"+a);b.parentNode.appendChild(e);b.style.paddingRight="18px";return SBGrid.CT.InputSpin.createObject(a,e,c,d)}return null};SBGrid.CT.InputSpin.createMainNode=function(b,e){var d=document.SBHE_allElement.item(b);if(null!=d){var f=Number(d.attribute.left.split("px")[0]);var g=Number(d.attribute.top.split("px")[0]);var h=Number(d.attribute.width.split("px")[0]);var c=Number(d.attribute.height.split("px")[0]);var a=document.createElement("div");SBGrid.CT.InputSpin.createAttribute(heInputSpin,e);heInputSpin.style.position="absolute";heInputSpin.style.left=(f+h-18)+"px";heInputSpin.style.top=g+"px";heInputSpin.style.width="18px";heInputSpin.style.height=c+"px";heInputSpin.style.borderWidth="1px";heInputSpin.style.backgroundRepeat="no-repeat";heInputSpin.style.backgroundPosition="center center";if(SBGrid.DEF.is_ie){heInputSpin.style.width="17px";heInputSpin.style.height=(c-1)+"px";heInputSpin.style.top=(g+1)+"px"}return heInputSpin}return null};SBGrid.CT.InputSpin.createObject=function(b,c,i,a){var d="";var f=false;var m="";var l="visible";var g="";var h=i.getCollection();for(var n in h){switch(n){case"class":d=h[n];break;case"disabled":if("true"==h[n]){f=true}break;case"id":m=h[n];break;case"visibility":l=h[n];break;default:if(!SBGrid.DEF.SB_STYLELIST[n]){g+=n+":"+h[n]+"; "}break}}h=null;var e=new SBGrid.CT.InputSpin(b,d,f,m,a,"softbowl:inputbutton",l,g);return e};SBGrid.CT.InputSpin.createAttribute=function(b,a){b=SBGrid.CT.TextArea.createAttribute(b,a);return b};SBGrid.CT.SpinUpButton=function(b,f,c,e,d,a){if(!e){return}SBGrid.CT.Button.call(this,b,"","","","","",false,"",f,c,false,"","","",e,"","","",-1,false,d,a)};SBGrid.CT.SpinUpButton.prototype=new SBGrid.CT.Button;SBGrid.CT.SpinDownButton=function(b,f,c,e,d,a){if(!e){return}SBGrid.CT.Button.call(this,b,"","","","","",false,"",f,c,false,"","","",e,"","","",-1,false,d,a)};SBGrid.CT.SpinDownButton.prototype=new SBGrid.CT.Button;SBGrid.CT.Secret=function(t,v,r,o,i,F,Q,g,L,p,d,b,I,s,e,l,O,B,n,D,q,N,G,h,A,M,a,w,K,J,z,H,f,u,y,m,E,P,C,x,c){if(!e){return}SBGrid.CT.Input.call(this,t,v,r,o,i,F,Q,g,L,p,d,b,I,s,false,e,l,O,B,n,D,q,N,G,h,A,M,a,w,K,J,z,H,f,false,E,P,C,x,c);this.attribute.secretendposition=String(u);this.attribute.secretmark=y;this.attribute.secretstartposition=String(m)};SBGrid.CT.Secret.prototype=new SBGrid.CT.Input;SBGrid.CT.Secret.create=function(b,d,e){d=SBGrid.CT.Element.createClassName(d,"secret");var a=SBGrid.CT.Secret.createMainNode(d);var c=document.getElementById(b);if(c==null){c=document.getElementById("SBHE_"+b)}if(c==null){return}c.appendChild(a);a=SBGrid.CT.Secret.createSubNodes(a,d);return SBGrid.CT.Secret.createObject(b,a,d,e)};SBGrid.CT.Secret.createMainNode=function(b){var a=SBGrid.CT.Input.createMainNode(b);jQuery(a).removeClass("sbgrid_input");jQuery(a).addClass("sbgrid_secret");a.type="password";return a};SBGrid.CT.Secret.createSubNodes=function(a,b){return a};SBGrid.CT.Secret.createObject=function(e,D,B,F){var n="";var f="";var C="";var u="";var p="";var t="";var z=false;var y=false;var h=false;var w=true;var x=true;var a="";var E="";var m=-1;var A=9007199254740992;var i="";var c="";var r=-1;var l="*";var s=-1;var d="";var v="visible";var o="";var q=B.getCollection();for(var g in q){switch(g){case"alert":n=q[g];break;case"help":f=q[g];break;case"hint":C=q[g];break;case"accesskey":u=q[g];break;case"bind":p=q[g];break;case"class":t=q[g];break;case"disabled":if("true"==q[g]){z=true}break;case"dragmode":if("true"==q[g]){y=true}break;case"dropmode":if("true"==q[g]){h=true}break;case"editable":if("false"==q[g]){w=false}break;case"editmenu":if("false"==q[g]){x=false}break;case"id":a=q[g];break;case"imemode":E=q[g];break;case"maxlength":m=parseInt(q[g]);break;case"navindex":A=parseInt(q[g]);break;case"ref":i=q[g];break;case"jsonref":c=q[g];break;case"secretendposition":r=parseInt(q[g]);break;case"secretmark":l=q[g];break;case"secretstartposition":s=parseInt(q[g]);break;case"visibility":v=q[g];break;default:if(!SBGrid.DEF.SB_STYLELIST[g]){o+=g+":"+q[g]+"; "}break}}q=null;var b=new SBGrid.CT.Secret(e,n,f,C,u,false,p,t,z,y,h,w,x,"",a,E,"secret","",false,"",-1,m,A,"","",i,c,false,d,0,"none","",false,r,l,s,F,"softbowl:secret",false,v,o);return b};SBGrid.CT.Secret.createAttribute=function(b,a){b=SBGrid.CT.Input.createAttribute(b,a);return b};SBGrid.CT.Output=function(e,h,f,u,t,p,v,l,n,r,m,d,a,s,g,b,c,o,x,w,q,i){if(!a){return}SBGrid.CT.Caption.call(this,e,h,f,u,t,p,v,l,n,r,m,d,a,s,g,b,c,o,x,w,q,i)};SBGrid.CT.Output.prototype=new SBGrid.CT.Caption;SBGrid.CT.Output.create=function(b,d,e){d=SBGrid.CT.Element.createClassName(d,"output");var a=SBGrid.CT.Output.createMainNode(d);var c=document.getElementById(b);if(c==null){c=document.getElementById("SBHE_"+b)}if(c==null){return}c.appendChild(a);a=SBGrid.CT.Output.createSubNodes(a,d);return SBGrid.CT.Output.createObject(b,a,d,e)};SBGrid.CT.Output.createMainNode=function(c){var a=document.createElement("span");a=SBGrid.CT.Output.createAttribute(a,c);var b=c.item("autoresize");jQuery(a).addClass("sbgrid_caption_div sbgrid_boxsizing");return a};SBGrid.CT.Output.createSubNodes=function(b,d){var f=d.item("id");var h=document.createElement("table");h.cellspacing="0";h.cellpadding="0";h.onclick=function(){};h.ondbclick=function(){};h.onmousedown=function(){};h.onmousemove=function(){};h.onmouseup=function(){};var e=document.createElement("tbody");var g=document.createElement("tr");var a=document.createElement("td");jQuery(e).addClass("sbgrid_caption_tbody");var c=d.item("autoresize");if(null!=c){if("true"==c){jQuery(h).addClass("sbgrid_caption_table")}else{jQuery(h).addClass("sbgrid_caption_table sbgrid_table_fixed")}}else{jQuery(h).addClass("sbgrid_caption_table sbgrid_table_fixed")}jQuery(a).addClass("sbgrid_caption_td");a.setAttribute("id","SBHE_"+f+"_TEXT");if(b.getAttribute("text")){jQuery(a).text(b.getAttribute("text").newlineCharConvert())}g.appendChild(a);e.appendChild(g);h.appendChild(e);b.appendChild(h);return b};SBGrid.CT.Output.createObject=function(e,h,y,B){var m="";var f="";var A="";var z="";var u="";var p=false;var o="";var s="";var w=false;var r=false;var d="";var a="";var x=9007199254740992;var i="";var b="";var c="";var t=0;var v="visible";var n="";var q=y.getCollection();for(var g in q){switch(g){case"alert":m=q[g];break;case"help":f=q[g];break;case"hint":A=q[g];break;case"accesskey":u=q[g];break;case"autoreisze":if("true"==q[g]){p=true}break;case"bind":o=q[g];break;case"class":s=q[g];break;case"ellipsis":if("true"==q[g]){r=true}break;case"format":d=q[g];break;case"id":a=q[g];break;case"navindex":x=parseInt(q[g]);break;case"ref":i=q[g];break;case"jsonref":b=q[g];break;case"roundmode":strRoundMode=q[g];break;case"roundposition":nRoundPosition=parseInt(q[g]);break;case"visibility":v=q[g];break;default:if(!SBGrid.DEF.SB_STYLELIST[g]){n+=g+":"+q[g]+"; "}break}}q=null;var l=new SBGrid.CT.Output(e,m,f,A,z,u,p,o,s,w,r,d,a,x,i,b,c,t,B,"softbowl:output",v,n);return l};SBGrid.CT.Output.createAttribute=function(b,a){b=SBGrid.CT.BindableControl.createAttribute(b,a);b.cellSpacing=0;b.cellPadding=0;return b};SBGrid.CT.Select=function(s,v,r,o,n,L,q,h,i,H,G,p,m,f,B,M,C,l,I,a,D,y,x,E,A,K,J,w,g,c,b,t,F,u,z,d,e){if(!f){return}SBGrid.CT.Group.call(this,s,v,r,o,n,L,h,G,f,C,l,"",I,a,y,E,A,K,w,d);this.attribute.appearance=z;this.attribute.cellspacing=q;this.attribute.cols=i;this.attribute.direction=H;this.attribute.dragmode=String(p);this.attribute.dropmode=String(m);this.attribute.itemheight=B;this.attribute.itemwidth=M;this.attribute.rows=D;this.attribute.sep=x;this.attribute.vcellspacing=J;this.label;this.value;this.children;this.selected=false;this.mouseCol=0;this.mouseRow=0;this.focusIndex=-1;this.isnodeset=c;this.nodeset=b;this.jsonnodeset=t;this.labelref=F;this.valueref=u;this.checkImage="";this.unCheckImage="";this.disCheckImage="";this.disUnCheckImage="";this.itemLength=g>0?g:0;this.length=this.itemLength;this.choices;this.itemset;this.m_strUserStaticValue=e;this.htStaticValue;this.m_objItem;this.m_nCols;this.m_nRows;this.arItemList;this.m_arItemList;this.m_heItemList;this.m_arCloneNode;this.m_arCloneJson;this.m_nAppearance="full"==z?1:3;this.m_bIsReBuild=false};SBGrid.CT.Select.prototype=new SBGrid.CT.Group;SBGrid.CT.Select.prototype.init=function(){SBGrid.CT.Group.prototype.init.call(this);this.m_heCtrl.setAttribute("onscroll","SBGrid.DEF._W_onProcessEvent(window.event, 'onscroll', this.id.replace('SBHE_', ''))");this.checkImage=null!=this.attribute["select.background-image"]?this.attribute["select.background-image"]:this.checkImage;this.unCheckImage=null!=this.attribute["background-image"]?this.attribute["background-image"]:this.unCheckImage;this.disCheckImage=null!=this.attribute["disable.select.background-image"]?this.attribute["disable.select.background-image"]:this.disCheckImage;this.disUnCheckImage=null!=this.attribute["disable.background-image"]?this.attribute["disable.background-image"]:this.disUnCheckImage;var s=null;var l=null;this.itemCheckImage=null!=this.attribute["item.select.background-image"]?this.attribute["item.select.background-image"]:"";this.itemUnCheckImage=null!=this.attribute["item.disable.select.background-image"]?this.attribute["item.disable.select.background-image"]:"";this.itemDisCheckImage=null!=this.attribute["item.disable.select.background-image"]?this.attribute["item.disable.select.background-image"]:"";this.itemDisUnSelectImage=null!=this.attribute["item.disable.background-image"]?this.attribute["item.disable.background-image"]:"";var c=null;var b=null;var g="";var a=this.getAttribute("appearance");if("full"==a){s=null!=this.attribute["select.background-color"]?this.attribute["select.background-color"]:"";l=null!=this.attribute["select.color"]?this.attribute["select.color"]:"";c=null!=this.attribute["item.select.background-color"]?this.attribute["item.select.background-color"]:"";b=null!=this.attribute["item.select.color"]?this.attribute["item.select.color"]:"";g="id:"+this.id+".item; background-image:"+this.unCheckImage+"; select.background-image:"+this.checkImage+"; disable.background-image:"+this.disUnCheckImage+"; disable.select.background-image:"+this.disCheckImage+"; ";g+=" select.background-color:"+s+"; select.color:"+l+"; ";g+="item.select.background-image:"+this.itemCheckImage+"; item.disable.select.background-image:"+this.itemDisCheckImage+"; item.select.background-color:"+c+"; item.select.color:"+b+"; "}else{if("minimal"==a){g="id:"+this.id+".item; select.background-image:#select-menu; "}else{s=null!=this.attribute["select.background-color"]?this.attribute["select.background-color"]:"#00008B";l=null!=this.attribute["select.color"]?this.attribute["select.color"]:"#FFFFFF";c=null!=this.attribute["item.select.background-color"]?this.attribute["item.select.background-color"]:"#00008B";b=null!=this.attribute["item.select.color"]?this.attribute["item.select.color"]:"#FFFFFF";g="id:"+this.id+".item; select.background-color:"+s+"; select.color:"+l+"; ";g+="item.select.background-color:"+c+"; item.select.color:"+b+"; "}}s=null;l=null;this.m_objItem=this.createChild("softbowl:selectitem",g);this.choices=new SBGrid.DS.Choices(this.id,this.id+".choices","softbowl:choices");if(this.isnodeset){var r=new SBGrid.DS.Itemset(this.id+".choices",this.id+".itemset","softbowl:itemset");r.setAttribute("nodeset",this.nodeset);var e=new SBGrid.DS.Label(this.id+".itemset",this.id+".label","softbowl:label");e.setAttribute("ref",this.labelref);var f=new SBGrid.DS.Value(this.id+".itemset",this.id+".value","softbowl:value");f.setAttribute("ref",this.valueref);r.setLabel(e);r.setValue(f);this.choices.setItemset(r);this.initItemset()}else{if(null!=this.m_strUserStaticValue&&""!=this.m_strUserStaticValue){this.htStaticValue={};var h=this.m_strUserStaticValue.split("|");for(var d=0;d<h.length;d++){if(-1!=h[d].indexOf("^")){var o=h[d].split("^");var n=o[0];o.shift();this.htStaticValue[n]=o}}}}var p=this.getAttribute("cellspacing");this.makeCell();this.setAttribute("cellspacing",p);var m=this.children.getCollection();for(var d in m){var q=m[d];if(null!=q){if(!this.isnodeset&&"softbowl:cell"==q.attribute.tag){SBGrid.CF.Init(q);q.label=this.htStaticValue[q.id][0];q.value=this.htStaticValue[q.id][1];q.m_heCtrl.setAttribute("name",this.id+"_item");q.m_heCtrl.setAttribute("label",this.htStaticValue[q.id][0]);q.m_heCtrl.setAttribute("value",this.htStaticValue[q.id][1]);q.m_heCtrl.noWrap=true}else{if("softbowl:cell"==q.attribute.tag){SBGrid.CF.Init(q)}else{q.init()}}}}m=null;this.m_heItemList=document.getElementById("SBHE_"+this.id+"_allitem");SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=true};SBGrid.CT.Select.prototype.reBuild=function(){if(this.isnodeset){this.m_bIsReBuild=true;if(this.m_heItemList){this.m_heItemList.parentNode.removeChild(this.m_heItemList)}for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b){SBGrid.CF.UnInit(b)}}}this.initItemset();this.makeCell();for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b){SBGrid.CF.Init(b)}}}this.m_heItemList=document.getElementById("SBHE_"+this.id+"_allitem");SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=true}else{this.m_bIsReBuild=true;if(this.m_heItemList){this.m_heItemList.parentNode.removeChild(this.m_heItemList)}var d=0;for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b){var e=b.id;this.children.remove(e);document.SBHE_allElement.remove(e,b);d++}}}this.initItemset();this.makeCell();for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b){SBGrid.CF.Init(b)}}}this.m_heItemList=document.getElementById("SBHE_"+this.id+"_allitem");SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=true}};SBGrid.CT.Select.prototype.refresh=function(){if(null!=this.m_heCtrl){var a=this.getValue();if(null!=a){if(this.isnodeset){if(this.equlsChangeNode()){this.reBuild()}this.applySelectCell()}else{if(!this.isnodeset&&("softbowl:select"==this.attribute.tag||"full"==this.attribute.appearance)){this.reBuild();this.applySelectCell()}}this.applySelection(a)}}SBGrid.CT.Group.prototype.refresh.call(this)};SBGrid.CT.Select.prototype.applySelectCell=function(){var c=0;for(var d=0;d<this.m_nRows;d++){for(var b=0;b<this.m_nCols;b++){var a=this.getCell(d,b);if(null==a){continue}var f=null;if("downacross"==this.attribute.direction&this.isnodeset){f=this.arItemList[((this.m_nRows*b)+d)]}else{f=this.arItemList[c]}if(null==f){this.m_nCols=this.m_nCols-1;break}var e=f.label;var g=f.value;var h="";var l="";if((this.jsonnodeset!=""&&this.jsonnodeset!=null)||!this.isnodeset){h=e;l=g}else{h=SBGrid.UT.XmlLib.getTextValue(e);l=SBGrid.UT.XmlLib.getTextValue(g)}if(null!=a.m_heCtrl){if(h!=SBGrid.CF.GetLabel(a)||l!=SBGrid.CF.GetValue(a)){SBGrid.CF.SetLabel(a,h);SBGrid.CF.SetValue(a,l);if("true"==this.m_bShowValue){this.m_ShowValueStrLabel=l+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+h}else{this.m_ShowValueStrLabel=h}SBGrid.CF.SetLabelChange(a,this.m_ShowValueStrLabel)}}a.label=h;a.value=l;c++}}};SBGrid.CT.Select.prototype.equlsChangeNode=function(){if(this.jsonnodeset!=""&&this.jsonnodeset!=null){var strNodeSet=this.jsonnodeset;try{var oItemSetList=eval(strNodeSet);if(null==this.m_arCloneJson){this.m_arCloneJson=new Array();if(null!=oItemSetList){this.resetCloneJson(oItemSetList);return true}}if(null!=oItemSetList){if(oItemSetList.length!=this.m_arCloneJson.length){this.resetCloneJson(oItemSetList);return true}for(var i=0;i<oItemSetList.length;i++){if(oItemSetList[i]!=this.m_arCloneJson[i]){this.resetCloneJson(oItemSetList);return true}}}return false}catch(e){return false}}else{var strNodeSet=this.nodeset;if((strNodeSet.length-1)==strNodeSet.lastIndexOf("/")){strNodeSet=strNodeSet.substring(0,strNodeSet.length-1)}var xnItemSetList=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,strNodeSet);if(null==this.m_arCloneNode){this.m_arCloneNode=new Array();if(null!=xnItemSetList){this.resetCloneNode(xnItemSetList);return true}}if(null!=xnItemSetList){if(xnItemSetList.length!=this.m_arCloneNode.length){this.resetCloneNode(xnItemSetList);return true}else{if(1==xnItemSetList.length&&1==this.m_arCloneNode.length){if(null!=this.m_arCloneNode.m_nCloneLength){if(xnItemSetList.item(0).childNodes.length!=this.m_arCloneNode.m_nCloneLength){this.resetCloneNode(xnItemSetList);return true}}}}for(var i=0;i<xnItemSetList.length;i++){if(xnItemSetList.item(i)!=this.m_arCloneNode[i]){this.resetCloneNode(xnItemSetList);return true}}}return false}};SBGrid.CT.Select.prototype.resetCloneNode=function(a){this.m_arCloneNode=new Array();for(var b=0;b<a.length;b++){this.m_arCloneNode.push(a.item(b))}if(1==a.length){this.m_arCloneNode.m_nCloneLength=a.item(0).childNodes.length}};SBGrid.CT.Select.prototype.resetCloneJson=function(a){this.m_arCloneJson=new Array();for(var b=0;b<a.length;b++){this.m_arCloneJson.push(a[b])}};SBGrid.CT.Select.prototype.listBoxReSize=function(){var a=this.getAttribute("appearance");if("compact"==a){if(this.m_heCtrl.clientWidth>this.m_heItemList.clientWidth){this.m_heItemList.style.width="100%"}else{this.m_heItemList.style.width=""}}};SBGrid.CT.Select.prototype.item=function(b){var a=-1;var c=-1;a=parseInt(b/this.m_nCols);c=parseInt(b%this.m_nCols);return this.getCell(a,c)};SBGrid.CT.Select.prototype.setAttribute=function(a,b){SBGrid.CT.Group.prototype.setAttribute.call(this,a,b);switch(a){case"cellspacing":this.attribute.cellspacing=b;break;case"col":this.attribute.col=b;this.m_nSelectedCol=parseInt(this.attribute.col);this.mouseCol=this.m_nSelectedCol;break;case"cols":this.attribute.cols=b;this.m_nCols=parseInt(this.attribute.cols);this.reBuild();break;case"direction":this.attribute.direction=b;break;case"dragmode":this.attribute.dragmode=b;break;case"dropmode":this.attribute.dropmode=b;break;case"itemheight":this.attribute.itemheight=b;if(""!=b){this.setItemheight(b)}break;case"height":if("full"==this.attribute.appearance&&"visible"==this.attribute.overflow){if(this.m_nOverflowHeight>parseInt(b.replace("px",""))){this.m_heCtrl.style.height=this.m_nOverflowHeight+"px";this.attribute.height=this.m_nOverflowHeight+"px"}}break;case"itemwidth":this.attribute.itemwidth=b;if(""!=b){this.setItemwidth(b)}break;case"overflow":this.attribute.overflow=b;this.setOverflow(b);break;case"row":this.attribute.row=b;this.m_nSelectedRow=parseInt(this.attribute.row);this.mouseRow=this.m_nSelectedRow;break;case"rows":this.attribute.rows=b;break;case"scroll":this.attribute.scroll=b;this.setScroll(b);break;case"sep":this.attribute.sep=b;break;case"vcellspacing":this.attribute.vcellspacing=b;if(""!=b){this.setVcellspacing(b)}break}};SBGrid.CT.Select.prototype.setCheckImage=function(d){this.checkImage=d;this.m_objItem.setAttribute("select.background-image",d);this.m_objItem.m_jsonCssEvent.select="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heCtrl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select.prototype.setUnCheckImage=function(d){this.unCheckImage=d;this.m_objItem.setAttribute("background-image",d);this.m_objItem.m_jsonCssEvent.deselect="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heCtrl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select.prototype.setDisCheckImage=function(d){this.disCheckImage=d;this.m_objItem.setAttribute("disable.select.background-image",d);this.m_objItem.m_jsonCssEvent.disable="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heCtrl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select.prototype.setDisUnCheckImage=function(d){this.disUnCheckImage=d;this.m_objItem.setAttribute("disable.background-image",d);this.m_objItem.m_jsonCssEvent.dedisable="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heCtrl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select.prototype.setCellspacing=function(f){var a=parseInt(f.split("px")[0])/2;for(var d=0;d<this.m_nRows;d++){for(var b=0;b<this.m_nCols;b++){var c=this.getCell(d,b);if(null!=c){var e=c.m_heCtrl;if(null!=e){e.style.paddingLeft=a+"px";e.style.paddingRight=a+"px"}}}}};SBGrid.CT.Select.prototype.setVcellspacing=function(a){var f=parseInt(a.split("px")[0])/2;for(var d=0;d<this.m_nRows;d++){for(var b=0;b<this.m_nCols;b++){var c=this.getCell(d,b);if(null!=c){var e=c.m_heCtrl;if(null!=e){e.style.paddingTop=f+"px";e.style.paddingBottom=f+"px"}}}}};SBGrid.CT.Select.prototype.setItemwidth=function(d){var l=document.getElementById("SBHE_"+this.id+"_allitem");if(null!=l){var d=String(d);d=-1!=d.indexOf("px")?d:d+"px";if(SBGrid.DEF.is_ie7){if("COLGROUP"==l.firstChild.tagName){var g=l.firstChild.children;for(var e=0;e<this.m_nCols;e++){g.item(e).style.width=d}}else{var h=document.createElement("colgroup");var m=document.createElement("col");m.style.width=d;for(var e=0;e<this.m_nCols;e++){h.appendChild(m.cloneNode(true))}h.appendChild(document.createElement("col"));l.insertBefore(h,l.firstChild);for(var e=0;e<this.m_nRows;e++){for(var c=0;c<this.m_nCols;c++){var b=this.getCell(e,c);if(null!=b){var a=b.m_heCtrl;if(null!=a){a.style.paddingRight=""}}}}}}else{if("fixed"==l.style.tableLayout){var f=l.querySelectorAll("col[style]");for(var e=0;e<f.length;e++){f.item(e).style.width=d}}else{l.style.tableLayout="fixed";var h=document.createElement("colgroup");var m=document.createElement("col");m.style.width=d;for(var e=0;e<this.m_nCols;e++){h.appendChild(m.cloneNode(true))}h.appendChild(document.createElement("col"));l.insertBefore(h,l.firstChild);var f=l.querySelectorAll("td");for(var e=0;e<f.length;e++){f.item(e).style.paddingRight=""}}}}};SBGrid.CT.Select.prototype.setItemheight=function(a){for(var d=0;d<this.m_nRows;d++){for(var b=0;b<this.m_nCols;b++){var c=this.getCell(d,b);if(null!=c){var e=c.m_heCtrl;if(null!=e){e.style.height=a.split("px")[0]+"px"}}}}};SBGrid.CT.Select.prototype.getBindingType=function(){return SBGrid.DEF.SB_SINGLE};SBGrid.CT.Select.prototype.makeCell=function(){var h=this.attribute.cols;var g=this.attribute.rows;this.m_nCols=(""==h)||("*"==h)?1:parseInt(h);this.m_nRows=""==g?1:parseInt(g);if("*"==h&&(1<=this.m_nRows)){this.m_nCols=Math.ceil(this.itemLength/this.m_nRows)}else{this.m_nRows=Math.ceil(this.itemLength/this.m_nCols)}var f=0;var e=null;var d=null;var a=this.attribute.direction=="downacross"?true:false;for(var c=0;c<this.m_nRows;c++){for(var b=0;b<this.m_nCols&&f<this.itemLength;b++){if(a&&(this.m_nRows*b)+c>=this.itemLength){continue}e=this.id+"_"+c+"_"+b;d=this.children.item(e);d=null==d?new SBGrid.CT.SelectCell(this,b,e,c,"softbowl:cell"):d;this.children.add(e,d);document.SBHE_allElement.add(e,d);d.setElement(this.m_objItem);d.setIndex(f);d.selected=false;f++}}f=null;e=null;d=null};SBGrid.CT.Select.prototype.initItemset=function(){this.arItemList=new Array();if(this.isnodeset){if(this.m_heCtrl){if(null!=this.m_heItemList&&null!=this.m_heCtrl.firstChild){this.m_heCtrl.removeChild(this.m_heItemList)}}this.m_heCtrl=document.getElementById("SBHE_"+this.id);var strNodeSet=this.nodeset;if((strNodeSet.length-1)==strNodeSet.lastIndexOf("/")){strNodeSet=strNodeSet.substring(0,strNodeSet.length-1)}var strLabelRef=this.labelref;if(0==strLabelRef.indexOf("/")){strLabelRef=strLabelRef.substring(1)}var arLabelRefPath=strLabelRef.split("/");if(1!=arLabelRefPath.length){for(var i=0;i<arLabelRefPath.length-1;i++){strNodeSet=strNodeSet+"/"+arLabelRefPath[i]}strLabelRef=arLabelRefPath[arLabelRefPath.length-1]}var strValueRef=this.valueref;if(0==strValueRef.indexOf("/")){strValueRef=strValueRef.substring(1)}var arValueRefPath=strValueRef.split("/");if(1!=arValueRefPath.length){strValueRef=arValueRefPath[arValueRefPath.length-1]}this.itemLength=0;if(this.jsonnodeset!=""&&this.jsonnodeset!=null){try{this.itemLength=eval(this.jsonnodeset).length;for(var i=0;i<this.itemLength;i++){var data={label:eval(this.jsonnodeset+"["+i+"]."+strLabelRef),value:eval(this.jsonnodeset+"["+i+"]."+strValueRef)};this.arItemList.push(data)}}catch(e){SBGrid.DEF.errorMsg("jsonref를 이용한 itemset 구성 오류")}}else{var xlItemSetLabel=null;var xlItemSetValue=null;var nLabelLength=-1;var nValueLength=-1;if(""!=strLabelRef){xlItemSetLabel=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,strNodeSet+"/"+strLabelRef);nLabelLength=xlItemSetLabel.length}if(""!=strValueRef){xlItemSetValue=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,strNodeSet+"/"+strValueRef);nValueLength=xlItemSetValue.length}var nItemSetLength=nLabelLength>=nValueLength?nValueLength:nLabelLength;for(var i=0;i<nItemSetLength;i++){var data={label:xlItemSetLabel.item(i),value:xlItemSetValue.item(i)};this.arItemList.push(data)}this.itemLength=nItemSetLength}var strCols=this.attribute.cols;var strRows=this.attribute.rows;this.m_nCols=(""==strCols)||("*"==strCols)?1:parseInt(strCols);this.m_nRows=""==strRows?1:parseInt(strRows);if("*"==strCols&&(1<this.m_nRows)){this.m_nCols=Math.ceil(this.itemLength/this.m_nRows)}else{this.m_nRows=Math.ceil(this.itemLength/this.m_nCols)}}else{var strCols=this.attribute.cols;var strRows=this.attribute.rows;this.m_nCols=""==strCols?1:0==this.m_nCols?1:parseInt(strCols);this.m_nRows=""==strRows?1:"*"==strRows?1:0==this.m_nRows?1:parseInt(strRows);if("*"==strCols&&1<=this.m_nRows){this.m_nCols=Math.ceil(this.itemLength/this.m_nRows)}else{this.m_nRows=Math.ceil(this.itemLength/this.m_nCols)}}this.htStaticValue={};if(null!=this.m_strUserStaticValue&&""!=this.m_strUserStaticValue){var arCellList=this.m_strUserStaticValue.split("|");var cellListIndex=0;for(var i=0;i<this.m_nRows;i++){for(var j=0;j<this.m_nCols;j++){var strCellName=this.id+"_"+i+"_"+j;if(-1!=arCellList[cellListIndex].indexOf("^")){var arCellLabelAndValue=arCellList[cellListIndex].split("^");arCellLabelAndValue.shift();this.htStaticValue[strCellName]=arCellLabelAndValue;var data={label:this.htStaticValue[strCellName][0],value:this.htStaticValue[strCellName][1]};this.arItemList.push(data);cellListIndex++}}}}this.m_arItemList=new Array();this.m_arItemList.push("<table id='SBHE_"+this.id+"_allitem' cellPadding=0 cellSpacing=0 width='100%' ");var nTotalHeight="";var strItemHeight=this.getAttribute("itemheight");var strItemWidth=this.getAttribute("itemwidth");var strVcellSpacing=this.getAttribute("vcellspacing");var strCellSpacing=this.getAttribute("cellspacing");strItemHeight=(null!=strItemHeight)?strItemHeight.split("px")[0]:"";strItemWidth=(null!=strItemWidth)?strItemWidth.split("px")[0]:"";strVcellSpacing=(null!=strVcellSpacing)?strVcellSpacing.split("px")[0]:"";strCellSpacing=(null!=strCellSpacing)?strCellSpacing.split("px")[0]:"";if(""!=strItemWidth){if(!SBGrid.DEF.is_ie7){this.m_arItemList.push(" style='table-layout:fixed;'>")}else{this.m_arItemList.push(">")}this.m_arItemList.push("<colgroup>");for(var j=0;j<this.m_nCols;j++){this.m_arItemList.push("<col style='width:"+strItemWidth+"px'/>")}this.m_arItemList.push("<col/>");this.m_arItemList.push("</colgroup><tbody>")}else{this.m_arItemList.push("><tbody>")}var strPaddingTop="";var nPaddingTop=0;var strPaddingBottom="";var strPaddingRight="4px";if(""!=strItemHeight){if(18>parseInt(strItemHeight)){strItemHeight="18px"}else{strItemHeight=strItemHeight+"px"}}else{if(""==strVcellSpacing||"0"==strVcellSpacing){strItemHeight="18px"}else{strPaddingTop="padding-top:"+String(parseInt(strVcellSpacing)/2+1)+"px; ";nPaddingTop=parseInt(strVcellSpacing)/2+1;strPaddingBottom="padding-bottom:"+String(parseInt(strVcellSpacing)/2+1)+"px; "}}nTotalHeight=parseInt(strItemHeight.split("px")[0])+nPaddingTop;if(""!=strItemWidth){strItemWidth=strItemWidth+"px"}else{if(""!=strCellSpacing&&null!=strCellSpacing){var nCellSpacing=parseInt(strPaddingRight.replace("px",""))+parseInt(strCellSpacing);strPaddingRight=String(nCellSpacing)+"px"}}var strCSSName="class='sbgrid_selectitem"+this.m_nAppearance+" ";if(this.m_clCSSName.exists(SBGrid.DEF.SB_APPEARANCE[this.m_nAppearance]+"_selectitem")){strCSSName+=this.m_clCSSName.item(SBGrid.DEF.SB_APPEARANCE[this.m_nAppearance]+"_selectitem ")}if(this.m_clCSSName.exists(this.m_strLocalTag+"_selectitem")){strCSSName+=this.m_clCSSName.item(this.m_strLocalTag+"_selectitem")}var bIsTooltip="true"==this.attribute.selectitemtooltip;var nItemIndex=0;for(var i=0;i<this.m_nRows;i++){this.m_arItemList.push("<tr>");for(var j=0;j<this.m_nCols&&nItemIndex<this.arItemList.length;j++){var xnItem=null;if("downacross"==this.attribute.direction&&this.isnodeset){xnItem=this.arItemList[((this.m_nRows*j)+i)]}else{xnItem=this.arItemList[nItemIndex]}var xnLabel=xnItem.label;var xnValue=xnItem.value;var strLabel="";var strValue="";if((this.jsonnodeset!=""&&this.jsonnodeset!=null)||!this.isnodeset){strLabel=xnItem.label;strValue=xnItem.value}else{strLabel=SBGrid.UT.XmlLib.getTextValue(xnLabel);strValue=SBGrid.UT.XmlLib.getTextValue(xnValue)}var strTDId=this.id+"_"+i+"_"+j;var heTableTd;if(SBGrid.DEF.is_smartphone){this.m_arItemList.push("<td id='SBHE_"+strTDId+"' "+strCSSName+" "+strTDId+'_Attr\' onmousedown=" " onmousemove=" " onmouseup=" " ondblclick=" " onkeydown=" " onkeypress=" " onkeyup=" " name=\''+this.id+"_item' noWrap=true value='"+strValue+"' style='width:"+strItemWidth+";height:"+strItemHeight+";"+strPaddingTop+strPaddingBottom)}else{var strTooltip="";if(bIsTooltip){strTooltip=" title='"+strLabel+"' "}this.m_arItemList.push("<td id='SBHE_"+strTDId+"' "+strCSSName+" "+strTDId+"_Attr' "+strTooltip+'onmousedown=" " onmousemove=" " onmouseup=" " ondblclick=" " onkeydown=" " onkeypress=" " onkeyup=" " name=\''+this.id+"_item' noWrap=true value='"+strValue+"' label='"+strLabel+"' style='height:"+strItemHeight+";"+strPaddingTop+strPaddingBottom)}var bIsAddTd=false;if(j<this.m_nCols){this.m_arItemList.push("padding-right:"+strPaddingRight+";'>")}if(j!=0&&j==this.m_nCols-1){bIsAddTd=true}nItemIndex++;this.m_arItemList.push(""+strLabel+"</td>");if(bIsAddTd){this.m_arItemList.push("<td style='width:100%;'></td>")}}this.m_arItemList.push("</tr>")}this.m_arItemList.push("</tbody></table>");jQuery(this.m_heCtrl).html(this.m_arItemList.join(""));this.length=this.itemLength;nTotalHeight=nTotalHeight*this.m_nRows;if("visible"==this.getAttribute("overflow")){if(""==this.getAttribute("height")||(""!=this.getAttribute("height")&&nTotalHeight>(parseInt(this.getAttribute("height").replace("px",""))))){this.m_heCtrl.style.height=nTotalHeight+"px";this.attribute.height=nTotalHeight+"px";this.m_nOverflowHeight=nTotalHeight}}};SBGrid.CT.Select.prototype.defaultAction=function(b,a){SBGrid.CT.Group.prototype.defaultAction.call(this,b,a);if("onselect"==b){this.onSelect(a)}else{if("ondeselect"==b){this.onDeselect(a)}}};SBGrid.CT.Select.prototype.select=function(f){var h=this.getRefNode();if(null==h){return}if(this.isnodeset){var b=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset);if(0==b.length||f>=b.length){return}}this.m_nSelectedRow=parseInt(f/this.m_nCols);this.m_nSelectedCol=parseInt(f%this.m_nCols);var d=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null==d){return}var a=false;var c=h.item(0);if(null!=c){var l=SBGrid.UT.XmlLib.getTextValue(c);var p=SBGrid.CF.GetValue(d);var n="";var g=this.getAttribute("sep");if(!g.isEmpty()){var o=l.split(g);for(var e=0;e<o.length;e++){if(!o[e].isEmpty()){n+=o[e]+g;if(o[e]==p){return}}}}n+=p;SBGrid.UT.XmlLib.setTextValue(c,n);if(l!=n){a=true}}var m="";m=this.attribute.jsonref;if(m==""||m==null){m=this.attribute.ref}this.refreshCurrentModel(m);this.dispatch("onselect");this.dispatch("SBUx_select");if(a){this.dispatch("onvaluechanged");this.dispatch("SBUx_value_changed")}};SBGrid.CT.Select.prototype.deselect=function(f){var c=false;if(null==f){f=0;c=true}var h=this.getRefNode();if(null==h){return}this.m_nSelectedRow=parseInt(f/this.m_nCols);this.m_nSelectedCol=parseInt(f%this.m_nCols);var d=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null==d){return}var a=false;var b=h.item(0);if(null!=b){var m="";if(!c){var l=SBGrid.UT.XmlLib.getTextValue(b);var o=SBGrid.CF.GetValue(d);var g=this.getAttribute("sep");if(!g.isEmpty()){var n=l.split(g);for(var e=0;e<n.length;e++){if(!n[e].isEmpty()){if(n[e]!=o){m+=n[e]+g}}}}else{if(l!=o){m=l}}if(l!=m){a=true}}else{a=true}SBGrid.UT.XmlLib.setTextValue(b,m)}this.refreshCurrentModel(this.attribute.ref);this.dispatch("ondeselect");this.dispatch("SBUx_deselect");if(a){this.dispatch("onvaluechanged");this.dispatch("SBUx_value_changed")}};SBGrid.CT.Select.prototype.clearSelect=function(){for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heCtrl&&b.m_bSelect){SBGrid.CF.SetSelect(b,false)}}}};SBGrid.CT.Select.prototype.applySelection=function(o){if(!this.m_bIsReBuild){this.clearSelect()}this.label="";this.value=o;if(null!=o){o=o.trim();var h=this.getAttribute("sep");var a;if(null==h||h.isEmpty()){a=[o]}else{a=o.split(h)}for(var e=0;e<a.length;e++){var l=a[e];if(""==l){continue}for(var g=0;g<this.m_nRows;g++){for(var f=0;f<this.m_nCols;f++){var d=this.getCell(g,f);if(null==d||null==d.m_heCtrl){continue}var o=SBGrid.CF.GetValue(d);if(o==l){SBGrid.CF.SetSelect(d,true);d.m_bSelectChange=true;if(""==this.label){this.label+=SBGrid.CF.GetLabel(d)}else{this.label+=(h+SBGrid.CF.GetLabel(d))}}}}}for(var c=0;c<this.m_nRows;c++){for(var b=0;b<this.m_nCols;b++){var d=this.getCell(c,b);if(null==d||null==d.m_heCtrl){continue}if(!d.m_bSelectChange){SBGrid.CF.SetSelect(d,false)}d.m_bSelectChange=false}}}this.m_bIsReBuild=false};SBGrid.CT.Select.prototype.setNodeset=function(a){if(this.isnodeset){this.nodeset=a}};SBGrid.CT.Select.prototype.onSelect=function(b){var g=this.getRefNode();if(null==g){return}var d=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null==d||null==b){this.setSelect();return}var a=false;var m=this.attribute.jsonref;var c;if(typeof g!="string"){c=g.item(0)}if(null!=c||(m!=""&&m!=null)){var h=this.value;if(m!=""&&m!=null){h=SBGrid.DS.JsonStorage.getUniqueStorage().getValue(this.attribute.jsonref)}else{h=SBGrid.UT.XmlLib.getTextValue(c)}var o=SBGrid.CF.GetValue(d);var l="";var f=this.getAttribute("sep");if(!f.isEmpty()){var n=h.split(f);for(var e=0;e<n.length;e++){if(!n[e].isEmpty()){l+=n[e]+f;if(n[e]==o){return}}}}l+=o;if(m!=""&&m!=null){SBGrid.DS.JsonStorage.getUniqueStorage().setValue(this.attribute.jsonref,l)}else{SBGrid.UT.XmlLib.setTextValue(c,l)}if(h!=l){a=true}}m=this.attribute.jsonref;if(m==""||m==null){m=this.attribute.ref}this.refreshCurrentModel(m);this.dispatch("SBUx_select");if(a){this.dispatch("onvaluechanged");this.dispatch("SBUx_value_changed")}};SBGrid.CT.Select.prototype.setSelect=function(){this.attribute.appearance="true";this.selected=true;if(null!=this.m_htSelectStyle){for(var strKey in this.m_htSelectStyle){var strValue=this.m_htSelectStyle[strKey];if(-1!=strKey.indexOf("background-image")){if(-1==strValue.indexOf("url(")){strValue="url("+strValue+")"}}var strStyle="";if(-1!=strKey.indexOf("-")){var arStyle=strKey.split("-");strStyle+=arStyle[0].toLowerCase();for(var i=1;i<arStyle.length;i++){var strUpper=arStyle[i].charAt(0).toUpperCase();var strLower=arStyle[i].substring(1);strStyle+=strUpper.concat(strLower)}}else{strStyle=strKey.toLowerCase()}eval("this.m_heCtrl.style."+strStyle+" = '"+strValue+"'")}}};SBGrid.CT.Select.prototype.onDeselect=function(b){var g=this.getRefNode();if(null==g){return}var d=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null==d||null==b){this.setDeselect();return}var a=false;var m=this.attribute.jsonref;var c;if(typeof g!="string"){c=g.item(0)}if(null!=c||(m!=""&&m!=null)){var h=this.value;if(m!=""&&m!=null){h=SBGrid.DS.JsonStorage.getUniqueStorage().getValue(this.attribute.jsonref)}else{h=SBGrid.UT.XmlLib.getTextValue(c)}var o=SBGrid.CF.GetValue(d);var l="";var f=this.getAttribute("sep");if(!f.isEmpty()){var n=h.split(f);for(var e=0;e<n.length;e++){if(!n[e].isEmpty()){if(n[e]!=o){l+=n[e]+f}}}l=l.substring(0,l.lastIndexOf(f))}else{if(h!=o){l=h}}if(m!=""&&m!=null){SBGrid.DS.JsonStorage.getUniqueStorage().setValue(this.attribute.jsonref,l)}else{SBGrid.UT.XmlLib.setTextValue(c,l)}if(h!=l){a=true}}m=this.attribute.jsonref;if(m==""||m==null){m=this.attribute.ref}this.refreshCurrentModel(m);this.dispatch("SBUx_deselect");if(a){this.dispatch("onvaluechanged");this.dispatch("SBUx_value_changed")}};SBGrid.CT.Select.prototype.setDeselect=function(){this.attribute.appearance="false";this.selected=false;if(null!=this.m_strStyle){this.m_heCtrl.style.cssText=this.m_strStyle}};SBGrid.CT.Select.prototype.onMouseUp=function(a){SBGrid.CT.Group.prototype.onMouseUp.call(this,a);this.m_bLButtonDown=false};SBGrid.CT.Select.prototype.onMouseMove=function(a){if(this.m_bLButtonDown&&""!=this.getAttribute("dragmode")&&"false"!=this.getAttribute("dragmode")&&!this.m_bDragStart){SBGrid.DEF.bDragDrop=true;this.m_bDragStart=true;a.capture="";a.drag=this.id;this.dispatch("ondragstart");if(this.m_bLButtonDown&&""!=this.getAttribute("dropmode")&&"false"!=this.getAttribute("dropmode")){this.dispatch("ondragenter");this.dispatch("ondragover")}}else{SBGrid.CT.Group.prototype.onMouseMove.call(this,a)}};SBGrid.CT.Select.prototype.onMouseDown=function(b){SBGrid.CT.Group.prototype.onMouseDown.call(this,b);if(!this.isCell(b.target)){return}if(SBGrid.EVT.BUTTON_LEFT!=b.button){return}if("false"==this.getAttribute("editable")){return}this.m_bLButtonDown=false;this.m_bDragStart=false;var a=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null!=a){if(a.getDisabled()){return}var c=a.getElement();if(a.selected){this.dispatch("ondeselect")}else{this.dispatch("onselect")}SBGrid.DEF.setFocus(a.getId());this.m_bLButtonDown=true}};SBGrid.CT.Select.prototype.onKeyDown=function(b){SBGrid.CT.Group.prototype.onKeyDown.call(this,b);var c=false;var a;switch(b.keyCode){case SBGrid.EVT.UP:if(this.m_nSelectedRow>0){this.m_nSelectedRow--;c=true}else{this.m_nSelectedRow=0;c=true}break;case SBGrid.EVT.DOWN:if(this.m_nSelectedRow<this.m_nRows-1){this.m_nSelectedRow++;c=true}else{this.m_nSelectedRow=(this.m_nRows-1);c=true}break;case SBGrid.EVT.LEFT:if(this.m_nSelectedCol>0){this.m_nSelectedCol--;c=true}else{this.m_nSelectedCol=0;c=true}break;case SBGrid.EVT.RIGHT:if(this.m_nSelectedCol<this.m_nCols-1){this.m_nSelectedCol++;c=true}else{this.m_nSelectedCol=this.m_nCols-1;c=true}break;case SBGrid.EVT.SPACE:case SBGrid.EVT.ENTER:a=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(a){if(a.disabled){return}if(a.selected){if(!(this instanceof SBGrid.CT.Select1)){this.dispatch("ondeselect")}}else{this.dispatch("onselect")}}break}if(c){a=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(a){SBGrid.DEF.setFocus(a.getId())}}};SBGrid.CT.Select.prototype.onFocus=function(c){SBGrid.CT.Group.prototype.onFocus.call(this,c);var b=false;if("minimal"==this.getAttribute("appearance")){b=true}if(this instanceof SBGrid.CT.Select1&&this.getAttribute("appearance")=="full"){return}var d=this.focusIndex;if(-1==this.m_nSelectedRow&&!b){this.m_nSelectedRow=0}if(-1==this.m_nSelectedCol&&!b){this.m_nSelectedCol=0}var a=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null!=a){if(!b){SBGrid.DEF.setFocus(a.getId())}if("full"==this.getAttribute("appearance")&&-1!=d&&d!=a.index&&"softbowl:select"!=this.tag){this.dispatch("ondeselect")}this.focusIndex=a.index}};SBGrid.CT.Select.create=function(a,c,d){var e=SBGrid.CT.Select.createMainNode(c);var b=document.getElementById(a);if(b==null){b=document.getElementById("SBHE_"+a)}if(b==null){return}b.appendChild(e);e=SBGrid.CT.Select.createSubNodes(e,c);return SBGrid.CT.Select.createObject(a,e,c,d)};SBGrid.CT.Select.createMainNode=function(a){var b=document.createElement("div");b=SBGrid.CT.Select.createAttribute(b,a);a=SBGrid.CT.Element.createClassName(a,"select");jQuery(b).addClass("sbgrid_select sbgrid_boxsizing");if(a.exists("class")){jQuery(b).addClass(a.item("class"))}return b};SBGrid.CT.Select.createSubNodes=function(b,a){return b};SBGrid.CT.Select.createObject=function(t,N,y,C){var x="";var s="";var o="";var n="";var O="";var p="";var i="";var l="1";var L="acrossdown";var K=false;var q=false;var f=false;var h="";var m="";var F="";var D=9007199254740992;var c="hidden";var M="";var a="";var E="*";var B="";var A=" ";var I="";var z="visible";var J=N.getAttribute("appearance");var e="";var b="";var u="";var H="";var v="";var g="";var r=y.getCollection();for(var d in r){switch(d){case"alert":x=r[d];break;case"help":s=r[d];break;case"hint":o=r[d];break;case"accesskey":n=r[d];break;case"bind":O=r[d];break;case"cellspacing":p=r[d];break;case"class":i=r[d];break;case"cols":l=r[d];break;case"direction":L=r[d];break;case"disabled":if("true"==r[d]){K=true}break;case"dragmode":if("true"==r[d]){q=true}break;case"dropmode":if("true"==r[d]){f=true}break;case"id":h=r[d];break;case"itemheight":m=r[d];break;case"itemwidth":F=r[d];break;case"navindex":D=parseInt(r[d]);break;case"overflow":c=r[d];break;case"ref":M=r[d];break;case"jsonref":a=r[d];break;case"nodeset":b=r[d];break;case"jsonnodeset":u=r[d];break;case"labelref":H=r[d];break;case"valueref":v=r[d];break;case"rows":E=r[d];break;case"scroll":B=r[d];break;case"sep":A=r[d];break;case"vcellspacing":I=r[d];break;case"visibility":z=r[d];break;case"appearance":break;default:if(!SBGrid.DEF.SB_STYLELIST[d]){e+=d+":"+r[d]+"; "}break}}r=null;var G=false;if(b!=""||u!=""){G=true}var w=new SBGrid.CT.Select(t,x,s,o,n,O,p,i,l,L,K,q,f,h,m,F,D,c,M,a,E,B,A,null,C,"softbowl:select",I,z,0,G,b,u,H,v,J,e,"");return w};SBGrid.CT.Select.createAttribute=function(b,a){b=SBGrid.CT.Group.createAttribute(b,a);return b};SBGrid.CT.Select.prototype.setLableRef=function(a){this.labelref=a};SBGrid.CT.Select.prototype.setValueRef=function(a){this.valueref=a};SBGrid.CT.Select1=function(v,y,u,p,o,T,t,f,h,O,N,q,n,K,g,e,r,F,V,G,l,C,P,a,H,B,A,J,s,E,S,R,z,Q,L,b,x,M,w,D,c,d,i,I,m,U){if(!e){return}if("minimal"==D){this.m_heComboboxInput=document.getElementById("SBHE_"+e+"_input")}SBGrid.CT.Select.call(this,v,y,u,p,o,T,t,f,h,O,N,q,n,e,F,V,G,l,P,a,H,B,A,J,E,S,R,z,Q,L,b,x,M,w,D,c,d);this.m_bShowItemList=false;this.m_nComboButtomPoint=0;this.attribute.editmenu=String(K);this.attribute.editmode=g;this.attribute.itemcount=String(r);this.attribute.pastemode=C;this.attribute.showvalue=String(s);this.m_bIsComboFiltering=m;this.m_arrComboFilteringInfoList=U;this.m_arrFilteringHiddenIndexList=new Array();this.m_bIsKeyDownProcessing=false;this.selectImage="";this.unSelectImage="";this.disSelectImage="";this.disUnSelectImage="";this.m_objInput;this.m_objButtion;this.m_bButtonClick=false;this.m_bSelect;this.m_bIsSelectedCell=false;this.m_bGridCombo=false;this.m_bItemCount="data";this.m_nItemSetHeight;this.m_bShowValue;this.m_ShowValueStrLabel;this.m_nItemHeight=null!=i?parseInt(i):null;this.m_nItemWidth=null!=I?parseInt(I):null;this.m_objScroll={bScrollEvent:false,bUpProcess:true,bDownProcess:true,nMaxLength:0,nBottom:0,nStartRow:0,nEndRow:0,nTopRow:0,nBottomRow:0,nPosition:0,nTargetTop:0,nTargetHeight:0,heTargetTable:null,heTargetTbody:null,nScrollDivHeight:0,arScrollLength:new Array()};this.m_heScrollDiv=null;this.m_bScrollRock=true;this.m_objWidthCtl={bScrollEvent:false,nStaticWidth:0};this.m_nAppearance="full"==D?2:4};SBGrid.CT.Select1.prototype=new SBGrid.CT.Select;SBGrid.CT.Select1.prototype.init=function(){SBGrid.CT.Group.prototype.init.call(this);this.selectImage=null!=this.attribute["select.background-image"]?this.attribute["select.background-image"]:this.selectImage;this.unSelectImage=null!=this.attribute["background-image"]?this.attribute["background-image"]:this.unSelectImage;this.disSelectImage=null!=this.attribute["disable.select.background-image"]?this.attribute["disable.select.background-image"]:this.disSelectImage;this.disUnSelectImage=null!=this.attribute["disable.background-image"]?this.attribute["disable.background-image"]:this.disUnSelectImage;var a=null;var m=null;this.itemSelectImage=null!=this.attribute["item.select.background-image"]?this.attribute["item.select.background-image"]:"";this.itemUnSelectImage=null!=this.attribute["item.background-image"]?this.attribute["item.background-image"]:"";this.itemDisSelectImage=null!=this.attribute["item.disable.select.background-image"]?this.attribute["item.disable.select.background-image"]:"";this.itemDisUnSelectImage=null!=this.attribute["item.disable.background-image"]?this.attribute["item.disable.background-image"]:"";var l=null;var o=null;var e="";var p=this.getAttribute("appearance");if("full"==p){a=null!=this.attribute["select.background-color"]?this.attribute["select.background-color"]:"";m=null!=this.attribute["select.color"]?this.attribute["select.color"]:"";l=null!=this.attribute["item.select.background-color"]?this.attribute["item.select.background-color"]:"";o=null!=this.attribute["item.select.color"]?this.attribute["item.select.color"]:"";e="id:"+this.id+".item; background-image:"+this.unSelectImage+";select.background-image:"+this.selectImage+"; disable.background-image:"+this.disUnSelectImage+"; disable.select.background-image:"+this.disSelectImage+"; ";e+=" select.background-color:"+a+"; select.color:"+m+"; ";e+="item.select.background-image:"+this.itemSelectImage+"; item.disable.select.background-image:"+this.itemDisSelectImage+"; item.select.background-color:"+l+"; item.select.color:"+o+"; "}else{if("minimal"==p){var t="#00008B";if(this.parent.elementName=="softbowl:datagrid"){switch(this.parent.m_style_theme){case"darkgray":t="#E1632D";break;case"graypurple":t="#7B62C9";break;case"lightgreen":t="#3E8741";break;case"oceanblue":t="#6DA4CF";break;case"blackgray":t="#5A5D5F";break;case"pinkgray":t="#999C9F";break;case"bluishgreen":t="#999C9F";break;case"claret":t="#7D3240";break;case"skyblue":t="#26A0DA";break}}else{t="#00008B"}a=null!=this.attribute["select.background-color"]?this.attribute["select.background-color"]:"#26A0DA";m=null!=this.attribute["select.color"]?this.attribute["select.color"]:"#FFFFFF";l=null!=this.attribute["item.select.background-color"]?this.attribute["item.select.background-color"]:t;o=null!=this.attribute["item.select.color"]?this.attribute["item.select.color"]:"#FFFFFF";e="id:"+this.id+".item; select.background-color:"+a+"; select.color:"+m+"; ";e+="item.select.background-color:"+l+"; item.select.color:"+o+"; ";var h="";var b="";if(null!=this.getAttribute("ref")){h=this.getAttribute("ref")}if(null!=this.getAttribute("jsonref")){b=this.getAttribute("jsonref")}this.m_objInput=new SBGrid.CT.Input(this.id,"","",this.hint,"",false,"","",this.disabled,this.getAttribute("dragmode"),this.getAttribute("dropmode"),this.isEditable(),false,"",false,this.id+"_input","","","","","",-1,-1,-1,"","",h,b,false,"",-1,"","",false,false,"","softbowl:comboinput",false,"visible");if(this.getEditMode()==SBGrid.DEF.SB_POPUP_SEARCH){this.m_objInput.setAttribute("skipvaluechanged","true")}this.m_objInput.m_bDependentCtl=true;this.m_objButton=new SBGrid.CT.Button(this.id,"","",this.hint,"","",false,"","",this.disabled,false,"","","",this.id+"_button",-1,"","","",-1,false,"","softbowl:combobutton","visible");this.m_objButton.m_bDependentCtl=true;if(this.getAttribute("class_combobutton")!=""){jQuery(this.m_objButton.m_heCtrl).addClass(this.getAttribute("class_combobutton"))}}else{a=null!=this.attribute["select.background-color"]?this.attribute["select.background-color"]:"#26A0DA";m=null!=this.attribute["select.color"]?this.attribute["select.color"]:"#FFFFFF";l=null!=this.attribute["item.select.background-color"]?this.attribute["item.select.background-color"]:"#26A0DA";o=null!=this.attribute["item.select.color"]?this.attribute["item.select.color"]:"#FFFFFF";e="id:"+this.id+".item; select.background-color:"+a+"; select.color:"+m+"; ";e+="item.select.background-color:"+l+"; item.select.color:"+o+"; "}}a=null;m=null;this.m_objItem=this.createChild("softbowl:selectitem",e);this.choices=new SBGrid.DS.Choices(this.id,this.id+"_choices","softbowl:choices");if(this.isnodeset){var c=new SBGrid.DS.Itemset(this.id+"_choices",this.id+".itemset","softbowl:itemset");if(this.jsonnodeset!=""&&this.jsonnodeset!=null){c.setAttribute("jsonref",this.jsonnodeset)}else{c.setAttribute("nodeset",this.nodeset)}var u=new SBGrid.DS.Label(this.id+".itemset",this.id+".label","softbowl:label");u.setAttribute("ref",this.labelref);var x=new SBGrid.DS.Value(this.id+".itemset",this.id+".value","softbowl:value");x.setAttribute("ref",this.valueref);c.setLabel(u);c.setValue(x);this.choices.setItemset(c);this.initItemset()}else{if("minimal"==p){var g=document.getElementById("SBHE_"+this.id+"_allitem");SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=true;if(null!=g){document.body.appendChild(g);if(null==this.m_nItemSetHeight){this.m_nItemSetHeight=g.offsetHeight}if(!SBGrid.DEF.is_smartphone){g.setAttribute("U_D_C_S","combo");g.setAttribute("onscroll","SBGrid.DEF._W_onProcessEvent(window.event, 'onscroll', "+this.id+".id)")}g.style.height="0px";if(SBGrid.DEF.is_smartphone){g.style.overflow="hidden"}}}else{if("full"==p){this.initItemset()}}if(null!=this.m_strUserStaticValue&&""!=this.m_strUserStaticValue){this.htStaticValue={};var n=this.m_strUserStaticValue.split("|");for(var v=0;v<n.length;v++){if(-1!=n[v].indexOf("^")){var r=n[v].split("^");var w=r[0];r.shift();this.htStaticValue[w]=r;var c=new SBGrid.DS.Itemset(this.id+"_choices",this.id+".item."+v,"softbowl:item");var u=new SBGrid.DS.Label(this.id+"_itemset",this.id+".label."+v,"softbowl:label");u.setAttribute("text",r[0]);var x=new SBGrid.DS.Value(this.id+"_itemset",this.id+".value."+v,"softbowl:value");x.setAttribute("text",r[1]);c.setLabel(u);c.setValue(x)}}}this.m_objWidthCtl.nStaticWidth=this.m_nItemWidth}this.makeCell();var q=this.children.getCollection();for(var v in q){var s=q[v];if(null!=s){if(!this.isnodeset&&"softbowl:cell"==s.getAttribute("tag")){SBGrid.CF.Init(s);if(null!=s.m_heCtrl){s.m_heCtrl.setAttribute("label",this.htStaticValue[s.id][0]);s.m_heCtrl.setAttribute("value",this.htStaticValue[s.id][1]);s.m_heCtrl.noWrap=true;s.label=this.htStaticValue[s.id][0];s.value=this.htStaticValue[s.id][1]}}else{if("softbowl:cell"==s.attribute.tag){SBGrid.CF.Init(s)}else{s.init()}}}}q=null;this.m_heItemList=document.getElementById("SBHE_"+this.id+"_allitem");SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=true;if(null!=this.m_heItemList){this.m_heItemList.setAttribute("parentId","true");this.scrollAttributeSetting();var f=this.attribute.windowcombo;if(null!=f&&"true"==f){this.parentWindowAppend(this.m_heItemList)}f=null}this.m_bIsTooltip="true"==this.attribute.selectitemtooltip;this.m_blockObject="true"==this.attribute["block-object"];var d=document.getElementById("SBHE_"+this.id+"_input");if(null!=d){SBGrid.UT.HtmlLib.setStyle(d,"padding","0px 3px;")}};SBGrid.CT.Select1.prototype.parentWindowAppend=function(d){var c=window;var b=window;var e=window;while(true){b=c.parent;if(null!=b&&c!=b&&null!=c.SBGrid.DEF.__getAppName){e=c;c=b}else{if(null==c.SBGrid.DEF.__getAppName){var a=e.document.documentElement.lastChild;a.appendChild(d);d.parentWindow=window;this.m_objItemWindow=e}else{var a=c.document.documentElement.lastChild;a.appendChild(d);d.parentWindow=window;this.m_objItemWindow=c}break}}};SBGrid.CT.Select1.prototype.reBuild=function(){if(this.isnodeset||"full"==this.attribute.appearance){this.m_bIsReBuild=true;if(this.m_heItemList){this.m_heItemList.parentNode.removeChild(this.m_heItemList)}var e=this.m_objScroll.nTopRow;var b=this.m_objScroll.nBottomRow;for(var d=e;d<=b;d++){for(var a=0;a<this.m_nCols;a++){var c=this.getCell(d,a);if(null!=c){SBGrid.CF.UnInit(c)}}}this.initItemset();this.m_heItemList=document.getElementById("SBHE_"+this.id+"_allitem");SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=true;this.scrollAttributeSetting();this.makeCell();e=this.m_objScroll.nTopRow;b=this.m_objScroll.nBottomRow;for(var d=e;d<=b;d++){for(var a=0;a<this.m_nCols;a++){var c=this.getCell(d,a);if(null!=c){SBGrid.CF.Init(c)}}}e=null;b=null;var f=this.attribute.windowcombo;if(null!=f&&"true"==f){this.parentWindowAppend(this.m_heItemList)}f=null}};SBGrid.CT.Select1.prototype.refresh=function(){SBGrid.CT.Select.prototype.refresh.call(this);if("minimal"==this.attribute.appearance){if(null==this.label){this.label=this.value}var a=this.label;if(null==a){a="";this.label=""}else{if("value"==this.getAttribute("showtype")){a=this.value}else{if("true"==this.getAttribute("showvalue")||"all"==this.getAttribute("showtype")){a=" ["+this.value+"]     "+a}}}this.m_objInput.setWindowText(a)}};SBGrid.CT.Select1.prototype.setSelectImage=function(d){this.selectImage=d;this.m_objItem.setAttribute("select.background-image",d);this.m_objItem.m_jsonCssEvent.select="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heCtrl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select1.prototype.setUnSelectImage=function(d){this.unSelectImage=d;this.m_objItem.setAttribute("disable.select.background-image",d);this.m_objItem.m_jsonCssEvent.deselect="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heCtrl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select1.prototype.setDisSelectImage=function(d){this.disSelectImage=d;this.m_objItem.setAttribute("disable.background-image",d);this.m_objItem.m_jsonCssEvent.disable="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heCtrl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select1.prototype.setDisUnSelectImage=function(d){this.disUnSelectImage=d;this.m_objItem.setAttribute("disable.select.background-image",d);this.m_objItem.m_jsonCssEvent.dedisable="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heCtrl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select1.prototype.getEditMode=function(){var a=this.getAttribute("editmode");switch(a){case"search":return SBGrid.DEF.SB_POPUP_SEARCH;case"nopopupsearch":return SBGrid.DEF.SB_NO_POPUP_SEARCH;case"input":return SBGrid.DEF.SB_INPUT;case"inputsearch":return SBGrid.DEF.SB_POPUP_INPUT;default:return SBGrid.DEF.SB_NONE_EDIT}};SBGrid.CT.Select1.prototype.setAttribute=function(b,c){SBGrid.CT.Select.prototype.setAttribute.call(this,b,c);switch(b){case"left":if("minimal"==this.attribute.appearance){var a=isFinite(c)?c+"px":c;this.m_heItemList.style.left=a}break;case"editmenu":this.attribute.editmenu=c;break;case"editmode":this.attribute.editmode=c;if(""!=c){this.attribute.editable=true;this.m_heComboboxInput.readOnly=false}else{this.attribute.editable=false;this.m_heComboboxInput.readOnly=true}break;case"itemcount":this.attribute.itemcount=c;break;case"pastemode":this.attribute.pastemode=c;break;case"showvalue":this.attribute.showvalue=c;break}};SBGrid.CT.Select1.prototype.setDisabled=function(b,a){SBGrid.CT.Select.prototype.setDisabled.call(this,b,a);if("minimal"==this.attribute.appearance){this.showItemList(false)}};SBGrid.CT.Select1.prototype.applyDefaultStyle=function(){};SBGrid.CT.Select1.prototype.defaultAction=function(b,a){SBGrid.CT.Select.prototype.defaultAction.call(this,b,a);if("onglobalmousedown"==b){this.showItemList(false);this.showItemListBar(false)}};SBGrid.CT.Select1.prototype.prepareStyle=function(){SBGrid.CT.Select.prototype.prepareStyle.call(this)};SBGrid.CT.Select1.prototype.getClientLeft=function(a){var c=0;var e=window;var d=this.m_heCtrl;var b="true"==this.attribute.windowcombo;while(null!=d){c+=d.offsetLeft;if(d!=this.m_heCtrl){c+=d.clientLeft}if(a&&d!=document.body){c-=(SBGrid.DEF.is_android?0:d.scrollLeft)}d=d.offsetParent;if(null==d&&b){if(null!=this.m_objItemWindow&&this.m_objItemWindow!=e){if(null!=e.frameElement){d=e.frameElement}e=e.parent}}}e=null;return c};SBGrid.CT.Select1.prototype.getClientTop=function(a){var f=0;var e=window;var d=this.m_heCtrl;var c="true"==this.attribute.windowcombo;while(null!=d){f+=d.offsetTop;if(d!=this.m_heCtrl){f+=d.clientTop}if(a&&d!=document.body){f-=(SBGrid.DEF.is_android?0:d.scrollTop)}d=d.offsetParent;if(null==d&&c){if(null!=this.m_objItemWindow&&this.m_objItemWindow!=e){if(null!=e.frameElement){d=e.frameElement}e=e.parent}}}var b=this.m_heCtrl;if(null!=b){if(f!=Math.round(jQuery("#"+b.id).offset().top)){f=Math.round(jQuery("#"+b.id).offset().top)}}e=c=b=null;return f};SBGrid.CT.Select1.prototype.showItemList=function(o){var s=nViewportWidth;var z=nViewportHeight;var u=0;if(this.m_bIsComboFiltering){if(this.itemLength>this.attribute.itemcount){var A=this.itemLength-this.m_arrFilteringHiddenIndexList.length;if(this.attribute.itemcount>A){u=(this.attribute.itemcount-A)*this.m_nItemHeight}}else{if(this.itemLength<=this.attribute.itemcount){u=this.m_arrFilteringHiddenIndexList.length*this.m_nItemHeight}}}var c=0;var v=0;if(this.parent.elementName!="softbowl:datagrid"){this.m_bShowItemList=o}else{this.parent.m_bIsShowItem=this.m_bShowItemList=o}var x=SBGrid.DS.SBBody;var a=document;var d="true"==this.attribute.windowcombo;if(d){var g=this.m_objItemWindow;if(null!=g.body){x=g.body;a=g.document;s=g.nViewportWidth;z=g.nViewportHeight;v=x.m_heCtrl.scrollTop}g=null}if(typeof a.documentElement.scrollTop!="undefined"){c=a.documentElement.scrollTop}else{if(typeof x.m_heCtrl.scrollTop!="undefined"){c=x.m_heCtrl.scrollTop}}var f=this.m_heItemList;if(f){if(o&&!this.disabled){SBGrid.DEF.setPermitResize(false);f.style.visibility="";if(SBGrid.DEF.is_smartphone){f.style.height=null;f.style.overflow="visible"}else{if("data"==this.m_bItemCount){if(typeof this.m_nItemSetHeight!="undefined"){f.style.height=(this.m_nItemSetHeight-u)+"px"}else{f.style.height=null}}else{if(this.m_bItemCount){f.style.height=(this.m_nItemSetHeight-u)+"px";f.style.overflowY="scroll"}else{f.style.height=null;f.style.overflowY="visible"}}}if(this.getClientLeft(true)+f.offsetWidth>s){f.style.left=(this.getClientLeft(true)+(this.m_heCtrl.offsetWidth-f.offsetWidth))+"px"}else{f.style.left=this.getClientLeft(true)+"px"}if(this.getClientTop(true)+this.m_heCtrl.offsetHeight+f.offsetHeight>z-this.getClientTop(true)){if(this.getClientTop(true)-c>z-this.getClientTop(true)){if(z-this.getClientTop(true)-this.m_heCtrl.offsetHeight<f.offsetHeight){if(typeof this.m_nItemSetHeight!="undefined"){if(this.m_nItemSetHeight>this.getClientTop(true)-c){f.style.height=(this.getClientTop(true)-c)+"px"}}else{f.style.height=null}f.style.overflowY="scroll";if((this.getClientTop(true)-f.offsetHeight)>0){f.style.top=(this.getClientTop(true)-f.offsetHeight-v)+"px"}else{f.style.top=(c-v)+"px"}}else{f.style.top=(this.getClientTop(true)+this.m_heCtrl.offsetHeight+v)+"px";if(typeof this.m_nItemSetHeight!="undefined"){f.style.height=(this.m_nItemSetHeight-u)+"px"}else{f.style.height=null}}}else{f.style.top=(this.getClientTop(true)+this.m_heCtrl.offsetHeight+v)+"px";if(f.offsetHeight>z-this.m_heCtrl.offsetHeight-this.getClientTop(true)){f.style.overflowY="scroll";f.style.height=(z-this.m_heCtrl.offsetHeight-u-this.getClientTop(true)+c-5)+"px"}else{if(typeof this.m_nItemSetHeight!="undefined"){f.style.height=(this.m_nItemSetHeight-u)+"px"}else{f.style.height=null}}}}else{f.style.top=(this.getClientTop(true)+this.m_heCtrl.offsetHeight+v)+"px";if(typeof this.m_nItemSetHeight!="undefined"){f.style.height=(this.m_nItemSetHeight-u)+"px"}else{f.style.height=null}}this.m_objScroll.nScrollDivHeight=f.offsetHeight;var h=""==this.attribute.cellspacing?0:parseInt(this.attribute.cellspacing);if(this.m_bGridCombo){f.style.width=this.m_heCtrl.offsetWidth+"px"}else{f.style.width=(this.m_nItemWidth+h)+"px"}if(SBGrid.DEF.is_ie&&this.m_blockObject){var n="left:"+(parseInt(f.style.left)-1)+"px;";var y="height:"+(parseInt(f.style.height)+1)+"px;";var w="width:"+(parseInt(f.style.width)+2)+"px;";var m="top:"+f.style.top+";";document.getElementById("SBHE___SB_LoadExcel").style.cssText="position: absolute;"+n+m+y+w+";z-index:3"}}else{SBGrid.DEF.setPermitResize(true);f.style.visibility="hidden";if(SBGrid.DEF.is_smartphone){f.style.height="0px";f.style.overflow="hidden"}else{f.style.height="0px";if(!this.m_bItemCount){f.style.top="0px";f.style.overflow="hidden"}}f.style.width="0px";if(SBGrid.DEF.is_ie&&this.m_blockObject){document.getElementById("SBHE___SB_LoadExcel").style.cssText="display: none; position: absolute;"}if(this.m_objTargetCol){this.m_objTargetCol.dispatch("onblur")}this.m_bIsKeyDownProcessing=false}if(this.m_bIsComboFiltering){for(var r=0;r<this.itemLength;r++){var t="SBHE_"+this.id+"_"+r.toString()+"_0";var e=jQuery("#"+t).parent();if(SBGrid.DEF.arrBinarySearch(r,this.m_arrFilteringHiddenIndexList)!=-1){e.hide()}else{e.show()}}jQuery(this.m_heScrollDiv).css("height",f.style.height)}}if(this.parent.elementName=="softbowl:datagrid"){var b=this.parent.getTextMatrix(this.parent.getMouseRow(),this.parent.getMouseCol());for(var r=0;r<this.m_nRows;r++){for(var p=0;p<this.m_nCols;p++){var l=this.getCell(r,p);if(null!=l&&b==SBGrid.CF.GetValue(l)){if(l.row>=this.attribute.itemcount){var q=parseInt(l.row)*this.m_nItemHeight;this.m_heItemList.scrollTop=q}else{if(l.row<this.attribute.itemcount){this.m_heItemList.scrollTop=0}}SBGrid.CF.SetSelect(l,true)}else{SBGrid.CF.SetSelect(l,false)}}}}b=null;l=null;f=null};SBGrid.CT.Select1.prototype.showItemListBar=function(a){var b=this.attribute.windowcombo;if(null!=b&&"true"==b){return}};SBGrid.CT.Select1.prototype.setValueToInput=function(b,a){};SBGrid.CT.Select1.prototype.setReverseColor=function(){};SBGrid.CT.Select1.prototype.isEditable=function(){return(this.getEditMode()!=SBGrid.DEF.SB_NONE_EDIT)};SBGrid.CT.Select1.prototype.applySelection=function(e){if(!this.m_bIsReBuild){this.clearSelect()}var d=this.value;this.label=null;this.value=e;if(null!=d&&"minimal"!=this.getAttribute("appearance")){if("full"==this.getAttribute("appearance")||"full"!=this.getAttribute("appearance")&&""!=d&&e!=d){for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){b=this.getCell(c,a);if(null!=b&&null!=b.m_heCtrl&&d==SBGrid.CF.GetValue(b)){SBGrid.CF.SetSelect(b,false)}}}}}if(null!=e){e=e.trim();var b=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null!=b&&null!=b.m_heCtrl&&e==SBGrid.CF.GetValue(b)){SBGrid.CF.SetSelect(b,true);this.label=SBGrid.CF.GetLabel(b);this.m_bIsSelectedCell=true;return}else{for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){b=this.getCell(c,a);if(null!=b&&(e==SBGrid.CF.GetValue(b))){SBGrid.CF.SetSelect(b,true);this.label=SBGrid.CF.GetLabel(b);this.m_bIsSelectedCell=true;this.m_bIsReBuild=false;return}}}}}this.m_bIsReBuild=false};SBGrid.CT.Select1.prototype.onMouseMove=function(a){var b=a.currentTarget;if(b.indexOf("combobox")!=-1){if(a.hover!=""){a.hover=""}}b=null};SBGrid.CT.Select1.prototype.initItemset=function(){if(this.m_heItemList){if(null!=this.m_heItemList.firstChild){this.m_heItemList.removeChild(this.m_heItemList.firstChild)}}var strAppearance=this.getAttribute("appearance");if("minimal"==strAppearance){var strNodeSet=this.nodeset;if((strNodeSet.length-1)==strNodeSet.lastIndexOf("/")){strNodeSet=strNodeSet.substring(0,strNodeSet.length-1)}var strLabelRef=this.labelref;if(0==strLabelRef.indexOf("/")){strLabelRef=strLabelRef.substring(1)}var arLabelRefPath=strLabelRef.split("/");if(1!=arLabelRefPath.length){for(var i=0;i<arLabelRefPath.length-1;i++){strNodeSet=strNodeSet+"/"+arLabelRefPath[i]}strLabelRef=arLabelRefPath[arLabelRefPath.length-1]}var strValueRef=this.valueref;if(0==strValueRef.indexOf("/")){strValueRef=strValueRef.substring(1)}var arValueRefPath=strValueRef.split("/");if(1!=arValueRefPath.length){strValueRef=arValueRefPath[arValueRefPath.length-1]}this.itemLength=0;this.arItemList=new Array();this.m_arItemList=new Array();var tdIDs=null;if(SBGrid.DEF.is_firefox){tdIDs=new Array()}if(this.jsonnodeset!=""&&this.jsonnodeset!=null){try{this.itemLength=eval(this.jsonnodeset).length;for(var i=0;i<this.itemLength;i++){var data={label:eval(this.jsonnodeset+"["+i+"]."+strLabelRef),value:eval(this.jsonnodeset+"["+i+"]."+strValueRef)};this.arItemList.push(data)}}catch(e){SBGrid.DEF.errorMsg("jsonref를 이용한 itemset 구성 오류")}}else{var xlItemSetLabel=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,strNodeSet+"/"+strLabelRef);var xlItemSetValue=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,strNodeSet+"/"+strValueRef);var nLabelLength=xlItemSetLabel.length;var nValueLength=xlItemSetValue.length;var nItemSetLength=nLabelLength>=nValueLength?nValueLength:nLabelLength;for(var i=0;i<nItemSetLength;i++){var data={label:xlItemSetLabel.item(i),value:xlItemSetValue.item(i)};this.arItemList.push(data)}this.itemLength=nItemSetLength;this.length=this.itemLength}this.m_heComboboxImg=document.getElementById(this.id+"_img");this.m_heCtrl=document.getElementById("SBHE_"+this.id);var heComboListDiv=null;if(null!=this.m_heItemList){heComboListDiv=this.m_heItemList}else{var heTempDiv=document.createElement("div");jQuery(heTempDiv).html('<div onscroll=\'SBGrid.DEF._W_onProcessEvent(event, "onscroll", "'+this.id+"\")'></div>");heComboListDiv=heTempDiv.firstChild}heComboListDiv.setAttribute("id","SBHE_"+this.id+"_allitem");SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=true;jQuery(heComboListDiv).addClass("sbgrid_combo_itemlist");jQuery(heComboListDiv).addClass("sbgrid_scroll");if(!SBGrid.DEF.is_smartphone){heComboListDiv.setAttribute("U_D_C_S","combo")}var strGridFontFamily=jQuery("#SBHE_"+this.parent.id).css("font-family");jQuery(heComboListDiv).css("font-family",strGridFontFamily);strGridFontFamily=null;jQuery(heComboListDiv).css("visibility","hidden");jQuery(heComboListDiv).css("height","0px");var strItemHeight=this.getAttribute("itemheight");var strItemWidth=this.getAttribute("itemwidth");var strVcellSpacing=this.getAttribute("vcellspacing");var strCellSpacing=this.getAttribute("cellspacing");strItemHeight=(null!=strItemHeight)?strItemHeight.split("px")[0]:"";strItemWidth=(null!=strItemWidth)?strItemWidth.split("px")[0]:"";strVcellSpacing=(null!=strVcellSpacing)?strVcellSpacing.split("px")[0]:"";strCellSpacing=(null!=strCellSpacing)?strCellSpacing.split("px")[0]:"";if(""==strItemWidth){var strComboWidth=this.getAttribute("sbgrid_grid_combo_width");if(""!=strComboWidth){strItemWidth=parseInt(strComboWidth)-2}}var nItemHeight=parseInt(strItemHeight);var nItemWidth=parseInt(strItemWidth);var nVcellSpacing=parseInt(strVcellSpacing);var nCellSpacing=parseInt(strCellSpacing);var nPaddingRight=null;var strCols=this.attribute.cols;var strRows=this.attribute.rows;var nCols=(""==strCols)||("*"==strCols)?1:parseInt(strCols);var nRows=(""==strRows)||("*"==strRows)?1:parseInt(strRows);var strComboWidth=this.getAttribute("width").replaceAll("px","");if(""==strComboWidth||null==strComboWidth){strComboWidth=this.m_heCtrl.style.width}var nComboWidth=parseInt(strComboWidth);if((""==strItemWidth||null==strItemWidth)||nComboWidth>nItemWidth){nItemWidth=isNaN(nComboWidth)?100:nComboWidth}if("*"==strCols&&(1<nRows)){nCols=Math.ceil(this.itemLength/nRows)}else{nRows=Math.ceil(this.itemLength/nCols)}var strDirection=this.attribute.direction;if("true"==this.attribute.showvalue){nCols=1;nRows=this.itemLength;strDirection=""}nPaddingRight=(""==strCellSpacing||null==strCellSpacing)?(nCols>1?18:0):nCellSpacing;if(""==strItemHeight||null==strItemHeight){nItemHeight=(""==strVcellSpacing||null==strVcellSpacing)?18:nVcellSpacing}this.m_nItemHeight=nItemHeight;var nItemCutLine=parseInt(this.attribute.itemcount);if(nItemCutLine<nRows&&!SBGrid.DEF.is_smartphone){this.m_bItemCount=true;this.m_nItemSetHeight=(nItemHeight*nItemCutLine)}else{this.m_bItemCount=false;this.m_nItemSetHeight=(nItemHeight*nRows)}if(SBGrid.DEF.is_smartphone){heComboListDiv.style.height="0px"}this.m_nItemWidth=(nItemWidth*nCols);this.m_objWidthCtl.nStaticWidth=(nItemWidth*nCols);this.m_arItemList.push("<table class='sbgrid_combo_itemlist_table' cellSpacing=0 cellPadding=0 style='width:100%;height:100%'>");var bIsTooltip="true"==this.attribute.selectitemtooltip;var nItemIndex=0;this.m_nRows=nRows;var comboText;var strItemClassName="class='sbgrid_selectitem"+this.m_nAppearance+" ";if(this.m_clCSSName.exists(this.m_strLocalTag+"_selectitem")){strItemClassName+=this.m_clCSSName.item(this.m_strLocalTag+"_selectitem")}if(this.m_clCSSName.exists("select1_selectitem")){strItemClassName+=" "+this.m_clCSSName.item("select1_selectitem")}var appendEvent="";var bAttach=false;if(window.attachEvent){bAttach=true}for(var i=0;i<nRows;i++){var nCreateItemCount=nItemCutLine+10;if(this.m_bIsComboFiltering){nCreateItemCount=this.itemLength}if(i<nCreateItemCount){this.m_arItemList.push("<tr>");for(var j=0;j<nCols&&nItemIndex<this.arItemList.length;j++){var xnItem=null;if("downacross"==strDirection){xnItem=this.arItemList[((nRows*j)+i)]}else{xnItem=this.arItemList[nItemIndex]}if(xnItem==null){this.m_arItemList.push("<td/>");continue}var xnLabel=xnItem.label;var xnValue=xnItem.value;var strLabel="";var strValue="";if(this.jsonnodeset!=""&&this.jsonnodeset!=null){strLabel=xnItem.label;strValue=xnItem.value}else{strLabel=SBGrid.UT.XmlLib.getTextValue(xnLabel);strValue=SBGrid.UT.XmlLib.getTextValue(xnValue)}var strTDId=this.id+"_"+i+"_"+j;this.m_bShowValue=this.attribute.showvalue;if("true"==this.attribute.showvalue){comboText=strValue+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+strLabel}else{comboText=strLabel}if(SBGrid.DEF.is_smartphone||SBGrid.DEF.is_ipad){this.m_arItemList.push("<td id='SBHE_"+strTDId+"' "+strItemClassName+" "+strTDId+"_Attr' onmousedown='' i='' onmouseup='' ondblclick='' onkeydown='' onkeypress='' onkeyup='' text='"+strLabel+"' value='"+strValue+"' label='"+strLabel+"' noWrap='nowrap' style='height:"+nItemHeight+"px;padding-right:"+nPaddingRight+"px;'>"+comboText+"</td>")}else{var strTooltip="";if(bIsTooltip){strTooltip=" title='"+comboText+"' "}this.m_arItemList.push("<td id='SBHE_"+strTDId+"' "+strItemClassName+" "+strTDId+"_Attr' "+strTooltip+"text='"+strLabel+"' value='"+strValue+"' label='"+strLabel+"' noWrap=true style='height:"+nItemHeight+"px;padding-right:"+nPaddingRight+"px;'>"+comboText+"</td>");nItemIndex++}if(bAttach){appendEvent+="SBHE_"+strTDId+".attachEvent('onmousedown', SBGrid.DEF._W_onProcessMouseEvent);";appendEvent+="SBHE_"+strTDId+".attachEvent('onmousemove', SBGrid.DEF._W_onProcessMouseEvent);";appendEvent+="SBHE_"+strTDId+".attachEvent('onmouseup', SBGrid.DEF._W_onProcessMouseEvent);"}else{appendEvent+="SBHE_"+strTDId+".addEventListener('mousedown', SBGrid.DEF._W_onProcessMouseEvent, false);";appendEvent+="SBHE_"+strTDId+".addEventListener('mousemove', SBGrid.DEF._W_onProcessMouseEvent, false);";appendEvent+="SBHE_"+strTDId+".addEventListener('mouseup', SBGrid.DEF._W_onProcessMouseEvent, false);"}if(tdIDs){tdIDs.push("SBHE_"+strTDId)}}this.m_arItemList.push("</tr>")}else{break}}this.m_arItemList.push("</table>");this.m_arItemList.push("<div class='sbgrid_ScrollDiv' style='height:"+(nRows*nItemHeight)+"px'></div>");jQuery(heComboListDiv).html(this.m_arItemList.join(""));document.body.appendChild(heComboListDiv);if(SBGrid.DEF.is_firefox&&tdIDs){for(var t=0;t<tdIDs.length;t++){var strTDID=tdIDs[t];var htTD=document.getElementById(strTDID);if(htTD){htTD.addEventListener("mousedown",SBGrid.DEF._W_onProcessMouseEvent,false);htTD.addEventListener("mousemove",SBGrid.DEF._W_onProcessMouseEvent,false);htTD.addEventListener("mouseup",SBGrid.DEF._W_onProcessMouseEvent,false)}}delete tdIDs;tdIDs=null}else{eval(appendEvent)}}else{SBGrid.CT.Select.prototype.initItemset.call(this)}};SBGrid.CT.Select1.prototype.getComboLabel=function(c){var b="";for(var a=0;a<this.arItemList.length;a++){if(this.arItemList[a].value==c){b=this.arItemList[a].label;break}}return b};SBGrid.CT.Select1.prototype.getComboValue=function(b){var c="";for(var a=0;a<this.arItemList.length;a++){if(this.arItemList[a].label==b){c=this.arItemList[a].value;break}}return c};SBGrid.CT.Select1.prototype.getLabelValue=function(c,f){var d=null;var a={label:"",value:""};if("downacross"==this.attribute.direction){d=this.arItemList[((this.m_nRows*f)+c)]}else{d=this.arItemList[((this.m_nCols*c)+f)]}var e=d.label;var b=d.value;if(this.jsonnodeset!=""&&this.jsonnodeset!=null){a.label=e;a.value=b}else{a.label=SBGrid.UT.XmlLib.getTextValue(e);a.value=SBGrid.UT.XmlLib.getTextValue(b)}return a};SBGrid.CT.Select1.prototype.onSelect=function(b){var d=this.getRefNode();if(null==d){return}var a=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null==a||null==b){this.setSelect();return}var c=this.value;this.setValue(SBGrid.CF.GetValue(a));this.dispatch("SBUx_select");if(c!=this.getValue()){this.dispatch("onvaluechanged");this.dispatch("SBUx_value_changed")}};SBGrid.CT.Select1.prototype.setSelect=function(){this.attribute.appearance="true";this.selected=true;if(null!=this.m_htSelectStyle){for(var strKey in this.m_htSelectStyle){var strValue=this.m_htSelectStyle[strKey];if(-1!=strKey.indexOf("background-image")){if(-1==strValue.indexOf("url(")){strValue="url("+strValue+")"}}var strStyle="";if(-1!=strKey.indexOf("-")){var arStyle=strKey.split("-");strStyle+=arStyle[0].toLowerCase();for(var i=1;i<arStyle.length;i++){var strUpper=arStyle[i].charAt(0).toUpperCase();var strLower=arStyle[i].substring(1);strStyle+=strUpper.concat(strLower)}}else{strStyle=strKey.toLowerCase()}eval("this.m_heCtrl.style."+strStyle+" = '"+strValue+"'")}}};SBGrid.CT.Select1.prototype.onFocus=function(a){SBGrid.CT.Select.prototype.onFocus.call(this,a);if(""==this.attribute.editmode){this.setReverseColor()}};SBGrid.CT.Select1.prototype.onBlur=function(a){if("minimal"==this.getAttribute("appearance")&&(a.relatedTarget.isEmpty()||!this.isDescendants(a.relatedTarget,true))){this.showItemList(false);this.showItemListBar(false)}if(this.m_objInput&&a.target==this.m_objInput.getId()){if(SBGrid.DEF.SB_NONE_EDIT!=this.getEditMode()){}}this.m_bSelect=false;SBGrid.CT.Select.prototype.onBlur.call(this,a)};SBGrid.CT.Select1.prototype.isCell=function(a){if("minimal"==this.getAttribute("appearance")){if(a==this.id+"_input"||a==this.id+"_button"){return false}}return SBGrid.CT.Select.prototype.isCell.call(this,a)};SBGrid.CT.Select1.prototype.onMouseDown=function(e){SBGrid.CT.Group.prototype.onMouseDown.call(this,e);this.m_bButtonClick=false;if(SBGrid.EVT.BUTTON_LEFT!=e.button){return}if(this.m_heItemList&&"minimal"==this.getAttribute("appearance")){if(!this.isCell(e.target)){if(this.m_bShowItemList){this.showItemList(false);this.showItemListBar(false)}else{var a=(null==this.m_objInput)||!this.isEditable()||(e.target!=this.m_objInput.getId());if(a){if(SBGrid.DEF.SB_INPUT==this.getEditMode()||SBGrid.DEF.SB_POPUP_INPUT==this.getEditMode()){var f=this.m_objInput.getWindowText();if(null!=f&&!f.isEmpty()){var d=-1;var g=-1;if(false){this.clearSelect();var c=this.getCell(d,g);if(c){SBGrid.CF.SetSelect(c,true)}}}}if("minimal"==this.getAttribute("appearance")){this.showItemList(true)}}}if(""!=this.label){this.m_bLButtonDown=true}}else{this.m_bButtonClick=true;this.showItemList(false);this.showItemListBar(false)}}var c=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null!=c&&!("minimal"==this.getAttribute("appearance")&&!this.isCell(e.target))){this.dispatch("onselect");if(this.parent.elementName=="softbowl:datagrid"){this.parent.setComboHidden(false);var b=this.m_objConnectControl;SBGrid.DEF.setFocus(b.getId())}this.m_bLButtonDown=true}this.m_bButtonClick=false};SBGrid.CT.Select1.prototype.onMouseOver=function(c){SBGrid.CT.Control.prototype.onMouseOver.call(this,c);if("minimal"==this.attribute.appearance&&this.isCell(c.target)){var b=this.getAttribute("row");var d=this.getAttribute("col");this.clearSelect();var a=this.getCell(b,d);if(a){this.m_nSelectedRow=b;this.m_nSelectedCol=d;SBGrid.CF.SetSelect(a,true)}this.showItemListBar(true);b=null;d=null;a=null}};SBGrid.CT.Select1.prototype.onKeyUp=function(a){var b=false;switch(a.keyCode){case SBGrid.EVT.ENTER:if(SBGrid.DEF.SB_POPUP_SEARCH==this.getEditMode()){this.setText("");this.setValue("")}break;default:break}if(SBGrid.DEF.SB_POPUP_SEARCH==this.getEditMode()){b=true}if(b){if(SBGrid.EVT.UP!=a.keyCode&&SBGrid.EVT.DOWN!=a.keyCode&&SBGrid.EVT.ESC!=a.keyCode&&SBGrid.EVT.ENTER!=a.keyCode){this.checkComboListItem(a,b)}}};SBGrid.CT.Select1.prototype.onKeyDown=function(d){if(this.parent.elementName=="softbowl:datagrid"){if(!(this.m_bIsKeyDownProcessing)){this.m_bIsKeyDownProcessing=true;var e=this.parent.getTextMatrix(this.parent.getMouseRow(),this.parent.getMouseCol());for(var c=0;c<this.arItemList.length;c++){if(this.arItemList[c].value==e){this.m_nSelectedRow=c;break}}if(this.m_nSelectedCol==-1){this.m_nSelectedCol=0}}if(this.parent.m_bIsContextMenu==true){var f=this.parent.m_heContextMenu;if(f.style.visibility=="visible"){if(d.preventDefault){d.preventDefault()}d.returnValue=false;this.parent.ContextMenuOnclick(d);return false}f=null}}if("minimal"==this.attribute.appearance){SBGrid.CT.Group.prototype.onKeyDown.call(this,d);if(SBGrid.EVT.UP!=d.keyCode&&SBGrid.EVT.DOWN!=d.keyCode&&SBGrid.EVT.ESC!=d.keyCode&&SBGrid.EVT.ENTER!=d.keyCode){if(this.m_objInput&&this.m_objInput.getId()==d.target){return}}}else{SBGrid.CT.Select.prototype.onKeyDown.call(this,d);return}var g=false;switch(d.keyCode){case SBGrid.EVT.UP:if(this.m_nSelectedRow>0){if(this.m_bIsComboFiltering){while(this.m_nSelectedRow>0){if(SBGrid.DEF.arrBinarySearch(this.m_nSelectedRow-1,this.m_arrFilteringHiddenIndexList)==-1){this.m_nSelectedRow--;break}else{this.m_nSelectedRow--;if(this.m_nSelectedRow==0){while(SBGrid.DEF.arrBinarySearch(this.m_nSelectedRow,this.m_arrFilteringHiddenIndexList)!=-1){this.m_nSelectedRow++}break}}}}else{this.m_nSelectedRow--}g=true}break;case SBGrid.EVT.DOWN:if(this.m_nSelectedRow<this.m_nRows-1){if(this.m_bIsComboFiltering){while(this.m_nSelectedRow<(this.m_nRows-1)){if(SBGrid.DEF.arrBinarySearch(this.m_nSelectedRow+1,this.m_arrFilteringHiddenIndexList)==-1){this.m_nSelectedRow++;break}else{this.m_nSelectedRow++;if(this.m_nSelectedRow==(this.m_nRows-1)){while(SBGrid.DEF.arrBinarySearch(this.m_nSelectedRow,this.m_arrFilteringHiddenIndexList)!=-1){this.m_nSelectedRow--}break}}}}else{this.m_nSelectedRow++}g=true}break;case SBGrid.EVT.LEFT:if(this.m_nSelectedCol>0){this.m_nSelectedCol--;g=true}break;case SBGrid.EVT.RIGHT:if(this.m_nSelectedCol<this.m_nCols-1){this.m_nSelectedCol++;g=true}break;case SBGrid.EVT.SPACE:case SBGrid.EVT.ENTER:if(!this.m_bShowItemList){this.showItemList(true);this.showItemListBar(true)}else{this.showItemList(false);this.showItemListBar(false);if(this.m_objInput.getId()!=d.target){this.dispatch("onselect");var a=this.m_objConnectControl;SBGrid.DEF.setFocus(a.getId())}if(SBGrid.DEF.SB_POPUP_SEARCH==this.getEditMode()){if(this.m_nSelectedCol==-1&&this.m_nSelectedRow==-1){this.setText("");this.setValue("")}g=true;break}}return;case SBGrid.EVT.ESC:this.showItemList(false);this.showItemListBar(false);return;default:return}if(g){if(this.m_nSelectedCol==-1){this.m_nSelectedCol=0}if(this.m_nSelectedRow==-1){this.m_nSelectedRow=0}var b=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null!=b){if(this.m_bShowItemList){this.clearSelect();SBGrid.CF.SetSelect(b,true)}else{this.dispatch("onselect");if(""!=this.attribute.editmode){window.setTimeout("try{if (null != "+this.m_objInput.id+"){"+this.m_objInput.id+'.m_heCtrlInput.select();}else{document.SBHE_allElement.item("'+this.m_objInput.id+'").m_heCtrlInput.select();}}catch(e){}',0)}}}if(SBGrid.EVT.UP!=d.keyCode&&SBGrid.EVT.DOWN!=d.keyCode&&SBGrid.EVT.ESC!=d.keyCode&&SBGrid.EVT.ENTER!=d.keyCode){this.itemValidCheck(d,g)}}};SBGrid.CT.Select1.prototype.itemValidCheck=function(a,h){if(!this.isCell(a.target)){if(a.target==this.m_objInput.getId()||(""==this.attribute.editmode&&!this.m_bShowItemList)){var m=this.m_objInput.getWindowText();if(null!=m&&!m.isEmpty()){var d=-1;var g=-1;this.clearSelect();var b=false;for(var f=0;f<this.m_nRows;f++){for(var e=0;e<this.m_nCols;e++){var c=this.getCell(f,e);for(var l=0;l<m.length;l++){if(c.label.charAt(l)==m.charAt(l)){if(l==m.length-1){b=true}continue}else{break}}if(b){d=f;g=e;break}}if(b){break}}var c=this.getCell(d,g);if(null!=c){SBGrid.CF.SetSelect(c,true);if(SBGrid.DEF.SB_POPUP_SEARCH==this.getEditMode()){this.m_nSelectedRow=d;this.m_nSelectedCol=g}}else{if(SBGrid.DEF.SB_POPUP_SEARCH==this.getEditMode()){this.m_nSelectedRow=-1;this.m_nSelectedCol=-1}return}if((SBGrid.DEF.SB_POPUP_SEARCH==this.getEditMode()||SBGrid.DEF.SB_POPUP_INPUT==this.getEditMode())&&!h){this.showItemList(true)}}else{this.clearSelect();this.showItemList(false)}}}};SBGrid.CT.Select1.prototype.checkComboListItem=function(a,l){if(!this.isCell(a.target)){if(a.target==this.m_objInput.getId()||("search"==this.attribute.editmode)){var n=this.m_objInput.getWindowText();if(null!=n){var e=-1;var h=-1;this.clearSelect();var b=false;for(var g=0;g<this.m_nRows;g++){for(var f=0;f<this.m_nCols;f++){var d=this.getCell(g,f);for(var m=0;m<n.length;m++){if(d.label.charAt(m)==n.charAt(m)){if(m==n.length-1){b=true}continue}else{break}}if(b){e=g;h=f;break}}if(b){l=false;break}}var d=this.getCell(e,h);if(null!=d){if(b){if(d.row>=this.attribute.itemcount){var c=parseInt(d.row)*this.m_nItemHeight;window.setTimeout("SBGrid.getGrid('"+this.id+"').m_heItemList.scrollTop = "+c,0)}else{if(d.row<this.attribute.itemcount){this.m_heItemList.scrollTop=0}}window.setTimeout("SBGrid.getGrid('"+this.id+"').clearSelect()",0);window.setTimeout("SBGrid.CF.SetSelect(SBGrid.getGrid('"+this.id+"').getCell("+e+","+h+"),true)",20)}else{window.setTimeout("SBGrid.getGrid('"+this.id+"').clearSelect()",0);window.setTimeout("SBGrid.CF.SetSelect(SBGrid.getGrid('"+this.id+"').getCell("+e+","+h+"),true)",0)}if(SBGrid.DEF.SB_POPUP_SEARCH==this.getEditMode()){this.m_nSelectedRow=e;this.m_nSelectedCol=h}}else{if(SBGrid.DEF.SB_POPUP_SEARCH==this.getEditMode()){this.m_nSelectedRow=-1;this.m_nSelectedCol=-1}return}if((SBGrid.DEF.SB_POPUP_SEARCH==this.getEditMode()||SBGrid.DEF.SB_POPUP_INPUT==this.getEditMode())&&!l){this.showItemList(true);l=true}}}}};SBGrid.CT.Select1.prototype.onScroll=function(a){if(!SBGrid.DEF.is_smartphone){if(this.m_objScroll.bScrollEvent&&this.m_objScroll.nPosition!=this.m_heItemList.scrollTop){var b=this.m_objScroll.nPosition-this.m_heItemList.scrollTop;if(Math.abs(b)<80){this.scrolButtonClick(b,this.m_heItemList.scrollTop)}else{jQuery(this.m_heScrollDiv).addClass("sbgrid_comboDiv_alpha");this.m_objScroll.arScrollLength.push(1);window.setTimeout("SBGrid.DEF."+this.id+".scrollingCombo(true);",100)}}}};SBGrid.CT.Select1.prototype.scrollAttributeSetting=function(){var c=this.m_objScroll;var a=parseInt(this.attribute.itemcount)+10;if(this.m_bIsComboFiltering){a=this.itemLength}var b=a<this.m_nRows;c.nMaxLength=a;c.nBottomRow=b?c.nTopRow+a-1:this.m_nRows-1;c.nEndRow=this.m_nRows-a;c.bScrollEvent=b;c.nPosition=this.m_heItemList.scrollTop;c.nScrollDivHeight=this.m_heItemList.offsetHeight;c.heTargetTable=this.m_heItemList.firstChild;if(null!=c.heTargetTable){c.heTargetTbody=c.heTargetTable.firstChild;c.nTargetHeight=c.heTargetTable.offsetHeight}this.m_heScrollDiv=this.m_heItemList.lastChild;c=null};SBGrid.CT.Select1.prototype.scrolButtonClick=function(f,d){if(this.mbScrollRock){return}this.m_bScrollRock=true;var e=this.m_objScroll;e.nPosition=d;var c=d+e.nScrollDivHeight/2;var b=e.nTargetTop+e.nTargetHeight/2;var a=Math.ceil((Math.abs(f)/this.m_nItemHeight));if(0>f&&e.bDownProcess){if(b-c<0){this.scrollUpDownTable(true,a)}}else{if(e.bUpProcess){if(b-c>0){this.scrollUpDownTable(false,a)}}}e=null;this.m_bScrollRock=false};SBGrid.CT.Select1.prototype.scrollUpDownTable=function(p,f){var e=null;var l=null;var b=this.m_objScroll;if(p){var o=b.nTopRow+f;if(o>b.nEndRow){f=f-(o-b.nEndRow)}b.nTargetTop=b.nTargetTop+(this.m_nItemHeight*f);e=b.nTopRow+f;l=b.nBottomRow+f;for(var n=0;n<f;n++){var c=b.heTargetTbody.firstChild;var h=b.nTopRow+n;for(var m=0;m<this.m_nCols;m++){var g=this.getCell(h,m);if(null!=g){if(g.selected){SBGrid.CF.SetSelect(g,false);g.selected=true}if(null!=g.m_heCtrl){jQuery(g.m_heCtrl).removeClass(g.id+"_Attr");var d=this.id+"_"+(b.nBottomRow+1+n)+"_"+m;g.m_heCtrl.id="SBHE_"+d;jQuery(g.m_heCtrl).addClass(d+"_Attr")}SBGrid.CF.UnInit(g)}}h=b.nBottomRow+1+n;for(var m=0;m<this.m_nCols;m++){var g=this.getCell(h,m);if(null!=g){SBGrid.CF.Init(g);if(this.isnodeset){var q=this.getLabelValue(h,m);g.label=q.label;g.value=q.value}SBGrid.CF.SetLabel(g,g.label,this.m_bIsTooltip);SBGrid.CF.SetValue(g,g.value);if("true"==this.m_bShowValue){this.m_ShowValueStrLabel=g.value+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+g.label}else{this.m_ShowValueStrLabel=g.label}SBGrid.CF.SetLabelChange(g,this.m_ShowValueStrLabel);if(g.selected){SBGrid.CF.SetSelect(g,true)}}}b.heTargetTbody.appendChild(c)}}else{f=f>b.nTopRow?b.nTopRow:f;b.nTargetTop=b.nTargetTop-(this.m_nItemHeight*f);e=b.nTopRow-f;l=b.nBottomRow-f;var c=b.heTargetTbody.firstChild;for(var n=0;n<f;n++){var h=b.nBottomRow-n;for(var m=0;m<this.m_nCols;m++){var g=this.getCell(h,m);if(null!=g){if(g.selected){SBGrid.CF.SetSelect(g,false);g.selected=true}if(null!=g.m_heCtrl){jQuery(g.m_heCtrl).removeClass(g.id+"_Attr");var d=this.id+"_"+(b.nTopRow-1-n)+"_"+m;g.m_heCtrl.id="SBHE_"+d;jQuery(g.m_heCtrl).addClass(d+"_Attr")}SBGrid.CF.UnInit(g)}}h=b.nTopRow-1-n;for(var m=0;m<this.m_nCols;m++){var g=this.getCell(h,m);if(null!=g){SBGrid.CF.Init(g);if(this.isnodeset){var q=this.getLabelValue(h,m);g.label=q.label;g.value=q.value}SBGrid.CF.SetLabel(g,g.label,this.m_bIsTooltip);SBGrid.CF.SetValue(g,g.value);if("true"==this.m_bShowValue){this.m_ShowValueStrLabel=g.value+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+g.label}else{this.m_ShowValueStrLabel=g.label}SBGrid.CF.SetLabelChange(g,this.m_ShowValueStrLabel);if(g.selected){SBGrid.CF.SetSelect(g,true)}}}var a=b.heTargetTbody.lastChild;b.heTargetTbody.insertBefore(a,c);c=a}}b.heTargetTable.style.top=b.nTargetTop+"px";b.nTopRow=e;b.nBottomRow=l;b.bUpProcess=0!=e;b.bDownProcess=(this.m_nRows-1)!=l;b=null};SBGrid.CT.Select1.prototype.scrollingCombo=function(d){var o=this.m_objScroll;if(o.arScrollLength.length>1){o.arScrollLength.shift();return}if(this.mbScrollRock){return}this.m_bScrollRock=true;jQuery(this.m_heScrollDiv).removeClass("sbgrid_comboDiv_alpha");var e=null;var g=null;o.nPosition=this.m_heItemList.scrollTop;var l=o.nPosition+(o.nScrollDivHeight/2)-(o.nTargetHeight/2);var a=parseInt(l/this.m_nItemHeight);if(a==o.nTopRow){o.heTargetTable.style.top=o.nTargetTop+"px";o.arScrollLength=new Array();return}else{if(a<o.nStartRow){a=o.nStartRow}else{if(a>o.nEndRow){a=o.nEndRow}}}e=a;g=o.nBottomRow-o.nTopRow+a;o.nTargetTop=this.m_nItemHeight*(a);var c=0;for(var m=o.nTopRow;m<=o.nBottomRow;m++){for(var h=0;h<this.m_nCols;h++){var f=this.getCell(m,h);if(null!=f){if(f.selected){SBGrid.CF.SetSelect(f,false);f.selected=true}if(null!=f.m_heCtrl){jQuery(f.m_heCtrl).removeClass(f.id+"_Attr");var b=this.id+"_"+(a+c)+"_"+h;f.m_heCtrl.id="SBHE_"+b;jQuery(f.m_heCtrl).addClass(b+"_Attr")}SBGrid.CF.UnInit(f)}}c++}c=0;for(var m=e;m<=g;m++){for(var h=0;h<this.m_nCols;h++){var f=this.getCell(m,h);if(null!=f){SBGrid.CF.Init(f);if(this.isnodeset){var n=this.getLabelValue(m,h);f.label=n.label;f.value=n.value}SBGrid.CF.SetLabel(f,f.label,this.m_bIsTooltip);SBGrid.CF.SetValue(f,f.value);if("true"==this.m_bShowValue){this.m_ShowValueStrLabel=f.value+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+f.label}else{this.m_ShowValueStrLabel=f.label}SBGrid.CF.SetLabelChange(f,this.m_ShowValueStrLabel);if(f.selected){SBGrid.CF.SetSelect(f,true)}}}c++}o.heTargetTable.style.top=o.nTargetTop+"px";o.nTopRow=e;o.nBottomRow=g;o.arScrollLength=new Array();o.bUpProcess=0!=e;o.bDownProcess=(this.m_nRows-1)!=g;o=null;this.m_bScrollRock=false};SBGrid.CT.Select1.create=function(a,c,d){var e=SBGrid.CT.Select1.createMainNode(c);var b=document.getElementById(a);if(b==null){b=document.getElementById("SBHE_"+a)}if(b==null){return}b.appendChild(e);e=SBGrid.CT.Select1.createSubNodes(e,c);return SBGrid.CT.Select1.createObject(a,e,c,d)};SBGrid.CT.Select1.createMainNode=function(i){var d=document.createElement("div");d=SBGrid.CT.Select1.createAttribute(d,i);i=SBGrid.CT.Element.createClassName(i,"select1");jQuery(d).addClass("sbgrid_select sbgrid_boxsizing");if(d.getAttribute("appearance")=="full"){if(i.exists("class")){jQuery(d).addClass(i.item("class"))}}if(d.getAttribute("appearance")=="minimal"){jQuery(d).addClass("sbgrid_select4");var l=d.id;var f=document.createElement("table");f.cellPadding=0;f.cellSpacing=0;SBGrid.UT.HtmlLib.setStyle(f,"width","100%");SBGrid.UT.HtmlLib.setStyle(f,"height","100%");var c=document.createElement("tbody");var e=document.createElement("tr");SBGrid.UT.HtmlLib.setStyle(e,"width","100%");SBGrid.UT.HtmlLib.setStyle(e,"height","100%");var g=document.createElement("td");g.valign="middle";var h=document.createElement("input");if(!i.exists("editmode")){if(i.item("editmode")==""){h.readOnly=true}}h.id=l+"_input";var a="sbgrid_combo_input ";if(i.exists("select1_comboinput")){a+=i.item("select1_comboinput")+" "}if(i.exists("combo_comboinput")){a+=i.item("combo_comboinput")+" "}if(h.getAttribute("class")!=null){a=h.getAttribute("class")+" "+a}h.setAttribute("class",a);a="";var b=document.createElement("td");b.id=l+"_img";b.valign="middle";b.align="center";b.setAttribute("class","sbgrid_combo_button_td");var m=document.createElement("button");m.id=l+"_button";a="sbgrid_combo_button ";if(i.exists("select1_combobutton")){a+=i.item("select1_combobutton")+" "}if(i.exists("combo_combobutton")){a+=i.item("combo_combobutton")+" "}if(m.getAttribute("class")!=null){a=m.getAttribute("class")+" "+a}m.setAttribute("class",a);b.appendChild(m);g.appendChild(h);e.appendChild(g);e.appendChild(b);c.appendChild(e);f.appendChild(c);d.appendChild(f)}return d};SBGrid.CT.Select1.createSubNodes=function(b,a){return b};SBGrid.CT.Select1.createObject=function(y,n,E,J){var D="";var x="";var t="";var s="";var U="";var u="";var o="";var p="1";var S="acrossdown";var R=false;var v=false;var g=false;var i="";var q="";var M="";var K=9007199254740992;var d="hidden";var T="";var a="";var L="*";var I="";var H=" ";var P="";var F="visible";var Q=n.getAttribute("appearance");var c="";var z="";var O="";var A="";var h="";var r=false;var V=null;var G=false;var b="";var l=0;if(n.getAttribute("appearance")=="full"){l=0}else{if(n.getAttribute("appearance")=="minimal"){l=E.exists("itemcount")?parseInt(E.item("itemcount")):30}else{if(n.getAttribute("appearance")=="compact"){l=0}}}var C="default";var m=false;var f="";var w=E.getCollection();for(var e in w){switch(e){case"alert":D=w[e];break;case"help":x=w[e];break;case"hint":t=w[e];break;case"accesskey":s=w[e];break;case"bind":U=w[e];break;case"cellspacing":u=w[e];break;case"class":o=w[e];break;case"cols":p=w[e];break;case"direction":S=w[e];break;case"disabled":if("true"==w[e]){R=true}break;case"dragmode":if("true"==w[e]){v=true}break;case"dropmode":if("true"==w[e]){g=true}break;case"editmenu":if("true"==w[e]){G=true}break;case"editmode":b=w[e];break;case"id":i=w[e];break;case"itemcount":break;case"itemheight":q=w[e];break;case"itemwidth":M=w[e];break;case"navindex":K=parseInt(w[e]);break;case"overflow":d=w[e];break;case"pastemode":C=w[e];break;case"ref":T=w[e];break;case"jsonref":a=w[e];break;case"rows":L=w[e];break;case"scroll":I=w[e];break;case"sep":H=w[e];break;case"showtype":strShowType=w[e];break;case"showvalue":if("true"==w[e]){m=true}break;case"vcellspacing":P=w[e];break;case"visibility":F=w[e];break;case"appearance":break;case"nodeset":c=w[e];break;case"jsonnodeset":z=w[e];break;case"labelref":O=w[e];break;case"valueref":A=w[e];break;case"userstaticvalue":h=w[e];break;default:if(!SBGrid.DEF.SB_STYLELIST[e]){f+=e+":"+w[e]+"; "}break}}w=null;var N=false;if(c!=""||z!=""){N=true}var B=new SBGrid.CT.Select1(y,D,x,t,s,U,u,o,p,S,R,v,g,G,b,i,l,q,M,K,d,C,T,a,L,I,H,null,m,J,"softbowl:select1",P,F,0,N,c,z,O,A,Q,f,h,q,M,r,V);return B};SBGrid.CT.Select1.createAttribute=function(b,a){b=SBGrid.CT.Select.createAttribute(b,a);return b};SBGrid.CT.SelectItem=function(a,c,b){this.m_parentWindow=window;if(!c){return}SBGrid.CT.Caption.call(this,a,"","","","","",true,"","",false,false,"",c,-1,"","","",0,b,"softbowl:selectitem","visible")};SBGrid.CT.SelectItem.prototype=new SBGrid.CT.Caption;SBGrid.CT.SelectItem.prototype.init=function(){SBGrid.CT.Caption.prototype.init.call(this)};SBGrid.CT.SelectItem.prototype.setSelect=function(a){if(null==a){a=false}var f=this.getRefElement();if(null!=f){var e=f.m_heCtrl;if(null!=e){var n=SBGrid.DEF.is_ie?e.currentStyle.height:window.getComputedStyle(e,null).height;if(n!=""){var m=Number(n.split("px")[0]);if(m<18){n="18px"}}var c=SBGrid.DEF.is_ie?e.currentStyle.paddingRight:window.getComputedStyle(e,null).paddingRight;var g=SBGrid.DEF.is_ie?e.currentStyle.paddingTop:window.getComputedStyle(e,null).paddingTop;var d=SBGrid.DEF.is_ie?e.currentStyle.paddingBottom:window.getComputedStyle(e,null).paddingBottom;n=""!=n?"height:"+n+";":"";c=1<parseInt(c)?"padding-right:"+c+";":"";g=1<parseInt(g)?"padding-top:"+g+";":"";d=1<parseInt(d)?"padding-bottom:"+d+";":"";f.m_bSelect=a;var l=this.parent.getState(SBGrid.DEF.SB_CS_DISABLE);var h="";var i=this.parent.m_nAppearance;if(a){if(1==i){jQuery(e).removeClass("sbgrid_selectitem1").addClass("sbgrid_selectitem1_check")}else{if(2==i){jQuery(e).removeClass("sbgrid_selectitem2").addClass("sbgrid_selectitem2_check")}}if(l||f.disable){e.style.cssText=(n+c+g+d)+this.m_jsonCssEvent.disable}else{e.style.cssText=(n+c+g+d)+this.m_jsonCssEvent.itemselect}var b=e.style.backgroundImage;if(b){if(b.trim().substring(0,4)!="url("){b="url("+b+")"}window.setTimeout("var SBHE_Control_obj = document.getElementById('"+e.id+"');if(null != SBHE_Control_obj){SBHE_Control_obj.style.backgroundImage = '"+b+"';}",0)}else{window.setTimeout("var SBHE_Control_obj = document.getElementById('"+e.id+"');if(null != SBHE_Control_obj){SBHE_Control_obj.style.backgroundImage = '';}",0)}}else{if(1==i){jQuery(e).removeClass("sbgrid_selectitem1_check").addClass("sbgrid_selectitem1")}else{if(2==i){jQuery(e).removeClass("sbgrid_selectitem2_check").addClass("sbgrid_selectitem2")}}if(l||f.disable){e.style.cssText=(n+c+g+d)+this.m_jsonCssEvent.dedisable}else{e.style.cssText=(n+c+g+d)+this.m_jsonCssEvent.deselect}var b=e.style.backgroundImage;if(b){if(b.trim().substring(0,4)!="url("){b="url("+b+")"}window.setTimeout("var SBHE_Control_obj = document.getElementById('"+e.id+"');if(null != SBHE_Control_obj){SBHE_Control_obj.style.backgroundImage = '"+b+"';}",0)}else{window.setTimeout("var SBHE_Control_obj = document.getElementById('"+e.id+"');if(null != SBHE_Control_obj){SBHE_Control_obj.style.backgroundImage = '';}",0)}}}}};SBGrid.CT.SelectItem.create=function(b,d,e){var g=d.item("id")?d.item("id"):"";var a=new SBGrid.CT.SelectItem(b,g,e);a.m_jsonCssEvent.itemselect="";var c=d.getCollection();for(var f in c){if(-1!=f.indexOf("disable.select.")){var h=c[f];f=f.substring(15);if(-1!=f.indexOf("background-image")){h="url("+h+")"}a.m_jsonCssEvent.disable+=f+":"+h+";"}else{if(-1!=f.indexOf("disable.")){var h=c[f];f=f.substring(8);if(-1!=f.indexOf("background-image")){h="url("+h+")"}a.m_jsonCssEvent.dedisable+=f+":"+h+";"}else{if(-1!=f.indexOf("item.select.")){var h=c[f];f=f.substring(12);if(-1!=f.indexOf("background-image")){h="url("+h+")"}a.m_jsonCssEvent.itemselect+=f+":"+h+";"}else{if(-1!=f.indexOf("background-image")){var h=c[f];h="url("+h+")";a.m_jsonCssEvent.deselect=f+":"+h+";"}else{a.setAttribute(f,c[f])}}}}}c=null;return a};SBGrid.DS.Choices=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b);this.itemset};SBGrid.DS.Choices.prototype=new SBGrid.CT.Element;SBGrid.DS.Choices.prototype.init=function(){};SBGrid.DS.Choices.prototype.setItemset=function(a){this.itemset=a};SBGrid.DS.Choices.create=function(b,c){var a=new SBGrid.DS.Choices(b,c.item("id"),"softbowl:choices");a.parent.isnodeset=true;return a};SBGrid.DS.Itemset=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b);this.label;this.value};SBGrid.DS.Itemset.prototype=new SBGrid.CT.Element;SBGrid.DS.Itemset.prototype.init=function(){};SBGrid.DS.Itemset.prototype.setLabel=function(a){this.label=a};SBGrid.DS.Itemset.prototype.setValue=function(a){this.value=a};SBGrid.DS.Itemset.prototype.setAttribute=function(a,b){SBGrid.CT.Element.prototype.setAttribute.call(this,a,b);switch(a){case"nodeset":if(null!=this.parent.parent){this.parent.parent.nodeset=b}break}};SBGrid.DS.Itemset.create=function(e,g){var d=new SBGrid.DS.Itemset(e,g.item("id"),"softbowl:itemset");var f=d.parent;var b=f.elementName;if("softbowl:treeview"==b){if(g.exists("nodeset")){f.m_bIsItemSet=true;var c=g.item("nodeset");var a=c.lastIndexOf("/");var h=c.substring(a+1);f.nodeset=c;f.m_strNodeSetName=h}}else{if("softbowl:choices"==b){if(g.exists("nodeset")){d.parent.parent.nodeset=g.item("nodeset")}}}return d};SBGrid.DS.Label=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b)};SBGrid.DS.Label.prototype=new SBGrid.CT.Element;SBGrid.DS.Label.prototype.init=function(){};SBGrid.DS.Label.prototype.setAttribute=function(a,b){SBGrid.CT.Element.prototype.setAttribute.call(this,a,b);switch(a){case"ref":if(null!=this.parent.parent.parent){this.parent.parent.parent.labelref=b}break}};SBGrid.DS.Label.create=function(b,d){var e=new SBGrid.DS.Label(b,d.item("id"),"softbowl:label");var c=e.parent.parent;var a=c.elementName;if("softbowl:treeview"==a){if(d.exists("ref")){c.m_strLabelRef=d.item("ref")}}else{if("softbowl:choices"==a){if(d.exists("ref")){e.parent.parent.parent.labelref=d.item("ref")}e.parent.parent.parent.reBuild("init");e.parent.parent.parent.setDisabled(this.disabled)}}return e};SBGrid.DS.Value=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b)};SBGrid.DS.Value.prototype=new SBGrid.CT.Element;SBGrid.DS.Value.prototype.init=function(){};SBGrid.DS.Value.prototype.setAttribute=function(a,b){SBGrid.CT.Element.prototype.setAttribute.call(this,a,b);switch(a){case"ref":if(null!=this.parent.parent.parent){this.parent.parent.parent.valueref=b}break}};SBGrid.DS.Value.create=function(c,e){var b=new SBGrid.DS.Value(c,e.item("id"),"softbowl:value");var d=b.parent.parent;var a=d.elementName;if("softbowl:treeview"==a){if(e.exists("ref")){d.m_strValueRef=e.item("ref")}}else{if("softbowl:choices"==a){if(e.exists("ref")){b.parent.parent.parent.valueref=e.item("ref")}b.parent.parent.parent.reBuild("init");b.parent.parent.parent.setDisabled(this.disabled)}}return b};SBGrid.DS.Depth=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b)};SBGrid.DS.Depth.prototype=new SBGrid.CT.Element;SBGrid.DS.Depth.prototype.init=function(){};SBGrid.DS.Depth.create=function(a,c){var b=new SBGrid.DS.Depth(a,c.item("id"),"softbowl:depth");if(c.exists("ref")){b.parent.parent.m_strDepthRef=c.item("ref")}return b};SBGrid.CT.Image=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b)};SBGrid.CT.Image.prototype=new SBGrid.CT.Element;SBGrid.CT.Image.prototype.init=function(){};SBGrid.CT.Image.create=function(b,c){var a=new SBGrid.CT.Image(b,c.item("id"),"softbowl:image");if(c.exists("ref")){a.parent.parent.m_strImageRef=c.item("ref")}return a};SBGrid.CT.SelectedImage=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b)};SBGrid.CT.SelectedImage.prototype=new SBGrid.CT.Element;SBGrid.CT.SelectedImage.prototype.init=function(){};SBGrid.CT.SelectedImage.create=function(a,c){var b=new SBGrid.CT.SelectedImage(a,c.item("id"),"softbowl:selectedimage");if(c.exists("ref")){b.parent.parent.m_strSelectedImageRef=c.item("ref")}return b};SBGrid.CT.ExpandedImage=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b)};SBGrid.CT.ExpandedImage.prototype=new SBGrid.CT.Element;SBGrid.CT.ExpandedImage.prototype.init=function(){};SBGrid.CT.ExpandedImage.create=function(a,b){var c=new SBGrid.CT.ExpandedImage(a,b.item("id"),"softbowl:expandedimage");if(b.exists("ref")){c.parent.parent.m_strExpandedImageRef=b.item("ref")}return c};SBGrid.CT.Img=function(c,h,d,u,p,l,o,n,s,r,e,a,t,f,b,g,w,v,m,q,i){if(!a){return}SBGrid.CT.BindableControl.call(this,c,h,d,u,p,l,n,s,a,t,f,b,w,v,q,i);this.attribute.dragmode=String(r);this.attribute.dropmode=String(e);this.attribute.cache=String(o);this.attribute.src=g;this.attribute.upload=String(m);this.attribute.jsonref=String(b);this.src=g;this.upload=m;this.m_heUploadUI=null;this.m_bUploadUIVisible=false};SBGrid.CT.Img.prototype=new SBGrid.CT.BindableControl;SBGrid.CT.Img.prototype.getBindingType=function(){return SBGrid.DEF.SB_SINGLE};SBGrid.CT.Img.prototype.refresh=function(){if(null!=this.m_heCtrl){var strRef="";strRef=this.attribute.jsonref;if(null!=strRef&&""!=strRef){var strValue=eval(this.attribute.jsonref);this.setSrc(strValue)}strRef=this.attribute.ref;if(null!=strRef&&""!=strRef){var strValue=this.getValue(strRef);this.setSrc(strValue)}}};SBGrid.CT.Img.prototype.init=function(){SBGrid.CT.BindableControl.prototype.init.call(this);var c=document.getElementById("SBHE___SB_ImageUploadFrame");if(c){if(c.attachEvent){c.attachEvent("onload",SBGrid.CT.Img.uploadTempComplete)}else{c.addEventListener("load",SBGrid.CT.Img.uploadTempComplete,false)}}if(this.upload){this.createUploadUI()}var e=parseInt((this.m_heCtrl.style.border).replaceAll("px",""));var f=parseInt((this.m_heCtrl.style.borderLeft).replaceAll("px",""));var b=parseInt((this.m_heCtrl.style.borderTop).replaceAll("px",""));var d=parseInt((this.m_heCtrl.style.borderRight).replaceAll("px",""));var a=parseInt((this.m_heCtrl.style.borderBottom).replaceAll("px",""));if(""!=e&&null!=e){if(""!=f&&null){this.m_heCtrl.style.borderLeft=f}}};SBGrid.CT.Img.prototype.createUploadUI=function(){this.m_heUploadShadowUI=document.createElement("div");this.m_heUploadShadowUI.className="sbgrid_image_upload_shadow";this.m_heUploadShadowUI.style.visibility="hidden";this.m_heUploadShadowUI.style.top=this.getAttribute("top");this.m_heUploadShadowUI.style.left=this.getAttribute("left");this.m_heUploadShadowUI.style.width=this.getAttribute("width");this.m_heUploadShadowUI.style.height=this.getAttribute("height");this.m_heCtrl.parentNode.appendChild(this.m_heUploadShadowUI);this.m_heUploadUI=document.createElement("div");this.m_heUploadUI.setAttribute("id","SBHE_"+this.id);var e=this.m_heCtrl.className;if(""!=e){jQuery(this.m_heUploadUI).addClass(e)}this.m_heUploadUI.style.top=this.getAttribute("top");this.m_heUploadUI.style.left=this.getAttribute("left");this.m_heUploadUI.style.width=this.getAttribute("width");this.m_heUploadUI.style.overflow="hidden";this.m_heCtrl.parentNode.appendChild(this.m_heUploadUI);var d=document.createElement("button");d.id="SBHE_"+this.id+".detach";var h="";if(this.m_clCSSName.exists("img_detach")){h=this.m_clCSSName.item("img_detach")}jQuery(d).addClass("sbgrid_image_detach "+h);d.parent=this;d.style.right="4px";d.style.top="4px";d.style.width="16px";d.style.height="16px";d.style.backgroundColor="transparent";d.onclick=function(){SBGrid.CT.Img.deleteFile(this.parent.id)};this.m_heUploadUI.appendChild(d);var c=new SBGrid.CT.Button(this.id,"","","","","",false,"","",false,false,"","","",this.id+".detach",-1,"","",-1,false,"","softbowl:button","visible");c.init();var b=document.createElement("div");b.id="SBHE_"+this.id+".attach";b.style.left="50%";b.style.top="50%";b.style.width="32px";b.style.height="32px";b.style.fontSize="0pt";b.style.overflow="hidden";var f="";if(this.m_clCSSName.exists("img_attach")){f=this.m_clCSSName.item("img_attach")}jQuery(b).addClass("sbgrid_image_attach "+f);this.m_heUploadUI.appendChild(b);var g=new SBGrid.CT.Button(this.id,"","","","","",false,"","",false,false,"","","",this.id+".attach",-1,"","",-1,false,"","softbowl:button","visible");g.init();b.style.marginLeft=(b.offsetWidth/-2)+"px";b.style.marginTop=(b.offsetHeight/-2)+"px";var a=document.createElement("form");a.id="SBHE___SB_ImageUploadForm_"+this.id;a.name="SBHE___SB_ImageUploadForm_"+this.id;a.action=SBGrid.DEF.__getAppName()+"/FileUpload.tfs";a.method="post";a.encoding="multipart/form-data";a.enctype="multipart/form-data";a.target="SBHE___SB_ImageUploadFrame";a.style.backgroundColor="transparent";b.appendChild(a);this.createUploadFileInput()};SBGrid.CT.Img.prototype.createUploadFileInput=function(d){var d=document.getElementById("SBHE___SB_ImageUploadForm_"+this.id);d.style.left="0px";d.style.top="0px";d.style.width="100%";d.style.height="100%";var c=document.getElementById("SBHE_ImageInput_"+this.id);if(c){d.removeChild(c)}var a=document.createElement("input");a.id="SBHE_ImageInput_"+this.id;a.name="SBHE_ImageInput_"+this.id;a.type="file";a.onchange=function(){var g=this.parentNode.id.replace("SBHE___SB_ImageUploadForm_","");SBGrid.CT.Img.submitFile(g);document.SBHE_controls.item(g).createUploadFileInput()};d.appendChild(a);var e=document.getElementById("SBHE_"+this.id+".attach");var b=e.offsetHeight;var f=e.offsetWidth;a=document.getElementById("SBHE_ImageInput_"+this.id);a.style.filter="alpha(opacity = 0)";a.style.opacity=0;a.style.left="0px";a.style.top="0px";a.style.width="100%";a.style.height="100%"};SBGrid.CT.Img.prototype.showUploadUI=function(){if(this.upload){this.m_bUploadUIVisible=true;this.m_heUploadUI.style.visibility="";this.m_heUploadShadowUI.style.visibility="";var c=this.getAttribute("top");var d=this.getAttribute("left");var b=this.getAttribute("width");var a=this.getAttribute("height");this.m_heUploadUI.style.top=parseInt(c)+"px";this.m_heUploadUI.style.left=parseInt(d)+"px";this.m_heUploadUI.style.width=parseInt(b)+"px";this.m_heUploadUI.style.height=parseInt(a)+"px"}};SBGrid.CT.Img.prototype.hideUploadUI=function(){if(this.upload){this.m_bUploadUIVisible=false;this.m_heUploadUI.style.visibility="hidden";this.m_heUploadShadowUI.style.visibility="hidden"}};SBGrid.CT.Img.prototype.deleteFile=function(){if(""!=this.src){this.setSrc("");if(this.attribute.jsonref!=""){eval(this.attribute.jsonref+"='';")}else{SBGrid.DS.XMLStorage.getUniqueStorage().setValue(this.attribute.ref,"")}this.refresh()}};SBGrid.CT.Img.prototype.submitFile=function(){var b=document.getElementById("SBHE_ImageInput_"+this.id);var a=document.getElementById("SBHE___SB_ImageUploadForm_"+this.id);a.submit()};SBGrid.CT.Img.prototype.setAttachedFile=function(a,b){this.setSrc(b);this.setValue(a+"|"+b)};SBGrid.CT.Img.prototype.setAttribute=function(a,b){SBGrid.CT.BindableControl.prototype.setAttribute.call(this,a,b);switch(a){case"cache":this.attribute.cache=b;break;case"src":this.attribute.src=b;this.src=b;this.m_heCtrl.src=b;break}};SBGrid.CT.Img.prototype.setSrc=function(b){if(this.upload&&-1<b.indexOf("|")){var a=b.split("|");if(2==a.length){b=a[1]}}if(this.src!=b){this.attribute.src=b;this.src=b;if(b==""){this.m_heCtrl.src="data:image/png;base64,"}else{this.m_heCtrl.src=b}}};SBGrid.CT.Img.prototype.onClick=function(a){SBGrid.CT.BindableControl.prototype.onClick.call(this,a);if(SBGrid.DEF.is_smartphone&&this.upload){(this.m_bUploadUIVisible)?this.hideUploadUI():this.showUploadUI()}};SBGrid.CT.Img.prototype.onMouseMove=function(a){if(this.m_bLButtonDown&&""!=this.getAttribute("dragmode")&&"false"!=this.getAttribute("dragmode")&&!this.m_bDragStart){SBGrid.DEF.bDragDrop=true;this.m_bDragStart=true;a.capture="";a.drag=this.id;this.dispatch("ondragstart");if(this.m_bLButtonDown&&""!=this.getAttribute("dropmode")&&"false"!=this.getAttribute("dropmode")){this.dispatch("ondragenter");this.dispatch("ondragover")}}else{SBGrid.CT.Control.prototype.onMouseMove.call(this,a)}};SBGrid.CT.Img.prototype.onMouseDown=function(a){SBGrid.CT.Control.prototype.onMouseDown.call(this,a);this.m_bLButtonDown=true};SBGrid.CT.Img.prototype.onMouseUp=function(a){SBGrid.CT.Control.prototype.onMouseUp.call(this,a);this.m_bLButtonDown=false};SBGrid.CT.Img.prototype.onMouseEnter=function(a){SBGrid.CT.BindableControl.prototype.onMouseEnter.call(this,a);if(this.upload){this.showUploadUI()}};SBGrid.CT.Img.prototype.onMouseOut=function(a){SBGrid.CT.BindableControl.prototype.onMouseOut.call(this,a);if(this.upload&&a.pTarget.parent!=this&&a.pTarget!=this){this.hideUploadUI()}};SBGrid.CT.Img.deleteFile=function(b){var a=document.SBHE_controls.item(b);if(null!=a&&a instanceof SBGrid.CT.Img){a.deleteFile()}};SBGrid.CT.Img.submitFile=function(b){var a=document.SBHE_controls.item(b);if(null!=a&&a instanceof SBGrid.CT.Img){a.submitFile()}};SBGrid.CT.Img.uploadTempComplete=function(){var i=document.getElementById("SBHE___SB_ImageUploadFrame").contentWindow.document;var f;if(SBGrid.DEF.is_ie){if(i.XMLDocument){f=i.XMLDocument.xml}else{var h=new XMLSerializer();f=h.serializeToString(i)}}else{var h=new XMLSerializer();f=h.serializeToString(i)}if(f){var a=SBGrid.UT.XmlLib.loadXMLFromString(f);if(a.selectSingleNode("/root")){var m=a.selectSingleNode("/root/tagName");var b=a.selectSingleNode("/root/fileName");var d=a.selectSingleNode("/root/tempName");var g=SBGrid.UT.XmlLib.getTextValue(m);var l=SBGrid.UT.XmlLib.getTextValue(b);var e=SBGrid.UT.XmlLib.getTextValue(d);var c=document.SBHE_controls.item(g.substr("SBHE_ImageInput_".length));if(null!=c){c.setAttachedFile(l,e)}}}};SBGrid.CT.Img.create=function(b,d,e){d=SBGrid.CT.Element.createClassName(d,"img");var a=SBGrid.CT.Img.createMainNode(d);var c=document.getElementById(b);if(c==null){c=document.getElementById("SBHE_"+b)}if(c==null){return}c.appendChild(a);a=SBGrid.CT.Img.createSubNodes(a,d);return SBGrid.CT.Img.createObject(b,a,d,e)};SBGrid.CT.Img.createMainNode=function(b){var a=document.createElement("img");a.setAttribute("alt",this.id);a=SBGrid.CT.Img.createAttribute(a,b);jQuery(a).addClass("sbgrid_image");jQuery(a).addClass("sbgrid_boxsizing");return a};SBGrid.CT.Img.createSubNodes=function(a,b){return a};SBGrid.CT.Img.createObject=function(c,q,y,A){var l="";var d="";var z="";var t="";var n="";var s=true;var r="";var w=false;var v=false;var g=false;var a="";var x=9007199254740992;var h="";var b="";var i="";var o=false;var u="visible";var m="";var p=y.getCollection();for(var f in p){switch(f){case"alert":l=p[f];break;case"help":d=p[f];break;case"hint":z=p[f];break;case"accesskey":t=p[f];break;case"bind":n=p[f];break;case"cache":if("false"==p[f]){s=false}break;case"class":r=p[f];break;case"disabled":if("true"==p[f]){w=true}break;case"dragmode":if("true"==p[f]){v=true}break;case"dropmode":if("true"==p[f]){g=true}break;case"id":a=p[f];break;case"navindex":x=parseInt(p[f]);break;case"ref":h=p[f];break;case"jsonref":b=p[f];break;case"src":i=p[f];break;case"visibility":u=p[f];break;default:if(!SBGrid.DEF.SB_STYLELIST[f]){m+=f+":"+p[f]+"; "}break}}p=null;var e=new SBGrid.CT.Img(c,l,d,z,t,n,s,r,w,v,g,a,x,h,b,i,A,"softbowl:img",o,u,m);return e};SBGrid.CT.Img.createAttribute=function(b,a){b=SBGrid.CT.BindableControl.createAttribute(b,a);return b};SBGrid.UT.GridStatusManager=function(){this.m_nRow=-1;this.m_nCol=-1;this.m_strText="";this.m_dwUpdataFlag=0;this.m_arDeleteData=new Array();this.m_arDeleteDataXml=new Array()};SBGrid.UT.GridStatusManager.prototype.getModifyRow=function(){return this.m_nRow};SBGrid.UT.GridStatusManager.prototype.setModifyRow=function(a){this.m_nRow=a};SBGrid.UT.GridStatusManager.prototype.getModifyCol=function(){return this.m_nCol};SBGrid.UT.GridStatusManager.prototype.setModifyCol=function(a){this.m_nCol=a};SBGrid.UT.GridStatusManager.prototype.getModifyText=function(){return this.m_strText};SBGrid.UT.GridStatusManager.prototype.setModifyText=function(a){this.m_strText=a};SBGrid.UT.GridStatusManager.prototype.getUpdateFlag=function(){return this.m_dwUpdataFlag};SBGrid.UT.GridStatusManager.prototype.setUpdateFlag=function(a){this.m_dwUpdataFlag=a};SBGrid.UT.GridStatusManager.prototype.getArrayDelete=function(){return this.m_arDeleteData};SBGrid.UT.GridStatusManager.prototype.getArrayDeleteXml=function(){return this.m_arDeleteDataXml};SBGrid.CT.DataGrid=function(strParentId,strAlert,strHelp,strHint,bAllowBigSelection,bAllowSelection,bAllowUserResize,bAutoResize,bAutoSizeMouse,strBackColorAlternate,strBackColorFrozen,strCaption,strCaptionLayout,strClass,strColSep,strColWidth,strDataHeight,strDataType,nDefaultRows,strDeleteFlagImage,bDisabled,bDragMode,bDropmode,bEllipsis,strExplorerbar,strExplorerUI,strExtendLastCol,nFixedCols,strFocusColor,strForeColorFrozen,nFrozenBottomRows,nFrozenCols,nFrozenRows,strId,strInsertFlagImage,strMergeCells,strMergeCellsFixedCols,strMergeCellsFixedRows,bMultiTotal,strNodeSet,strJsonRef,strNormalFlagImage,strOverflow,bRemoveHScroll,bRemoveVScroll,strRowHeader,strRowHeight,nRows,strRowSep,strScroll,strSelectFontColor,strSelectFontColorStyle,strSelectImageStyle,strSelectMode,strSubTotalPosition,strStyle,strTag,strToolTip,strUpdateFlagImage,strVisibility,strWallPaper,bIsDecimalFormatInsert,strUserDefineAttrib,strSummary,bAutoResizeCaption,strDataReplace,bIsDataReplaceValueChanged,cReady,strGridReady,strEmptyRecords,strEmptyRecordsFontStyle,strTheme,bCreateAll,nRenderingRows,bAllowCopy,bAllowPaste,strBeforeElementId,strNextElementId,bRealDataSync,arExtRefList,nScrollingDelayTime,bContextMenu,bDataSearching,bIsShowLoadingImage,bAutoSavePsnlData,strPsnlDataId,arContextMenuList,bIsTextareaScroll,bUseMultiSorting,bIsSortFrozenRows,bIsSortFrozenBottomRows,strGridSummary,strUserCaption,bUseWebAccess,arCalcParam,bComboDataSync,bCellsInfoDisplay,bOneClickEdit,bUseFrozenSelect,strCellFocusColor){if(!strId){return}this.m_heLodExcelForm=null;this.m_strTargetGrid=strId;this.m_strGridJsonReg=strJsonRef!=null?strJsonRef:"";this.m_heContextMenu=null;this.m_bIsContextMenu=bContextMenu;this.m_bIsTextareaScroll=bIsTextareaScroll;this.m_bIsCellsInfoDiv=null;this.m_bIsCellsInfoDisplay=bCellsInfoDisplay;this.m_bIsOneclickEdit=bOneClickEdit;this.m_strGridSummary=strGridSummary;this.m_bUseWebAccess=bUseWebAccess;this.m_bUseFrozenSelect=bUseFrozenSelect;this.m_bComboDataSync=bComboDataSync;this.m_strUserCaption=strUserCaption;this.m_arUserCaption=new Array();this.m_strComboId="";this.m_clPivotColData=new SBGrid.DS.Collection();this.m_bUseMultiSorting=bUseMultiSorting;this.m_mapMultiSortShowIconInfo=new SBGrid.DS.Map();this.m_clMultiSortingHistory=new SBGrid.DS.Collection();this.m_bIsSortFrozenRows=bIsSortFrozenRows;this.m_bIsSortFrozenBottomRows=bIsSortFrozenBottomRows;this.m_bIsAllowCopy=bAllowCopy;this.m_bIsAllowPaste=bAllowPaste;this.m_heGridDataSearchUI=null;this.m_strDataSearchHistory=0;this.m_bIsDataSearching=bDataSearching;this.m_arContextMenuList=arContextMenuList;this.m_arCalcParam=arCalcParam;this.m_strCellFocusColor=strCellFocusColor;this.createDefaultHtmlTag(strParentId,strId,strStyle);SBGrid.CT.Group.call(this,strParentId,strAlert,strHelp,strHint,"","",strClass,bDisabled,strId,0,strOverflow,"","","",strScroll,"",strStyle,strTag,strVisibility,strUserDefineAttrib);strCaption=strCaption.split("__SB_STR_N").join("\\n");strCaption=strCaption.split("__SB_STR_T").join("\\t");strCaption=strCaption.split("__SB_STR_R").join("\\r");strCaption=strCaption.split("__SB_N").join("\n");strCaption=strCaption.split("__SB_T").join("\t");strCaption=strCaption.split("__SB_R").join("\r");if(strJsonRef==""&&strDataType=="delimeter"){strJsonRef=strId+"_delimeterData"}this.attribute.allowbigselection=String(bAllowBigSelection);this.attribute.allowselection=String(bAllowSelection);this.attribute.allowuserresize=String(bAllowUserResize);this.attribute.autoresize=String(bAutoResize);this.attribute.autosizemouse=String(bAutoSizeMouse);this.attribute.backcoloralternate=strBackColorAlternate;this.attribute.backcolorfrozen=strBackColorFrozen;this.attribute.caption=strCaption;this.attribute["caption-layout"]=strCaptionLayout;this.attribute.colsep=strColSep;this.attribute.colwidth=strColWidth;this.attribute.dataheight=strDataHeight;this.attribute.datatype=strDataType;this.attribute.defaultrows=String(nDefaultRows);this.attribute.deleteflagimage=strDeleteFlagImage;this.attribute.dragmode=String(bDragMode);this.attribute.dropmode=String(bDropmode);this.attribute.ellipsis=String(bEllipsis);this.attribute.explorerbar=strExplorerbar;this.attribute.explorerui=strExplorerUI;this.attribute.extendlastcol=strExtendLastCol;this.attribute.fixedcols=String(nFixedCols);this.attribute.focuscolor=strFocusColor;this.attribute.forecolorfrozen=strForeColorFrozen;this.attribute.frozenbottomrows=String(nFrozenBottomRows);this.attribute.frozencols=String(nFrozenCols);this.attribute.frozenrows=String(nFrozenRows);this.attribute.insertflagimage=strInsertFlagImage;this.attribute.mergecells=strMergeCells;this.attribute.mergecellsfixedcols=strMergeCellsFixedCols;this.attribute.mergecellsfixedrows=strMergeCellsFixedRows;this.attribute.multitotal=String(bMultiTotal);this.attribute.nodeset=strNodeSet;this.attribute.jsonref=strJsonRef;this.attribute.normalflagimage=strNormalFlagImage;this.attribute.removehscroll=String(bRemoveHScroll);this.attribute.removevscroll=String(bRemoveVScroll);this.attribute.rowheader=strRowHeader;this.attribute.rowheight=strRowHeight;this.attribute.rows=String(nRows);this.attribute.rowsep=strRowSep;this.attribute.selectfontcolor=strSelectFontColor;this.attribute.selectfontcolorstyle=strSelectFontColorStyle;this.attribute.selectimagestyle=strSelectImageStyle;this.attribute.selectionmode=strSelectMode;this.attribute.subtotalposition=strSubTotalPosition;this.attribute.tooltip=strToolTip;this.attribute.updateflagimage=strUpdateFlagImage;this.attribute.wallpaper=strWallPaper;this.attribute.decimalformatinsert=String(bIsDecimalFormatInsert);this.attribute.summary=strSummary;this.attribute.datareplace=strDataReplace;this.attribute.datareplacevaluechange=bIsDataReplaceValueChanged;this.attribute.ready=cReady;this.attribute.gridready=strGridReady;this.attribute.beforeelementid=strBeforeElementId;this.attribute.nextelementid=strNextElementId;this.allowBigSelection=bAllowBigSelection;this.allowSelection=bAllowSelection;this.allowUserResize=bAllowUserResize;this.autoMerge=true;this.autoResize=bAutoResize;this.autoSizeMouse=bAutoSizeMouse;this.backColorAlternate=strBackColorAlternate;this.backColorFrozen=strBackColorFrozen;this.caption=strCaption;this.col=-1;this.colDisabled;this.cols;this.m_arColWidth=new Array();this.colWidthMax=9999;this.colWidthMin=3;this.dataHeight=""==strDataHeight?20:parseInt(strDataHeight);this.dataHeightMin=20;this.explorerbar=strExplorerbar;this.explorerui=strExplorerUI;this.extendLastCol=strExtendLastCol;this.ellipsis=bEllipsis;this.fixedCols=nFixedCols;this.fixedRows;this.focusColor=strFocusColor;this.foreColorFrozen=strForeColorFrozen;this.frozenBottomRows=nFrozenBottomRows;this.frozenCols=nFrozenCols;this.frozenRows=nFrozenRows;this.mergeCells=strMergeCells;this.mergeCellsFixedCols=strMergeCellsFixedCols;this.mergeCellsFixedRows=strMergeCellsFixedRows;this.mouseCol;this.mouseRow;this.multiTotals=bMultiTotal;this.nodeset=strNodeSet;this.jsonref=strJsonRef;this.group=0;this.groupCol=0;this.groupLevelCol=null;this.row=-1;this.prevMouseRow=-1;this.prevMouseCol=-1;this.rowheader=strRowHeader;this.m_nRowHeight=""==strRowHeight?28:parseInt(strRowHeight);this.rowHeightMax=9999;this.rowHeightMin=19;this.rows;this.selectedRows;this.selectFontColorStyle=strSelectFontColorStyle;this.selectImageStyle=strSelectImageStyle;this.selectionMode;this.seqRowHeader=1;this.subtotalPosition=strSubTotalPosition;this.topRow=0;this.bottomRow=0;this.wallPaper=strWallPaper;this.m_strTooltip=strToolTip;this.m_objUpdate=new SBGrid.UT.GridStatusManager();this.m_htRowHeight={};this.m_bRowHeader=!strRowHeader.isEmpty();this.m_bIsChangeItem=false;this.m_arColumn=new Array();this.m_arCaption=new Array();this.m_arCombo=new Array();this.m_heWhole;this.m_heEmptyRecords;this.m_bIsCaptionDrag=true;this.m_heFFS;this.m_heFFNS;this.m_heFFC;this.m_heFFBS;this.m_heFFBNS;this.m_heInitRow;this.m_heMergeCell;this.m_heHGuideLine;this.m_heVGuideLine;this.m_heMoveColumnBar;this.m_objInput;this.m_objCombo;this.m_objTextArea;this.m_bScrollMoveFirstCell=false;this.m_ContextIndex=0;this.m_nPrevX;this.m_nPrevY;this.m_nEditRow=-1;this.m_nEditCol=-1;this.m_nPrevDownRow=-1;this.m_nPrevDownCol=-1;this.m_nDownRow=-1;this.m_nDownCol=-1;this.m_strPrevCursor="";this.m_resizeInfo={m_nCurX:0,m_nCurY:0};this.m_arSelectRows;this.m_arSelectCols;this.m_htSelectCells;this.m_bModify=false;this.m_bEditing=false;this.m_bChangedItem=false;this.m_bColChangeStatus=false;this.m_bClearCaption=false;this.m_bAfterResize;this.m_nDefaultRows=nDefaultRows;this.m_nRealRows=0;this.m_strDeleteFlagImage=(""==strDeleteFlagImage?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHDelete:strDeleteFlagImage);this.m_strInsertFlagImage=(""==strInsertFlagImage?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHInsert:strInsertFlagImage);this.m_strNormalFlagImage=(""==strNormalFlagImage?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHNew:strNormalFlagImage);this.m_strUpdateFlagImage=(""==strUpdateFlagImage?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHUpdate:strUpdateFlagImage);this.m_arHiddenCol=new Array();this.m_arHiddenRow;this.m_arHiddenRowState=new Array();this.m_arUpdateDeleteList=new Array();this.m_nHideColumnsCount;this.m_clIndexes=new SBGrid.DS.Collection();this.m_clFilteringHistoryStack=new SBGrid.DS.Collection();if(SBGrid.DEF.is_smartphone){this.m_nOriginWidth=0;this.m_nOriginHeight=0}this.m_htDataStyle=null;this.m_htFixedStyle=null;this.m_bIsExplorerBar=false;this.m_nExplorerBarType=-1;this.m_bIsExplorerUI=false;this.m_nExplorerUIType=-1;this.m_bIsFirstMoveColumn=false;this.m_bHasItem;this.m_heWait=null;this.m_htColSort={};this.m_nSortType=SBGrid.DEF.SBST_ASC;this.m_htRowSubTotal={};this.m_nMakeIndex=0;this.m_nBottomRowCount=0;this.m_arMergeList=new Array();this.m_arMergeByFreeList=new Array();this.m_arMergeFixedRowList=new Array();this.m_arMergeFixedColList=new Array();this.m_htMergeBFColList={};this.m_htMergeFRColList={};this.m_htMergeFCColList={};this.m_htMergeColList={};this.m_bChangeFixedRows=false;this.m_arFixedRowHiddenStatus=new Array();this.m_bIsShowItem=false;this.m_bIsSort=false;this.m_arSortNodeList=null;this.m_arSortJson=null;this.m_bIsMakeCellStatus=false;this.m_objGridData=null;this.m_nlightGridTime=null;this.m_nlightGridLine=0;this.m_bIsMaxLength=false;this.m_bIsRowHeight=""!=strRowHeight;this.m_bIsUsePercentOfColWidth=false;this.bExistImageType=false;this.m_objScroll={bScrollEvent:false,bUpProcess:true,bDownProcess:true,nMaxLength:0,nBottom:0,nStartRow:0,nEndRow:0,nTopRow:0,nBottomRow:0,nPosition:0,nTargetTop:0,nTargetHeight:0,heTargetTable:null,nScrollDivHeight:0,arScrollLength:new Array(),arTargetRow:new Array()};this.m_objHeArea={bTotalHiddenCheck:false,bCheckWidth:null,bChangeWidth:null,bCheckHeight:null};this.m_bScrollRock=false;this.m_objGroup=new Array();this.m_scrollSetTime=null;this.m_htCellFormat={};if(strDataType=="delimeter"){SBGrid.DEF.m_arLightgrid.push({id:strId,nodeset:strNodeSet,jsonref:strJsonRef});this.jsonref=strId+"_delimeterData"}this.m_bIsShowCombo=false;this.m_nReScrollPosition=null;this.autoResizeCaption=bAutoResizeCaption;this.m_replaceString=strDataReplace;this.m_bIsDataReplaceValueChanged=bIsDataReplaceValueChanged;this.m_strEmptyRecords=strEmptyRecords;this.m_strEmptyRecordsFontStyle=strEmptyRecordsFontStyle;this.m_bSMC=false;this.m_style_theme=strTheme==""||strTheme=="undefined"?"":strTheme;this.m_default_theme="";this.m_bIsTinit=__initSBDataGrid();this.nHiddenTrTagCount=0;this.m_nRenderingRows=nRenderingRows;this.m_nCSSBottomBorderFlg=false;this.m_bIsAutoSavePsnlData=bAutoSavePsnlData;this.m_strPsnlDataId=strPsnlDataId;this.m_arrBeforeRefOfCol=new SBGrid.DS.Set();this.m_arChangedColInfo=new SBGrid.DS.Set();this.m_arrHiddenCol=new SBGrid.DS.Set();this.m_arrHiddenRow=new SBGrid.DS.Set();this.m_objPersonalize=[];if(typeof this.backColorFrozen=="undefined"){this.backColorFrozen=""}eval("window."+strId+"_delimeterData = new Array();");document.SBHE_grids.add(this.id,this);this.m_bCreateAll=bCreateAll;this.m_mapColStyleInfo=new SBGrid.DS.Map();this.m_bIsMouseWheel=false;this.m_bMouseDown=false;this.m_bCapturing=false;this.m_bIsRealDataSync=bRealDataSync;this.m_arExtRefList=arExtRefList;this.m_nScrollingDelayTime=nScrollingDelayTime;this.m_mapGridStyleInfo=new SBGrid.DS.Map();this.m_bIsShowLoadingImage=bIsShowLoadingImage;this.m_bNotRunAutoResize=true;this.m_setLimitedSelectRows=new SBGrid.DS.Set();this.m_mapMergeByFree=new SBGrid.DS.Map();this.m_bIsMergeByFree=false};SBGrid.CT.DataGrid.prototype=new SBGrid.CT.Group;SBGrid.CT.DataGrid.prototype.AddColSelect=function(d){if(this.getAllowSelection()&&SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){var a=SBGrid.DEF.arrFind_Value(this.m_arSelectCols,d);if(-1==a){this.m_arSelectCols.push(d);for(var c=this.fixedRows;c<this.rows;c++){var b=this.getCellEx(c,d);if(null!=b){this.setCellSelect(b,true)}}}}};SBGrid.CT.DataGrid.prototype.AddFreeSelect=function(b,c){if(this.getAllowSelection()&&SBGrid.DEF.SBSM_FREE==this.getSelectionMode()){var a=this.getCellEx(b,c);if(null!=a){this.setCellSelect(a,true)}}};SBGrid.CT.DataGrid.prototype.AddListSelect=function(d){if(this.getAllowSelection()&&SBGrid.DEF.SBSM_LIST==this.getSelectionMode()){var a=SBGrid.DEF.arrFind_Value(this.m_arSelectRows,d);if(-1==a){this.m_arSelectRows.push(d);for(var c=this.fixedCols;c<this.cols;c++){var b=this.getCellEx(d,c);if(null!=b){this.setCellSelect(b,true)}}}this.selectedRows=this.m_arSelectRows.length}};SBGrid.CT.DataGrid.prototype.addColumn=function(a,b){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".addColumn","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".addColumn","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(null==b){b=true}else{if(typeof b!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".addColumn","Please check if second parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(this.hasInstance()||this.isJsonRef()){this.addColumnHasInstance(a,b)}else{}this.applyColStyleInheritanceCellCSS();if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.m_heFFS.style.width=this.m_heWhole.clientWidth+"px";this.m_heFFBS.style.width=this.m_heWhole.clientWidth+"px";this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.addItem=function(c,b,a){if(null==c){c=true}if(null==b){b=false}if(null==a){a=false}if(this.hasInstance()||this.isJsonRef()){this.addRowHasInstance(c,b,a);this.setEmptyRecordsGrid();if(this.m_objScroll.bScrollEvent){this.reSizeScrollDiv()}}else{}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.insertItem=function(c,d,e,b,a){if(null==c||0>c||c>=this.rows){if(this.fixedRows==this.rows){c=0}else{return}}if(null==e){e=true}if(null==b){b=false}if(null==d){d="above"}if(null==c||c>=this.m_nRealRows){return}if("above"==d&&c<(this.fixedRows)){return}if(null==a){a=false}if(c==(this.m_nRealRows-1)&&"below"==d){this.addItem(e,b,a);return}if(this.hasInstance()||this.isJsonRef()){this.insertRowHasInstance(c,d,e,b,a);if(this.m_objScroll.bScrollEvent){this.reSizeScrollDiv()}}else{}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.deleteItem=function(b,c,a){if(null==b||b<this.fixedRows||b>=this.m_nRealRows){return}if(b==(this.m_nRealRows-1)){this.removeRow(c,a);return}if(null==c){c=false}if(null==a){a=false}if(this.hasInstance()||this.isJsonRef()){this.deleteRowHasInstance(b,c,a);if(this.m_objScroll.bScrollEvent){this.reSizeScrollDiv()}}else{}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.insertColumn=function(d,a,b,c){if(null==d||0>d||d>=this.cols){return}if(d==(this.cols-1)&&"after"==b){this.addColumn(a,c);return}if(null==c){c=true}if(null==b){b="before"}if(this.hasInstance()||this.isJsonRef()){this.insertColumnHasInstance(d,a,b,c)}else{}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.deleteColumn=function(b,a){if(null==b||0>b||b>=this.cols){return}if(b==(this.cols-1)){this.removeColumn(a);return}if(b>=this.cols){return}if(null==a){a=true}if(this.hasInstance()||this.isJsonRef()){this.deleteColumnHasInstance(b,a)}else{}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.removeItem=function(b,a){if(null==b){b=true}if(null==a){a=false}if(this.hasInstance()||this.isJsonRef()){this.RemoveRowHasInstance(b,a);if(this.m_objScroll.bScrollEvent){this.reSizeScrollDiv()}}else{}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.removeColumn=function(a){if(null==a){a=true}else{if(typeof a!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".removeColumn","Please check if parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(this.hasInstance()||this.isJsonRef()){this.RemoveColumnHasInstance(a)}else{}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.init=function(){SBGrid.CT.Group.prototype.init.call(this);this.userGridCss();if(null==this.attribute.pageselection){this.attribute.pageselection="true"}this.m_objFixedCell=this.createChild("softbowl:gridfixedcell","id:"+this.id+".fixed-cell");this.m_objInput=this.createChild("softbowl:gridinput","id:"+this.id+"_input;decimalformatinsert:"+this.getAttribute("decimalformatinsert"));this.m_objTextArea=this.createChild("softbowl:gridtextarea","id:"+this.id+"_textarea;");this.m_objInput.m_bDependentCtl=true;if(this.m_htFixedStyle){for(var strKey in this.m_htFixedStyle){this.m_objFixedCell.attribute[strKey]=this.m_htFixedStyle[strKey]}}if(SBGrid.DEF.is_smartphone){this.m_nOriginWidth=this.m_heCtrl.offsetWidth;this.m_nOriginHeight=this.m_heCtrl.offsetHeight}this.setDefaultThemeName();this.initGridProperties();var cObj=this.children.getCollection();for(var strChild in cObj){var objChild=cObj[strChild];if(null!=objChild&&"softbowl:cell"!=objChild.elementName){objChild.init()}}cObj=null;this.applyColStyleInheritanceCellCSS();this.applyBaseCellCSS("fixed");this.applyBaseCellCSS("data");this.applyFocusColorCss();this.makeGrid();if(this.frozenBottomRows>this.rows){this.frozenBottomRows=this.rows}if(this.frozenRows>this.rows){this.frozenRows=this.rows}this.setOverflowGrid(this.attribute.overflow);if(SBGrid.DEF.is_smartphone){var cObj=this.children.getCollection();for(var strChild in cObj){var objChild=cObj[strChild];if(null!=objChild&&"softbowl:col"!=objChild.elementName){objChild.init()}}cObj=null}this.colGroupNameSpace();this.setSeqForRowHeader();if(0<this.cols){this.m_bHasItem=true}window.setTimeout("SBGrid.getGrid('"+this.id+"').resize()",0);if(this.m_objScroll.bScrollEvent){this.setTableMatrix(this.m_objScroll.nTopRow,this.m_objScroll.nBottomRow)}this.defaultAttributeSetting(!SBGrid.DEF.is_smartphone);if(this.autoMerge){this.m_bScrollMergeCell=true}if(SBGrid.DEF.is_ie){if(this.m_nRowHeight!=0){window.setTimeout("try{SBGrid.getGrid('"+this.id+"').m_heFFS.style.height = SBGrid.getGrid('"+this.id+"').m_heFFS.firstChild.offsetHeight + 'px'}catch(e){}",0);window.setTimeout("try{SBGrid.getGrid('"+this.id+"').m_heFFNS.style.height = SBGrid.getGrid('"+this.id+"').m_heFFNS.firstChild.offsetHeight + 'px'}catch(e){}",0)}}if(this.isPossibleFiltering()){if(this.rows-this.fixedRows>0){this.createIndexesForFiltering()}else{this.m_clIndexes=new SBGrid.DS.Collection()}this.initFilteringHistoryStack()}if(this.autoResizeCaption){this.autoResizeCaptionWidth()}var strBeforeElementId=this.getBeforeElementId();if(strBeforeElementId!=""){var objBeforeElement=document.getElementById(strBeforeElementId);if(SBGrid.US.isElement(objBeforeElement)){if(window.attachEvent){eval("objBeforeElement.attachEvent('onkeydown', function(){"+this.id+".moveFocusFirstDataCell();});")}else{eval("objBeforeElement.addEventListener('keydown', function(){"+this.id+".moveFocusFirstDataCell();}, false);")}}}if(this.m_bIsAllowPaste&&!(window.clipboardData)){if(SBGrid.DEF.is_safari==false&&SBGrid.DEF.is_firefox==false){var strGridID=this.id;SBGrid.DEF.addEvent(document,"onpaste",function(event){if(/text\/plain/.test(event.clipboardData.types)){var arrClipboardData=event.clipboardData.getData("text/plain").split("\n");if(!(arrClipboardData instanceof Array)){return}var objTargetGrid=eval(strGridID);var nStartRow=objTargetGrid.getRow();var nStartCol=objTargetGrid.getCol();if(nStartRow<objTargetGrid.getFixedRows()||nStartRow>=objTargetGrid.getRows()){return}if(nStartCol<objTargetGrid.getFixedCols()||nStartCol>=objTargetGrid.getCols){return}for(var i=0;i<arrClipboardData.length;i++){var arrRowData=arrClipboardData[i].split("\t");if(i==arrClipboardData.length-1&&arrRowData==""){return}for(var j=0;j<arrRowData.length;j++){objTargetGrid.setTextMatrix(nStartRow+i,nStartCol+j,arrRowData[j])}}objTargetGrid=null}})}}var strFFBNid=jQuery("#SBHE_DATAGRID_FFBN_TBODY_"+this.id);var strFFNid=jQuery("#SBHE_DATAGRID_FFN_TBODY_"+this.id);if(this.fixedCols>0){if(this.frozenCols>0){strFFNid.find("tr:gt("+parseInt(this.fixedRows-1)+")").find("td:eq("+parseInt(this.fixedCols-1)+")").addClass("sbgrid_datagrid_FixedCol_Cell");strFFNid.find("tr:gt("+parseInt(this.fixedRows-1)+")").find("td:eq("+parseInt(this.fixedCols-1)+")").css("font-weight","normal");strFFBNid.find("tr:gt(0)").find("td:eq("+parseInt(this.fixedCols-1)+")").addClass("sbgrid_datagrid_FixedCol_Cell");strFFBNid.find("tr:gt(0)").find("td:eq("+parseInt(this.fixedCols-1)+")").css("font-weight","normal")}else{strFFNid.find("tr:gt("+parseInt(this.fixedRows-1)+")").find("td").addClass("sbgrid_datagrid_FixedCol_Cell");strFFNid.find("tr:gt("+parseInt(this.fixedRows-1)+")").find("td").css("font-weight","normal");strFFBNid.find("tr:gt(0)").find("td").addClass("sbgrid_datagrid_FixedCol_Cell");strFFBNid.find("tr:gt(0)").find("td").css("font-weight","normal")}}this.dispatch("ongridrebuild");this.dispatch("SBUx_rebuild")};SBGrid.CT.DataGrid.prototype.moveFocusFirstDataCell=function(){if(this.m_strGridSummary!=""){document.getElementById("SBHE_"+this.id).setAttribute("onKeyDown",'SBGrid.DEF.onkeydownGridSummary(event, "'+this.id+'")');var a=document.getElementById("SBHE_"+this.id);if(a){SBGrid.DEF.setFocus(a);a.tabIndex="0"}}else{var c=this.getCellEx(this.getFixedRows(),this.getFixedCols());if(c){var e=c.getElement();if(SBGrid.DEF.SBIT_CHECK==e.getColType()){if(c.m_heCtrl){var d=c.m_heCtrl.firstChild;SBGrid.DEF.setFocus(c.id);this.setTopRow(this.getFixedRows());this.setCol(this.getFixedCols());d.tabIndex="0";document.getElementById(this.parentId).focus();this.m_heCtrl.focus()}else{this.setTopRow(this.getFixedRows());this.m_bScrollMoveFirstCell=true}}else{var b=c.m_heDCtrl;if(b){if(this.m_bUseWebAccess==true){SBGrid.DEF.setFocus(c.id);this.setTopRow(this.getFixedRows());this.setCol(this.getFixedCols());b.tabIndex="0";document.getElementById(this.parentId).focus();this.m_heCtrl.focus()}else{b.focus();SBGrid.DEF.setFocus(c.id);this.setRow(this.getFixedRows());this.setCol(this.getFixedCols());this.setTopRow(this.getFixedRows());document.getElementById(this.parentId).focus()}}else{this.setTopRow(this.getFixedRows());this.m_bScrollMoveFirstCell=true}}}}};SBGrid.CT.DataGrid.prototype.executeCalculate=function(){if(this.fixedRows<this.rows){for(var i=this.fixedCols;i<this.cols;i++){var objColumn=this.getColumnControl(i);var strCalc=objColumn.getAttribute("calc");if(""!=strCalc){for(var j=this.fixedRows;j<this.rows;j++){var objCell=this.getCellEx(j,i);var objCol=objCell.getElement();var strCalc=objCol.getAttribute("calc");if(""!=strCalc){var strCalcName=strCalc.substring(0,strCalc.indexOf("("));var strCalcParam="(this.id, "+j.toString()+", "+i.toString();if(this.m_arCalcParam.length>0){for(var k=0;k<this.m_arCalcParam.length;k++){strCalcParam+=", this.m_arCalcParam["+k+"] "}}strCalcParam+=")";strCalc=strCalcName+strCalcParam;var strResult=eval(strCalc);if(null!=strResult){SBGrid.CF.GridSetText(objCell,strResult)}}}}}}};SBGrid.CT.DataGrid.prototype.createIndexesForFiltering=function(){this.m_clIndexes=new SBGrid.DS.Collection();var a=[];if(this.m_bRowHeader){a.push("")}for(var b=(0+this.m_bRowHeader?1:0);b<this.cols;b++){a.push(this.m_arColumn[b].getAttribute("ref"))}var c=this.m_bRowHeader?1:0;for(var b=0+c;b<this.getCols();b++){this.m_clIndexes.add(a[b],this.getIndexDataOfSelectedColumn(b))}};SBGrid.CT.DataGrid.prototype.initFilteringHistoryStack=function(){this.m_clFilteringHistoryStack=new SBGrid.DS.Collection();var b=new Array();for(var a=this.fixedRows;a<this.getRows();a++){b.push(a)}this.m_clFilteringHistoryStack.add("TOTAL_ROW_LIST",b.splice(0,b.length))};SBGrid.CT.DataGrid.prototype.refresh=function(a){this.showWait(true);SBGrid.CT.Group.prototype.refresh.call(this);if(this.hasInstance()||this.isJsonRef()){this.refreshForHasInstance(a)}else{this.refreshForHasNotInstance()}if(SBGrid.DEF.is_ie){if(this.m_nRowHeight!=0){window.setTimeout("try{SBGrid.getGrid('"+this.id+"').m_heFFS.style.height = SBGrid.getGrid('"+this.id+"').m_heFFS.firstChild.offsetHeight + 'px'}catch(e){}",0);window.setTimeout("try{SBGrid.getGrid('"+this.id+"').m_heFFNS.style.height = SBGrid.getGrid('"+this.id+"').m_heFFNS.firstChild.offsetHeight + 'px'}catch(e){}",0)}}this.executeCalculate();if(this.autoResize){this.autoResizeHeight()}this.setEmptyRecordsGrid();this.m_heInitRow=this.makeInitRow();if(this.m_bIsAutoSavePsnlData==true&&this.m_strPsnlDataId!=null){this.savePersonalInfo(this.m_strPsnlDataId)}this.showWait(false)};SBGrid.CT.DataGrid.prototype.rebuild=function(){this.dispatch("onbeforerebuild");if(this.getGroup()!="none"){for(var c=this.fixedRows;c<this.m_nRealRows;c++){if(this.getGroupCollapsed(c)==true){this.setGroupCollapsed(c,false)}}}this.showWait(true);this.m_arUpdateDeleteList=new Array();if(this.hasInstance()||(this.isJsonRef()&&-1==this.jsonref.indexOf("_delimeterData"))){this.rebuildForHasInstance()}else{this.rebuildForHasNotInstance()}this.initFixedcellcheckbox();for(var c=this.fixedRows;c<this.m_nRealRows;c++){for(var a=this.fixedCols;a<this.cols;a++){if(this.getColType(a)=="checkbox"){var b=this.getCellEx(c,a);if(null!=b){b.m_bIsHidden=false}}}}this.setEmptyRecordsGrid();this.resizeColumnWidth();if(this.isPossibleFiltering()){if(this.rows-this.fixedRows>0){this.createIndexesForFiltering()}else{this.m_clIndexes=new SBGrid.DS.Collection()}this.initFilteringHistoryStack()}this.m_clMultiSortingHistory.clear();this.showWait(false);this.dispatch("onafterrebuild")};SBGrid.CT.DataGrid.prototype.rebuildForHasNotInstance=function(){var strJsonRef=this.getAttribute("jsonref");eval(strJsonRef+"= new Array();");this.refresh()};SBGrid.CT.DataGrid.prototype.colRef=function(a){for(var b=this.fixedCols;b<this.cols;b++){if(null!=this.m_arColumn[b]){if(a.localeCompare(this.m_arColumn[b].getAttribute("ref"))==0){return b}}}return -1};SBGrid.CT.DataGrid.prototype.getColRef=function(a){return this.colRef(a)};SBGrid.CT.DataGrid.prototype.getColList=function(a,b){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".getColOfCaption","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".getColOfCaption","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}else{if(a!="caption"&&a!="ref"){SBGrid.DEF.APIerrorMsg(this.id+".getColOfCaption","Please check if first parameter's value is valid.",SBGrid.DEF.DEBUG_MODE);return}}if((typeof b)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".getColOfCaption","Please check if second parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}try{var l=this.m_bRowHeader?1:0;var c=new SBGrid.DS.Set();if(a=="caption"){for(var d=0;d<this.m_arCaption.length;d++){var h=this.m_arCaption[d];if(h.length>0){var g=l;do{var e=h.indexOf(b,g);if(e>-1){c.add(e);g=e+1}}while(e>-1)}h=null}}else{if(a=="ref"){var f=[];for(var d=0;d<this.cols;d++){if(this.m_arColumn[d]){if(this.isJsonRef()){f.push(this.m_arColumn[d].getAttribute("jsonref"))}else{f.push(this.m_arColumn[d].getAttribute("ref"))}}}if(f.length>1){var g=l;do{var e=f.indexOf(b,g);if(e>-1){c.add(e);g=e+1}}while(e>-1)}SBGrid.DEF.clearArray(f);f=null}}return c.keys(true)}finally{c.clear()}};SBGrid.CT.DataGrid.prototype.getBeforeElementId=function(){return this.attribute.beforeelementid};SBGrid.CT.DataGrid.prototype.getNextElementId=function(){return this.attribute.nextelementid};SBGrid.CT.DataGrid.prototype.getRefOfCol=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".getRefOfCol","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getRefOfCol","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(this.isJsonRef()){return this.m_arColumn[a].getAttribute("jsonref")}else{return this.m_arColumn[a].getAttribute("ref")}};SBGrid.CT.DataGrid.prototype.findRow=function(l,b,g,a,h){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".findRow","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof l)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".findRow","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(b==null){b=this.fixedRows}else{if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".findRow","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(g==null){g=this.fixedCols}else{if(typeof g!="number"){SBGrid.DEF.APIerrorMsg(this.id+".findRow","Please check if 3rd parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(a==null){a=false}else{if(typeof a!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".findRow","Please check if 4th parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(h==null){h=false}else{if(typeof h!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".findRow","Please check if 5th parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}for(var e=b;e<this.m_nRealRows;e++){for(var d=g;d<this.cols;d++){var c=this.getCellEx(e,d);if(null!=c){var f=SBGrid.CF.GridGetText(c);if(a&&h){if(f.localeCompare(l)==0){return e}}else{if(a&&!h){if(f.indexOf(l)!=-1){return e}}else{if(!a&&h){l=l.toUpperCase();f=f.toUpperCase();if(f.localeCompare(l)==0){return e}}else{if(!a&&!h){l=l.toUpperCase();f=f.toUpperCase();if(f.indexOf(l)!=-1){return e}}}}}}}}return -1};SBGrid.CT.DataGrid.prototype.setLeftCol=function(c){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setLeftCol","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return false}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setLeftCol","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return false}else{if(c<this.fixedCols+this.frozenCols||c>=this.cols){return}}var b=0;for(var a=this.fixedCols+this.frozenCols;a<c;a++){if(this.getColHidden(a)){continue}b+=this.getColWidth(a)}this.m_heWhole.scrollLeft=b};SBGrid.CT.DataGrid.prototype.setTopRow=function(c){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setTopRow","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return false}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setTopRow","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return false}else{if(c<this.fixedRows||c>=this.rows){return}}this.stopEditing();var a=0;for(var b=this.fixedRows;b<c;b++){if(this.isRowHidden(b)){continue}a+=this.m_htRowHeight[b]?this.m_htRowHeight[b]:this.dataHeight}this.m_heWhole.scrollTop=a;this.topRow=c;this.setRow(c);this.dispatch("onrowchanged")};SBGrid.CT.DataGrid.prototype.setTopBottomRowPosition=function(){var a=this.m_heWhole.scrollTop;var c=0;var b=0;for(var e=0;e<this.fixedRows;e++){b+=this.m_htRowHeight[e]?this.m_htRowHeight[e]:this.rowHeight}var f=a+(this.m_heWhole.clientHeight-b);if(!this.autoResize){this.topRow=Math.floor((a)/this.dataHeight)+1;this.bottomRow=Math.floor((f)/this.dataHeight)+1;return}for(var e=this.fixedRows;e<this.m_nRealRows;e++){c+=this.m_htRowHeight[e]?this.m_htRowHeight[e]:this.dataHeight;if(0>(a-c)){this.topRow=e;for(var d=e+1;d<this.m_nRealRows;d++){c+=this.m_htRowHeight[d]?this.m_htRowHeight[d]:this.dataHeight;if(0>(f-c)){this.bottomRow=d;return}}}}};SBGrid.CT.DataGrid.prototype.setBottomRow=function(c){var a=0;c=c>this.m_nRealRows-1?this.m_nRealRows-1:c;for(var b=0;b<=c;b++){if(this.isRowHidden(b)){continue}a+=this.m_htRowHeight[b]?this.m_htRowHeight[b]:this.rowHeight}a=(a-this.m_heWhole.clientHeight)-1;if(a<0){a=0}this.m_heWhole.scrollTop=a;this.bottomRow=c};SBGrid.CT.DataGrid.prototype.textMatrix=function(a,b){if(this.isFixedCell(a,b)){return this.labelMatrix(a,b)}else{return this.valueMatrix(a,b)}};SBGrid.CT.DataGrid.prototype.setTextMatrix=function(a,c,b){if(arguments.length!=3){SBGrid.DEF.APIerrorMsg(this.id+".setTextMatrix","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setTextMatrix","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setTextMatrix","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof b)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setTextMatrix","Please check if third parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}this.setValueMatrix(a,c,b)};SBGrid.CT.DataGrid.prototype.getTextMatrix=function(a,c,b){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".getTextMatrix","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getTextMatrix","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getTextMatrix","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(b==undefined){b=false}else{if(typeof b!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".getTextMatrix","Please check if third parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(b){return this.sortedValueMatrix(a,c)}else{return this.valueMatrix(a,c)}};SBGrid.CT.DataGrid.prototype.labelMatrix=function(d,h){var c=this.getCellEx(d,h);if(null!=c){if(this.isFixedCell(d,h)){return jQuery(c.m_heCtrl).text()}else{var e=c.getElement();if(e){if(SBGrid.DEF.SBIT_CHECK==e.getInputType()||SBGrid.DEF.SBIT_RADIO==e.getInputType()||SBGrid.DEF.SBIT_IMAGE==e.getInputType()){return this.valueMatrix(d,h)}else{if(null!=c.m_heDCtrl){return jQuery(c.m_heDCtrl).text()}else{if(SBGrid.DEF.SBIT_COMBO==e.getInputType()){var a=e.m_objCombo;if(e.m_bIsCellCombo&&a.isnodeset){var b=c.getAttribute("nodeset");if(null!=b){a.nodeset=b;a.reBuild()}else{if(null!=e.m_strComboNodeSet&e.m_strComboNodeSet!=a.nodeset){a.nodeset=e.m_strComboNodeSet;a.refresh()}}b=null}strToolTipText=a.getLableByValue(SBGrid.CF.GridGetText(c));var f=e.getAttribute("format");f=null!=c.attribute.format?c.attribute.format:f;a=null;if(null==f||""==f){return strToolTipText}else{return strToolTipText.formatting(f)}}else{var g=SBGrid.CF.GridGetText(c);if(null!=g){var f=e.getAttribute("format");f=null!=c.attribute.format?c.attribute.format:f;a=null;if(null==f||""==f){return g}else{return g.formatting(f)}}}}}}}}return""};SBGrid.CT.DataGrid.prototype.getUpdateDataXml=function(a,t){var b;var m="";var o=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceDocument();var c=new Array();var s=this.attribute.colsep;var l=this.attribute.rowsep;var r=this.nodeset.substring(this.nodeset.lastIndexOf("/")+1,this.nodeset.length);for(var q=this.fixedCols;q<this.cols;q++){c.push(this.m_arColumn[q].getAttribute("ref"))}switch(a){case"insert":b=1;break;case"delete":b=4;break;case"update":b=2;break;default:b=0;break}if(null==t){t="status"}if(0==b||4==b){for(var q=0;q<this.m_arUpdateDeleteList.length;q++){var f=this.m_arUpdateDeleteList[q].substring(0,this.m_arUpdateDeleteList[q].lastIndexOf(l));var e=f.split(s);var h=o.createElement(r);for(var p=2;p<e.length;p++){var n=o.createElement(c[p-2]);var u=n.ownerDocument.createTextNode(e[p]);n.appendChild(u);h.appendChild(n)}var n=o.createElement(t);var u=n.ownerDocument.createTextNode(e[0]);n.appendChild(u);h.appendChild(n);m+=SBGrid.UT.XmlLib.serializeToString(h)}}for(var q=this.fixedRows;q<this.m_nRealRows;q++){var g=this.getRowStatus(q);if(3==g){g=1}else{if(4<g&&7>g){g=4}}if(0<g&&(g==b||0==b)){var d="";switch(g){case 1:d="i";break;case 2:d="u";break;case 4:d="d";break}var h=o.createElement(r);for(var p=this.fixedCols;p<this.cols;p++){var n=o.createElement(c[p-this.fixedCols]);var u=n.ownerDocument.createTextNode(SBGrid.CF.GridGetText(this.getCellEx(q,p)));n.appendChild(u);h.appendChild(n)}var n=o.createElement(t);var u=n.ownerDocument.createTextNode(d);n.appendChild(u);h.appendChild(n);m+=SBGrid.UT.XmlLib.serializeToString(h)}}return m};SBGrid.CT.DataGrid.prototype.getUpdateDataJson=function(n,a,f,g){var b;var o="";var p=new Array();var v=this.attribute.colsep;var m=this.attribute.rowsep;if(f==null){f="status"}if(g==null){g="rownum"}if(n==null){n=false}for(var s=this.fixedCols;s<this.cols;s++){p.push(this.m_arColumn[s].getAttribute("ref"))}if(this.m_bIsRealDataSync){for(var s=0,q=this.m_arExtRefList.length;s<q;s++){p.push(this.m_arExtRefList[s])}}switch(a){case"insert":b=1;break;case"delete":b=4;break;case"update":b=2;break;default:b=0;break}if(0==b||4==b){for(var s=0;s<this.m_arUpdateDeleteList.length;s++){var h=this.m_arUpdateDeleteList[s].substring(0,this.m_arUpdateDeleteList[s].lastIndexOf(m));var c=h.split(v);for(var r=0;r<c.length;r++){if(o!=""&&r==0){o+=", "}if(r==0){o+='{"'+f+'":"'+c[r]+'",'}else{if(r==1){o+='"'+g+'":"'+c[r]+'",'}else{if(r>1&&r<c.length-1){o+='"'+p[r-2]+'":"'+c[r]+'",'}else{if(r==c.length-1){o+='"'+p[r-2]+'":"'+c[r]+'"}'}}}}}}}for(var s=this.fixedRows;s<this.m_nRealRows;s++){var l=this.getRowStatus(s);if(3==l){l=1}else{if(4<l&&7>l){l=4}}if(0<l&&(l==b||0==b)){var d="";switch(l){case 1:d="i";break;case 2:d="u";break;case 4:d="d";break}if(o!=""){o+=","}o+='{"'+f+'":"'+d+'","';o+=g+'":"'+s+'",';for(var r=this.fixedCols;r<this.cols;r++){o+='"'+p[r-this.fixedCols]+'":"'+SBGrid.CF.GridGetText(this.getCellEx(s,r));if(r<this.cols-1){o+='",'}else{o+='"'}}if(this.m_bIsRealDataSync){if(this.m_arExtRefList.length>0){o+=","}else{o+="}}"}for(var r=0;r<this.m_arExtRefList.length;r++){var u=this.m_xlRefNode[s-this.fixedRows][this.m_arExtRefList[r]];o+='"'+this.m_arExtRefList[r]+'":"'+(u==undefined?"":u);if(r<this.m_arExtRefList.length-1){o+='",'}else{o+='"}'}u=null}}else{o+="}"}}}if(o!=""){o="["+o+"]"}o=o.replaceAll("\\","\\\\");if(n){try{return JSON.parse(o)}catch(t){return[]}}return o};SBGrid.CT.DataGrid.prototype.getUpdateData=function(n,a,f,g){var b;var o="";var p=new Array();var v=this.attribute.colsep;var m=this.attribute.rowsep;if(f==null){f="status"}if(g==null){g="rownum"}if(n==null){n=false}for(var s=this.fixedCols;s<this.cols;s++){p.push(this.m_arColumn[s].getAttribute("ref"))}if(this.m_bIsRealDataSync){for(var s=0,q=this.m_arExtRefList.length;s<q;s++){p.push(this.m_arExtRefList[s])}}switch(a){case"insert":b=1;break;case"delete":b=4;break;case"update":b=2;break;default:b=0;break}if(0==b||4==b){for(var s=0;s<this.m_arUpdateDeleteList.length;s++){var h=this.m_arUpdateDeleteList[s].substring(0,this.m_arUpdateDeleteList[s].lastIndexOf(m));var c=h.split(v);for(var r=0;r<c.length;r++){if(o!=""&&r==0){o+=", "}if(r==0){o+='{"'+f+'":"'+c[r]+'",'}else{if(r==1){o+='"'+g+'":"'+c[r]+'","data":{'}else{if(r>1&&r<c.length-1){o+='"'+p[r-2]+'":"'+c[r]+'",'}else{if(r==c.length-1){o+='"'+p[r-2]+'":"'+c[r]+'"}}'}}}}}}}for(var s=this.fixedRows;s<this.m_nRealRows;s++){var l=this.getRowStatus(s);if(3==l){l=1}else{if(4<l&&7>l){l=4}}if(0<l&&(l==b||0==b)){var d="";switch(l){case 1:d="i";break;case 2:d="u";break;case 4:d="d";break}if(o!=""){o+=","}o+='{"'+f+'":"'+d+'","';o+=g+'":"'+s+'","data":{';for(var r=this.fixedCols;r<this.cols;r++){o+='"'+p[r-this.fixedCols]+'":"'+SBGrid.CF.GridGetText(this.getCellEx(s,r));if(r<this.cols-1){o+='",'}else{o+='"'}}if(this.m_bIsRealDataSync){if(this.m_arExtRefList.length>0){o+=","}else{o+="}}"}for(var r=0;r<this.m_arExtRefList.length;r++){var u=this.m_xlRefNode[s-this.fixedRows][this.m_arExtRefList[r]];o+='"'+this.m_arExtRefList[r]+'":"'+(u==undefined?"":u);if(r<this.m_arExtRefList.length-1){o+='",'}else{o+='"}}'}u=null}}else{o+="}}"}}}if(o!=""){o="["+o+"]"}o=o.replaceAll("\\","\\\\");if(n){try{return JSON.parse(o)}catch(t){return[]}}return o};SBGrid.CT.DataGrid.prototype.moveSubtotal=function(f,b){if(null==f||null==b||(0>f||this.m_nRealRows<=f)){return}if("insert"==b){var d={};for(var e in this.m_htRowSubTotal){var a=Number(e);if(f<=a){var c=this.m_htRowSubTotal[a];d[a+1]=c}else{d[a]=this.m_htRowSubTotal[a]}}this.m_htRowSubTotal=d;d=null}else{if("delete"==b){var d={};for(var e in this.m_htRowSubTotal){var a=Number(e);if(f==a){continue}if(f<a){var c=this.m_htRowSubTotal[a];d[a-1]=c}else{d[a]=this.m_htRowSubTotal[a]}}this.m_htRowSubTotal=d;d=null}else{if("above"==b||"below"==b){var d={};for(var e in this.m_htRowSubTotal){var a=Number(e);if(f<=a){var c=this.m_htRowSubTotal[a];d[a+1]=c}else{d[a]=this.m_htRowSubTotal[a]}}this.m_htRowSubTotal=d;d=null}}}};SBGrid.CT.DataGrid.prototype.isSubtotalAll=function(){for(var a in this.m_htRowSubTotal){return true}return false};SBGrid.CT.DataGrid.prototype.isSubtotal=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".isSubtotal","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".isSubtotal","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(null!=this.m_htRowSubTotal[a]){return true}else{return false}};SBGrid.CT.DataGrid.prototype.setIsSubtotal=function(a,b){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".isSubtotal","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".isSubtotal","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".isSubtotal","Please check if parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}this.m_htRowSubTotal[a]=b};SBGrid.CT.DataGrid.prototype.subtotal=function(f,p,c,s,b,r,o,t){if(arguments.length<3){SBGrid.DEF.APIerrorMsg(this.id+".subtotal","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof f)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".subtotal","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof p!="number"){SBGrid.DEF.APIerrorMsg(this.id+".subtotal","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".subtotal","Please check if 3rd parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}var u=typeof(p);if("number"!=u&&"string"!=u){for(var n=0;n<p.length;n++){if(-1==p[n]){p.splice(n,1)}}switch(p.length){case 0:p=-1;u="number";break;case 1:p=p[0];u="number";break;default:break}}if("number"!=typeof(c)&&"string"!=typeof(c)){var g=this.multiTotals;this.multiTotals=true;for(var n=0;n<c.length;n++){this.subtotal(f,p,c[n],s,b,r,o,t)}this.multiTotals=g;return}switch(f){case"clear":this.clearAllSubTotalRow();break;case"sum":case"percent":case"count":case"average":case"max":case"min":break;default:return}if("clear"!=f){if(null!=s){try{var m=null;m=s.split(";");if(null!=m){for(var n=0;n<m.length;n++){if(-1!=m[n].indexOf("format")){s=m[n].split(":")[1]}}}}catch(q){}}else{s=""}if(null==b){b=""}var a=p;if("number"!=u&&"string"!=u){a=p[p.length-1]}if(null==r||"string"==typeof(r)){r=(-1==a)?0:a}if(this.fixedRows==this.m_nRealRows){return}this.clearSelection();if(this.m_nRealRows!=this.m_nMakeIndex){SBGrid.CT.DataGrid.PartiallyCount=this.m_nRealRows;if(!SBGrid.DEF.is_smartphone){}else{for(var n=0;n<this.m_nRealRows;n++){for(var l=0;l<this.cols;l++){var h=this.getCellEx(n,l);if(null!=h){this.children.remove(h.id);SBGrid.DEF.__removeAll(h.id)}}}this.makeSmartPhoneGrid()}SBGrid.CT.DataGrid.PartiallyCount=100}var d=new Array();if("number"==u){this.colCellGroup(p,this.fixedRows,this.m_nRealRows-1,d)}else{if(null!=p&&0<p.length){this.colCellGroup(p[0],this.fixedRows,this.m_nRealRows-1,d);if(1!=p.length){d=this.colCellGroupArray(p,this.fixedRows,this.m_nRealRows-1,d);p=p[p.length-1]}}}if(-1==p){p=this.fixedCols;o=null==o?"":o}this.setSubTotalResult(d,f,p,c,s,b,r,o,t);this.setSeqForRowHeader();this._rCH()}};SBGrid.CT.DataGrid.prototype.clearAllSubTotalRow=function(h){var c=0;var g=new Array();for(var f in this.m_htRowSubTotal){g.push(Number(f))}g.sort(SBGrid.DEF.numberASC);for(var e=0;e<g.length;e++){for(var b=this.fixedCols;b<this.cols;b++){var d=this.getCellEx(g[e],b);if(null!=d){d.m_bIsSubTotal=false;d.text=""}if(!h){this.rebuildStyle(g[e],b)}}}if(!h){for(var a=0;a<g.length;a++){this.deleteItem(g[a]+c,false,true);c--}}this.m_htRowSubTotal={}};SBGrid.CT.DataGrid.prototype.setSubTotalResult=function(e,t,s,n,c,F,B,f,D){var r=0;var w=false;if(null==f){w=true}if(this.fixedCols<=s&&s<this.cols){for(var y=0;y<e.length;y++){var C=f;var l=e[y][0]+r;var v=e[y][1]+r;var E=false;for(var d in this.m_htRowSubTotal){if(s!=parseInt(this.m_htRowSubTotal[d][0])){if((v+1)==parseInt(d)){E=true;break}}}if(E){var A={};for(var d in this.m_htRowSubTotal){var h=this.m_htRowSubTotal[d];var u=parseInt(d);if((v+1)<=u){A[String(u+1)]=h}else{A[d]=h}}this.m_htRowSubTotal=A}var b=this.getCalcurateRow(t,n,l,v);var p=this.getCellEx(l,s);if(w){if(null!=p){C=SBGrid.CF.GridGetText(p)}}else{if(-1!=f.indexOf("%s")){if(null!=p){C=f.replace("%s",SBGrid.CF.GridGetText(p))}}}if("above"==this.subtotalPosition){var a=l;var p=this.getCellEx(a-1,s);while(null!=p&&p.m_bIsSubTotal){a=p.row;p=this.getCellEx(a-1,s)}var z=true;var g=false;if(this.multiTotals){var q=this.m_htRowSubTotal[a];if(null!=q){g=true;if(q[0]==s){for(var x=1;x<q.length;x++){if(q[x]!=n){z=false}else{z=true;break}}}}}if(z){if(g){this.moveSubtotal(a,"above")}var m=new Array();this.m_htRowSubTotal[a]=m;m.push(s);m.push(n);this.insertItem(a,"before",false,true,true);this.setSubTotalValue(a,n,c,F,B,C,b);r++}else{var q=this.m_htRowSubTotal[a];q.push(n);this.setSubTotalValue(a,n,c,F,B,C,b)}}else{var g=false;var o=v;var p=this.getCellEx(o+1,s);while(null!=p&&p.m_bIsSubTotal){o=p.row;p=this.getCellEx(o+1,s)}var z=true;if(this.multiTotals){var q=this.m_htRowSubTotal[o];if(null!=q){g=true;if(q[0]==s){for(var x=1;x<q.length;x++){if(q[x]!=n){z=false}else{z=true;break}}}}}if(z){this.moveSubtotal(o+1,"below");var m=new Array();this.m_htRowSubTotal[o+1]=m;m.push(s);m.push(n);if(this.m_nRealRows-1!=o){this.insertItem(o+1,"before",false,true,true)}else{this.addItem(false,true,true)}this.setSubTotalValue(o+1,n,c,F,B,C,b);r++}else{var q=this.m_htRowSubTotal[o];q.push(n);this.setSubTotalValue(o,n,c,F,B,C,b)}}}}else{var b=this.getCalcurateRow(t,n,this.fixedRows,this.m_nRealRows-1);if(w){f=""}else{if(-1!=f.indexOf("%s")){if(null!=p){f=f.replace("%s","")}}}if("above"==this.subtotalPosition){var z=true;if(this.multiTotals){var q=this.m_htRowSubTotal[this.fixedRows];if(null!=q){if(q[0]==s){for(var x=1;x<q.length;x++){if(q[x]!=n){z=false}else{z=true;break}}}}}if(z){var m=new Array();this.m_htRowSubTotal[this.fixedRows]=m;m.push(s);m.push(n);this.insertItem(this.fixedRows,"before",false,true,true);this.setSubTotalValue(this.fixedRows,n,c,F,B,f,b)}else{var q=this.m_htRowSubTotal[this.fixedRows];q.push(n);this.setSubTotalValue(this.fixedRows,n,c,F,B,f,b)}}else{var z=true;if(this.multiTotals){var q=this.m_htRowSubTotal[v+1];if(null!=q){if(q[0]==s){for(var x=1;x<q.length;x++){if(q[x]!=n){z=false}else{z=true;break}}}}}if(z){var m=new Array();this.m_htRowSubTotal[v+1]=m;m.push(s);m.push(n);if(this.m_nRealRows-1!=v){this.insertItem(v+1,"before",false,true,true)}else{this.addItem(false,true,true)}this.setSubTotalValue(v+1,n,c,F,B,f,b);r++}else{var q=this.m_htRowSubTotal[v+1];q.push(n);this.setSubTotalValue(v+1,n,c,F,B,f,b)}}}};SBGrid.CT.DataGrid.prototype.setSubTotalValue=function(e,c,o,a,n,l,q){var b=false;for(var h=0;h<this.cols;h++){var d=this.getCellEx(e,h);if(null!=d){b=d.m_bIsSubTotal;d.m_bIsSubTotal=true;if(c==h){d.text=q;if(d.m_heCtrl!=null){jQuery(d.m_heCtrl.firstChild).addClass("sbgrid_datagrid_Output");jQuery(d.m_heCtrl).removeClass("sbgrid_vat")}this.setLinkedData(d,null,null);SBGrid.CF.GridSetWindowText(d,q,true,o)}else{if(n==h){if(b&&""==l){b=false;continue}d.text=l;this.setLinkedData(d,null,null);SBGrid.CF.GridSetWindowText(d,l,true,"")}else{if(null==d.text){d.text=""}this.setLinkedData(d,null,null);SBGrid.CF.GridSetWindowText(d,d.text,true,o)}}b=false}}var m={};var g=a.split(/\;/g);for(var h=0;h<g.length;h++){if(g[h].trim().isEmpty()){break}var f=g[h].split(/\:/g);m[f[0].trim()]=f[1].trim()}for(var p in m){this.setRowStyle(e,"data",p,m[p])}};SBGrid.CT.DataGrid.prototype.getCalcurateRow=function(d,b,f,e){switch(d){case"sum":var n=0;for(var l=f;l<=e;l++){var g=this.getCellEx(l,b);if(null!=g&&!g.m_bIsSubTotal){var o=SBGrid.CF.GridGetText(g);o=o.replace(/\,/g,"");n+=isFinite(o)?Number(o):0}}return String(n);case"percent":var n=0;var m=0;for(var l=this.fixedRows;l<this.m_nRealRows;l++){var g=this.getCellEx(l,b);if(null!=g&&!g.m_bIsSubTotal){var o=SBGrid.CF.GridGetText(g);o=o.replace(/\,/g,"");m+=isFinite(o)?Number(o):0;if(f<=l&&l<=e){n+=isFinite(o)?Number(o):0}}}return String((n/m)*100);case"count":var a=0;for(var l=f;l<=e;l++){var g=this.getCellEx(l,b);if(null!=g&&!g.m_bIsSubTotal){a++}}return String(a);case"average":var n=0;var a=0;for(var l=f;l<=e;l++){var g=this.getCellEx(l,b);if(null!=g&&!g.m_bIsSubTotal){var o=SBGrid.CF.GridGetText(g);o=o.replace(/\,/g,"");n+=isFinite(o)?Number(o):0;a++}}return String(n/a);case"max":var c=null;for(var l=f;l<=e;l++){var g=this.getCellEx(l,b);if(null!=g&&!g.m_bIsSubTotal){var o=SBGrid.CF.GridGetText(g);o=o.replace(/\,/g,"");if(isFinite(o)){if(null==c){c=Number(o);continue}c=c<Number(o)?Number(o):c}}}if(null==c){c=""}return String(c);case"min":var h=null;for(var l=f;l<=e;l++){var g=this.getCellEx(l,b);if(null!=g&&!g.m_bIsSubTotal){var o=SBGrid.CF.GridGetText(g);if(isFinite(o)){if(null==h){h=Number(o);continue}h=h>Number(o)?Number(o):h}}}if(null==h){h=""}return String(h)}};SBGrid.CT.DataGrid.prototype.getSubTotalSize=function(){var a=0;for(var b in this.m_htRowSubTotal){a++}return a};SBGrid.CT.DataGrid.prototype.getRowCountFromInstance=function(){this.m_xlRefNode=this.getControlNodeList();if(this.m_xlRefNode){return this.m_xlRefNode.length}return 0};SBGrid.CT.DataGrid.prototype.eventCaptionClear=function(){this.m_bClearCaption=true};SBGrid.CT.DataGrid.prototype.isCellNodeChanged=function(){this.m_xlRefNode=this.getControlNodeList();for(var c=this.fixedCols;c<this.cols;c++){for(var a=this.fixedRows;a<this.m_nRealRows;a++){var b=this.getCellEx(a,c);if(null!=b&&!b.m_bIsSubTotal){if(null==b.m_xnNodeElement){return true}}}}return false};SBGrid.CT.DataGrid.prototype.refreshForHasInstance=function(h){var g=true;var b;var l=this.m_replaceString;if(l!=""&&l!="undefined"&&l!=null){b=l.split("?")}if(g&&!this.isChangedItem()){if(!h){if(!this.m_bHasItem){this.rebuildForHasInstance();return}if(this.m_bColChangeStatus){this.rebuildForHasInstance();this.m_bColChangeStatus=false;return}}var f=this.getRowCountFromInstance();if(f+this.fixedRows!=this.m_nRealRows-this.getSubTotalSize()){this.rebuildForHasInstance();return}else{if(typeof h=="undefined"){this.m_xlRefNode=this.getControlNodeList();this.mappingCellHasInstanceEx(null,null,null,null)}for(var e=this.fixedRows;e<this.fixedRows+this.frozenRows;e++){for(var d=this.fixedCols;d<this.cols;d++){var c=this.getCellEx(e,d);if(null!=c){SBGrid.CF.GridSetTextRefresh(c,SBGrid.CF.GridGetText(c),b,this.m_bIsDataReplaceValueChanged)}}}if(h){if(this.m_bCreateAll){for(var d=this.fixedCols;d<this.cols;d++){var a=this.getColumnControl(d);if(a.m_fnRenderer){for(var e=this.m_objScroll.nTopRow;e<=this.m_objScroll.nBottomRow;e++){var c=this.getCellEx(e,d);if(null!=c){SBGrid.CF.GridSetTextRefresh(c,SBGrid.CF.GridGetText(c),b,this.m_bIsDataReplaceValueChanged)}c=null}}a=null}}else{for(var e=this.m_objScroll.nTopRow;e<=this.m_objScroll.nBottomRow;e++){for(var d=this.fixedCols;d<this.cols;d++){var c=this.getCellEx(e,d);if(null!=c){SBGrid.CF.GridSetTextRefresh(c,SBGrid.CF.GridGetText(c),b,this.m_bIsDataReplaceValueChanged)}}}}}for(var e=this.m_nRealRows-this.m_nBottomRowCount;e<this.m_nRealRows;e++){for(var d=this.fixedCols;d<this.cols;d++){var c=this.getCellEx(e,d);if(null!=c){SBGrid.CF.GridSetTextRefresh(c,SBGrid.CF.GridGetText(c),b,this.m_bIsDataReplaceValueChanged)}}}for(var e=0;e<this.m_arCombo.length;e++){var m=this.m_arCombo[e];if(true==m.visible){m.showComboRefresh()}}this.setCaption(this.getCaption())}}this.setChangedItem(false)};SBGrid.CT.DataGrid.prototype.gridToJson=function(){if(this.m_arSortJson!=null){var movecol=this.m_moveColInfo;var joSort=new Array();var j=parseInt(movecol.substring(movecol.length-1));for(var i=0;i<this.m_arSortJson.length;i++){joSort[i]=this.m_arSortJson[i][j]}var joToJson=eval(this.jsonref);for(var i=0;i<joSort.length;i++){joToJson[i]=joSort[i]}}};SBGrid.CT.DataGrid.prototype.mappingCellHasInstance=function(f,p,c,l){var d;if(null==f){f=this.fixedRows}if(null==p){p=this.fixedCols}if(null==c){c=this.m_nRealRows}if(null==l){l=this.cols}var r=this.m_replaceString;if(r!=""&&r!="undefined"&&r!=null){d=r.split("?")}var n=null;if(SBGrid.DEF.is_chrome&&!this.isJsonRef()){n=new Array();for(var m=0;m<this.m_xlRefNode.length;m++){var q={};var o=this.m_xlRefNode.item(m).firstChild;while(o){if("#text"!=o.nodeName){q[o.nodeName]=o}o=o.nextSibling}n.push(q)}}for(var m=p;m<l;m++){var t=this.m_arColumn[m].getAttribute("ref");for(var g=f;g<c;g++){var a=null;var s=null;var h=null;var b=null;if(this.isJsonRef()){s=this.m_xlRefNode[g-this.fixedRows];b=s}else{if(!SBGrid.DEF.is_chrome){a=this.m_xlRefNode.item(g-this.fixedRows);h=SBGrid.UT.XmlLib.selectSingleNode(a,t)}else{h=n[g-this.fixedRows][t]}}var e=this.getCellEx(g,m);if(null!=e&&(null!=h||null!=b)){this.setLinkedData(e,h,b);if(this.isPhysicalRow(g)){if(b!=null){SBGrid.CF.GridSetTextRefresh(e,b[t]+"",d,this.m_bIsDataReplaceValueChanged)}else{SBGrid.CF.GridSetTextRefresh(e,SBGrid.UT.XmlLib.getTextValue(h),d,this.m_bIsDataReplaceValueChanged)}}}}}};SBGrid.CT.DataGrid.prototype.mappingCellHasInstanceEx=function(){var c;nStartRow=this.fixedRows;nStartCol=this.fixedCols;nEndRow=this.m_nRealRows;nEndCol=this.cols;var n=this.m_replaceString;if(n!=""&&n!="undefined"&&n!=null){c=n.split("?")}var h=null;if(SBGrid.DEF.is_chrome&&!this.isJsonRef()){h=new Array();for(var g=0;g<this.m_xlRefNode.length;g++){var m={};var l=this.m_xlRefNode.item(g).firstChild;while(l){if("#text"!=l.nodeName){m[l.nodeName]=l}l=l.nextSibling}h.push(m)}}var q;for(var g=nStartCol;g<nEndCol;g++){var p=this.m_arColumn[g].getAttribute("ref");q=nStartRow-this.fixedRows;for(var e=nStartRow;e<nEndRow;e++){var a=null;var o=null;var f=null;var b=null;if(this.isJsonRef()){o=this.m_xlRefNode[q];b=o}else{if(!SBGrid.DEF.is_chrome){a=this.m_xlRefNode.item(q);f=SBGrid.UT.XmlLib.selectSingleNode(a,p)}else{f=h[e-this.fixedRows][p]}}var d=this.getCellEx(e,g);if(null!=d&&(null!=f||null!=b)){if(d.m_bIsSubTotal){continue}this.setLinkedData(d,f,b);if(this.isPhysicalRow(e)){if(b!=null){SBGrid.CF.GridSetTextRefresh(d,b[p]+"",c)}else{SBGrid.CF.GridSetTextRefresh(d,SBGrid.UT.XmlLib.getTextValue(f),c)}}}q++}}};SBGrid.CT.DataGrid.prototype.refreshForHasNotInstance=function(){if(null!=this.m_nlightGridTime){this.stopCreateInterval()}if(null!=this.m_objGridData){if(SBGrid.DEF.is_ie){var h=this.id;this.m_heWhole.attachEvent("onscroll",function(){SBGrid.DEF._W_onProcessEvent(event,"onscroll",h)})}else{this.m_heWhole.setAttribute("onscroll",'SBGrid.DEF._W_onProcessEvent(event, "onscroll", "'+this.id+'")')}var l=this.m_heWhole.firstChild;var f=this.m_heFFS.firstChild;if(null!=this.m_heFFNS.firstChild&&null!=this.m_heFFC.firstChild&&null!=this.m_heFFBS.firstChild&&null!=this.m_heFFBNS.firstChild){this.m_heFFNS.removeChild(this.m_heFFNS.firstChild);this.m_heFFC.removeChild(this.m_heFFC.firstChild);this.m_heFFBS.removeChild(this.m_heFFBS.firstChild);this.m_heFFBNS.removeChild(this.m_heFFBNS.firstChild)}l.removeChild(l.lastChild);l.removeChild(l.lastChild);f.removeChild(f.lastChild);f.removeChild(f.lastChild);var a=new Array();var g=new Array();var c="border-top-width:0px;border-left-width:0px;border-right-width:1px;border-bottom-width:1px;border-top-style:none;border-left-style:none;border-right-style:solid;border-bottom-style:solid;border-right-color:#D4D0C8;border-bottom-color:#D4D0C8;";var e="background-color:#D4D0C8;text-align:center;border-right-color:#6F6F5F;border-bottom-color:#6F6F5F;";var b="<div style='width:100%;border-right-color:transparent; border-bottom-color:transparent; border-top-color:transparent;overflow:hidden; border-left-color:transparent;word-wrap:normal'>";a.push("<colgroup>");g.push("<colgroup>");for(var d=0;d<this.m_objGridData.status.col;d++){a.push("<col style='width:"+this.m_objGridData.column[d].width+"px;'/>");g.push("<col style='width:"+this.m_objGridData.column[d].width+"px;'/>")}a.push("</colgroup>");g.push("</colgroup>");a.push("<tbody>");g.push("<tbody id='"+this.id+".datagridwhole.tbody'>");a.push("<tr>");g.push("<tr>");for(var d=0;d<this.m_objGridData.status.col;d++){a.push("<td style='height:"+this.m_nRowHeight+"px;"+c+e+"'>"+b+'<span style="white-space:nowrap;">'+this.m_objGridData.column[d].caption+"</span></div></td>");g.push("<td style='height:"+this.m_nRowHeight+"px;"+c+e+"'>"+b+"</div></td>")}a.push("</tr>");g.push("</tr>");a.push("</tbody>");g.push("</tbody>");jQuery(f).append(a.join(""));jQuery(l).append(g.join(""));this.m_nlightGridTime=window.setTimeout("SBGrid.getGrid('"+this.id+"').createIntervalTag();",50)}};SBGrid.CT.DataGrid.prototype.createIntervalTag=function(){if(this.m_nlightGridLine>=this.m_objGridData.status.row){return}var f="border-top-width:0px;border-left-width:0px;border-right-width:1px;border-bottom-width:1px;border-top-style:none;border-left-style:none;border-right-style:solid;border-bottom-style:solid;border-right-color:#D4D0C8;border-bottom-color:#D4D0C8;";var a="<div style='width:100%;border-right-color:transparent; border-bottom-color:transparent; border-top-color:transparent;overflow:hidden; border-left-color:transparent;word-wrap:normal'>";var g=new Array();var e=""!=this.backColorAlternate;if(SBGrid.DEF.is_ie){var d=1==this.m_nlightGridLine&1&&e?"background-color:"+this.backColorAlternate+";":"";g.push("<tr>");for(var b=0;b<this.m_objGridData.status.col;b++){g.push("<td style='height:"+this.dataHeight+"px;"+f+this.m_objGridData.column[b].style+d+"'>"+a+'<span style="white-space:nowrap;">'+this.m_objGridData.data[this.m_nlightGridLine][b].D+"</span></div></td>")}g.push("</tr>");this.m_nlightGridLine++}else{for(var c=0;c<100;c++){var d=1==c&1&&e?"background-color:"+this.backColorAlternate+";":"";g.push("<tr>");for(var b=0;b<this.m_objGridData.status.col;b++){g.push("<td style='height:"+this.dataHeight+"px;"+f+this.m_objGridData.column[b].style+d+"'>"+a+'<span style="white-space:nowrap;">'+this.m_objGridData.data[this.m_nlightGridLine][b].D+"</span></div></td>")}g.push("</tr>");this.m_nlightGridLine++}}jQuery(document.getElementById(this.id+".datagridwhole.tbody")).append(g.join(""));if(!SBGrid.DEF.is_smartphone){this.__FFRowMove()}this.stopCreateInterval()};SBGrid.CT.DataGrid.prototype.stopCreateInterval=function(){window.clearTimeout(this.m_nlightGridTime);this.m_nlightGridTime=null;if(this.m_nlightGridLine>=this.m_objGridData.status.row){this.m_nlightGridLine=0}else{this.m_nlightGridTime=window.setTimeout("SBGrid.getGrid('"+this.id+"').createIntervalTag();",50)}};SBGrid.CT.DataGrid.prototype.rebuildForHasInstance=function(){this.m_bChangeFixedRows=false;this.setDisabled(false);this.deleteSortShowIcon();this.deleteMultiSortShowIcon();this.deleteShowExplorerUI();this.stopEditing();this.clearSelection();this.clearAllSubTotalRow(true);this.clearMerge();this.initGridProperties();this.m_bHasItem=true;this.m_bIsSort=false;this.m_objGroup=new Array();this.m_mapGridStyleInfo.clear();this.m_mapColStyleInfo.clear();this.m_htCellFormat={};this.group=0;if(0==this.cols){this.m_bHasItem=false;return}this.resetScroll();this.remakeGrid();for(var e=0;e<this.m_arColumn.length;e++){this.setChild(this.m_arColumn[e].id,this.m_arColumn[e]);if(SBGrid.DEF.SBIT_COMBO==this.m_arColumn[e].m_nInputType){this.setChild(this.m_arColumn[e].m_objCombo.id,this.m_arColumn[e].m_objCombo)}}this.setChild(this.m_objInput.id,this.m_objInput);this.setChild(this.m_objTextArea.id,this.m_objTextArea);var d=this.children.getCollection();for(var a in d){var f=d[a];if(f&&"softbowl:cell"!=f.elementName){SBGrid.CF.GridInit(f)}}if(SBGrid.DEF.is_smartphone){for(var a in d){var f=d[a];if(f&&"softbowl:col"!=f.elementName){SBGrid.CF.GridInit(f)}}}d=null;this.mappingCellHasInstance(null,null,this.m_nMakeIndex,null);for(var e=this.fixedRows;e<this.m_nMakeIndex;e++){this.setRowStatus(e,SBGrid.DEF.SBGS_NEW)}this.colGroupNameSpace();if(!SBGrid.DEF.is_smartphone){if(this.m_objScroll.bScrollEvent){this.setTableMatrix(this.m_objScroll.nTopRow,this.m_objScroll.nBottomRow)}}this.defaultAttributeSetting(!SBGrid.DEF.is_smartphone);if(this.autoMerge){this.merge()}if(this.m_bIsMergeByFree){this.reMergeByFree()}this.makeScrollDiv(this.m_heGridScrollDivCell,true);if(null!=this.m_heFFC){this.makeScrollDiv(this.m_heFFGridScrollDivCell,false)}if(this.autoResize){this.reSizeScrollDiv()}if(!SBGrid.DEF.is_smartphone){this.scrollAttributeSetting();this.__FFRowMove()}this.m_objScroll.bDownProcess=true;this.m_objScroll.bUpProcess=true;if(!this.m_objScroll.bScrollEvent){for(var e=this.fixedRows;e<=this.m_nMakeIndex;e++){for(var b=0;b<this.cols;b++){var c=this.getCellEx(e,b);if(c){SBGrid.CF.GridInit(c)}}}window.setTimeout("SBGrid.getGrid('"+this.id+"').initGridCell();",100)}this.dispatch("ongridrebuild");this.dispatch("SBUx_rebuild")};SBGrid.CT.DataGrid.prototype.initGridCell=function(e,b){if(this.m_bCreateAll){return}e=(e==undefined?this.fixedRows:e);b=(b==undefined?(this.rows-1):b);for(var d=e;d<=b;d++){for(var a=0;a<this.cols;a++){var c=this.getCellEx(d,a);if(c){SBGrid.CF.GridInit(c)}}}};SBGrid.CT.DataGrid.prototype.deleteColumnHasInstance=function(nCol,bRefresh){this.stopEditing();if(0==this.m_arColumn.length){return}this.clearSelection();this.clearMerge();if(!(this.rowheader&&0==this.m_arColumn.length)){var strRef=this.m_arColumn[nCol].getAttribute("ref");if(this.isJsonRef()){try{var objGridItemJson=eval(this.jsonref)}catch(e){return}if(null!=objGridItemJson&&0<objGridItemJson.length){for(var i=(objGridItemJson.length-1);i>-1;i--){try{eval("delete "+this.jsonref+"["+i+"]."+strRef)}catch(e){SBGrid.DEF.errorMsg("Deletecolumn 함수 수행에 실패하였습니다::DeleteColumnHasInstance");return}}}}else{var xnDoc=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceDocument();if(null!=strRef&&!strRef.isEmpty()&&null!=xnDoc){for(var i=0;i<this.m_xlRefNode.length;i++){var xnRef=this.m_xlRefNode.item(i);if(null!=xnRef.selectSingleNode(strRef)){xnRef.removeChild(xnRef.selectSingleNode(strRef))}}}}this.m_arColumn.splice(nCol,1);this.m_arColWidth.splice(nCol,1);this.m_arHiddenCol.splice(nCol,1);for(var i=0;i<this.fixedRows;i++){this.m_arCaption[i].splice(nCol,1)}}for(var i=0;i<this.m_nRealRows;i++){this.physicalRemoveCell(i,nCol)}this.cols--;this.colWidthReset();this.captionReset();this.setColGroupDeleteCol(nCol);for(var i=(nCol+1);i<(this.cols+1);i++){for(var j=0;j<this.m_nRealRows;j++){var objCell=this.getCellEx(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+j+"_"+(i-1);objCell.col=i-1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;if(objCell.m_heCtrl){objCell.m_heCtrl.id="SBHE_"+strCellNewId}if(objCell.m_heDCtrl){objCell.m_heDCtrl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}}var strRemoveChildColID=this.id+"_col_"+this.cols;this.children.remove(strRemoveChildColID);SBGrid.DEF.__removeAll(strRemoveChildColID);for(var i=0;i<this.cols;i++){this.setColWidth(i,this.m_arColWidth[i])}this.defaultAttributeSetting();if(bRefresh){this.refreshCurrentModel(this.attribute.ref)}if(this.autoMerge){this.merge()}if(this.m_bIsMergeByFree){this.reMergeByFree()}};SBGrid.CT.DataGrid.prototype.insertColumnHasInstance=function(nCol,strColAttribute,strType,bRefresh){this.stopEditing();if(strColAttribute.isEmpty()){return}this.clearSelection();this.clearMerge();if(!(this.rowheader&&0==this.m_arColumn.length)){if("after"==strType){nCol++}for(var i=(this.m_arColumn.length-1);i>=nCol;i--){var objCol=this.m_arColumn[i];var strNewId=this.id+"_col_"+(i+1);objCol.id=strNewId;objCol.attribute.id=strNewId;this.children.add(strNewId,objCol);SBGrid.DEF.__appendControl(strNewId,objCol);SBGrid.DEF.__appendAll(strNewId,objCol)}var strCreateChildColID=this.id+"_col_"+nCol;this.children.remove(strCreateChildColID);SBGrid.DEF.__removeAll(strCreateChildColID);strColAttribute+="id:"+strCreateChildColID;var objChild=this.createChild("softbowl:col",strColAttribute);var strCursor=objChild.getAttribute("cursor");if(null!=strCursor&&strCursor.isEmpty()){objChild.setAttribute("cursor",this.getAttribute("cursor"))}var strRef=objChild.getAttribute("ref");if(this.isJsonRef()){var strGridItemJson=JSON.stringify(eval(this.jsonref));var strRegExp="/(\\{";for(var i=0;i<nCol;i++){strRegExp+="[^,}]*"}strRegExp+="\\,)([^}]*\\})/g";var strInsertedGridItemJson=strGridItemJson.replace(eval(strRegExp),function(match,strRegCap1,strRegCap2){return strRegCap1+' "'+strRef+'":"", '+strRegCap2});eval(this.jsonref+" = "+strInsertedGridItemJson)}else{var xnDoc=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceDocument();if(null!=strRef&&!strRef.isEmpty()&&null!=xnDoc){for(var i=0;i<this.m_xlRefNode.length;i++){var xnRef=this.m_xlRefNode.item(i);var xnNewColNode=xnDoc.createElement(strRef);xnRef.appendChild(xnNewColNode)}}}this.m_arColumn.splice(nCol,0,objChild);this.m_arColWidth.splice(nCol,0,100);this.m_arHiddenCol.splice(nCol,0,100);var strCaption=objChild.getAttribute("caption");for(var i=0;i<this.fixedRows;i++){if(null==strCaption||""==strCaption){this.m_arCaption[i].splice(nCol,0," ")}else{this.m_arCaption[i].splice(nCol,0,strCaption)}}this.setColGroupInsertCol(nCol,100)}else{strColAttribute="type:"+this.getAttribute("rowheader")+";";strColAttribute+="id:"+this.id+"_col_"+this.cols;var objChild=this.createChild("softbowl:col",strColAttribute);if(null==objChild){return}var strCursor=objChild.getAttribute("cursor");if(null!=strCursor&&strCursor.isEmpty()){objChild.setAttribute("cursor",this.getAttribute("cursor"))}var strCaption=objChild.getAttribute("caption");for(var i=0;i<this.fixedRows;i++){if(null==strCaption||""==strCaption){this.m_arCaption[i].push(" ")}else{this.m_arCaption[i].push(strCaption)}}this.m_arColumn.push(objChild);this.m_arColWidth.push(20);this.setColGroupAddCol(this.cols,20)}this.cols++;this.colWidthReset();this.captionReset();for(var i=(this.m_arColumn.length-1);i>(nCol-1);i--){for(var j=0;j<this.m_nRealRows;j++){var objCell=this.getCellEx(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+j+"_"+(i+1);objCell.col=i+1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;if(objCell.m_heCtrl){objCell.m_heCtrl.id="SBHE_"+strCellNewId}if(objCell.m_heDCtrl){objCell.m_heDCtrl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}}this.m_xlRefNode=this.getControlNodeList();var objColumn=this.m_arColumn[nCol];var strColumnRef=objColumn.getAttribute("ref");for(var i=0;i<this.m_nRealRows;i++){var strCellId=this.id+"_"+i+"_"+nCol;if(i<this.fixedCols){var objCell=this.getCellExById(strCellId);if(null!=objCell){if(strCellId!=objCell.id){objCell=null}}objCell=null==objCell?new SBGrid.CT.DataGridCell(this,nCol,strCellId,i,"softbowl:cell"):objCell;objCell.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(objCell,objColumn.m_bMerge)}else{var xnCell=null;var jsonCell=null;if(this.isJsonRef()){xnRowData=this.m_xlRefNode[i-this.fixedRows];jsonCell=xnRowData}else{xnRowData=this.m_xlRefNode.item(i-this.fixedRows);xnCell=SBGrid.UT.XmlLib.selectSingleNode(xnRowData,strColumnRef)}var objCell=this.getCellByIdEx(strCellId);if(null!=objCell){if(strCellId!=objCell.id){objCell=null}}objCell=null==objCell?new SBGrid.CT.DataGridCell(this,nCol,strCellId,i,"softbowl:cell"):objCell;objCell.setElement(objColumn);this.setLinkedData(objCell,xnCell,jsonCell);SBGrid.CF.GridSetMergeType(objCell,objColumn.m_bMerge)}}var objScroll=this.m_objScroll;if(objScroll.bScrollEvent){objColumn.init();var nFFLength=this.fixedRows+this.frozenRows;var objCell;for(var i=0;i<nFFLength;i++){this.physicalCreateCell(i,nCol);objCell=this.getCellEx(i,nCol);if(null!=objCell){SBGrid.CF.GridInit(objCell);objCell.m_bUserAddCell=true}if(!SBGrid.DEF.is_ie){for(var j=0;j<this.cols;j++){objCell=this.getCellEx(i,j);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}}var nAppendRowLength=objScroll.nTopRow-nFFLength;for(var i=nFFLength;i<this.m_nMakeIndex;i++){this.physicalCreateCell(i,nCol,false,false,true,false,nAppendRowLength,0)}for(var i=nFFLength;i<this.m_nRealRows;i++){objCell=this.getCellEx(i,nCol);if(null!=objCell){SBGrid.CF.GridInit(objCell)}if(!SBGrid.DEF.is_ie){for(var j=0;j<this.cols;j++){objCell=this.getCellEx(i,j);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}}this.scrollingGrid();this.m_heFFBS.removeChild(this.m_heFFBS.firstChild);this.m_heFFBNS.removeChild(this.m_heFFBNS.firstChild);this.m_heFFBS=this.makeFixedFrozenBottomScrollingRow();this.m_heFFBNS=this.makeFixedFrozenBottomNoScrollingRow();for(var i=nFFLength;i<this.m_nRealRows;i++){this.scrollingCellStyle(i,nCol)}this.defaultAttributeStyleSetting(true);this.setExtendLastCol(this.extendLastCol)}else{var nRealBottomRow=0;if(this.frozenBottomRows>0){nRealBottomRow=this.m_nBottomRowCount;this.m_nBottomRowCount=0}for(var i=0;i<this.m_nRealRows;i++){this.physicalCreateCell(i,nCol);if(i>=this.m_nRealRows-nRealBottomRow){this.m_nBottomRowCount++}}objColumn.init();for(var i=0;i<this.m_nRealRows;i++){var objCell=this.getCellEx(i,nCol);if(null!=objCell){SBGrid.CF.GridInit(objCell);objCell.m_bUserAddCell=true}if(!SBGrid.DEF.is_ie){for(var j=nCol+1;j<this.cols;j++){objCell=this.getCellEx(i,j);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}}this.defaultAttributeSetting();if(bRefresh){this.refreshCurrentModel(this.attribute.ref)}}if("hidden"==objColumn.attribute.visibility){this.setColHidden(nCol,true)}if(this.autoMerge){this.merge()}if(this.m_bIsMergeByFree){this.reMergeByFree()}};SBGrid.CT.DataGrid.prototype.addColumnHasInstance=function(strColAttribute,bRefresh){this.stopEditing();if(strColAttribute.isEmpty()){return}this.clearSelection();if(!(this.rowheader&&0==this.m_arColumn.length)){var strSemicolon="";strColAttribute=strColAttribute.trim();if(0<strColAttribute.length&&(-1==strColAttribute.lastIndexOf(";")||strColAttribute.length!=strColAttribute.lastIndexOf(";"))){strSemicolon=";"}if(-1==strColAttribute.indexOf("id:")){strColAttribute+=strSemicolon+"id:"+this.id+"_col_"+this.cols}var objChild=this.createChild("softbowl:col",strColAttribute);if(null==objChild){return}var strCursor=objChild.getAttribute("cursor");if(null!=strCursor&&strCursor.isEmpty()){objChild.setAttribute("cursor",this.getAttribute("cursor"))}var strRef=objChild.getAttribute("ref");if(this.isJsonRef()){var objGridJSONData=eval(this.jsonref);var nDataLength=objGridJSONData.length;for(var i=0;i<nDataLength;i++){if(objGridJSONData[i][strRef]==undefined){objGridJSONData[i][strRef]=""}}objGridJSONData=null}else{var xnDoc=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceDocument();if(null!=strRef&&!strRef.isEmpty()&&null!=xnDoc){for(var i=0;i<this.m_xlRefNode.length;i++){var xnRef=this.m_xlRefNode.item(i);var xnNewColNode=xnDoc.createElement(strRef);xnRef.appendChild(xnNewColNode)}}}var strCaption=objChild.getAttribute("caption");for(var i=0;i<this.fixedRows;i++){if(null==strCaption||""==strCaption){this.m_arCaption[i].push(" ")}else{this.m_arCaption[i].push(strCaption)}}this.m_arColumn.push(objChild);this.m_arColWidth.push(100);this.m_arHiddenCol.push(100);this.setColGroupAddCol(this.cols,100)}else{strColAttribute="type:"+this.getAttribute("rowheader")+";";strColAttribute+="id:"+this.id+"_col_"+this.cols;var objChild=this.createChild("softbowl:col",strColAttribute);if(null==objChild){return}var strCursor=objChild.getAttribute("cursor");if(null!=strCursor&&strCursor.isEmpty()){objChild.setAttribute("cursor",this.getAttribute("cursor"))}var strCaption=objChild.getAttribute("caption");for(var i=0;i<this.fixedRows;i++){if(null==strCaption||""==strCaption){this.m_arCaption[i].push(" ")}else{this.m_arCaption[i].push(strCaption)}}this.m_arColumn.push(objChild);this.m_arColWidth.push(20);this.m_arHiddenCol.push(20);this.setColGroupAddCol(this.cols,20)}this.cols++;this.colWidthReset();this.captionReset();this.m_xlRefNode=this.getControlNodeList();var objScroll=this.m_objScroll;if(objScroll.bScrollEvent){var objTargetCol=this.m_arColumn[this.cols-1];objTargetCol.init();var nFFLength=this.fixedRows+this.frozenRows;var objCell;for(var i=0;i<nFFLength;i++){this.physicalCreateCell(i,this.cols-1);objCell=this.getCellEx(i,this.cols-1);if(null!=objCell){SBGrid.CF.GridInit(objCell);objCell.m_bUserAddCell=true}if(!SBGrid.DEF.is_ie){for(var j=0;j<this.cols-1;j++){objCell=this.getCellEx(i,j);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}}var nAppendRowLength=objScroll.nTopRow-nFFLength;for(var i=nFFLength;i<this.m_nMakeIndex;i++){this.physicalCreateCell(i,this.cols-1,false,false,true,false,nAppendRowLength,0)}var strColumnRef=objTargetCol.getAttribute("ref");for(var i=nFFLength;i<this.m_nRealRows;i++){var xnRowData=null;var jsonRowData=null;if(this.isJsonRef()){jsonRowData=this.m_xlRefNode[i-this.fixedRows]}else{xnRowData=this.m_xlRefNode.item(i-this.fixedRows)}var strCellId=this.id+"_"+i+"_"+(this.cols-1);var objCell=this.getCellByIdEx(strCellId);if(null!=objCell){if(strCellId!=objCell.id){objCell=null}}objCell=null==objCell?new SBGrid.CT.DataGridCell(this,this.cols-1,strCellId,i,"softbowl:cell"):objCell;objCell.setElement(objTargetCol);if(null!=strColumnRef){var xnCell=null;var jsonCell=null;if(this.isJsonRef()){jsonCell=jsonRowData}else{xnCell=SBGrid.UT.XmlLib.selectSingleNode(xnRowData,strColumnRef)}this.setLinkedData(objCell,xnCell,jsonCell)}SBGrid.CF.GridSetMergeType(objCell,objTargetCol.m_bMerge);SBGrid.CF.GridInit(objCell);objCell.m_bUserAddCell=true;if(!SBGrid.DEF.is_ie){for(var j=0;j<this.cols-1;j++){objCell=this.getCellEx(i,j);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}}this.setTableMatrix(this.m_objScroll.nTopRow,this.m_objScroll.nBottomRow);this.scrollingGrid();this.m_heFFBS.removeChild(this.m_heFFBS.firstChild);this.m_heFFBNS.removeChild(this.m_heFFBNS.firstChild);this.m_heFFBS=this.makeFixedFrozenBottomScrollingRow();this.m_heFFBNS=this.makeFixedFrozenBottomNoScrollingRow();this.defaultAttributeStyleSetting(true);this.setExtendLastCol(this.extendLastCol)}else{var nRealBottomRow=0;if(this.frozenBottomRows>0){nRealBottomRow=this.m_nBottomRowCount;this.m_nBottomRowCount=0}for(var i=0;i<this.m_nRealRows;i++){this.physicalCreateCell(i,this.cols-1);if(i>=this.m_nRealRows-nRealBottomRow){this.m_nBottomRowCount++}}this.m_arColumn[this.cols-1].init();for(var i=0;i<this.m_nRealRows;i++){var objCell=this.getCellEx(i,this.cols-1);if(null!=objCell){SBGrid.CF.GridInit(objCell);objCell.m_bUserAddCell=true}}this.defaultAttributeSetting();if(bRefresh){this.refreshCurrentModel(this.attribute.ref)}}var objCol=this.m_arColumn[this.cols-1];if("hidden"==objCol.attribute.visibility){this.setColHidden(this.cols-1,true)}if(this.autoMerge){this.merge()}};SBGrid.CT.DataGrid.prototype.deleteRowHasInstance=function(nRow,bRefresh,bNotDeleteNode){this.stopEditing();this.clearSelection();this.clearMerge();if(this.fixedRows==this.m_nRealRows){return}var nShiftRow,bIsFirstNode=true,bIsBottomRow=false,objStringArr,strRplcDt=this.m_replaceString;if(strRplcDt!=""&&strRplcDt!="undefined"&&strRplcDt!=null){objStringArr=strRplcDt.split("?")}if(!bNotDeleteNode){var objRemoveFcell=this.getCellEx(nRow,0);if(!objRemoveFcell.m_bUserAddCell){var strColSep=this.attribute.colsep;var strRowSep=this.attribute.rowsep;var strData="d"+strColSep+"-1";var nRowHeader=this.m_bRowHeader?1:0;for(var i=0+nRowHeader;i<this.cols;i++){strData+=strColSep;strData+=SBGrid.CF.GridGetText(this.getCellEx(nRow,i))}if(this.m_bIsRealDataSync){for(var i=0,nExtRefListLength=this.m_arExtRefList.length;i<nExtRefListLength;i++){strData+=strColSep;var strExtensionRefData=this.m_xlRefNode[nRow-this.fixedRows][this.m_arExtRefList[i]];strData+=(strExtensionRefData==undefined?"":strExtensionRefData.toString())}}strData+=strRowSep;this.m_arUpdateDeleteList.push(strData)}var xnNodeset;var xnParentNode;var objRemoveTargetCell=this.getCellEx(nRow,this.fixedCols);if(this.isJsonRef()){if(null!=objRemoveTargetCell){eval("SBGrid.DEF.arrRemoveAt("+this.jsonref+","+(nRow-this.fixedRows)+");")}}else{xnNodeset=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset);xnParentNode=xnNodeset.item(0).parentNode;if(null!=objRemoveTargetCell){try{xnParentNode.removeChild(xnNodeset.item(nRow-this.fixedRows))}catch(e){if(null!=window.console){}}}}}this.m_xlRefNode=this.getControlNodeList();this.makeScrollDiv(this.m_heGridScrollDivCell,true);if(null!=this.m_heFFC){this.makeScrollDiv(this.m_heFFGridScrollDivCell,false)}var nScrollMaxLen=this.m_objScroll.nMaxLength;if(nScrollMaxLen<=this.m_nMakeIndex&&nScrollMaxLen<this.m_nRealRows-this.m_nBottomRowCount){this.m_objScroll.bScrollEvent=true;this.m_objScroll.nEndRow--;var objCell=null;var nScrollTopRow=this.m_objScroll.nTopRow;var nScrollBottomRow=this.m_objScroll.nBottomRow;for(var i=(nRow+1);i<this.m_nRealRows;i++){for(var j=0;j<this.cols;j++){objCell=this.getCellEx(i,j);if(null!=objCell){var strCellNewId=this.id+"_"+(i-1)+"_"+j;objCell.row=i-1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);if(i>=nScrollTopRow&&i<=nScrollBottomRow){SBGrid.CF.GridInit(objCell);if(bRefresh){if(j>=this.fixedCols){SBGrid.CF.GridSetTextRefresh(objCell,SBGrid.CF.GridGetText(objCell),objStringArr,this.m_bIsDataReplaceValueChanged)}}}}}}this.m_nRealRows--;for(var k=nRow,nLength=this.m_objScroll.arTargetRow.length-1;k<nLength;k++){if(this.m_htRowHeight[k]===undefined&&this.m_htRowHeight[k+1]===undefined){continue}else{if(this.m_htRowHeight[k]!==undefined&&this.m_htRowHeight[k+1]===undefined){delete this.m_htRowHeight[k]}else{this.m_htRowHeight[k]=this.m_htRowHeight[k+1]}}}if(this.m_htRowHeight[this.m_objScroll.arTargetRow.length-1]!==undefined){delete this.m_htRowHeight[this.m_objScroll.arTargetRow.length-1]}this.m_objScroll.arTargetRow.splice(nRow,1);for(var k=nRow,nLength=this.m_objScroll.arTargetRow.length;k<nLength;k++){this.m_objScroll.arTargetRow[k]-=1}this.m_mapGridStyleInfo.remove(nRow.toString());var arrRowIndexList=this.m_mapGridStyleInfo.keys();while(parseInt(arrRowIndexList[0])<nRow){arrRowIndexList.shift()}for(var k=0,nLength=arrRowIndexList.length;k<nLength;k++){var strKey=(parseInt(arrRowIndexList[k])-1).toString();this.m_mapGridStyleInfo.add(strKey,this.m_mapGridStyleInfo.find(arrRowIndexList[k]));strKey=null}this.m_mapGridStyleInfo.remove(arrRowIndexList[arrRowIndexList.length-1]);SBGrid.DEF.clearArray(arrRowIndexList);arrRowIndexList=null;this.scrollingGrid();this.m_heFFBS.removeChild(this.m_heFFBS.firstChild);this.m_heFFBNS.removeChild(this.m_heFFBNS.firstChild);this.m_heFFBS=this.makeFixedFrozenBottomScrollingRow();this.m_heFFBNS=this.makeFixedFrozenBottomNoScrollingRow();this.defaultAttributeStyleSetting()}else{this.m_objScroll.bScrollEvent=false;this.m_objScroll.nBottomRow--;this.m_objScroll.nTargetHeight-=this.dataHeight;this.physicalRemovePartRow(nRow,nRow);if(nRow<(this.fixedRows+this.frozenRows)){var nCountRow=nRow;while((nCountRow+1)!=(this.fixedRows+this.frozenRows)){nCountRow++;for(var i=0;i<this.cols;i++){var objCell=this.getCellEx(nCountRow,i);if(null!=objCell){var strCellNewId=this.id+"_"+(nCountRow-1)+"_"+i;objCell.row=nCountRow-1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;objCell.m_heCtrl.id="SBHE_"+strCellNewId;if(objCell.m_heDCtrl){objCell.m_heDCtrl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}}for(var i=0;i<this.cols;i++){var objCell=this.getCellEx(nCountRow+1,i);if(null!=objCell){this.physicalCreateCell(nCountRow,i,bIsFirstNode,objCell.m_bIsSubTotal,true,true);bIsFirstNode=false}}for(var i=0;i<this.cols;i++){var objCell=this.getCellEx(nCountRow+1,i);if(null!=objCell){var strCellNewId=this.id+"_"+(nCountRow)+"_"+i;objCell.row=nCountRow;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;SBGrid.CF.GridInit(objCell);SBGrid.CF.GridSetTextRefresh(objCell,SBGrid.CF.GridGetText(objCell),objStringArr,this.m_bIsDataReplaceValueChanged);this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell)}}if(nCountRow+1<this.m_nRealRows){this.physicalRemovePartRow(nCountRow+1,nCountRow+1)}for(var i=0;i<this.cols;i++){for(var j=nCountRow+2;j<this.m_nRealRows;j++){var objCell=this.getCellEx(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+(j-1)+"_"+i;objCell.row=j-1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;objCell.m_heCtrl.id="SBHE_"+strCellNewId;if(objCell.m_heDCtrl){objCell.m_heDCtrl.id=strCellNewId+"_data"}SBGrid.CF.GridInit(objCell);this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell)}}}for(var i=this.fixedRows;i<this.m_nRealRows;i++){var objCell=this.getCellEx(i,0);if(null!=objCell){this.setRowStatus(i,objCell.getStatus())}}}else{for(var i=0;i<this.cols;i++){for(var j=(nRow+1);j<this.m_nRealRows;j++){var objCell=this.getCellEx(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+(j-1)+"_"+i;objCell.row=j-1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;objCell.m_heCtrl.id="SBHE_"+strCellNewId;if(objCell.m_heDCtrl){objCell.m_heDCtrl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}}if(nRow>=(this.m_nRealRows-this.frozenBottomRows)&&this.frozenBottomRows>0){if(this.m_nRealRows>this.fixedRows+this.frozenBottomRows+this.frozenRows){bIsBottomRow=true;nShiftRow=this.m_nRealRows-this.frozenBottomRows-1;this.physicalRemovePartRow(nShiftRow,nShiftRow)}}}if(this.rows==this.m_nRealRows){this.rows--}this.m_nRealRows--;this.m_nMakeIndex--;if(bIsBottomRow){var nTempBottomRowCount=this.m_nBottomRowCount;this.m_nBottomRowCount=0;for(var i=0;i<this.cols;i++){var objCell=this.getCellEx(nShiftRow,i);if(null!=objCell){this.physicalCreateCell(nShiftRow,i,bIsFirstNode,objCell.m_bIsSubTotal,true);bIsFirstNode=false}}for(var i=0;i<this.cols;i++){var objCell=this.getCellEx(nShiftRow,i);if(null!=objCell){SBGrid.CF.GridInit(objCell);SBGrid.CF.GridSetTextRefresh(objCell,SBGrid.CF.GridGetText(objCell),objStringArr,this.m_bIsDataReplaceValueChanged);this.setRowStatus(nShiftRow,objCell.getStatus())}}this.m_nBottomRowCount=nTempBottomRowCount+1}for(var k=nRow,nLength=this.m_objScroll.arTargetRow.length-1;k<nLength;k++){if(this.m_htRowHeight[k]===undefined&&this.m_htRowHeight[k+1]===undefined){continue}else{if(this.m_htRowHeight[k]!==undefined&&this.m_htRowHeight[k+1]===undefined){delete this.m_htRowHeight[k]}else{this.m_htRowHeight[k]=this.m_htRowHeight[k+1]}}}if(this.m_objScroll.bScrollEvent){if(this.m_htRowHeight[this.m_objScroll.arTargetRow.length-1]!==undefined){delete this.m_htRowHeight[this.m_objScroll.arTargetRow.length-1]}}this.m_objScroll.arTargetRow.splice(nRow,1);for(var k=nRow,nLength=this.m_objScroll.arTargetRow.length;k<nLength;k++){this.m_objScroll.arTargetRow[k]-=1}for(var i=0;i<this.cols;i++){var strRemoveChildCellId=this.id+"_"+this.m_nRealRows+"_"+i;this.children.remove(strRemoveChildCellId);SBGrid.DEF.__removeAll(strRemoveChildCellId)}this.m_heFFBS.removeChild(this.m_heFFBS.firstChild);this.m_heFFBNS.removeChild(this.m_heFFBNS.firstChild);this.m_heFFBS=this.makeFixedFrozenBottomScrollingRow();this.m_heFFBNS=this.makeFixedFrozenBottomNoScrollingRow();this.defaultAttributeSetting();if(bRefresh){this.refreshCurrentModel(this.attribute.ref)}}this.rows=this.m_nRealRows;if(!bNotDeleteNode){this.moveSubtotal(nRow,"delete");this.setSeqForRowHeader()}if(this.autoMerge){this.merge()}if(this.m_bIsMergeByFree){this.reMergeByFree()}};SBGrid.CT.DataGrid.prototype.insertRowHasInstance=function(nRow,strType,bRefresh,bPreserveStatus,bNotAddNode){this.stopEditing();this.clearSelection();this.clearMerge();if("below"==strType){nRow++}var objStringArr;var strRplcDt=this.m_replaceString;var bIsFirstNode=true;var bIsBottomRow=false;var nTempBottomRowCount=this.m_nBottomRowCount;var nExpectationRows=this.m_nRealRows;if(strRplcDt!=""&&strRplcDt!="undefined"&&strRplcDt!=null){objStringArr=strRplcDt.split("?")}if(!bNotAddNode){if(this.isJsonRef()){var arNewRow=new Array();var strJson="";var nRowHeader=this.m_bRowHeader?1:0;for(var i=0+nRowHeader;i<this.cols;i++){var strRef=this.m_arColumn[i].getAttribute("ref");if(strRef==null||strRef==""){continue}arNewRow.push('"'+strRef+'":""')}for(var i=0,nExtRefListLength=this.m_arExtRefList.length;i<nExtRefListLength;i++){var strRef=this.m_arExtRefList[i];if(strRef==null||strRef==""){continue}arNewRow.push('"'+strRef+'":""')}var arJsonObject=this.jsonref.split(".");for(var k=0;k<arJsonObject.length;k++){if((arJsonObject[k].indexOf(")")!=-1)&&(k<arJsonObject.length-1)){arJsonObject[k+1]=arJsonObject[k]+"."+arJsonObject[k+1];arJsonObject.shift()}}if(this.fixedRows==this.m_nRealRows){if(arJsonObject.length==1){strJson=arJsonObject[0]+"=[{"+arNewRow.join(",")+"}]"}else{if(arJsonObject.length>1){strJson='"'+arJsonObject[arJsonObject.length-1]+'":[{'+arNewRow.join(",")+"}]";for(var i=arJsonObject.length-2;i>0;i--){strJson='"'+arJsonObject[i]+'" : {'+strJson+"}"}strJson=arJsonObject[0]+"={"+strJson+"};"}}eval(strJson)}else{strJson="{"+arNewRow.join(",")+"}";eval(this.jsonref+".splice("+(nRow-this.fixedRows)+", 0,"+strJson+");")}}else{if(this.fixedRows==this.m_nRealRows){var xnNodeset=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset.substring(0,this.nodeset.lastIndexOf("/")));var strNodeName=this.nodeset.substring(this.nodeset.lastIndexOf("/")+1,this.nodeset.length);strNodeName=strNodeName.replace(/\[(.*)\]/g,"");var xnNewRow=SBGrid.UT.XmlLib.createChild(xnNodeset.item(0),strNodeName)}else{var xnDoc=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceDocument();var xnNodeset=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset);var strNodeName=this.nodeset.substring(this.nodeset.lastIndexOf("/")+1,this.nodeset.length);strNodeName=strNodeName.replace(/\[(.*)\]/g,"");var xnNewRow=xnDoc.createElement(strNodeName);var xnParentNode=xnNodeset.item(0).parentNode;xnParentNode.insertBefore(xnNewRow,xnNodeset.item((nRow-this.fixedRows)))}var strSplitNodeset=this.nodeset;var htStartsWith=null;if(-1!=strSplitNodeset.indexOf("starts-with")){htStartsWith={};strSplitNodeset=strSplitNodeset.replace(/\).*starts\-with\s*\(/g,"|");var arStartsWith=strSplitNodeset.replace(/(.*starts\-with(\s*)\((\s*))|(\)\s*\])/g,"").split("|");for(var i=0;i<arStartsWith.length;i++){var arNodeToVale=arStartsWith[i].split(",");htStartsWith[arNodeToVale[0]]=arNodeToVale[1].replace(/(\s*\')|(\'\s*)/g,"")}}var nRowHeader=this.m_bRowHeader?1:0;for(var i=0+nRowHeader;i<this.cols;i++){var strRef=this.m_arColumn[i].getAttribute("ref");if(null!=strRef&&""!=strRef){if(null!=htStartsWith){if(null!=htStartsWith[strRef]){SBGrid.UT.XmlLib.createChildWithValue(xnNewRow,strRef,htStartsWith[strRef]);continue}}SBGrid.UT.XmlLib.createChild(xnNewRow,strRef)}}}}if(this.m_objScroll.nMaxLength<=this.m_nMakeIndex){this.m_objScroll.bScrollEvent=true;this.m_objScroll.nEndRow++;if(null==this.m_objScroll.arTargetRow||this.m_nRealRows!=this.m_objScroll.arTargetRow.length){this.m_objScroll.arTargetRow=new Array();for(var i=0;i<this.m_nRealRows;i++){if(this.m_arHiddenRowState[i]==true){continue}this.m_objScroll.arTargetRow.push(i)}this.m_objScroll.arTargetRow.push(this.m_nRealRows)}else{this.m_objScroll.arTargetRow.push(this.m_nRealRows)}}else{this.m_objScroll.bScrollEvent=false;this.m_objScroll.nBottomRow++;this.m_objScroll.nTargetHeight+=this.dataHeight;this.m_nMakeIndex++}if(this.rows==this.m_nRealRows){this.rows++}this.m_nRealRows++;if(!this.m_objScroll.bScrollEvent){if(nRow<(this.fixedRows+this.frozenRows)){var nCountRow=nRow;var nBottomRowCount;var bBottomRowStatus=false;while((nCountRow+1)!=(this.fixedRows+this.frozenRows)){nCountRow++}if(this.m_nBottomRowCount<this.frozenBottomRows){nBottomRowCount=this.m_nBottomRowCount;this.m_nBottomRowCount=0;bBottomRowStatus=true}for(var i=0;i<this.cols;i++){for(var j=(nExpectationRows-1);j>nCountRow;j--){if(0==i){jQuery('tr[rowNum="'+this.id+"_"+j+'"]').attr("rowNum",this.id+"_"+(j+1))}var objCell=this.getCellEx(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+(j+1)+"_"+i;objCell.row=j+1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;objCell.m_heCtrl.id="SBHE_"+strCellNewId;objCell.m_heCtrl.setAttribute("rowNum",this.id+"_"+(j+1));objCell.m_heCtrl.setAttribute("cellId",this.id+"."+(j+1)+"."+i);if(objCell.m_heDCtrl){objCell.m_heDCtrl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}var objCell=this.getCellEx(nCountRow,i);if(null!=objCell){this.physicalCreateCell(nCountRow+1,i,bIsFirstNode,objCell.m_bIsSubTotal,true);bIsFirstNode=false}}if(bBottomRowStatus){this.m_nBottomRowCount=nBottomRowCount+1}for(var i=0;i<this.cols;i++){var objCell=this.getCellEx(nCountRow,i);if(null!=objCell){var strCellNewId=this.id+"_"+(nCountRow+1)+"_"+i;var strCellOdlId=this.id+"_"+(nCountRow)+"_"+i;objCell.row=nCountRow+1;objCell.id=strCellNewId;this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);this.children.add(strCellOdlId,null);SBGrid.DEF.__appendAll(strCellOdlId,null);SBGrid.CF.GridInit(objCell);SBGrid.CF.GridSetTextRefresh(objCell,SBGrid.CF.GridGetText(objCell),objStringArr,this.m_bIsDataReplaceValueChanged);this.setRowStatus(nCountRow+1,objCell.getStatus())}}this.physicalRemovePartRow(nCountRow,nCountRow);for(var i=0;i<this.cols;i++){for(var j=nCountRow-1;j>(nRow-1);j--){if(0==i){jQuery('tr[rowNum="'+this.id+"_"+j+'"]').attr("rowNum",this.id+"_"+(j+1))}var objCell=this.getCellEx(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+(j+1)+"_"+i;objCell.row=j+1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;objCell.m_heCtrl.id="SBHE_"+strCellNewId;objCell.m_heCtrl.setAttribute("rowNum",this.id+"_"+(j+1));objCell.m_heCtrl.setAttribute("cellId",this.id+"."+(j+1)+"."+i);if(objCell.m_heDCtrl){objCell.m_heDCtrl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}}}else{if(nRow>(nExpectationRows-this.frozenBottomRows)&&this.frozenBottomRows>0){bIsBottomRow=true;for(var i=0;i<this.cols;i++){for(var j=(nExpectationRows-1);j>=nRow;j--){if(0==i){jQuery('tr[rowNum="'+this.id+"_"+j+'"]').attr("rowNum",this.id+"_"+(j+1))}var objCell=this.getCellEx(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+(j+1)+"_"+i;objCell.row=j+1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;objCell.m_heCtrl.id="SBHE_"+strCellNewId;objCell.m_heCtrl.setAttribute("rowNum",this.id+"_"+(j+1));objCell.m_heCtrl.setAttribute("cellId",this.id+"."+(j+1)+"."+i);if(objCell.m_heDCtrl){objCell.m_heDCtrl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}var strCellOldId=this.id+"_"+nRow+"_"+i;this.children.add(strCellOldId,null);SBGrid.DEF.__appendAll(strCellOldId,null)}if(nExpectationRows>=this.fixedRows+this.frozenBottomRows+this.frozenRows){var nShiftRow=nExpectationRows-this.frozenBottomRows;this.physicalRemovePartRow(nShiftRow,nShiftRow,nExpectationRows);nTempBottomRowCount=this.m_nBottomRowCount;for(var i=0;i<this.cols;i++){var objCell=this.getCellEx(nShiftRow,i);if(null!=objCell){this.physicalCreateCell(nShiftRow,i,bIsFirstNode,objCell.m_bIsSubTotal,true);bIsFirstNode=false}}for(var i=0;i<this.cols;i++){var objCell=this.getCellEx(nShiftRow,i);if(null!=objCell){SBGrid.CF.GridInit(objCell);SBGrid.CF.GridSetTextRefresh(objCell,SBGrid.CF.GridGetText(objCell),objStringArr,this.m_bIsDataReplaceValueChanged);this.setRowStatus(nShiftRow,objCell.getStatus())}}}this.m_nBottomRowCount=nRow-(this.m_nRealRows-this.frozenBottomRows)}else{for(var i=0;i<this.cols;i++){for(var j=(nExpectationRows-1);j>(nRow-1);j--){if(0==i){jQuery('tr[rowNum="'+this.id+"_"+j+'"]').attr("rowNum",this.id+"_"+(j+1))}var objCell=this.getCellEx(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+(j+1)+"_"+i;objCell.row=j+1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;objCell.m_heCtrl.id="SBHE_"+strCellNewId;objCell.m_heCtrl.setAttribute("rowNum",this.id+"_"+(j+1));objCell.m_heCtrl.setAttribute("cellId",this.id+"."+(j+1)+"."+i);if(objCell.m_heDCtrl){objCell.m_heDCtrl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}var strCellOldId=this.id+"_"+nRow+"_"+i;this.children.add(strCellOldId,null);SBGrid.DEF.__appendAll(strCellOldId,null)}}}}this.m_htRowHeight[nRow]=this.dataHeight;this.m_xlRefNode=this.getControlNodeList();this.makeScrollDiv(this.m_heGridScrollDivCell,true);if(null!=this.m_heFFC){this.makeScrollDiv(this.m_heFFGridScrollDivCell,false)}bIsFirstNode=true;if(!this.m_objScroll.bScrollEvent){for(var i=0;i<this.cols;i++){this.physicalCreateCell(nRow,i,bIsFirstNode,bNotAddNode);bIsFirstNode=false}for(var i=0;i<this.cols;i++){SBGrid.CF.GridInit(this.getCellEx(nRow,i))}}else{for(var i=0;i<this.cols;i++){if(this.frozenBottomRows>0){var objCell=this.getCellEx(nExpectationRows-this.frozenBottomRows,i);objCell.attribute["background-color"]=null}for(var j=(nExpectationRows-1);j>=(nRow);j--){var objCell=this.getCellEx(j,i);var strCellNewId=this.id+"_"+(j+1)+"_"+i;objCell.row=j+1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);objCell.attribute["background-color"]=null;SBGrid.CF.GridInit(objCell)}var objColumn=this.m_arColumn[i];var strColumnRef=objColumn.getAttribute("ref");var xnRowData=null;var jsonRowData=null;if(this.isJsonRef()){jsonRowData=this.m_xlRefNode[nRow-this.fixedRows]}else{xnRowData=this.m_xlRefNode.item(nRow-this.fixedRows)}var strCellId=this.id+"_"+nRow+"_"+i;var objCell=null;if(i<this.fixedCols){objCell=new SBGrid.CT.DataGridCell(this,i,strCellId,nRow,"softbowl:cell");objCell.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(objCell,objColumn.m_bMerge)}else{var xnCell=null;var jsonCell=null;if(this.isJsonRef()){jsonCell=jsonRowData}else{xnCell=SBGrid.UT.XmlLib.selectSingleNode(xnRowData,strColumnRef)}objCell=new SBGrid.CT.DataGridCell(this,i,strCellId,nRow,"softbowl:cell");objCell.setElement(objColumn);this.setLinkedData(objCell,xnCell,jsonCell);SBGrid.CF.GridSetMergeType(objCell,objColumn.m_bMerge)}this.children.add(strCellId,objCell);SBGrid.DEF.__appendAll(strCellId,objCell);SBGrid.CF.GridInit(objCell)}var arrRowIndexList=this.m_mapGridStyleInfo.keys();while(parseInt(arrRowIndexList[0])<nRow){arrRowIndexList.shift()}for(var k=arrRowIndexList.length-1;k>=0;k--){var strKey=(parseInt(arrRowIndexList[k])+1).toString();this.m_mapGridStyleInfo.add(strKey,this.m_mapGridStyleInfo.find(arrRowIndexList[k]));strKey=null}this.m_mapGridStyleInfo.remove(arrRowIndexList[0]);SBGrid.DEF.clearArray(arrRowIndexList);arrRowIndexList=null;if(this.m_mapColStyleInfo.count()>0){this.m_mapGridStyleInfo.add(nRow.toString(),(new SBGrid.DS.Map()));var mapRowStyleInfo=this.m_mapGridStyleInfo.find(nRow.toString());var arrColIndexList=this.m_mapColStyleInfo.keys();arrColIndexList.sort(SBGrid.DEF.numberASC);for(var k=0,nColIndexListLength=arrColIndexList.length;k<nColIndexListLength;k++){var objColStyleInfo=this.m_mapColStyleInfo.find(arrColIndexList[k]);var arrStyleList=SBGrid.DEF.getPropertyNameList(objColStyleInfo.style);if(objColStyleInfo.type=="fixed"||objColStyleInfo.type=="all"){if(nRow<this.fixedRows){mapRowStyleInfo.add(arrColIndexList[k],SBGrid.DEF.__deepCopy(objColStyleInfo.style))}}if(objColStyleInfo.type=="data"||objColStyleInfo.type=="all"){if(nRow>=this.fixedRows){mapRowStyleInfo.add(arrColIndexList[k],SBGrid.DEF.__deepCopy(objColStyleInfo.style))}}}}this.setTableMatrix(this.m_objScroll.nTopRow,this.m_objScroll.nBottomRow);this.scrollingGrid()}if(bIsBottomRow){this.m_nBottomRowCount=nTempBottomRowCount+1}this.m_heFFBS.removeChild(this.m_heFFBS.firstChild);this.m_heFFBNS.removeChild(this.m_heFFBNS.firstChild);this.m_heFFBS=this.makeFixedFrozenBottomScrollingRow();this.m_heFFBNS=this.makeFixedFrozenBottomNoScrollingRow();this.defaultAttributeSetting();if(bRefresh){this.refreshCurrentModel(this.attribute.ref)}if(!bNotAddNode){for(var i=0;i<this.cols;i++){var objCell=this.getCellEx(nRow,i);if(null!=objCell){objCell.m_bUserAddCell=true;if(!bPreserveStatus){objCell.setEditingMode(true)}}}if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){this.selectRow(nRow)}this.setRowValue(nRow);this.setRowStatus(nRow,SBGrid.DEF.SBGS_NEW|SBGrid.DEF.SBGS_INSERT);this.setSeqForRowHeader();this.moveSubtotal(nRow,"insert")}if(this.autoMerge){this.merge()}if(this.m_bIsMergeByFree){this.reMergeByFree()}};SBGrid.CT.DataGrid.prototype.addRowHasInstance=function(bRefresh,bPreserveStatus,bNotAddNode){this.stopEditing();this.clearSelection();var xnRowData=null;var jsonRowData=null;if(!bNotAddNode){if(this.isJsonRef()){var arNewRow=new Array();var strJson="";var nRowHeader=this.m_bRowHeader?1:0;for(var i=0+nRowHeader;i<this.cols;i++){var strRef=this.m_arColumn[i].getAttribute("ref");if(strRef==null||strRef==""){continue}arNewRow.push('"'+strRef+'":""')}for(var i=0,nExtRefListLength=this.m_arExtRefList.length;i<nExtRefListLength;i++){var strRef=this.m_arExtRefList[i];if(strRef==null||strRef==""){continue}arNewRow.push('"'+strRef+'":""')}var arJsonObject=this.jsonref.split(".");for(var k=0;k<arJsonObject.length;k++){if((arJsonObject[k].indexOf(")")!=-1)&&(k<arJsonObject.length-1)){arJsonObject[k+1]=arJsonObject[k]+"."+arJsonObject[k+1];arJsonObject.shift()}}if(this.fixedRows==this.m_nRealRows){if(arJsonObject.length==1){strJson=arJsonObject[0]+"=[{"+arNewRow.join(",")+"}]"}else{if(arJsonObject.length>1){strJson='"'+arJsonObject[arJsonObject.length-1]+'":[{'+arNewRow.join(",")+"}]";for(var i=arJsonObject.length-2;i>0;i--){strJson='"'+arJsonObject[i]+'" : {'+strJson+"}"}strJson=arJsonObject[0]+"={"+strJson+"};"}}eval(strJson)}else{strJson="{"+arNewRow.join(",")+"}";eval(this.jsonref+".push("+strJson+");")}}else{if(this.fixedRows==this.m_nRealRows){var xnNodeset=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset);if(xnNodeset.length>0){xnNewRow=xnNodeset.item(0)}else{var strNodeset=this.nodeset.replace(/\[(.*)\]/g,"");SBGrid.DS.XMLStorage.getUniqueStorage().makeNode(strNodeset);xnNewRow=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceSinglePart(null,strNodeset)}}else{var xnNodeset=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset);var strNodeName=this.nodeset.substring(this.nodeset.lastIndexOf("/")+1,this.nodeset.length);strNodeName=strNodeName.replace(/\[(.*)\]/g,"");var xnNewRow=SBGrid.UT.XmlLib.createChild(xnNodeset.item(0).parentNode,strNodeName)}var strSplitNodeset=this.nodeset;var htStartsWith=null;if(-1!=strSplitNodeset.indexOf("starts-with")){htStartsWith={};strSplitNodeset=strSplitNodeset.replace(/\).*starts\-with\s*\(/g,"|");var arStartsWith=strSplitNodeset.replace(/(.*starts\-with(\s*)\((\s*))|(\)\s*\])/g,"").split("|");for(var i=0;i<arStartsWith.length;i++){var arNodeToVale=arStartsWith[i].split(",");htStartsWith[arNodeToVale[0]]=arNodeToVale[1].replace(/(\s*\')|(\'\s*)/g,"")}}var nRowHeader=this.m_bRowHeader?1:0;for(var i=0+nRowHeader;i<this.cols;i++){var strRef=this.m_arColumn[i].getAttribute("ref");if(null!=strRef&&""!=strRef){if(null!=htStartsWith){if(null!=htStartsWith[strRef]){SBGrid.UT.XmlLib.createChildWithValue(xnNewRow,strRef,htStartsWith[strRef]);continue}}SBGrid.UT.XmlLib.createChild(xnNewRow,strRef)}}}}if(this.m_objScroll.nMaxLength<=this.m_nMakeIndex){this.m_objScroll.bScrollEvent=true;this.m_objScroll.nEndRow++;if(null==this.m_objScroll.arTargetRow||this.m_nRealRows!=this.m_objScroll.arTargetRow.length){this.m_objScroll.arTargetRow=new Array();for(var i=0;i<this.m_nRealRows;i++){if(this.m_arHiddenRowState[i]==true){continue}this.m_objScroll.arTargetRow.push(i)}this.m_objScroll.arTargetRow.push(this.m_nRealRows)}else{this.m_objScroll.arTargetRow.push(this.m_nRealRows)}}else{this.m_objScroll.bScrollEvent=false;this.m_objScroll.nBottomRow++;this.m_objScroll.nTargetHeight+=this.dataHeight;this.m_nMakeIndex++}var bFirstNode=true;var nFFBRowPosition=this.m_nRealRows-this.frozenBottomRows;if(this.m_nRealRows>=(this.fixedRows+this.frozenRows+this.frozenBottomRows)&&this.frozenBottomRows>0){if(!this.m_objScroll.bScrollEvent){this.physicalRemovePartRow(nFFBRowPosition,nFFBRowPosition)}}if(this.rows==this.m_nRealRows){this.rows++}this.m_nRealRows++;this.m_htRowHeight[this.m_nRealRows-1]=this.dataHeight;this.m_xlRefNode=this.getControlNodeList();this.makeScrollDiv(this.m_heGridScrollDivCell,true);if(null!=this.m_heFFC){this.makeScrollDiv(this.m_heFFGridScrollDivCell,false)}if(this.m_nRealRows>(this.fixedRows+this.frozenRows+this.frozenBottomRows)&&this.frozenBottomRows>0){var objCell;for(var i=0;i<this.cols;i++){objCell=this.getCellEx(nFFBRowPosition,i);if(null!=objCell){if(this.m_objScroll.bScrollEvent){objCell.attribute["background-color"]=null}else{this.physicalCreateCell(nFFBRowPosition,i,bFirstNode,objCell.m_bIsSubTotal,true)}bFirstNode=false}}if(!this.m_objScroll.bScrollEvent){for(var i=0;i<this.cols;i++){objCell=this.getCellEx(nFFBRowPosition,i);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}if(null!=objCell){this.setRowStatus(nFFBRowPosition,objCell.rowstatus)}}for(var i=0;i<this.cols;i++){if(this.m_objScroll.bScrollEvent){var objColumn=this.m_arColumn[i];var strColumnRef=objColumn.getAttribute("ref");if(this.isJsonRef()){jsonRowData=this.m_xlRefNode[this.m_nRealRows-1-this.fixedRows]}else{xnRowData=this.m_xlRefNode.item(this.m_nRealRows-1-this.fixedRows)}var strCellId=this.id+"_"+(this.m_nRealRows-1)+"_"+i;if(i<this.fixedCols){var objCell=this.getCellByIdEx(strCellId);if(null!=objCell&&strCellId!=objCell.id){objCell=null}objCell=null==objCell?new SBGrid.CT.DataGridCell(this,i,strCellId,this.m_nRealRows-1,"softbowl:cell"):objCell;objCell.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(objCell,objColumn.m_bMerge)}else{var xnCell=null;var jsonCell=null;if(this.isJsonRef()){jsonCell=jsonRowData}else{xnCell=SBGrid.UT.XmlLib.selectSingleNode(xnRowData,strColumnRef)}var objCell=this.getCellByIdEx(strCellId);if(null!=objCell&&strCellId!=objCell.id){objCell=null}objCell=null==objCell||strCellId!=objCell.id?new SBGrid.CT.DataGridCell(this,i,strCellId,this.m_nRealRows-1,"softbowl:cell"):objCell;objCell.setElement(objColumn);this.setLinkedData(objCell,xnCell,jsonCell);SBGrid.CF.GridSetMergeType(objCell,objColumn.m_bMerge)}}else{this.physicalCreateCell(this.m_nRealRows-1,i,false,bNotAddNode)}}if(!this.m_objScroll.bScrollEvent){for(var i=0;i<this.cols;i++){var objCell=this.getCellEx(this.m_nRealRows-1,i);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}this.m_objScroll.arTargetRow.push(this.m_nRealRows-1)}else{this.setTableMatrix(this.m_objScroll.nTopRow,this.m_objScroll.nBottomRow);this.scrollingGrid();this.m_heFFBS.removeChild(this.m_heFFBS.firstChild);this.m_heFFBNS.removeChild(this.m_heFFBNS.firstChild);this.m_heFFBS=this.makeFixedFrozenBottomScrollingRow();this.m_heFFBNS=this.makeFixedFrozenBottomNoScrollingRow()}if(this.m_nRealRows>(this.fixedRows+this.frozenRows)&&this.frozenBottomRows>0&&!this.m_objScroll.bScrollEvent){this.m_nBottomRowCount++}if(bRefresh){this.refreshCurrentModel(this.attribute.ref)}if(!bNotAddNode){this.defaultAttributeSetting();for(var i=0;i<this.cols;i++){var objCell=this.getCellEx(this.m_nRealRows-1,i);if(null!=objCell){objCell.m_bUserAddCell=true;if(!bPreserveStatus){objCell.setEditingMode(true)}}}if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){this.selectRow(this.m_nRealRows-1)}this.setRowValue(this.m_nRealRows-1);this.setRowStatus(this.m_nRealRows-1,SBGrid.DEF.SBGS_NEW|SBGrid.DEF.SBGS_INSERT);this.setSeqForRowHeader()}if(this.m_mapColStyleInfo.count()>0){this.m_mapGridStyleInfo.add((this.m_nRealRows-1).toString(),(new SBGrid.DS.Map()));var mapRowStyleInfo=this.m_mapGridStyleInfo.find((this.m_nRealRows-1).toString());var arrColIndexList=this.m_mapColStyleInfo.keys();arrColIndexList.sort(SBGrid.DEF.numberASC);for(var k=0,nColIndexListLength=arrColIndexList.length;k<nColIndexListLength;k++){var objColStyleInfo=this.m_mapColStyleInfo.find(arrColIndexList[k]);var arrStyleList=SBGrid.DEF.getPropertyNameList(objColStyleInfo.style);if(objColStyleInfo.type=="fixed"||objColStyleInfo.type=="all"){if(this.m_nRealRows-1<this.fixedRows){mapRowStyleInfo.add(arrColIndexList[k],SBGrid.DEF.__deepCopy(objColStyleInfo.style))}}if(objColStyleInfo.type=="data"||objColStyleInfo.type=="all"){if(this.m_nRealRows-1>=this.fixedRows){mapRowStyleInfo.add(arrColIndexList[k],SBGrid.DEF.__deepCopy(objColStyleInfo.style))}}}}};SBGrid.CT.DataGrid.prototype.RemoveRowHasInstance=function(bRefresh,bNotDeleteNode){this.stopEditing();this.clearSelection();this.clearMerge();if(this.fixedRows==this.m_nRealRows){return}if(!bNotDeleteNode){var objRemoveFcell=this.getCellEx(this.m_nRealRows-1,0);if(!objRemoveFcell.m_bUserAddCell){var strColSep=this.attribute.colsep;var strRowSep=this.attribute.rowsep;var strData="d"+strColSep+"-1";var nRowHeader=this.m_bRowHeader?1:0;for(var i=0+nRowHeader;i<this.cols;i++){strData+=strColSep;strData+=SBGrid.CF.GridGetText(this.getCellEx(this.m_nRealRows-1,i))}if(this.m_bIsRealDataSync){for(var i=0,nExtRefListLength=this.m_arExtRefList.length;i<nExtRefListLength;i++){strData+=strColSep;var strExtensionRefData=this.m_xlRefNode[(this.m_nRealRows-1)-this.fixedRows][this.m_arExtRefList[i]];strData+=(strExtensionRefData==undefined?"":strExtensionRefData.toString())}}strData+=strRowSep;this.m_arUpdateDeleteList.push(strData)}var xnNodeset;var xnNodeItem;var objRemoveTargetCell=this.getCellEx(this.m_nRealRows-1,this.fixedCols);if(this.isJsonRef()){if(null!=objRemoveTargetCell){eval("SBGrid.DEF.arrRemoveAt("+this.jsonref+","+(this.m_nRealRows-1-this.fixedRows)+");")}}else{xnNodeset=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset);xnNodeItem=xnNodeset.item(0).parentNode;if(null!=objRemoveTargetCell){try{xnNodeItem.removeChild(xnNodeset.item(this.m_nRealRows-1-this.fixedRows))}catch(e){if(null!=window.console){}}}}}var nScrollMaxLen=this.m_objScroll.nMaxLength;if(nScrollMaxLen<=this.m_nMakeIndex&&nScrollMaxLen<this.m_nRealRows-this.m_nBottomRowCount){this.m_objScroll.bScrollEvent=true;this.m_objScroll.nEndRow--}else{this.m_objScroll.bScrollEvent=false;this.m_objScroll.nBottomRow--;this.m_objScroll.nTargetHeight-=this.dataHeight;this.m_nMakeIndex--}this.m_htRowHeight[this.m_nRealRows-1]=null;this.m_xlRefNode=this.getControlNodeList();this.makeScrollDiv(this.m_heGridScrollDivCell,true);if(null!=this.m_heFFC){this.makeScrollDiv(this.m_heFFGridScrollDivCell,false)}if(!this.m_objScroll.bScrollEvent){this.physicalRemovePartRow(this.m_nRealRows-1,this.m_nRealRows-1)}var bFirstNode=true;var nShiftRow;if(this.m_nRealRows>(this.fixedRows+this.frozenRows+this.frozenBottomRows)&&this.frozenBottomRows>0){nShiftRow=this.m_nRealRows-this.frozenBottomRows-1;if(!this.m_objScroll.bScrollEvent){this.physicalRemovePartRow(nShiftRow,nShiftRow)}}if(this.rows==this.m_nRealRows){this.rows--}this.m_nRealRows--;this.m_objScroll.arTargetRow.pop();if(this.m_nRealRows>=(this.fixedRows+this.frozenRows+this.frozenBottomRows)&&this.frozenBottomRows>0){var objCell;var nTempData=this.m_nBottomRowCount;this.m_nBottomRowCount=0;for(var i=0;i<this.cols;i++){objCell=this.getCellEx(nShiftRow,i);if(null!=objCell){if(this.m_objScroll.bScrollEvent){objCell.attribute["background-color"]=null}else{this.physicalCreateCell(nShiftRow,i,bFirstNode,objCell.m_bIsSubTotal,true)}bFirstNode=false}}this.m_nBottomRowCount=nTempData+1;if(!this.m_objScroll.bScrollEvent){for(var i=0;i<this.cols;i++){objCell=this.getCellEx(nShiftRow,i);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}if(null!=objCell){this.setRowStatus(nShiftRow,objCell.rowstatus)}}if(!this.m_objScroll.bScrollEvent){for(var i=0;i<this.cols;i++){var objCell=this.getCellEx(this.m_nRealRows-1,i);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}else{this.scrollingGrid();this.m_heFFBS.removeChild(this.m_heFFBS.firstChild);this.m_heFFBNS.removeChild(this.m_heFFBNS.firstChild);this.m_heFFBS=this.makeFixedFrozenBottomScrollingRow();this.m_heFFBNS=this.makeFixedFrozenBottomNoScrollingRow()}this.m_mapGridStyleInfo.remove((this.m_nRealRows-1).toString());this.rows=this.m_nRealRows;if(bRefresh){this.refreshCurrentModel(this.attribute.ref)}if(!bNotDeleteNode){this.setSeqForRowHeader()}if(this.autoMerge){this.merge()}if(this.m_bIsMergeByFree){this.reMergeByFree()}};SBGrid.CT.DataGrid.prototype.RemoveColumnHasInstance=function(b){this.stopEditing();if(0==this.m_arColumn.length){return}this.clearSelection();this.clearMerge();this.children.remove(this.m_arColumn[this.cols-1].id);SBGrid.DEF.__removeAll(this.m_arColumn[this.cols-1].id);this.setColGroupRemoveCol();this.m_arColumn[this.cols-1]=null;this.m_arColumn.pop();this.m_arColWidth.pop();this.m_arHiddenCol.pop();this.cols--;this.colWidthReset();if(null!=this.m_arCaption[0][this.cols-1]){for(var a=0;a<this.m_arCaption.length;a++){this.m_arCaption[a].pop()}}this.captionReset();for(var a=0;a<this.m_nRealRows;a++){this.physicalRemoveCell(a,this.cols)}if(b){this.refreshCurrentModel(this.attribute.ref)}if(this.autoMerge){this.merge()}if(this.m_bIsMergeByFree){this.reMergeByFree()}};SBGrid.CT.DataGrid.prototype.captionReset=function(){var a=(this.m_bRowHeader)?1:0;this.attribute.caption="";for(var c=0;c<this.m_arCaption.length;c++){if(c>0){this.attribute.caption+="|"}for(var b=a;b<this.m_arCaption[c].length;b++){this.attribute.caption+=this.m_arCaption[c][b];if((b+1)<this.m_arCaption[c].length){this.attribute.caption+="^"}}}this.caption=this.attribute.caption};SBGrid.CT.DataGrid.prototype.colWidthReset=function(){var a=(this.m_bRowHeader)?1:0;var c=0;if(1==a){c+=this.m_arColWidth[0]}this.attribute.colwidth="";for(var b=a;b<this.m_arColWidth.length;b++){this.attribute.colwidth+=this.m_arColWidth[b];c+=this.m_arColWidth[b];if((b+1)<this.m_arColWidth.length){this.attribute.colwidth+=","}}this.setTableWidthChange(c)};SBGrid.CT.DataGrid.prototype.isChangedItem=function(){return this.m_bChangedItem};SBGrid.CT.DataGrid.prototype.setChangedItem=function(a){this.m_bChangedItem=a};SBGrid.CT.DataGrid.prototype.getBindingType=function(){return SBGrid.DEF.SB_MULTIPLE};SBGrid.CT.DataGrid.prototype.defaultAction=function(b,a){SBGrid.CT.Group.prototype.defaultAction.call(this,b,a);switch(b){case"onbeforeedit":this.onBeforeEdit(a);break;case"onstartedit":this.onStartEdit(a);break;case"onentercell":this.onEnterCell(a);break;case"onleavecell":this.onLeaveCell(a);break;case"onafteredit":this.onAfterEdit(a);break;case"onbeforeuserresize":this.onBeforeUserResize(a);break;case"onafteruserresize":this.onAfterUserResize(a);break;case"onbeforemovecolumn":this.onBeforeMoveColumn(a);break;case"onaftermovecolumn":this.onAfterMoveColumn(a);break;case"onimestart":this.onImeStart(a);break;case"onspinupbuttonclick":this.onSpinUpButtonClick(a);break;case"onspindownbuttonclick":this.onSpinDownButtonClick(a);break;case"onresize":this.onResize(a);break;case"oncopy":this.onCopy(a);break;case"onpaste":this.onPaste(a);break;case"onbeforeprevious":this.onbeforePrevious(a);break;case"onbeforenext":this.onbeforeNext(a);break;case"onrowchanged":this.onRowChanged(a);break;case"onselectedcells":this.onSelectedCells(a);break}};SBGrid.CT.DataGrid.prototype.initGridProperties=function(){this.col=-1;this.row=-1;this.m_nEditRow=-1;this.m_nEditCol=-1;this.m_nPrevDownRow=-1;this.m_nPrevDownCol=-1;this.m_nDownRow=-1;this.m_nDownCol=-1;this.cols=this.m_arColumn.length;if(this.fixedCols>this.cols){this.fixedCols=this.cols}if(this.frozenCols>this.cols){this.frozenCols=this.cols}var strCaptions=this.attribute.caption;var arCaptionRow=strCaptions.split("|");this.m_arCaption=new Array();for(var i=0;i<arCaptionRow.length;i++){this.m_arCaption[i]=new Array();var strCaptionRow=arCaptionRow[i];var arCaptionCol=strCaptionRow.split("^");if(this.m_bRowHeader){this.m_arCaption[i][0]=" "}for(var j=0;j<arCaptionCol.length&&j<this.cols;j++){this.m_arCaption[i][(this.m_bRowHeader)?j+1:j]=arCaptionCol[j]}}var nBeforeFixedRows=this.fixedRows;this.fixedRows=""!=strCaptions||this.m_bRowHeader?this.m_arCaption.length:0;if(nBeforeFixedRows!=this.fixedRows){this.m_bChangeFixedRows=true}if(this.m_bRowHeader&&(0==this.fixedCols)){this.fixedCols=1}if(0==this.m_arColWidth.length){if(this.m_bRowHeader){if(null==this.m_arColWidth[0]){this.m_arColWidth[0]=20;this.m_arHiddenCol[0]=20}}var strColWidth=this.attribute.colwidth;if(null==strColWidth||strColWidth.isEmpty()){for(var i=0;i<this.cols;i++){var nIndex=(this.m_bRowHeader)?i+1:i;if(null!=this.m_arColumn[nIndex]){if(this.m_arColumn[nIndex].visible){this.m_arColWidth[nIndex]=100}else{this.m_arColWidth[nIndex]=0;this.m_arColumn[nIndex].m_bHiddenState=true}this.m_arHiddenCol[nIndex]=100}}}else{if(strColWidth.indexOf("%")!=-1){this.m_bIsUsePercentOfColWidth=true;strColWidth=strColWidth.replace(/%/g,"")}else{this.m_bIsUsePercentOfColWidth=false}var arColumnWidth=strColWidth.split(",");var nGridHeight=Number(jQuery("#SBHE_"+this.id).css("height").replace("px",""));var nGridWidth=Number(jQuery("#SBHE_"+this.id).css("width").replace("px",""));if(isNaN(nGridHeight)){nGridHeight=Number(jQuery("#SBHE_"+this.id).innerHeight())}if(isNaN(nGridWidth)){nGridWidth=Number(jQuery("#SBHE_"+this.id).innerWidth())}var nDataCount=0;if(this.isJsonRef()){var objJSONtemp=eval(this.jsonref);if(objJSONtemp){nDataCount=eval(this.jsonref).length}objJSONtemp=null}else{}if(nGridHeight<=((this.dataHeight*nDataCount)+this.m_nRowHeight)){nGridWidth-=17}var nRowHeader=this.m_bRowHeader?1:0;if(this.m_bRowHeader){nGridWidth-=this.m_arColWidth[0]}for(var i=0;i<this.cols;i++){var nIndex=i+nRowHeader;if(null!=this.m_arColumn[nIndex]){if(this.m_arColumn[nIndex].visible){if(i<arColumnWidth.length&&arColumnWidth[i]!=""&&!isNaN(Number(arColumnWidth[i].trim()))){if(this.m_bIsUsePercentOfColWidth){this.m_arColWidth[nIndex]=nGridWidth*arColumnWidth[i]/100}else{this.m_arColWidth[nIndex]=Number(arColumnWidth[i].trim())}}else{this.m_arColWidth[nIndex]=100}this.m_arHiddenCol[nIndex]=this.m_arColWidth[nIndex]}else{if(i<arColumnWidth.length&&arColumnWidth[i]!=""&&!isNaN(Number(arColumnWidth[i].trim()))){if(this.m_bIsUsePercentOfColWidth){this.m_arColWidth[nIndex]=nGridWidth*arColumnWidth[i]/100}else{this.m_arHiddenCol[nIndex]=Number(arColumnWidth[i].trim())}}else{this.m_arHiddenCol[nIndex]=100}this.m_arColWidth[nIndex]=0;this.m_arColumn[nIndex].m_bHiddenState=true}}}}}var nDataLength=0;if(this.m_xlRefNode){nDataLength=this.m_xlRefNode.length}if(this.attribute.frozenrows!=""){this.frozenRows=parseInt(this.attribute.frozenrows)}if(this.frozenRows>nDataLength+this.fixedRows){this.frozenRows=nDataLength+this.fixedRows}this.m_arCombo=new Array();var nComboCount=0;while(true){var objCombo=this.children.m_htCollection[this.id+"_combo_"+nComboCount];if(null!=objCombo){this.m_arCombo.push(objCombo)}else{break}nComboCount++}if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){this.m_arSelectRows=new Array()}else{if(SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){this.m_arSelectCols=new Array()}else{if(SBGrid.DEF.SBSM_FREE==this.getSelectionMode()){this.m_htSelectCells={}}}}if(!this.m_bIsRowHeight&&this.m_htFixedStyle&&this.m_htFixedStyle.height){this.m_nRowHeight=parseInt(this.m_htFixedStyle.height)}else{if(this.m_htFixedStyle&&this.m_htFixedStyle.height){this.m_htFixedStyle.height=this.m_nRowHeight+"px"}}if(this.m_htDataStyle&&this.m_htDataStyle.height){this.dataHeight=parseInt(this.m_htDataStyle.height)}};SBGrid.CT.DataGrid.prototype.hasInstance=function(){return("xml"==this.getAttribute("datatype"))};SBGrid.CT.DataGrid.prototype.appendColumn=function(a){this.m_arColumn.push(a)};SBGrid.CT.DataGrid.prototype.createColumns=function(objJson){if(arguments.length!=1){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(!(objJson instanceof Array)){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if parameter type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}else{if(objJson.length<=0){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if parameter array's length is 0.",SBGrid.DEF.DEBUG_MODE);return}else{var strId;if(this.m_bRowHeader){strId=this.id+"_col__0";var objGridCol=new SBGrid.CT.GridCol(this.id,true,true,"","","",1,false,false,true,true,"","","",strId,"",-1,true,"","",-1,-1,"default","","",0,1,"auto",-1,"",-1,"",false,"",false,"","softbowl:col",this.attribute.rowheader,"","","","","","","","","",false,"visible","","","",false,false,"");this.appendColumn(objGridCol)}for(var i=0;i<(objJson.length);i++){if(!(objJson[i].id)){objJson[i].id=this.id+"_col__"+(i+(this.m_bRowHeader?1:0))}else{if((typeof objJson[i].id)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'id' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}objJson[i].id=this.id+"_"+objJson[i].id}if(objJson[i].allowUserResizeWidth==undefined){objJson[i].allowUserResizeWidth=true}else{if((typeof objJson[i].allowUserResizeWidth)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'allowUserResizeWidth' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].type)){objJson[i].type="output"}else{if((typeof objJson[i].type)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'type' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(objJson[i].type=="image"){this.bExistImageType=true}}if(!(objJson[i].ref)){objJson[i].ref=""}else{if((typeof objJson[i].ref)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'ref' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].style)){objJson[i].style=""}else{if((typeof objJson[i].style)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'style' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].format)){objJson[i].format=""}else{if((typeof objJson[i].format)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'format' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].calc)){objJson[i].calc=""}else{if((typeof objJson[i].calc)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'calc' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].validate)){objJson[i].validate=""}else{if((typeof objJson[i].validate)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'validate' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].checkboxValidate)){objJson[i].checkboxValidate=""}else{if((typeof objJson[i].checkboxValidate)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'checkboxValidate' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(objJson[i].disabled==undefined){objJson[i].disabled=false}else{if((typeof objJson[i].disabled)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'disabled' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(objJson[i].textareaWidth==undefined){objJson[i].textareaWidth=0}else{if((typeof objJson[i].textareaWidth)!="number"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'textareaWidth' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(objJson[i].sortable==undefined){objJson[i].sortable=true}else{if((typeof objJson[i].sortable)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'sortable' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(objJson[i].bDataMerge==undefined){objJson[i].bDataMerge=true}else{if((typeof objJson[i].bDataMerge)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'bDataMerge' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(objJson[i].bIsColHidden==undefined){objJson[i].bIsColHidden=false}else{if((typeof objJson[i].bIsColHidden)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'bIsColHidden' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].maxlength)){objJson[i].maxlength=-1}else{if((typeof objJson[i].maxlength)!="number"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'maxlength' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(objJson[i].autonext==undefined){objJson[i].autonext=true}else{if((typeof objJson[i].autonext)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'autonext' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].checkvalue)){objJson[i].checkvalue="true,false"}else{if((typeof objJson[i].checkvalue)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'checkvalue' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].editable)){if(objJson[i].editable==undefined){objJson[i].editable=true}else{if((typeof objJson[i].editable)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'editable' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}}if(!(objJson[i].bIsColContext)){if(objJson[i].bIsColContext==undefined){objJson[i].bIsColContext=true}else{if((typeof objJson[i].bIsColContext)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'bIsColContext' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}}if(!(objJson[i].editmode)){objJson[i].editmode=""}else{if((typeof objJson[i].editmode)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'editmode' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(objJson[i].imageUri==null||objJson[i].imageUri=="undefined"){objJson[i].imageUri=""}if(objJson[i].imageWidth==null||objJson[i].imageWidth=="undefined"){objJson[i].imageWidth="100%"}if(objJson[i].imageHeight==null||objJson[i].imageHeight=="undefined"){objJson[i].imageHeight="100%"}if(objJson[i].imageStyle==null||objJson[i].imageStyle=="undefined"){objJson[i].imageStyle=""}if(objJson[i].imageAlt==null||objJson[i].imageAlt=="undefined"){objJson[i].imageAlt=""}if(objJson[i].type=="combo"){if(!(objJson[i].strNodeSet)){objJson[i].strNodeSet=""}else{if((typeof objJson[i].strNodeSet)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'strNodeSet' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].strJsonNodeSet)){objJson[i].strJsonNodeSet=""}else{if((typeof objJson[i].strJsonNodeSet)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'strJsonNodeSet' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(objJson[i].strNodeSet==""&&objJson[i].strJsonNodeSet==""){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check 'strNodeSet' and 'strJsonNodeSet' property's value is null.",SBGrid.DEF.DEBUG_MODE)}else{if((typeof objJson[i].strNodeSet)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'strNodeSet' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].strLabelRef)){objJson[i].strLabelRef=""}else{if((typeof objJson[i].strLabelRef)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'strLabelRef' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].strValueRef)){objJson[i].strValueRef=""}else{if((typeof objJson[i].strValueRef)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'strValueRef' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}}if(!(objJson[i].roundMode)){objJson[i].roundMode=""}else{if((typeof objJson[i].roundMode)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'roundMode' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].roundPosition)){objJson[i].roundPosition=0}else{if((typeof objJson[i].roundPosition)!="number"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'roundPosition' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].secretMark)){objJson[i].secretMark="*"}else{if((typeof objJson[i].secretMark)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'secretMark' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].secretStartPosition)){objJson[i].secretStartPosition=-1}else{if((typeof objJson[i].secretStartPosition)!="number"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'secretStartPosition' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].secretEndPosition)){objJson[i].secretEndPosition=-1}else{if((typeof objJson[i].secretEndPosition)!="number"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'secretEndPosition' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].title)||(objJson[i].type!="input"&&objJson[i].type!="combo")){objJson[i].title=""}else{if((objJson[i].title)&&((typeof objJson[i].title)!="string")){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'title' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(objJson[i].bSkipAutoResize==undefined){objJson[i].bSkipAutoResize=false}else{if((typeof objJson[i].bSkipAutoResize)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'bSkipAutoResize' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}}var arComboIdList=new Array();for(var i=0;i<(objJson.length);i++){var objGridCol=new SBGrid.CT.GridCol(this.id,objJson[i].allowUserResizeWidth,objJson[i].autonext,"",objJson[i].checkvalue,"",1,objJson[i].disabled,objJson[i].sortable,objJson[i].editable,true,objJson[i].editmode,"",objJson[i].format,objJson[i].id,"",-1,true,"","",-1,objJson[i].maxlength,"default",objJson[i].ref,objJson[i].roundMode,objJson[i].roundPosition,1,"auto",objJson[i].secretEndPosition,objJson[i].secretMark,objJson[i].secretStartPosition,"",false,"",false,objJson[i].style,"softbowl:col",objJson[i].type,objJson[i].imageUri,objJson[i].imageWidth,objJson[i].imageHeight,objJson[i].imageStyle,objJson[i].imageClick,objJson[i].imageAlt,objJson[i].title,"","",false,"visible",objJson[i].calc,objJson[i].validate,"",objJson[i].bDataMerge,objJson[i].bIsColHidden,objJson[i].checkboxValidate,objJson[i].textareaWidth,objJson[i].bSkipAutoResize,objJson[i].bIsColContext,objJson[i].strNodeSet,objJson[i].strJsonNodeSet,objJson[i].strLabelRef,objJson[i].strValueRef);if(objJson[i].renderer){objGridCol.m_fnRenderer=objJson[i].renderer}if(objJson[i].afterRenderer){objGridCol.m_fnAfterRenderer=objJson[i].afterRenderer}if(objJson[i].fixedRenderer){objGridCol.m_fnFixedRenderer=objJson[i].fixedRenderer}this.appendColumn(objGridCol);if(objJson[i].type=="combo"){if(objJson[i].bIsComboFiltering==undefined){objJson[i].bIsComboFiltering=false}if(objJson[i].arrComboFilteringInfoList==undefined){objJson[i].arrComboFilteringInfoList=[]}var strComboId=this.GenerateID(this.id+"_combo_");var objCombo=new SBGrid.CT.GridCombo(this.id,"","","","","","","","1","acrossdown",false,false,false,false,objJson[i].editmode,strComboId,20,"","",9007199254740992,"","","","","*","","",null,false,"","softbowl:select1","","visible",0,true,objJson[i].strNodeSet,objJson[i].strJsonNodeSet,objJson[i].strLabelRef,objJson[i].strValueRef,"minimal","","",null,null,objJson[i].id,objJson[i].bIsComboFiltering,objJson[i].arrComboFilteringInfoList);eval("SBGrid.DEF."+objCombo.id+"=objCombo");arComboIdList.push(objCombo.id)}else{arComboIdList.push("")}}this.init();for(var i=0,j=arComboIdList.length;i<j;i++){if(arComboIdList[i]!=""){document.getElementById("SBHE_"+arComboIdList[i]+"_input").setAttribute("title",objJson[i].title);this.m_strComboId=arComboIdList[i]}}this.refresh(true);this.m_bNotRunAutoResize=false;this.scrollingGrid(true,false,false);if(this.getAttribute("ready")!=""){var strReady=this.getAttribute("ready");if(""!=strReady){var strReadyName=strReady.substring(0,strReady.indexOf("("));var strReadyParam="(this.id);";strReady=strReadyName+strReadyParam;eval(strReady)}}if(this.getAttribute("gridready")!=""){var strGridReady=this.getAttribute("gridready");if(""!=strGridReady){var strGridReadyName=strGridReady.substring(0,strGridReady.indexOf("("));var strGridReadyParam="(this.id);";strGridReady=strGridReadyName+strGridReadyParam;eval(strGridReady)}}}}};SBGrid.CT.DataGrid.prototype.getFixedFrozenColWidth=function(){var a=0;for(var b=0;b<(this.fixedCols+this.frozenCols);b++){a+=this.m_arColWidth[b]}a=parseInt(a);return a};SBGrid.CT.DataGrid.prototype.getFixedFrozenRowHeight=function(){var a=0;for(var b=0;b<(this.fixedRows+this.frozenRows);b++){if(this.m_htRowHeight[b]){a+=this.m_htRowHeight[b]}}return a};SBGrid.CT.DataGrid.prototype.getFrozenBottomRowHeight=function(){var a=0;for(var b=this.m_nRealRows-this.frozenBottomRows;b<this.m_nRealRows;b++){if(this.m_htRowHeight[b]){a+=this.m_htRowHeight[b]}}return a};SBGrid.CT.DataGrid.prototype.getAllowSelection=function(){return this.allowSelection};SBGrid.CT.DataGrid.prototype.getAllowBigSelection=function(){return this.allowBigSelection};SBGrid.CT.DataGrid.prototype.getSelectionMode=function(){var a=this.getAttribute("selectionmode");switch(a){case"listbox":return SBGrid.DEF.SBSM_LIST;case"byrow":return SBGrid.DEF.SBSM_BYROW;case"bycol":return SBGrid.DEF.SBSM_BYCOL;case"free":return SBGrid.DEF.SBSM_FREE;case"none":return SBGrid.DEF.SBSM_NONE;default:return SBGrid.DEF.SBSM_LIST}};SBGrid.CT.DataGrid.prototype.setSelectionMode=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setSelectionMode","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setSelectionMode","Please check if parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(a=="listbox"||a=="byrow"||a=="bycol"||a=="free"){if(this.getAttribute("selectionmode")!=a){this.setAttribute("selectionmode",a);if(a=="bycol"){this.m_arSelectCols=new Array()}this.rebuild()}}else{if(this.getAttribute("selectionmode")!="listbox"){this.setAttribute("selectionmode","listbox");this.rebuild()}}};SBGrid.CT.DataGrid.prototype.isEditing=function(){return this.m_bEditing};SBGrid.CT.DataGrid.prototype.getEditRow=function(){return this.m_nEditRow};SBGrid.CT.DataGrid.prototype.getEditCol=function(){return this.m_nEditCol};SBGrid.CT.DataGrid.prototype.getRow=function(){return this.row};SBGrid.CT.DataGrid.prototype.setRowValue=function(a){this.row=a};SBGrid.CT.DataGrid.prototype.setRow=function(c){if(c>=this.m_nRealRows||c<-1){return}this.row=c;this.clearSelection();var b=this.getSelectionMode();if(c>=this.fixedRows){if(SBGrid.DEF.SBSM_LIST==b||SBGrid.DEF.SBSM_BYROW==b){this.selectRow(c)}else{if(SBGrid.DEF.SBSM_FREE==b){var a=this.getCellEx(c,this.col);if(null!=a){this.addSelCells(c,this.col,a)}a=null}}}if(this.col>=this.fixedCols){if(SBGrid.DEF.SBSM_BYCOL==b){this.selectCol(this.col)}}};SBGrid.CT.DataGrid.prototype.getCol=function(){return this.col};SBGrid.CT.DataGrid.prototype.setColValue=function(a){this.col=a};SBGrid.CT.DataGrid.prototype.setCol=function(c){if(c>=this.cols||c<-1){return}this.col=c;this.clearSelection();var b=this.getSelectionMode();if(c>=this.fixedCols){if(SBGrid.DEF.SBSM_BYCOL==b){this.selectCol(c)}else{if(SBGrid.DEF.SBSM_FREE==b){var a=this.getCellEx(this.row,c);if(null!=a){this.addSelCells(this.row,c,a)}a=null}}}if(this.row>=this.fixedRows){if(SBGrid.DEF.SBSM_LIST==b||SBGrid.DEF.SBSM_BYROW==b){this.selectRow(this.row)}}};SBGrid.CT.DataGrid.prototype.getMouseRow=function(){return parseInt(this.getAttribute("row"))};SBGrid.CT.DataGrid.prototype.setMouseRow=function(a){this.setAttribute("row",String(a))};SBGrid.CT.DataGrid.prototype.getMouseCol=function(){return parseInt(this.getAttribute("col"))};SBGrid.CT.DataGrid.prototype.getClickedRow=function(){return this.m_nDownRow};SBGrid.CT.DataGrid.prototype.getClickedCol=function(){return this.m_nDownCol};SBGrid.CT.DataGrid.prototype.setColType=function(l,c){if((null==l||null==c)||(0>l||this.cols<=l)){return}var b=this.m_arColumn[l];var d;var m=this.m_replaceString;if(m!=""&&m!="undefined"&&m!=null){d=m.split("?")}if(null!=b){var g;switch(c){case"output":case"input":case"radio":case"checkbox":case"inputbutton":case"outputbutton":case"inputdate":case"combo":if(b.getAttribute("type")==c){return}else{g=b.getAttribute("type");b.setAttribute("type",c);b.init()}break;default:return}this.stopEditing();this.clearSelection();var n=this.m_arColWidth[l];var a=true;if(("output"==c&&"input"==g)||("input"==c&&"output"==g)||("radio"==c&&"checkbox"==g)||("checkbox"==c&&"radio"==g)||("inputbutton"==c&&("inputdate"==g||"outputbutton"==g))||("inputdate"==c&&("inputbutton"==g||"outputbutton"==g))||("outputbutton"==c&&("inputdate"==g||"inputbutton"==g))||("outputbutton"==c&&("inputbutton"==g||"inputdate"==g))){a=false}for(var h=this.fixedRows;h<this.m_nRealRows;h++){var e=this.getCellEx(h,l);if(null!=e){if(a){if(("inputdate"==c||"inputbutton"==c)){e.m_heCtrl.vAlign="top"}else{e.m_heCtrl.vAlign="middle"}var f=b.makeCellElement(SBGrid.CF.GridGetText(e),n,e.id,e.attr);jQuery(e.m_heCtrl).html(f);if("checkbox"==c||"radio"==c){e.setAttribute("text-align","center")}SBGrid.CF.GridInit(e)}SBGrid.CF.GridSetTextRefresh(e,SBGrid.CF.GridGetText(e),d,this.m_bIsDataReplaceValueChanged)}}}};SBGrid.CT.DataGrid.prototype.valueMatrix=function(b,c){if(b>=this.rows||c>=this.cols){return""}var a=this.getCellEx(b,c);if(null!=a){if(this.isFixedCell(b,c)){return this.labelMatrix(b,c)}if(a.getNodeElement()||a.getJsonObject()){return SBGrid.CF.GridGetText(a)}else{return a.text}}return""};SBGrid.CT.DataGrid.prototype.sortedValueMatrix=function(a,b){if(a>=this.rows||b>=this.cols){return""}if(this.isFixedCell(a,b)){return this.labelMatrix(a,b)}else{if(this.m_bIsRealDataSync==false&&this.m_bIsSort){if(this.isJsonRef()){return this.m_arSortJson[a-this.fixedRows][b-this.fixedCols].Data[this.getRefOfCol(b)]}else{return SBGrid.DS.XMLStorage.getUniqueStorage().getValue(this.m_arSortNodeList[a-this.fixedRows][b-this.fixedCols].Data)}}else{return this.valueMatrix(a,b)}}return""};SBGrid.CT.DataGrid.prototype.setValueMatrix=function(c,e,d){if(c>=this.rows||e>=this.cols){return}var b=this.getCellEx(c,e);if(null!=b){d=String(d);if(this.m_bComboDataSync){var a=this.m_arColumn[e];if(a.m_objCombo&&a.m_objCombo.getComboLabel(d)==""){d=""}a=null}if(b.getNodeElement()||b.getJsonObject()){SBGrid.CF.GridSetText(b,d)}else{b.text=d}if(this.isFixedCell(c,e)){SBGrid.CF.GridSetFixedWindowText(b,d)}else{SBGrid.CF.GridSetTextRefresh(b,d)}}return};SBGrid.CT.DataGrid.prototype.tooltipText=function(b,c){var a=this.getCellEx(b,c);if(null!=a){if(null!=a.m_heCtrl.title){return a.m_heCtrl.title}}return""};SBGrid.CT.DataGrid.prototype.setTooltipText=function(b,d,c){var a=this.getCellEx(b,d);if(null!=a){a.m_heCtrl.title=c}};SBGrid.CT.DataGrid.prototype.sortClear=function(){this.m_htColSort={}};SBGrid.CT.DataGrid.prototype.colSort=function(a){switch(this.m_htColSort[a]){case SBGrid.DEF.SBST_ASC:return"asc";break;case SBGrid.DEF.SBST_DESC:return"desc";break;case SBGrid.DEF.SBST_NONE:return"none";break;default:return"none"}};SBGrid.CT.DataGrid.prototype.setColSort=function(d,c){if((null==d||null==c)||(0>d||this.cols<=d)){return}var a;switch(c){case"asc":a=SBGrid.DEF.SBST_ASC;break;case"desc":a=SBGrid.DEF.SBST_DESC;break;case"none":a=SBGrid.DEF.SBST_NONE;break;default:return}var b=this.m_arColumn[d];if(null!=b){this.m_htColSort[d]=a}};SBGrid.CT.DataGrid.prototype.setMouseCol=function(a){this.setAttribute("col",String(a))};SBGrid.CT.DataGrid.prototype.setCellComboNodeset=function(b,e,d){var a=this.getCellEx(b,e);var c=this.m_arColumn[e];if(null!=a&&null!=c){a.setAttribute("nodeset",d);c.m_bIsCellCombo=true}};SBGrid.CT.DataGrid.prototype.setCellComboJson=function(c,e,a){var b=this.getCellEx(c,e);var d=this.m_arColumn[e];if(null!=b&&null!=d){b.setAttribute("jsonnodeset",a);d.m_bIsCellCombo=true}};SBGrid.CT.DataGrid.prototype.getIsSortable=function(a){if(this.isSortable()==false){return false}else{return this.m_arColumn[a].getAttribute("sortable")}};SBGrid.CT.DataGrid.prototype.setIsSortable=function(b,a){if(this.isSortable()==false){this.m_arColumn[b].setAttribute("sortable",false)}else{return this.m_arColumn[b].setAttribute("sortable",a)}};SBGrid.CT.DataGrid.prototype.isSortable=function(){var b=this.getRowHeader()!=0?1:0;var a=false;switch(this.m_nExplorerBarType){case SBGrid.DEF.SBEB_SORT:case SBGrid.DEF.SBEB_SORT_SHOW:case SBGrid.DEF.SBEB_SORT_MOVE:case SBGrid.DEF.SBEB_SORT_SHOW_MOVE:a=true}if(a){if(this.isFixedCell(this.m_nDownRow,this.m_nDownCol)&&this.m_nDownCol>=b){return a}else{return false}}return a};SBGrid.CT.DataGrid.prototype.isPossibleFiltering=function(){var a=false;switch(this.m_nExplorerUIType){case SBGrid.DEF.SBEB_UI_FILTERING:case SBGrid.DEF.SBEB_UI_FILTERING_HIDE:case SBGrid.DEF.SBEB_UI_FILTERING_SHOW:case SBGrid.DEF.SBEB_UI_FILTERING_SHOW_HIDE_SHOW:a=true}return a};SBGrid.CT.DataGrid.prototype.isPossibleHideColumns=function(){var a=false;switch(this.m_nExplorerUIType){case SBGrid.DEF.SBEB_UI_HIDE:case SBGrid.DEF.SBEB_UI_FILTERING_HIDE:case SBGrid.DEF.SBEB_UI_HIDE_SHOW:case SBGrid.DEF.SBEB_UI_FILTERING_SHOW_HIDE_SHOW:a=true}return a};SBGrid.CT.DataGrid.prototype.isFixedCell=function(a,b){return((0<=a&&this.fixedRows>a)||(0<=b&&this.fixedCols>b))};SBGrid.CT.DataGrid.prototype.isFixedRow=function(a){return(0<=a&&this.fixedRows>a)};SBGrid.CT.DataGrid.prototype.isFixedCol=function(a){return(0<=a&&this.fixedCols>a)};SBGrid.CT.DataGrid.prototype.isFrozenCol=function(a){return((this.fixedCols<=a&&a<(this.fixedCols+this.frozenCols))||(a>=this.m_nRealCols))};SBGrid.CT.DataGrid.prototype.isFrozenRow=function(a){return((this.fixedRows<=a&&a<(this.fixedRows+this.frozenRows))||(a>=this.m_nRealRows-this.m_nBottomRowCount))};SBGrid.CT.DataGrid.prototype.isFrozenCell=function(a,b){return((this.fixedRows<=a)&&(this.fixedCols<=b))&&((a<(this.fixedRows+this.frozenRows))||(a>=this.m_nRealRows-this.m_nBottomRowCount)||(b<(this.fixedCols+this.frozenCols)))};SBGrid.CT.DataGrid.prototype.isNormalCell=function(a,b){if(-1==a||-1==b){return false}return(!this.isFixedCell(a,b))};SBGrid.CT.DataGrid.prototype.colCellGroup=function(h,e,b,f){var l=null;var m=0;var a=0;var c;if(-1!=h){while(true){var d=this.getCellEx(e,h);if(null!=d){if(d.m_bIsSubTotal){e++;continue}else{c=e;l=SBGrid.CF.GridGetText(d);if(null==f[a]){f[a]=new Array()}f[a][0]=c;f[a][1]=c+m;break}}}for(var g=e+1;g<=b;g++){d=this.getCellEx(g,h);if(null!=d&&!d.m_bIsSubTotal){if(l==SBGrid.CF.GridGetText(d)){m++;if(null==f[a]){f[a]=new Array()}f[a][0]=c;f[a][1]=c+m}else{l=SBGrid.CF.GridGetText(d);m=0;c=g;a++;if(null==f[a]){f[a]=new Array()}f[a][0]=c;f[a][1]=c+m}}else{m++}}}else{f[0]=new Array();f[0][0]=e;f[0][1]=b}};SBGrid.CT.DataGrid.prototype.colCellGroupArray=function(b,g,e,r){for(var l=1;l<b.length;l++){var c=new Array();var n=0;var m=b[l];if(-1==m){continue}var p=0;while(true){if(null==r[p]){break}var a=r[p][0];var o=r[p][1];var q=this.getCellEx(a,m);var f=SBGrid.CF.GridGetText(q);for(var h=a;h<=o;h++){var d=this.getCellEx(h,m);if(d.m_bIsSubTotal){continue}strCurrentRowValue=SBGrid.CF.GridGetText(d);if(null==c[n]){c[n]=new Array();c[n][0]=h}if(f!=strCurrentRowValue){f=strCurrentRowValue;n++;c[n]=new Array();c[n][0]=h;c[n][1]=h}else{c[n][1]=h}}n++;p++}r=c}return r};SBGrid.CT.DataGrid.prototype.sortEx=function(w,v,d,f){if(v>=d){return false}if(this.m_arColumn[w].getAttribute("sortable")==false){return false}if(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11){if(!this.m_objScroll.bScrollEvent){this.initGridCell(v,d)}}this.clearFiltering();var g,x=this.m_replaceString;if(x!=""&&x!="undefined"&&x!=null){g=x.split("?")}if(this.isJsonRef()){if(this.m_arSortJson){if(this.m_arSortJson.length<this.m_xlRefNode.length){this.m_bIsSort=false}}}else{if(this.m_arSortNodeList){if(this.m_arSortNodeList.length<this.m_xlRefNode.length){this.m_bIsSort=false}}}if(this.m_bIsSort){for(var r=0;r<this.m_xlRefNode.length;r++){var n=null;for(var q=this.fixedCols;q<this.cols;q++){n=this.getCellEx(r+this.fixedRows,q);if(null!=n){if(this.isJsonRef()){this.m_arSortJson[r][q].bIsSelect=n.selected}else{this.m_arSortNodeList[r][q].bIsSelect=n.selected}}}if(null!=n){if(this.isJsonRef()){this.m_arSortJson[r].splice(this.m_arSortJson[r].length-1,1,this.getRowStatus(r+this.fixedRows))}else{this.m_arSortNodeList[r].splice(this.m_arSortNodeList[r].length-1,1,this.getRowStatus(r+this.fixedRows))}}}}else{this.m_arSortNodeList=null;this.m_arSortJson=null;this.m_arSortNodeList=new Array();this.m_arSortJson=new Array();for(var r=0;r<this.m_xlRefNode.length;r++){this.m_arSortNodeList[r]=new Array();this.m_arSortJson[r]=new Array();for(var q=this.fixedCols;q<this.cols;q++){var n=this.getCellEx(r+this.fixedRows,q);var c=false;if(null!=n){c=n.selected}var h=this.m_arColumn[q].getAttribute("ref");if(this.isJsonRef()){var t=this.m_arColumn[q].getAttribute("ref");var l=new Object();l[t]=this.m_xlRefNode[r][t];this.m_arSortJson[r][q]={Row:(r),Data:l,bIsSelect:c}}else{this.m_arSortNodeList[r][q]={Row:(r),Data:SBGrid.UT.XmlLib.selectSingleNode(this.m_xlRefNode.item(r),h),bIsSelect:c}}}var n=this.getCellEx(r+this.fixedRows,w);if(null!=n){if(this.isJsonRef()){this.m_arSortJson[r].push(this.getRowStatus(r+this.fixedRows))}else{this.m_arSortNodeList[r].push(this.getRowStatus(r+this.fixedRows))}}else{if(this.isJsonRef()){this.m_arSortJson[r].push(SBGrid.DEF.SBGS_NEW)}else{this.m_arSortNodeList[r].push(SBGrid.DEF.SBGS_NEW)}}}}var u=this.getSelectionMode();if(SBGrid.DEF.SBSM_LIST==u||SBGrid.DEF.SBSM_BYROW==u||SBGrid.DEF.SBSM_FREE==u){this.clearSelection()}var s=v-this.fixedRows;var o=d-this.fixedRows;var y;if(this.isJsonRef()){y=this.m_arSortJson.slice(s,o+1);this.m_arSortJson.splice(s,o-s+1)}else{y=this.m_arSortNodeList.slice(s,o+1);this.m_arSortNodeList.splice(s,o-s+1)}var e=false;var b=new Array();for(var r=0;r<y.length;r++){b[r]=new Array();var m;if(this.isJsonRef()){m=y[r][w].Data[this.m_arColumn[w].getAttribute("ref")]+""}else{m=SBGrid.DS.XMLStorage.getUniqueStorage().getValue(y[r][w].Data)}if(isFinite(m)){m=Number(m)}else{e=true}b[r][0]=m;b[r][1]=r}if(e){b.sort()}else{b.sort(SBGrid.DEF.numberorder)}this.m_strSortIconStatus="up";if(f==SBGrid.DEF.SBST_DESC){b.reverse();this.m_strSortIconStatus="down"}var a=s;for(var r=0;r<y.length;r++){if(this.isJsonRef()){this.m_arSortJson.splice(a,0,y[b[r][1]])}else{this.m_arSortNodeList.splice(a,0,y[b[r][1]])}a++}for(var r=this.fixedRows;r<this.m_nRealRows;r++){var p=false;for(var q=this.fixedCols;q<this.cols;q++){var n=this.getCellEx(r,q);if(null!=n){if(this.isJsonRef()){n.setJsonObject(this.m_arSortJson[r-this.fixedRows][q].Data)}else{n.setNodeElement(this.m_arSortNodeList[r-this.fixedRows][q].Data)}SBGrid.CF.GridSetTextRefresh(n,SBGrid.CF.GridGetText(n),g,this.m_bIsDataReplaceValueChanged);if(SBGrid.DEF.SBSM_FREE==u){if(this.isJsonRef()){if(this.m_arSortJson[r-this.fixedRows][q].bIsSelect){this.addSelCells(r,q,n)}}else{if(this.m_arSortNodeList[r-this.fixedRows][q].bIsSelect){this.addSelCells(r,q,n)}}}p=true}}if(p){if(SBGrid.DEF.SBSM_LIST==u||SBGrid.DEF.SBSM_BYROW==u){if(this.isJsonRef()){if(this.m_arSortJson[r-this.fixedRows][this.fixedCols].bIsSelect){this.selectRow(r)}}else{if(this.m_arSortNodeList[r-this.fixedRows][this.fixedCols].bIsSelect){this.selectRow(r)}}}if(this.isJsonRef()){if(null!=this.m_arSortJson[r-this.fixedRows][q]){this.setRowStatus(r,this.m_arSortJson[r-this.fixedRows][q])}}else{if(null!=this.m_arSortNodeList[r-this.fixedRows][q]){this.setRowStatus(r,this.m_arSortNodeList[r-this.fixedRows][q])}}}}this.m_bIsSort=true;if(this.isPossibleFiltering()){if(this.rows-this.fixedRows>0){this.createIndexesForFiltering()}else{this.m_clIndexes=new SBGrid.DS.Collection()}this.initFilteringHistoryStack()}return true};SBGrid.CT.DataGrid.prototype.sortEx2=function(b,l,Q,G,r,x){if(l>=Q){return false}if(this.m_arColumn[b].getAttribute("sortable")==false){return false}if(r==undefined||typeof r!="boolean"){r=false}if(x==undefined||typeof x!="boolean"){x=true}if(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11){if(!this.m_objScroll.bScrollEvent){this.initGridCell(l,Q)}}this.clearMerge();var O,B=this.m_replaceString;if(B!=""&&B!="undefined"&&B!=null){O=B.split("?")}var H=this.getSelectedCellsInfo(l,Q);var L=this.getRefOfCol(b);var q=new SBGrid.DS.Map();var p=new SBGrid.DS.Map();var N=new SBGrid.DS.Set();var h=false;for(var T=l;T<=Q;T++){p.add(T.toString(),this.getRowStatus(T));if(this.isRowHidden(T)){N.add(T)}var e=null;var d="";var s=this.getCellEx(T,0);if(this.isJsonRef()){e=this.m_xlRefNode[T-this.fixedRows];d=e[L];if(isFinite(d)){d=Number(d)}else{h=true}if(s.m_bUserAddCell){e.SBGrid_bUserAddCell=true}else{e.SBGrid_bUserAddCell=false}if(H.find(T.toString())){e.SBGrid_bIsHaveSelectedInfo=true}else{e.SBGrid_bIsHaveSelectedInfo=false}e.SBGrid_BEFORE_ROW_INDEX=T.toString();if(q.find(d)==undefined){var y=new SBGrid.DS.Map();y.add(T,e);q.add(d,y);y=null}else{q.find(d).add(T,e)}}else{}}var V=q.keys();if(V.length<=1){if(this.m_bScrollMergeCell){this.m_bScrollMergeCell=false;this.merge()}else{if(this.mergeCellsFixedRows!=undefined&&this.mergeCellsFixedRows!="never"){this.mergeFixedRows()}if(this.mergeCellsFixedCols!=undefined){this.mergeFixedCols()}}if(this.m_bIsMergeByFree){this.reMergeByFree()}SBGrid.DEF.clearArray(V);q.clear();p.clear();N.clear();p=N=q=V=null;return false}if(h){V.sort()}else{V.sort(SBGrid.DEF.numberASC)}this.m_strSortIconStatus="up";if(G==SBGrid.DEF.SBST_DESC){V.reverse();this.m_strSortIconStatus="down"}var M=[];for(var T=0,c=V.length;T<c;T++){var P=q.find(V[T]);if(P){var D=P.keys(true);for(var S=0,a=D.length;S<a;S++){M.push(P.find(D[S]))}SBGrid.DEF.clearArray(D);P.clear();P=D=null}}if(M.length!=(Q-l+1)){SBGrid.DEF.clearArray(V);SBGrid.DEF.clearArray(M);q.clear();p.clear();N.clear();p=N=q=V=M=null;return false}for(var T=0,C=M.length;T<C;T++){if(this.isJsonRef()){this.m_xlRefNode[T+l-this.fixedRows]=M[T]}else{}}var I=this.getSelectionMode();if(SBGrid.DEF.SBSM_LIST==I||SBGrid.DEF.SBSM_BYROW==I||SBGrid.DEF.SBSM_FREE==I){this.clearSelection(l,Q)}var J=new SBGrid.DS.Set();var m=new SBGrid.DS.Map();for(var T=l;T<=Q;T++){for(var S=this.fixedCols;S<this.cols;S++){var s=this.getCellEx(T,S);if(s!=null){if(this.isJsonRef()){s.m_jsonObject=this.m_xlRefNode[T-this.fixedRows]}else{}if(!r){if(!this.m_objScroll.bScrollEvent){SBGrid.CF.GridSetTextRefresh(s,SBGrid.CF.GridGetText(s),O,this.m_bIsDataReplaceValueChanged)}}}}var u=this.getCellEx(T,0);var F=false;if(this.isJsonRef()){if(u!=null){u.m_bUserAddCell=this.m_xlRefNode[T-this.fixedRows]["SBGrid_bUserAddCell"]}F=this.m_xlRefNode[T-this.fixedRows]["SBGrid_bIsHaveSelectedInfo"];this.setRowStatus(T,p.find(this.m_xlRefNode[T-this.fixedRows]["SBGrid_BEFORE_ROW_INDEX"]))}else{}if(F){if(I==SBGrid.DEF.SBSM_FREE){if(this.isJsonRef()){var f=H.find(this.m_xlRefNode[T-this.fixedRows]["SBGrid_BEFORE_ROW_INDEX"]).keys(true);for(var S=0,z=f.length;S<z;S++){this.addSelCells(T,f[S],this.getCellEx(T,f[S]))}SBGrid.DEF.clearArray(f);f=null}else{}}else{if(I==SBGrid.DEF.SBSM_LIST||I==SBGrid.DEF.SBSM_BYROW){this.selectRow(T)}}}var K=-1;if(this.isJsonRef()){K=parseInt(this.m_xlRefNode[T-this.fixedRows]["SBGrid_BEFORE_ROW_INDEX"])}else{}if(N.contains(K)==false){J.add(T)}var W=this.m_mapGridStyleInfo.find(K.toString());if(W!=undefined){m.add(T.toString(),SBGrid.DEF.__deepCopy(W))}if(this.isJsonRef()){delete this.m_xlRefNode[T-this.fixedRows]["SBGrid_bUserAddCell"];delete this.m_xlRefNode[T-this.fixedRows]["SBGrid_bIsHaveSelectedInfo"];delete this.m_xlRefNode[T-this.fixedRows]["SBGrid_BEFORE_ROW_INDEX"]}else{}W=null}var A=J.keys();for(var T=l;T<=Q;T++){if(SBGrid.DEF.arrBinarySearch(T,A)==-1){this.setRowHidden(T,true,true)}else{this.setRowHidden(T,false,true)}}this.rebuildStyle(l,0,Q,this.cols-1,true);var w=m.keys();for(var T=0,g=w.length;T<g;T++){var n=w[T];this.m_mapGridStyleInfo.add(n.toString(),SBGrid.DEF.__deepCopy(m.find(n.toString())))}if(!r){if(this.m_objScroll.bScrollEvent){this.scrollingGrid(true)}else{if(this.m_bScrollMergeCell){this.m_bScrollMergeCell=false;this.merge()}else{if(this.mergeCellsFixedRows!=undefined&&this.mergeCellsFixedRows!="never"){this.mergeFixedRows()}if(this.mergeCellsFixedCols!=undefined){this.mergeFixedCols()}}if(this.m_bIsMergeByFree){this.reMergeByFree()}var o=this.m_mapGridStyleInfo.keys();for(var T=0;T<o.length;T++){var n=parseInt(o[T]);var W=this.m_mapGridStyleInfo.find(n.toString());var U=W.keys();for(var S=0;S<U.length;S++){var b=parseInt(U[S]);var v=W.find(b.toString());var E=SBGrid.DEF.getPropertyNameList(v);for(var R=0;R<E.length;R++){var t=E[R];var X=v[t];this.setCellStyle(t,n,b,n,b,X);t=X=null}b=v=E=null}n=W=U=null}}}SBGrid.DEF.clearArray(V);SBGrid.DEF.clearArray(M);q.clear();p.clear();m.clear();SBGrid.DEF.clearArray(A);SBGrid.DEF.clearArray(w);N.clear();J.clear();p=J=N=q=V=M=u=F=m=A=w=null;this.m_bIsSort=true;if(this.isPossibleFiltering()&&x){if(this.rows-this.fixedRows>0){this.createIndexesForFiltering()}else{this.m_clIndexes=new SBGrid.DS.Collection()}this.initFilteringHistoryStack()}return true};SBGrid.CT.DataGrid.prototype._multiSort=function(l,d,a){var e=l.shift();var h=e[0];var p=e[1];var n=this.m_objScroll.bScrollEvent?true:false;this.sortEx2(h,d,a,p,n,false);if(l.length>0){var r=this.getRefOfCol(h);var q=new SBGrid.DS.Map();for(var f=d;f<=a;f++){var m="";if(this.isJsonRef()){m=this.m_xlRefNode[f-this.fixedRows][r];if(q.find(m)==undefined){var g=[];g.push(f);q.add(m,g)}else{q.find(m).push(f)}}else{}m=null}var o=q.keys();for(var f=0,c=o.length;f<c;f++){var b=o[f];var g=q.find(b);if(g.length>1){d=g[0];a=g[g.length-1];this._multiSort(SBGrid.DEF.__deepCopy(l),d,a)}b=g=null}q.clear();r=q=o=null}e=d=a=h=p=null};SBGrid.CT.DataGrid.prototype.multiSortEx=function(m,e,a,b){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".multiSortEx","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(!(m instanceof Array)){SBGrid.DEF.APIerrorMsg(this.id+".multiSortEx","Please check if first parameter's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}else{if(m.length==0){return}else{for(var g=0,o=m.length;g<o;){var h=m[g][0];if(h==undefined||typeof h!="number"||h<this.fixedCols||h>=this.cols||this.m_arColumn[h].getAttribute("sortable")==false){m.splice(g,1);o=m.length;if(o==0){break}}else{g++}h=null}if(m.length==0){return}}}e=(e==undefined?this.fixedRows:e);a=(a==undefined?this.m_nRealRows-1:a);if(b==undefined||typeof b!="boolean"){b=false}this._multiSort(SBGrid.DEF.__deepCopy(m),e,a);if(this.m_objScroll.bScrollEvent){this.scrollingGrid(true)}if(!b){this.deleteMultiSortShowIcon();this.m_clMultiSortingHistory.clear();for(var g=0,o=m.length;g<o;g++){var f=m[g];var d=this.fixedRows-1;var l=f[0];var c=this.getCellEx(d,l);while(c&&c.mergeType==SBGrid.DEF.SBSM_HIDE){d-=1;c=this.getCellEx(d,l)}c=null;var n=f[1];this.m_clMultiSortingHistory.add(l,[[d,l],n]);f=null}}this.setMultiSortShowIcon();if(this.isPossibleFiltering()){if(this.rows-this.fixedRows>0){this.createIndexesForFiltering()}else{this.m_clIndexes=new SBGrid.DS.Collection()}this.initFilteringHistoryStack()}m=e=a=null};SBGrid.CT.DataGrid.prototype.getMultiSortingInfoList=function(){var a=[];var b=this.m_clMultiSortingHistory.count();if(b==0){return a}else{var e=this.m_clMultiSortingHistory.keys();for(var c=0;c<b;c++){var d=this.m_clMultiSortingHistory.item(e[c].toString());a.push([e[c],d[1]])}return a}};SBGrid.CT.DataGrid.prototype.setMultiSortShowIcon=function(h){if(!this.m_bUseMultiSorting){return}var e=[];if(h==undefined){e=this.m_clMultiSortingHistory.keys()}else{if(typeof h=="number"){if(this.m_clMultiSortingHistory.exists(h.toString())){e.push(h)}}}for(var d=0;d<e.length;d++){var g=this.m_clMultiSortingHistory.item(e[d].toString());if(g!=undefined){var f=g[0][0];var b=g[0][1];var c=this.getCellEx(f,b);this.initMultiSortShowIcon(c,b);var a=this.m_mapMultiSortShowIconInfo.find(b.toString());if(a!=undefined){a.heSecondTd.style.width="26px";a.heNumberDiv.innerHTML=(SBGrid.DEF.linearSearch(this.m_clMultiSortingHistory.keys(),b)+1).toString();a.heImgDiv.className=g[1]==SBGrid.DEF.SBST_ASC?"sbgrid_sort_up":"sbgrid_sort_down"}f=b=c=a=null}g=null}e=null};SBGrid.CT.DataGrid.prototype.deleteMultiSortShowIcon=function(f){if(!this.m_bUseMultiSorting){return}var b=-1;var e=-1;if(f==undefined){b=this.fixedCols;e=this.cols-1}else{if(typeof f!="number"){return}else{b=e=f}}for(var c=b;c<=e;c++){var a=this.m_mapMultiSortShowIconInfo.find(c.toString());if(a!=undefined){var d=a.heTable.parentNode;if(d){while(d.firstChild){d.removeChild(d.firstChild)}d.innerHTML=a.heBeforeCell.innerHTML}this.m_mapMultiSortShowIconInfo.remove(c.toString())}a=null}b=e=null};SBGrid.CT.DataGrid.prototype.initMultiSortShowIcon=function(d,f){if(!this.m_bUseMultiSorting){return}this.deleteMultiSortShowIcon(f);var a=this.m_mapMultiSortShowIconInfo.find(f.toString());if(a==undefined){a={};a.heTable=null;a.heFirstTd=null;a.heSecondTd=null;a.heNumberDiv=null;a.heImgDiv=null;a.heBeforeCell=null;a.heBeforeCell=d.m_heCtrl.cloneNode(true);a.heTable=document.createElement("table");var l=jQuery(a.heTable);l.addClass("sbgrid_datagrid_InputButton_table").height("100%").attr("border","0px").attr("cellspacing","0px").attr("cellpadding","0px");var e=jQuery(document.createElement("tbody"));var i=jQuery(document.createElement("tr"));a.heFirstTd=document.createElement("td");var h=jQuery(a.heFirstTd);h.width("100%").addClass("sbgrid_sort_Td").append(a.heBeforeCell.firstChild.cloneNode(true)).attr("multisorttype","init");jQuery(jQuery(h.children()[0]).attr("multisorttype","init").children()[0]).attr("multisorttype","init");a.heSecondTd=document.createElement("td");var g=jQuery(a.heSecondTd);g.height(SBGrid.DEF.is_mozBrowser?"98%":"100%").addClass("sbgrid_sort_Td").attr("multisorttype","normal");a.heNumberDiv=document.createElement("div");a.heImgDiv=a.heNumberDiv.cloneNode(true);var b=jQuery(a.heNumberDiv);var c=jQuery(a.heImgDiv);b.css("float","left").addClass("sbgrid_multi_sort").attr("multisorttype","normal");c.css("float","left").attr("multisorttype","normal");l.append(e.append(i.append(h,g.append(b,c))));l=e=i=h=g=b=c=null}while(d.m_heCtrl.firstChild){d.m_heCtrl.removeChild(d.m_heCtrl.firstChild)}d.m_heCtrl.appendChild(a.heTable);this.m_mapMultiSortShowIconInfo.add(f.toString(),a)};SBGrid.CT.DataGrid.prototype.showSortIcon=function(a){if(null==this.m_objSortIcon){this.m_nSortType=SBGrid.DEF.SBST_ASC;this.m_strSortIconStatus="up"}else{if(this.m_nSortType==SBGrid.DEF.SBST_DESC){this.m_nSortType=SBGrid.DEF.SBST_ASC;this.m_strSortIconStatus="up"}else{this.m_nSortType=SBGrid.DEF.SBST_DESC;this.m_strSortIconStatus="down"}}this.getSortShowIcon(this.getCellEx(this.fixedRows-1,a))};SBGrid.CT.DataGrid.prototype.getSortShowIcon=function(c,g){if(null==this.m_objSortIcon){this.m_objSortIcon={heTable:null,heFirstTd:null,heImgDiv:null,heBeforeCell:null,arrBeforeCellData:[],nSortedCol:-1};this.m_objSortIcon.heTable=document.createElement("table");var a=this.m_objSortIcon.heTable;var l=document.createElement("tbody");a.appendChild(l);var h=document.createElement("tr");l.appendChild(h);this.m_objSortIcon.heFirstTd=document.createElement("td");var n=this.m_objSortIcon.heFirstTd;var m=document.createElement("td");h.appendChild(n);h.appendChild(m);a.border="0";a.cellPadding="0";a.cellSpacing="0";a.style.height=SBGrid.DEF.is_mozBrowser?"97%":"100%";jQuery(a).addClass("sbgrid_datagrid_InputButton_table");n.style.width="100%";jQuery(n).addClass("sbgrid_sort_Td");m.style.width="13px";m.style.height=SBGrid.DEF.is_mozBrowser?"98%":"100%";jQuery(m).addClass("sbgrid_sort_Td");this.m_objSortIcon.heImgDiv=document.createElement("div");m.appendChild(this.m_objSortIcon.heImgDiv)}this.m_objSortIcon.nSortedCol=g;if(this.m_objSortIcon.heBeforeCell!=c.m_heCtrl){if(null!=this.m_objSortIcon.heBeforeCell){while(this.m_objSortIcon.heBeforeCell.firstChild){this.m_objSortIcon.heBeforeCell.removeChild(this.m_objSortIcon.heBeforeCell.firstChild)}for(var d=0,f=this.m_objSortIcon.arrBeforeCellData.length;d<f;d++){this.m_objSortIcon.heBeforeCell.appendChild(this.m_objSortIcon.arrBeforeCellData[d])}}this.m_objSortIcon.heBeforeCell=c.m_heCtrl;SBGrid.DEF.clearArray(this.m_objSortIcon.arrBeforeCellData);for(var d=0,e=c.m_heCtrl.childNodes.length;d<e;d++){this.m_objSortIcon.arrBeforeCellData.push(c.m_heCtrl.childNodes[d])}for(var d=0,e=this.m_objSortIcon.arrBeforeCellData.length;d<e;d++){this.m_objSortIcon.heFirstTd.appendChild(this.m_objSortIcon.arrBeforeCellData[d])}c.m_heCtrl.appendChild(this.m_objSortIcon.heTable);if(this.m_objSortIcon.heTable.childNodes.length==0){var l=document.createElement("tbody");var h=document.createElement("tr");l.appendChild(h);var m=document.createElement("td");m.style.width="13px";m.style.height=SBGrid.DEF.is_mozBrowser?"98%":"100%";jQuery(m).addClass("sbgrid_sort_Td");h.appendChild(this.m_objSortIcon.heFirstTd);h.appendChild(m);m.appendChild(this.m_objSortIcon.heImgDiv);this.m_objSortIcon.heTable.appendChild(l)}}if(null!=this.m_strSortIconStatus){var b="sbgrid_sort_"+this.m_strSortIconStatus;if(b!=this.m_objSortIcon.heImgDiv.className){jQuery(this.m_objSortIcon.heImgDiv).removeClass(this.m_objSortIcon.heImgDiv.className);jQuery(this.m_objSortIcon.heImgDiv).addClass(b)}b=null}};SBGrid.CT.DataGrid.prototype.getShowExplorerUI=function(objRectOfExplorerBarIcon){SBGrid.DEF.STR_SBGRID_ID=this.id;var objExplorerUI=document.getElementById("sb_explorerUI_top");if(!objExplorerUI){objExplorerUI=document.createElement("div");objExplorerUI.setAttribute("id","sb_explorerUI_top");objExplorerUI.style.zIndex="1";var objDivParentSet;var objDivIcon;var objDivLabel;if(this.isPossibleFiltering()){objDivParentSet=document.createElement("div");objDivIcon=document.createElement("div");objDivLabel=document.createElement("div");objDivLabel.appendChild(document.createTextNode("Filtering"));jQuery(objDivParentSet).addClass("sb_explorerUI_step1 align_bottom sb_explorerUI_flitering");jQuery(objDivIcon).addClass("sb_explorerUI_flitering_icon");jQuery(objDivLabel).addClass("sb_explorerUI_flitering_label");objDivParentSet.appendChild(objDivIcon);objDivParentSet.appendChild(objDivLabel);objDivParentSet.onmouseover=function(){eval(SBGrid.DEF.STR_SBGRID_ID+".getShowFilteringUI();")};objExplorerUI.appendChild(objDivParentSet)}if(this.isPossibleHideColumns()){objDivParentSet=document.createElement("div");objDivIcon=document.createElement("div");objDivLabel=document.createElement("div");objDivLabel.appendChild(document.createTextNode("Hide Columns"));jQuery(objDivParentSet).addClass("sb_explorerUI_step1 sb_explorerUI_hide_column");jQuery(objDivIcon).addClass("sb_explorerUI_hide_column_icon");jQuery(objDivLabel).addClass("sb_explorerUI_hide_column_label");objDivParentSet.appendChild(objDivIcon);objDivParentSet.appendChild(objDivLabel);objDivParentSet.onmouseover=function(){eval(SBGrid.DEF.STR_SBGRID_ID+".getShowHideColumnUI();")};objExplorerUI.appendChild(objDivParentSet)}var objBody=document.getElementById(this.parentId);objBody.appendChild(objExplorerUI)}var nExplorerUILeft=objRectOfExplorerBarIcon.getX()+objRectOfExplorerBarIcon.getWidth()-13;var nExplorerUIBottom=objRectOfExplorerBarIcon.getBottom()+1;objExplorerUI.style.visibility="visible";objExplorerUI.style.left=String(nExplorerUILeft)+"px";objExplorerUI.style.top=String(nExplorerUIBottom)+"px"};SBGrid.CT.DataGrid.prototype.getShowHideColumnUI=function(){this.deleteShowFilteringUI();if(!(this.isPossibleHideColumns())){return}var objHideColumnUI=document.getElementById("sb_explorerUI_hide_column_top");if(!objHideColumnUI){objHideColumnUI=document.createElement("div");objHideColumnUI.setAttribute("id","sb_explorerUI_hide_column_top");objHideColumnUI.style.zIndex="1";var objDivParentSet;var objDivIcon;var objDivColumnName;for(var i=0;i<this.getCols();i++){objDivParentSet=document.createElement("div");objDivIcon=document.createElement("div");objDivColumnName=document.createElement("div");objDivColumnName.appendChild(document.createTextNode(this.textMatrix(0,i)));jQuery(objDivParentSet).addClass("sb_explorerUI_hide_column_step1 sb_explorerUI_hide_column");jQuery(objDivIcon).addClass("sb_explorerUI_hide_column_status_icon");objDivIcon.setAttribute("id","sb_explorerUI_hide_column_status_icon_"+String(i));jQuery(objDivColumnName).addClass("sb_explorerUI_column_name");objDivParentSet.appendChild(objDivIcon);objDivParentSet.appendChild(objDivColumnName);jQuery(objDivParentSet).click(function(event){var objTarget=event.target;if(objTarget.getAttribute("class")!="sb_explorerUI_hide_column_status_icon"){if(objTarget.getAttribute("class")!="sb_explorerUI_hide_column_step1 sb_explorerUI_hide_column"){objTarget=objTarget.parentNode}objTarget=objTarget.children[0]}var nHideColNum=objTarget.getAttribute("id");nHideColNum=nHideColNum.replace("sb_explorerUI_hide_column_status_icon_","");var objCol;var strEval="objCol = "+SBGrid.DEF.STR_SBGRID_ID+".m_arColumn["+String(nHideColNum)+"];";eval(strEval);if(!objCol){alert("ERROR LOCATION: getShowHideColumnUI(), objCol is not exist!!");return}var nHideColumnsCount;eval("nHideColumnsCount = "+SBGrid.DEF.STR_SBGRID_ID+".getHideColumnCount();");var strHiddenState;if(objCol.m_bHiddenState){strHiddenState="false"}else{var nColumnsCount;eval("nColumnsCount = "+SBGrid.DEF.STR_SBGRID_ID+".getCols();");if(nHideColumnsCount>=nColumnsCount-1){return}strHiddenState="true"}strEval=SBGrid.DEF.STR_SBGRID_ID+".setColHidden("+String(nHideColNum)+", "+strHiddenState+");";eval(strEval);if(objCol.m_bHiddenState){objTarget.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_UNCHECKICON+")";eval(SBGrid.DEF.STR_SBGRID_ID+".m_nHideColumnsCount++;")}else{objTarget.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_CHECKICON+")";eval(SBGrid.DEF.STR_SBGRID_ID+".m_nHideColumnsCount--;")}});objHideColumnUI.appendChild(objDivParentSet)}var objBody=document.getElementById(this.parentId);objBody.appendChild(objHideColumnUI)}var objExplorerUI=document.getElementById("sb_explorerUI_top");if(!objExplorerUI){alert("ExplorerBar UI is not exist!!")}var nObjHideColumnUILeft=objExplorerUI.offsetLeft+objExplorerUI.offsetWidth;var nObjHideColumnUIBottom=objExplorerUI.offsetTop+objExplorerUI.offsetHeight-22;objHideColumnUI.style.visibility="visible";objHideColumnUI.style.left=String(nObjHideColumnUILeft)+"px";objHideColumnUI.style.top=String(nObjHideColumnUIBottom)+"px";for(var i=0;i<this.getCols();i++){var objDivIcon=document.getElementById("sb_explorerUI_hide_column_status_icon_"+String(i));var objCol=this.m_arColumn[i];if(objCol){if(objCol.m_bHiddenState){objDivIcon.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_UNCHECKICON+")"}else{objDivIcon.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_CHECKICON+")"}}}};SBGrid.CT.DataGrid.prototype.getIndexDataOfSelectedColumn=function(e){var b=new SBGrid.DS.Collection();for(var a=this.fixedRows;a<this.getRows();a++){var d;var c=this.valueMatrix(a,e);if(b.exists(c)){d=b.item(c);if(SBGrid.DEF.arrBinarySearch(a,d)==-1){d.push(a)}}else{d=new Array();d.push(a)}b.add(c,d)}return b};SBGrid.CT.DataGrid.prototype.isItemPossibleControlAboutExecutedFiltering=function(g){var d=SBGrid.DEF.__deepCopy(this.m_clFilteringHistoryStack);var c=d.getCollection();for(var f in c){if(f=="TOTAL_ROW_LIST"){continue}var e=f.substring(0,f.indexOf("#"));if(e==this.m_nDownCol){d.remove(f)}}c=null;var b=this.getFilteringHistory(d);var a=SBGrid.DEF.arrIntersection(b,g);if(a.length==0){return false}else{return true}};SBGrid.CT.DataGrid.prototype.getShowFilteringUI=function(){this.deleteShowHideColumnUI();var nRowHeader=this.m_bRowHeader?1:0;if(!(this.isPossibleFiltering())){return}var objFilteringUI=document.getElementById("sb_explorerUI_flitering_top");var objDivParentSet;var objDivIcon;var objDivColumnName;if(objFilteringUI){while(objFilteringUI.firstChild){objFilteringUI.removeChild(objFilteringUI.firstChild)}}else{objFilteringUI=document.createElement("div");objFilteringUI.setAttribute("id","sb_explorerUI_flitering_top");objFilteringUI.style.zIndex="1";var objBody=document.getElementById(this.parentId);objBody.appendChild(objFilteringUI)}objDivParentSet=document.createElement("div");objDivIcon=document.createElement("div");objDivColumnName=document.createElement("div");objDivColumnName.appendChild(document.createTextNode("Select All"));jQuery(objDivParentSet).addClass("sb_explorerUI_flitering_step1 align_bottom sb_explorerUI_flitering");jQuery(objDivIcon).addClass("sb_explorerUI_filtering_status_icon");objDivIcon.setAttribute("id","sb_explorerUI_filtering_status_icon_ALL");jQuery(objDivColumnName).addClass("sb_explorerUI_filtering_value");objDivParentSet.appendChild(objDivIcon);objDivParentSet.appendChild(objDivColumnName);jQuery(objDivParentSet).click(function(event){var nClickedColumnIndex;eval("nClickedColumnIndex = "+SBGrid.DEF.STR_SBGRID_ID+".m_nDownCol;");var nRows;eval("nRows = "+SBGrid.DEF.STR_SBGRID_ID+".getRows();");var objTarget=document.getElementById("sb_explorerUI_filtering_status_icon_ALL");objTarget.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_CHECKICON+")";var clIndexDataOfSelectedColumn;eval("clIndexDataOfSelectedColumn = "+SBGrid.DEF.STR_SBGRID_ID+".m_clIndexes.item("+SBGrid.DEF.STR_SBGRID_ID+".m_clIndexes.keys()[nClickedColumnIndex]);");for(var i=0;i<clIndexDataOfSelectedColumn.count();i++){var objDivIconTemp=document.getElementById("sb_explorerUI_filtering_status_icon_"+String(i));if(objDivIconTemp){objDivIconTemp.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_CHECKICON+")"}}var arKeyList;eval("arKeyList = SBGrid.DEF.__deepCopy("+SBGrid.DEF.STR_SBGRID_ID+".m_clFilteringHistoryStack.keys());");for(var i=1;i<arKeyList.length;i++){var strKey=arKeyList[i];var nColumnIndex=strKey.substring(0,strKey.indexOf("#"));if(nColumnIndex==nClickedColumnIndex){eval(SBGrid.DEF.STR_SBGRID_ID+".m_clFilteringHistoryStack.remove(strKey);")}}var arFilteringHistoryResult;eval("arFilteringHistoryResult = "+SBGrid.DEF.STR_SBGRID_ID+".getFilteringHistory("+SBGrid.DEF.STR_SBGRID_ID+".m_clFilteringHistoryStack);");for(var q=0;q<arFilteringHistoryResult.length-1;q++){var strEval=SBGrid.DEF.STR_SBGRID_ID+".setRowHidden(arFilteringHistoryResult[q], false, true);";eval(strEval)}eval(SBGrid.DEF.STR_SBGRID_ID+".setRowHidden(arFilteringHistoryResult[arFilteringHistoryResult.length - 1], false, false);")});objFilteringUI.appendChild(objDivParentSet);var clIndexDataOfSelectedColumn=this.m_clIndexes.item(this.m_clIndexes.keys()[this.m_nDownCol-nRowHeader]);for(var i=0;i<clIndexDataOfSelectedColumn.count();i++){var strKey=clIndexDataOfSelectedColumn.keys()[i];var arRowIndexList=this.m_clIndexes.item(this.m_clIndexes.keys()[this.m_nDownCol-nRowHeader]).item(strKey);if(this.isItemPossibleControlAboutExecutedFiltering(SBGrid.DEF.__deepCopy(arRowIndexList))==false){continue}objDivParentSet=document.createElement("div");objDivIcon=document.createElement("div");objDivColumnName=document.createElement("div");objDivColumnName.appendChild(document.createTextNode(strKey));jQuery(objDivParentSet).addClass("sb_explorerUI_flitering_step1 sb_explorerUI_flitering");jQuery(objDivParentSet).attr("id","sb_explorerUI_flitering_"+String(i));jQuery(objDivIcon).addClass("sb_explorerUI_filtering_status_icon");jQuery(objDivIcon).attr("id","sb_explorerUI_filtering_status_icon_"+String(i));jQuery(objDivColumnName).addClass("sb_explorerUI_filtering_value");jQuery(objDivColumnName).attr("id","sb_explorerUI_filtering_value_"+String(i));objDivParentSet.appendChild(objDivIcon);objDivParentSet.appendChild(objDivColumnName);jQuery(objDivParentSet).click(function(event){var nClickedColumnIndex;eval("nClickedColumnIndex = "+SBGrid.DEF.STR_SBGRID_ID+".m_nDownCol;");var nCols;eval("nCols = "+SBGrid.DEF.STR_SBGRID_ID+".getCols();");var nRows;eval("nRows = "+SBGrid.DEF.STR_SBGRID_ID+".getRows();");var nRowHeader;eval("nRowHeader = "+SBGrid.DEF.STR_SBGRID_ID+".m_bRowHeader ? 1:0;");var objTarget=event.target;if(objTarget.getAttribute("class")!="sb_explorerUI_filtering_value"){if(objTarget.getAttribute("class")!="sb_explorerUI_flitering_step1 sb_explorerUI_flitering"){objTarget=objTarget.parentNode}objTarget=objTarget.children[1]}var nIndexForKey=objTarget.getAttribute("id");nIndexForKey=nIndexForKey.replace("sb_explorerUI_filtering_value_","");var strKey=objTarget.firstChild.data;var arRowIndexList;eval("arRowIndexList = "+SBGrid.DEF.STR_SBGRID_ID+".m_clIndexes.item("+SBGrid.DEF.STR_SBGRID_ID+".m_clIndexes.keys()[nClickedColumnIndex - nRowHeader]).item(strKey).slice(0);");var bIsHidden;eval("bIsHidden = "+SBGrid.DEF.STR_SBGRID_ID+".isHiddenAboutKey(strKey, nClickedColumnIndex - nRowHeader);");var arExecuteRowList;if(bIsHidden){objTarget.parentNode.children[0].style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_CHECKICON+")";var arBeforeFilteringHistoryResult;eval("arBeforeFilteringHistoryResult = "+SBGrid.DEF.STR_SBGRID_ID+".getFilteringHistory("+SBGrid.DEF.STR_SBGRID_ID+".m_clFilteringHistoryStack);");eval(SBGrid.DEF.STR_SBGRID_ID+'.m_clFilteringHistoryStack.remove(nClickedColumnIndex.toString() + "#" + strKey);');var arAfterFilteringHistoryResult;eval("arAfterFilteringHistoryResult = "+SBGrid.DEF.STR_SBGRID_ID+".getFilteringHistory("+SBGrid.DEF.STR_SBGRID_ID+".m_clFilteringHistoryStack);");arExecuteRowList=SBGrid.DEF.arrDifferenceOfSets(arAfterFilteringHistoryResult,arBeforeFilteringHistoryResult);bState=false}else{var objDivShowAllIcon=document.getElementById("sb_explorerUI_filtering_status_icon_ALL");objDivShowAllIcon.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_UNCHECKICON+")";objTarget.parentNode.children[0].style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_UNCHECKICON+")";var arBeforeFilteringHistoryResult;eval("arBeforeFilteringHistoryResult = "+SBGrid.DEF.STR_SBGRID_ID+".getFilteringHistory("+SBGrid.DEF.STR_SBGRID_ID+".m_clFilteringHistoryStack);");eval(SBGrid.DEF.STR_SBGRID_ID+'.m_clFilteringHistoryStack.add(nClickedColumnIndex.toString() + "#" + strKey, arRowIndexList);');var arAfterFilteringHistoryResult;eval("arAfterFilteringHistoryResult = "+SBGrid.DEF.STR_SBGRID_ID+".getFilteringHistory("+SBGrid.DEF.STR_SBGRID_ID+".m_clFilteringHistoryStack);");arExecuteRowList=SBGrid.DEF.arrDifferenceOfSets(arBeforeFilteringHistoryResult,arAfterFilteringHistoryResult);bState=true}for(var q=0;q<arExecuteRowList.length-1;q++){var strEval=SBGrid.DEF.STR_SBGRID_ID+".setRowHidden(arExecuteRowList[q], bState, true);";eval(strEval)}eval(SBGrid.DEF.STR_SBGRID_ID+".setRowHidden(arExecuteRowList[arExecuteRowList.length - 1], bState, false);")});var bIsHidden=this.isHiddenAboutKey(strKey,this.m_nDownCol-nRowHeader);if(bIsHidden){objDivIcon.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_UNCHECKICON+")"}else{objDivIcon.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_CHECKICON+")"}objFilteringUI.appendChild(objDivParentSet)}var objExplorerUI=document.getElementById("sb_explorerUI_top");if(!objExplorerUI){alert("ExplorerBar UI is not exist!!")}var nObjFilteringUILeft=objExplorerUI.offsetLeft+objExplorerUI.offsetWidth;var nObjFilteringUIBottom=objExplorerUI.offsetTop+objExplorerUI.offsetHeight-42;objFilteringUI.style.visibility="visible";objFilteringUI.style.left=String(nObjFilteringUILeft)+"px";objFilteringUI.style.top=String(nObjFilteringUIBottom)+"px"};SBGrid.CT.DataGrid.prototype.deleteShowExplorerUI=function(){var a=document.getElementById("sb_explorerUI_top");if(a){a.style.visibility="hidden"}this.deleteShowHideColumnUI();this.deleteShowFilteringUI()};SBGrid.CT.DataGrid.prototype.deleteShowHideColumnUI=function(){var a=document.getElementById("sb_explorerUI_hide_column_top");if(a){a.style.visibility="hidden"}};SBGrid.CT.DataGrid.prototype.deleteShowFilteringUI=function(){var a=document.getElementById("sb_explorerUI_flitering_top");if(a){a.style.visibility="hidden"}};SBGrid.CT.DataGrid.prototype.getFilteringListOfColumn=function(c){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".getFilteringListOfColumn","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getFilteringListOfColumn","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}var b=this.m_bRowHeader?1:0;var a=this.m_clIndexes.item(this.m_clIndexes.keys()[c-b]);return a.keys()};SBGrid.CT.DataGrid.prototype.setFiltering=function(c,f,p,m){if(arguments.length<3){SBGrid.DEF.APIerrorMsg(this.id+".setFiltering","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setFiltering","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof f)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setFiltering","Please check if second parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof p!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setFiltering","Please check if 3rd parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}if(m==null||m==undefined){m=false}var r=this.m_bRowHeader?1:0;var h=this.m_clIndexes.item(this.m_clIndexes.keys()[c-r]).item(f);var n;n=this.getFilteringHistory(this.m_clFilteringHistoryStack);if(p){this.m_clFilteringHistoryStack.add(c.toString()+"#"+f,h)}else{this.m_clFilteringHistoryStack.remove(c.toString()+"#"+f)}var e;e=this.getFilteringHistory(this.m_clFilteringHistoryStack);var o;if(p){o=SBGrid.DEF.arrDifferenceOfSets(n,e)}else{o=SBGrid.DEF.arrDifferenceOfSets(e,n)}for(var a=0;a<o.length-1;a++){this.setRowHidden(o[a],p,true)}this.setRowHidden(o[o.length-1],p,m);for(var g=0;g<this.m_arColumn.length;g++){var l=this.m_arColumn[g];if(l.getAttribute("type")=="combo"){var b=document.getElementById("SBHE_"+l.m_objCombo.id);var d=document.getElementById("SBHE_"+l.m_objCombo.id+"_allitem");b.style.visibility="hidden";d.style.visibility="hidden"}}};SBGrid.CT.DataGrid.prototype.setRowFiltering=function(b,a,c){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setRowFiltering","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(!(b instanceof Array)){SBGrid.DEF.APIerrorMsg(this.id+".setRowFiltering","Please check if first parameter's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}if(a==undefined){a=[]}else{if(!(a instanceof Array)){SBGrid.DEF.APIerrorMsg(this.id+".setRowFiltering","Please check if second parameter's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}}if(c==null||c==undefined){c=false}else{if(typeof c!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setRowFiltering","Please check if 3rd parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}this.showWait(true);if(SBGrid.DEF.n_FilteringTimer!=null){window.clearTimeout(SBGrid.DEF.n_FilteringTimer)}var d=this.conditionSearchRows(b,a,c);SBGrid.DEF.n_FilteringTimer=window.setTimeout("SBGrid.getGrid('"+this.id+"').setRowsHidden("+JSON.stringify(d)+");",50)};SBGrid.CT.DataGrid.prototype.setRowFilteringEx=function(b,a,c){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setRowFilteringEx","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(!(b instanceof Array)){SBGrid.DEF.APIerrorMsg(this.id+".setRowFilteringEx","Please check if first parameter's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}if(a==undefined){a=[]}else{if(!(a instanceof Array)){SBGrid.DEF.APIerrorMsg(this.id+".setRowFilteringEx","Please check if second parameter's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}}if(c==null||c==undefined){c=false}else{if(typeof c!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setRowFilteringEx","Please check if 3rd parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}this.showWait(true);if(SBGrid.DEF.n_FilteringTimer!=null){window.clearTimeout(SBGrid.DEF.n_FilteringTimer)}var d=this.conditionSearchRowsEx(b,a,c);SBGrid.DEF.n_FilteringTimer=window.setTimeout("SBGrid.getGrid('"+this.id+"').setRowsHidden("+JSON.stringify(d)+");",50)};SBGrid.CT.DataGrid.prototype.setRowsHidden=function(c,b){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setRowsHidden","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(!(c instanceof Array)){SBGrid.DEF.APIerrorMsg(this.id+".setRowsHidden","Please check if first parameter's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}if(b==undefined){b=false}else{if(typeof b!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setRowsHidden","Please check if second parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}for(var a=this.fixedRows;a<this.rows;a++){if(SBGrid.DEF.arrBinarySearch(a,c)==-1){this.setRowHidden(a,true,true)}else{this.setRowHidden(a,false,true)}}if(!b){this.scrollingGrid(true)}};SBGrid.CT.DataGrid.prototype.clearFiltering=function(){if(this.isPossibleFiltering()){this.initFilteringHistoryStack();for(var a=this.fixedRows;a<this.rows-1;a++){this.setRowHidden(a,false,false)}this.setRowHidden((this.rows-1),false,false)}};SBGrid.CT.DataGrid.prototype.operatorSearchRows=function(nCol,strOperator,strComparisonTarget){if(arguments.length<3){SBGrid.DEF.APIerrorMsg(this.id+".OperatorSearchRows","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}var arResultRowList=[];if(typeof nCol!="number"||typeof strOperator!="string"){return arResultRowList}strOperator=strOperator.replaceAll(" ","");if(strOperator==">"||strOperator==">="||strOperator=="=="||strOperator=="<"||strOperator=="<="){var nComparisonTarget=Number(strComparisonTarget);if(!(isNaN(nComparisonTarget))){for(var i=this.fixedRows;i<this.rows;i++){var strCellValue=this.getTextMatrix(i,nCol);if(isNaN(Number(strCellValue))==false){if(eval(strCellValue+strOperator+strComparisonTarget)){arResultRowList.push(i)}}strCellValue=null}}}else{strOperator=strOperator.toUpperCase();if(strOperator=="LIKE"){for(var i=this.fixedRows;i<this.rows;i++){var strCellValue=this.getTextMatrix(i,nCol);if(strCellValue.indexOf(strComparisonTarget)>-1){arResultRowList.push(i)}strCellValue=null}}}return arResultRowList};SBGrid.CT.DataGrid.prototype.searchRows=function(e,d,c){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".searchRows","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof e!="number"){SBGrid.DEF.APIerrorMsg(this.id+".searchRows","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof d)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".searchRows","Please check if second parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(c==undefined){c=false}else{if(typeof c!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".searchRows","Please check if 3rd parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(c){if(this.rows-this.fixedRows>0){this.createIndexesForFiltering()}else{this.m_clIndexes=new SBGrid.DS.Collection()}this.initFilteringHistoryStack()}var a=[];if(e<this.fixedCols||e>=this.cols){return a}var b=this.m_bRowHeader?1:0;if(this.m_clIndexes.keys()[e-b]==undefined){a=[]}else{a=SBGrid.DEF.__deepCopy(this.m_clIndexes.item(this.m_clIndexes.keys()[e-b]).item(d))}if(a==undefined){a=[]}return a};SBGrid.CT.DataGrid.prototype.conditionSearchRows=function(o,f,m){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".conditionSearchRows","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(!(o instanceof Array)){SBGrid.DEF.APIerrorMsg(this.id+".conditionSearchRows","Please check if first parameter's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}if(f==undefined){f=[]}else{if(!(f instanceof Array)){SBGrid.DEF.APIerrorMsg(this.id+".conditionSearchRows","Please check if second parameter's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}}if(m==undefined){m=false}else{if(typeof m!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".conditionSearchRows","Please check if 3rd parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}var b=[];for(var h=0,q=o.length;h<q;h++){var a=o[h];if((a instanceof Array)&&a.length>=2){var l=a[0];var g=a[1];var c=(a[2]==undefined||typeof a[2]!="boolean"?false:a[2]);var e=[];l=(typeof l!="number"?Number(l):l);g=(typeof g=="string"?g:g.toString());if(f[h]==undefined||typeof f[h]!="string"){f[h]="AND"}else{f[h]=f[h].toUpperCase();f[h]=((f[h]!="AND"&&f[h]!="OR")?"AND":f[h])}if(h==0){e=this.searchRows(l,g,m)}else{e=this.searchRows(l,g,false)}if(c){var n=SBGrid.DEF.__deepCopy(this.m_clFilteringHistoryStack.item("TOTAL_ROW_LIST"));e=SBGrid.DEF.arrDifferenceOfSets(n,e)}b.push(e);a=l=g=c=e=null}else{a=null;SBGrid.DEF.APIerrorMsg(this.id+".conditionSearchRows","Please check first parameter's pattern.",SBGrid.DEF.DEBUG_MODE);return}}var d=[];if(b.length>=1){var h=1;d=b[0];while(h<b.length){var p=b[h];if(f[h-1]=="OR"){d=SBGrid.DEF.arrUnion(d,p)}else{if(f[h-1]=="AND"){d=SBGrid.DEF.arrIntersection(d,p)}}p=null;h++}}return d};SBGrid.CT.DataGrid.prototype.conditionSearchRowsEx=function(p,f,n){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".conditionSearchRowsEx","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(!(p instanceof Array)){SBGrid.DEF.APIerrorMsg(this.id+".conditionSearchRowsEx","Please check if first parameter's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}if(f==undefined){f=[]}else{if(!(f instanceof Array)){SBGrid.DEF.APIerrorMsg(this.id+".conditionSearchRowsEx","Please check if second parameter's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}}if(n==undefined){n=false}else{if(typeof n!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".conditionSearchRowsEx","Please check if 3rd parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}var b=[];for(var h=0,t=p.length;h<t;h++){var a=p[h];if((a instanceof Array)&&a.length>=3){var l=a[0];var r=a[1];l=(typeof l!="number"?Number(l):l);if(r==undefined||typeof r!="boolean"){r=true}var e=[];if(r){var g=a[2];var c=(a[3]==undefined||typeof a[3]!="boolean"?false:a[3]);g=(typeof g=="string"?g:g.toString());if(h==0){e=this.searchRows(l,g,n)}else{e=this.searchRows(l,g,false)}g=null}else{var s=a[2];var m=a[3];e=this.operatorSearchRows(l,s,m)}if(f[h]==undefined||typeof f[h]!="string"){f[h]="AND"}else{f[h]=f[h].toUpperCase();f[h]=((f[h]!="AND"&&f[h]!="OR")?"AND":f[h])}if(c){var o=SBGrid.DEF.__deepCopy(this.m_clFilteringHistoryStack.item("TOTAL_ROW_LIST"));e=SBGrid.DEF.arrDifferenceOfSets(o,e)}b.push(e);a=l=c=e=null}else{a=null;SBGrid.DEF.APIerrorMsg(this.id+".conditionSearchRowsEx","Please check first parameter's pattern.",SBGrid.DEF.DEBUG_MODE);return}}var d=[];if(b.length>=1){var h=1;d=b[0];while(h<b.length){var q=b[h];if(f[h-1]=="OR"){d=SBGrid.DEF.arrUnion(d,q)}else{if(f[h-1]=="AND"){d=SBGrid.DEF.arrIntersection(d,q)}}q=null;h++}}return d};SBGrid.CT.DataGrid.prototype.deleteSortShowIcon=function(){if(null!=this.m_objSortIcon){for(var b=0,a=this.m_objSortIcon.arrBeforeCellData.length;b<a;b++){this.m_objSortIcon.heBeforeCell.appendChild(this.m_objSortIcon.arrBeforeCellData[b])}var c=SBGrid.DEF.is_firefox?this.m_objSortIcon.heTable.parentNode:this.m_objSortIcon.heTable.parentElement;if(c!=null){c.removeChild(this.m_objSortIcon.heTable)}c=null;this.m_objSortIcon.heTable=null;this.m_objSortIcon.heFirstTd=null;this.m_objSortIcon.heImgDiv=null;this.m_objSortIcon.heBeforeCell=null;this.m_objSortIcon.heBeforeCellData=null;this.m_objSortIcon=null;this.m_strSortIconStatus=null}};SBGrid.CT.DataGrid.prototype.sort=function(f,a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".sort","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return false}if(typeof f!="number"){SBGrid.DEF.APIerrorMsg(this.id+".sort","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return false}if(this.m_arColumn[f].getAttribute("sortable")==false){return false}if(this.rows-this.fixedRows<=1){return false}if(a==null){a=this.m_nSortType}else{if(a==SBGrid.DEF.SBST_NONE){return false}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".sort","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return false}else{if((a!=SBGrid.DEF.SBST_ASC)&&(a!=SBGrid.DEF.SBST_DESC)){a=SBGrid.DEF.SBST_ASC}}}this.m_nSortType=a;this.dispatch("onbeforesort");if(null!=this.attribute.sortloading&&"true"==this.attribute.sortloading){this.showWait(true);window.setTimeout("SBGrid.getGrid('"+this.id+"').sortTimeout("+f+","+this.m_nSortType+");",0)}else{if(this.isSubtotalAll()){this.clearAllSubTotalRow()}var e=false;var d=this.fixedRows;var b=this.m_nRealRows-1;if(!(this.m_bIsSortFrozenRows)){d+=this.frozenRows}if(!(this.m_bIsSortFrozenBottomRows)){b-=this.frozenBottomRows}if(this.m_bIsRealDataSync){e=this.sortEx2(f,d,b,this.m_nSortType)}else{e=this.sortEx(f,d,b,this.m_nSortType)}if(e){this.defaultAttributeSetting();this.dispatch("onaftersort")}}if(e){if(this.m_nSortType==SBGrid.DEF.SBST_ASC){this.m_nSortType=SBGrid.DEF.SBST_DESC}else{this.m_nSortType=SBGrid.DEF.SBST_ASC}if(this.m_nExplorerBarType==SBGrid.DEF.SBEB_SORT_SHOW||this.m_nExplorerBarType==SBGrid.DEF.SBEB_SORT_SHOW_MOVE){var c;if(this.m_nDownRow==-1){c=this.fixedRows-1}else{c=this.m_nDownRow}this.getSortShowIcon(this.getCellEx(c,f),f)}return true}else{return false}};SBGrid.CT.DataGrid.prototype.sortCaptionColumn=function(c,a){var b=this.getAttribute("cursor");if(b!="arrow"||SBGrid.DEF.bIsAfterMouseUpFlg==false){return false}return this.sort(c,a)};SBGrid.CT.DataGrid.prototype.sortTimeout=function(c,a){if(this.isSubtotalAll()){this.clearAllSubTotalRow()}var b=false;if(this.m_bIsRealDataSync){b=this.sortEx2(c,this.fixedRows,this.m_nRealRows-1,a)}else{b=this.sortEx(c,this.fixedRows,this.m_nRealRows-1,a)}if(b){this.defaultAttributeSetting();this.dispatch("onaftersort")}this.showWait(false)};SBGrid.CT.DataGrid.prototype.getColumnControl=function(a){if(null!=a&&a<this.m_arColumn.length){return this.m_arColumn[a]}};SBGrid.CT.DataGrid.prototype.getRowHeader=function(){var a=0;switch(this.rowheader){case"seq":a=SBGrid.DEF.SBRH_SEQ;break;case"reverseseq":a=SBGrid.DEF.SBRH_REVERSESEQ;break;case"select":a=SBGrid.DEF.SBRH_SELECT;break;case"update":a=SBGrid.DEF.SBRH_UPDATE;break}return a};SBGrid.CT.DataGrid.prototype.getColStatus=function(b){var a=this.getCellEx(0,b);if(a){return a.getColStatus()}return false};SBGrid.CT.DataGrid.prototype.setColStatus=function(c,a){var b=this.getCellEx(0,c);if(null!=b){b.setColStatus(a)}};SBGrid.CT.DataGrid.prototype.getFixedcellcheckboxChecked=function(c,d){if(arguments.length!=2){SBGrid.DEF.APIerrorMsg(this.id+".getFixedcellcheckboxChecked","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getFixedcellcheckboxChecked","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof d!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getFixedcellcheckboxChecked","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(c>=this.fixedRows){return false}var b=this.getCellEx(c,d);var a=this.m_arColumn[d];if(null!=b&&null!=a&&SBGrid.DEF.SBIT_CHECK==b.m_fixedInputType){if(SBGrid.DEF.SBIT_CHECK==a.getInputType()){if(b.m_fixedCheckStatus){return true}else{return false}}}return false};SBGrid.CT.DataGrid.prototype.setFixedcellcheckboxChecked=function(nRow,nCol,bStatus,buildType){if(buildType==undefined){buildType=""}if(arguments.length!=3&&arguments.length!=4){SBGrid.DEF.APIerrorMsg(this.id+".setFixedcellcheckboxChecked","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof nRow!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setFixedcellcheckboxChecked","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof nCol!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setFixedcellcheckboxChecked","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof bStatus!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setFixedcellcheckboxChecked","Please check if 3rd parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}if(nRow>=this.fixedRows||nCol<0||nCol>this.cols){return}var objFixedCell=this.getCellEx(nRow,nCol);var objColumn=this.m_arColumn[nCol];var strValidate=objColumn.attribute.checkboxValidate;if(null!=objFixedCell&&null!=objColumn&&SBGrid.DEF.SBIT_CHECK==objFixedCell.m_fixedInputType){if(bStatus!=objFixedCell.m_fixedCheckStatus){objFixedCell.m_fixedCheckStatus=bStatus;if(SBGrid.DEF.SBIT_CHECK==objColumn.getInputType()){if(buildType!="rebuild"){for(var i=this.fixedRows;i<this.m_nRealRows;i++){var objCell=this.getCellEx(i,nCol);if(null!=objCell){var bResult=true;if(""!=strValidate){var strValidateName=strValidate.substring(0,strValidate.indexOf("("));var strValidateParam="(this.id, "+i.toString()+", "+nCol.toString()+","+bStatus+");";var strValidateFn=strValidateName+strValidateParam;bResult=eval(strValidateFn)}if(bResult){if(!objCell.m_bIsHidden&&this.isSubtotal(i)!=true){SBGrid.CF.GridSetFixedCheck(objCell,bStatus);this.setRowStatus(i,this.getRowStatus(i)|SBGrid.DEF.SBGS_UPDATE)}}}}}var strCaption=this.getCurrentCaption();this.caption=strCaption;this.attribute.caption=strCaption;this.refreshCurrentModel(this.attribute.ref);this.setCaption(strCaption);var imgTg=document.getElementById("fixedCheckbox_"+this.id+"_"+nCol);if(bStatus){objFixedCell.m_heCtrl.firstChild.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgCheck;imgTg.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgCheck;this.dispatch("onselect",SBGrid.DEF.m_event);this.dispatch("SBUx_select",window.m_event)}else{objFixedCell.m_heCtrl.firstChild.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgUnCheck;imgTg.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgUnCheck;this.dispatch("ondeselect",SBGrid.DEF.m_event);this.dispatch("SBUx_deselect",window.m_event)}}}}};SBGrid.CT.DataGrid.prototype.initFixedcellcheckbox=function(){for(var b=this.m_bRowHeader?1:0;b<this.cols;b++){for(var a=0;a<this.fixedRows;a++){this.setFixedcellcheckboxChecked(a,b,false,"rebuild")}}};SBGrid.CT.DataGrid.prototype.setFixedcellcheckbox=function(nRow,nCol,bStatus){if(arguments.length!=3){SBGrid.DEF.APIerrorMsg(this.id+".setFixedcellcheckbox","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof nRow!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setFixedcellcheckbox","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof nCol!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setFixedcellcheckbox","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof bStatus!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setFixedcellcheckbox","Please check if 3rd parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}if(nRow>=this.fixedRows){return}var objCell=this.getCellEx(nRow,nCol);if(null!=objCell){if(bStatus){if(objCell.m_fixedInputType==SBGrid.DEF.SBIT_OUTPUT){objCell.m_fixedInputType=SBGrid.DEF.SBIT_CHECK;var heImg=document.createElement("img");heImg.setAttribute("alt","");var strImgId="fixedCheckbox_"+this.id+"_"+nCol.toString();heImg.setAttribute("id",strImgId);heImg.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgUnCheck;eval("SBGrid.DEF.addEvent(heImg, 'onclick', function(){SBGrid.DEF.doClickcheckbox('"+this.id+"');});");objCell.m_heCtrl.insertBefore(heImg,objCell.m_heCtrl.firstChild)}}else{if(objCell.m_fixedInputType==SBGrid.DEF.SBIT_CHECK){objCell.m_fixedInputType=SBGrid.DEF.SBIT_OUTPUT;objCell.m_heCtrl.removeChild(objCell.m_heCtrl.firstChild)}}}};SBGrid.CT.DataGrid.prototype.fixedcellbutton=function(b,c){if(this.isFixedCell(b,c)){var a=this.getCellEx(b,c);if(null!=a){if(a.m_fixedInputType==SBGrid.DEF.SBIT_OUTPUT){return false}else{if(a.m_fixedInputType==SBGrid.DEF.SBIT_INPUTBUTTON){return true}}}}return false};SBGrid.CT.DataGrid.prototype.setFixedcellbutton=function(g,l,n){if(this.isFixedCell(g,l)){var h=this.getCellEx(g,l);if(null!=h){if(h.m_fixedInputType==SBGrid.DEF.SBIT_OUTPUT&&n){h.m_fixedInputType=SBGrid.DEF.SBIT_INPUTBUTTON;var m=jQuery(h.m_heCtrl).text();var b=(this.m_arColWidth[l]-22)+"px";var c="";var o="";if(SBGrid.DEF.is_mozBrowser){o="95%"}else{o="100%"}var p="<table cellpadding=0 cellspacing=0 border=0 height="+o+" style=\"font-family:굴림;font-size:9pt;\"><tr><td width='100%'>";c="";c+=h.getAttribute("font-family")?"font-family:"+h.getAttribute("font-family")+";":"";c+=h.getAttribute("font-size")?"font-size:"+h.getAttribute("font-size")+";":"";c+=h.getAttribute("font-weight")?"font-weight:"+h.getAttribute("font-weight")+";":"";c+=h.getAttribute("font-style")?"font-style:"+h.getAttribute("font-style")+";":"";c+=h.getAttribute("text-decoration")?"font-family:"+h.getAttribute("text-decoration")+";":"";c+=h.getAttribute("color")?"color:"+h.getAttribute("color")+";":"";c+=h.getAttribute("text-align")?"text-align:"+h.getAttribute("text-align")+";":"";var d="<div id='"+h.id+"_data' style=\""+c+"border-right-color:transparent; border-bottom-color:transparent; border-top-color:transparent; border-left-color:transparent;width:"+b+';overflow:hidden;">';d+='<span style="white-space:nowrap;">'+m+"</span>";d+="</div>";p+=d+"</td><td width='18px' style='height:100%'>";var e="";if(SBGrid.DEF.is_webkit){e="border-top-width:0px;border-bottom-width:0px;padding-top:0px;padding-bottom:0px;"}else{e="border-width:1px;"}var a="height:100%;"+e+"background-repeat:no-repeat;background-position:center;background-image:url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.imgGridButton+");";a=SBGrid.DEF.is_opera?a:a+"width:18px;";var i='<BUTTON style="'+a+'"></BUTTON>';p+=i+"</td></tr></table>";jQuery(h.m_heCtrl).html(p)}else{if((h.m_fixedInputType==SBGrid.DEF.SBIT_INPUTBUTTON||h.m_fixedInputType==SBGrid.DEF.SBIT_OUTPUTBUTTON)&&!n){h.m_fixedInputType=SBGrid.DEF.SBIT_OUTPUT;var m=jQuery(h.m_heCtrl).text();var f='<span style="border-right-color:transparent; border-bottom-color:transparent; border-top-color:transparent; border-left-color:transparent;"></span>';m='<span style="white-space:nowrap;">'+m+"</span>";jQuery(h.m_heCtrl).html(f+m)}}}}};SBGrid.CT.DataGrid.prototype.__FFRowMove=function(){if(!(SBGrid.DEF.is_ie8)){var d=this.m_heWhole.clientHeight-this.getFixedFrozenRowHeight();this.m_heFFC.style.height=(d<0?0:d).toString();+"px"}this.m_heFFS.style.width=this.m_heWhole.clientWidth+"px";this.m_heFFBS.style.width=this.m_heWhole.clientWidth+"px";var a=0;var b=this.fixedRows+this.frozenRows;for(var c=0;c<b&&c<this.m_nRealRows;c++){if(null!=this.m_htRowHeight[c]){a+=this.m_htRowHeight[c]}else{a+=c<this.fixedRows?this.m_nRowHeight:this.dataHeight}}this.m_heFFS.style.height=a+"px";this.m_heFFNS.style.height=a+"px"};SBGrid.CT.DataGrid.prototype.bottomRowMove=function(){var a=0;for(var b=1;b<=this.m_nBottomRowCount;b++){if(null!=this.m_htRowHeight[this.m_nRealRows-b]){a+=this.m_htRowHeight[this.m_nRealRows-b]}else{a+=this.dataHeight}}this.m_heFFBS.style.top=(this.m_heWhole.clientHeight-a)+"px";this.m_heFFBS.style.height=a+"px";this.m_heFFBNS.style.top=(this.m_heWhole.clientHeight-a)+"px";this.m_heFFBNS.style.height=a+"px"};SBGrid.CT.DataGrid.prototype.cellFormat=function(a,c){var b=this.m_htCellFormat[this.id+"_"+a+"_"+c];b=null==strformat?"":b;return b};SBGrid.CT.DataGrid.prototype.setCellFormat=function(d,g,f){var e=this.id+"_"+d+"_"+g;var c=this.getCellByIdEx(e);var b;var a=this.m_replaceString;this.m_htCellFormat[e]=f;if(a!=""&&a!="undefined"&&a!=null){b=a.split("?")}if(null!=c){SBGrid.CF.GridSetTextRefresh(c,SBGrid.CF.GridGetText(c),b,this.m_bIsDataReplaceValueChanged)}};SBGrid.CT.DataGrid.prototype.cellStyle=function(){return""};SBGrid.CT.DataGrid.prototype.setCellStyle=function(w,t,q,a,v,s){if(arguments.length<4){SBGrid.DEF.APIerrorMsg(this.id+".setCellStyle","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}else{if(w.trim()==""){return}else{if((typeof w)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setCellStyle","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if((typeof t)!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setCellStyle","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}else{if(!isFinite(t)||t<0||t>=this.rows){return}}if((typeof q)!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setCellStyle","Please check if 3rd parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}else{if(!isFinite(q)||q<0||q>=this.cols){return}}if(arguments.length==4){s=a;a=t;v=q}else{if(arguments.length>4){if((typeof a)!="number"){if(a==null||a==""){a=t}else{SBGrid.DEF.APIerrorMsg(this.id+".setCellStyle","Please check if 4th parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}else{if(!isFinite(a)){return}else{if(a<t){a=t}else{if(a>=this.rows){a=this.rows-1}}}}if((typeof v)!="number"){if(v==null||v==""){v=q}else{SBGrid.DEF.APIerrorMsg(this.id+".setCellStyle","Please check if 5th parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}else{if(!isFinite(v)){return}else{if(v<q){v=q}else{if(v>=this.cols){v=this.cols-1}}}}}}}if(SBGrid.DEF.SB_STYLELIST[w]){var f=(w!="background-color"?"!important":"");if(w.indexOf("color")!=-1){var b=Number(s);s=isNaN(b)?s:"#"+SBGrid.DEF.RGB_convert(b);b=null}for(var n=t;n<=a;n++){var o=n.toString();var m=this.m_mapGridStyleInfo.find(o);if(m==undefined){this.m_mapGridStyleInfo.add(o,(new SBGrid.DS.Map()));m=this.m_mapGridStyleInfo.find(o)}for(var l=q;l<=v;l++){if(s!=""){var u="";var d=l.toString();var c=m.find(d);if(c==undefined){c={};c[w]=s+f;m.add(d,c);u=w+":"+s+f+";"}else{var r=SBGrid.DEF.getPropertyNameList(c);for(var h=0,p=r.length;h<p;h++){u+=r[h]+":";u+=c[r[h]]+";"}c[w]=s+f;u+=w+":"+s+f+";";SBGrid.DEF.clearArray(r);r=null}var g=this.getCellEx(n,l);if(g!=null&&g.m_heCtrl!=null){var e=g.m_heCtrl.style.cssText+";";g.m_heCtrl.style.cssText=(e+u)}g=u=d=c=e=null}}o=m=null}f=null}};SBGrid.CT.DataGrid.prototype.rebuildStyle=function(s,r,c,w,t){if(arguments.length==1||arguments.length==3){return}else{if(arguments.length==0){var e=this.m_mapGridStyleInfo.keys();for(var o=0,h=e.length;o<=h;o++){var x=parseInt(e[o]);var n=this.m_mapGridStyleInfo.find(x.toString());if(n!=undefined){if(!(this.m_objScroll.bScrollEvent)){var p=n.keys();if(p!=undefined){for(var m=0;m<p.length;m++){var u=parseInt(p[m]);var b=n.find(u.toString());var v=SBGrid.DEF.getPropertyNameList(b);var g=this.getCellEx(x,u);if(g&&g.m_heCtrl){var a=jQuery(g.m_heCtrl);for(var l=0;l<v.length;l++){var f=v[l];a.css(f,"");f=null}a=null}u=b=v=null}}}n.clear()}n=null}SBGrid.DEF.clearArray(e);e=null;this.m_mapGridStyleInfo.clear();this.m_mapColStyleInfo.clear();t=false}else{if((typeof s)!="number"){SBGrid.DEF.APIerrorMsg(this.id+".rebuildStyle","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}else{if(!isFinite(s)||s<0||s>=this.rows){SBGrid.DEF.APIerrorMsg(this.id+".rebuildStyle","Please check if first parameter's value is valid.",SBGrid.DEF.DEBUG_MODE);return}}if((typeof r)!="number"){SBGrid.DEF.APIerrorMsg(this.id+".rebuildStyle","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}else{if(!isFinite(r)||r<0||r>=this.cols){SBGrid.DEF.APIerrorMsg(this.id+".rebuildStyle","Please check if second parameter's value is valid.",SBGrid.DEF.DEBUG_MODE);return}}if((typeof c)!="number"){if(c==null||c==""){c=s}else{SBGrid.DEF.APIerrorMsg(this.id+".rebuildStyle","Please check if 3rd parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}else{if(!isFinite(c)){SBGrid.DEF.APIerrorMsg(this.id+".rebuildStyle","Please check if 3rd parameter's value is valid.",SBGrid.DEF.DEBUG_MODE);return}else{if(c<s){SBGrid.DEF.APIerrorMsg(this.id+".rebuildStyle","Please check if 3rd parameter's value is valid.",SBGrid.DEF.DEBUG_MODE);return}else{if(c>=this.rows){c=this.rows-1}}}}if((typeof w)!="number"){if(w==null||w==""){w=r}else{SBGrid.DEF.APIerrorMsg(this.id+".rebuildStyle","Please check if 4th parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}else{if(!isFinite(w)){SBGrid.DEF.APIerrorMsg(this.id+".rebuildStyle","Please check if 4th parameter's value is valid.",SBGrid.DEF.DEBUG_MODE);return}else{if(w<r){SBGrid.DEF.APIerrorMsg(this.id+".rebuildStyle","Please check if 4th parameter's value is valid.",SBGrid.DEF.DEBUG_MODE);return}else{if(w>=this.cols){w=this.cols-1}}}}if(t==undefined){t=false}else{if((typeof t)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".rebuildStyle","Please check if 5th parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}for(var o=s;o<=c;o++){var q=o.toString();var n=this.m_mapGridStyleInfo.find(q);if(n!=undefined){if(!(this.m_objScroll.bScrollEvent)){var p=n.keys();for(var m=0;m<p.length;m++){var u=parseInt(p[m]);var b=n.find(u.toString());var v=SBGrid.DEF.getPropertyNameList(b);var g=this.getCellEx(o,u);if(g&&g.m_heCtrl){var a=jQuery(g.m_heCtrl);for(var l=0;l<v.length;l++){var f=v[l];a.css(f,"");f=null}a=null}u=b=v=null}}for(var m=r;m<=w;m++){var d=m.toString();n.remove(d)}if(n.count()==0){this.m_mapGridStyleInfo.remove(q)}}q=n=null}}}if(!t){this.scrollingGrid(true)}};SBGrid.CT.DataGrid.prototype.allStyle=function(b,a){if(SBGrid.DEF.SB_STYLELIST[a]){switch(b){case"data":return this.cellStyle(a,this.fixedRows,this.fixedCols,this.m_nRealRows-1,this.cols-1);break;case"fixed":if(0<this.fixedCols){return this.cellStyle(a,0,0,this.m_nRealRows-1,this.fixedCols-1)}else{return this.cellStyle(a,0,0,this.fixedRows-1,this.cols-1)}break;case"all":return this.cellStyle(a,0,0,this.m_nRealRows-1,this.cols-1);break}}return""};SBGrid.CT.DataGrid.prototype.setAllStyle=function(b,a,c){if(SBGrid.DEF.SB_STYLELIST[a]){switch(b){case"data":this.setCellStyle(a,this.fixedRows,this.fixedCols,this.m_nRealRows-1,this.cols-1,c);break;case"fixed":this.setCellStyle(a,0,0,this.fixedRows-1,this.cols-1,c);if(0<this.fixedCols){this.setCellStyle(a,0,0,this.m_nRealRows-1,this.fixedCols-1,c)}break;case"all":this.setCellStyle(a,0,0,this.m_nRealRows-1,this.cols-1,c);break}}};SBGrid.CT.DataGrid.prototype.getColStyle=function(c,b,a){if(null==c||(0>c||this.cols<=c)){return}if(SBGrid.DEF.SB_STYLELIST[a]){switch(b){case"data":if(c>=this.fixedCols){return this.cellStyle(a,this.fixedRows,c,this.m_nRealRows-1,c)}break;case"fixed":if(c<this.fixedCols){return this.cellStyle(a,0,c,this.m_nRealRows-1,c)}else{return this.cellStyle(a,0,c,this.fixedRows-1,c)}break;case"all":return this.cellStyle(a,0,c,this.m_nRealRows-1,c);break}}return""};SBGrid.CT.DataGrid.prototype.setColStyle=function(g,d,c,e){if(null==g||(0>g||this.cols<=g)){return}if(SBGrid.DEF.SB_STYLELIST[c]){switch(d){case"data":if(g>=this.fixedCols){this.setCellStyle(c,this.fixedRows,g,this.m_nRealRows-1,g,e)}break;case"fixed":if(g<this.fixedCols){this.setCellStyle(c,0,g,this.m_nRealRows-1,g,e)}else{this.setCellStyle(c,0,g,this.fixedRows-1,g,e)}break;case"all":this.setCellStyle(c,0,g,this.m_nRealRows-1,g,e);break}var a=(c!="background-color"?"!important":"");var f=this.m_mapColStyleInfo.find(g.toString());if(f==undefined){var b={};b[c]=e+a;this.m_mapColStyleInfo.add(g.toString(),{type:d,style:b});a=b=null}else{f.type=d;f.style[c]=e+a}a=f=null}};SBGrid.CT.DataGrid.prototype.setColStyles=function(f,h,a){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setColStyles","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof f)!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setColStyles","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(f==null||(f<0||f>=this.cols)){return}if(a==undefined||(a!="fixed"&&a!="data"&&a!="all")){a="data"}var c=0;var b=this.rows-1;if(a=="fixed"){b=this.fixedRows-1}if(a=="data"){c=this.fixedRows}if(h!=""){var l=h.split(";");var d=l.indexOf("");while(d!=-1){l.splice(d,1);d=l.indexOf("")}for(var e=0,m=l.length;e<m;e++){var g=l[e].split(":");g[0]=g[0].trim();if(SBGrid.DEF.SB_STYLELIST[g[0]]){this.setColStyle(f,a,g[0],g[1])}SBGrid.DEF.clearArray(g);g=null}SBGrid.DEF.clearArray(l);l=d=null}};SBGrid.CT.DataGrid.prototype.rowStyle=function(a,c,b){if(SBGrid.DEF.SB_STYLELIST[b]){switch(c){case"data":if(a>=this.fixedRows){return this.cellStyle(b,a,this.fixedCols,a,this.cols-1)}break;case"fixed":if(a<this.fixedRows){return this.cellStyle(b,a,0,a,this.cols-1)}else{if(0<this.fixedCols){return this.cellStyle(b,a,0,a,this.fixedCols-1)}}break;case"all":return this.cellStyle(b,a,0,a,this.cols-1);break}}return""};SBGrid.CT.DataGrid.prototype.setRowStyle=function(a,c,b,d){if(SBGrid.DEF.SB_STYLELIST[b]){switch(c){case"data":if(a>=this.fixedRows){this.setCellStyle(b,a,this.fixedCols,a,this.cols-1,d)}break;case"fixed":if(a<this.fixedRows){this.setCellStyle(b,a,0,a,this.cols-1,d)}else{if(0<this.fixedCols){this.setCellStyle(b,a,0,a,this.fixedCols-1,d)}}break;case"all":this.setCellStyle(b,a,0,a,this.cols-1,d);break}}};SBGrid.CT.DataGrid.prototype.editControlHeight=function(b){if(!SBGrid.DEF.is_smartphone){var a=this.m_heWhole.clientHeight;var d=null!=this.m_heFFS.clientHeight?this.m_heFFS.clientHeight:0;var c=null!=this.m_heFFBS.clientHeight?this.m_heFFBS.clientHeight:0;if(b>(a-d-c)){return(a-d-c)}return b}return b};SBGrid.CT.DataGrid.prototype.getInputTopPosition=function(c){if(c<this.fixedCols+this.frozenCols){var b=this.m_heFFC.offsetTop?this.m_heFFC.offsetTop:0;return b}else{var a=null!=this.m_heFFS.clientHeight?this.m_heFFS.clientHeight:0;return a}};SBGrid.CT.DataGrid.prototype.getEditControl=function(a){if(a==SBGrid.DEF.SBIT_INPUT){return this.m_objInput}else{if(a==SBGrid.DEF.SBIT_TEXTAREA){return this.m_objTextArea}}};SBGrid.CT.DataGrid.prototype.getAllowUserResize=function(b){if(null!=b&&-1!=b){var a=this.getColumnControl(b);if(null!=a){return a.getAttribute("allowuserresize")}}return this.allowUserResize};SBGrid.CT.DataGrid.prototype.getAllowUserResizeWidth=function(a){return this.getAllowUserResize(a)};SBGrid.CT.DataGrid.prototype.setAllowUserResizeWidth=function(c,a){if(null!=c&&-1!=c){var b=this.getColumnControl(c);if(null!=b){b.setAttribute("allowuserresize",a);return true}}return false};SBGrid.CT.DataGrid.prototype.setGridCursor=function(a){var b=this.getAttribute("cursor");if(null==b){b="arrow"}if(a==b){return}if(0>b.indexOf("resize")){this.m_strPrevCursor=b}this.setAttribute("cursor",a)};SBGrid.CT.DataGrid.prototype.restoreCursor=function(){if(SBGrid.DEF.bDragDrop){return}if(this.m_strPrevCursor.isEmpty()){this.m_strPrevCursor="arrow"}this.setAttribute("cursor",this.m_strPrevCursor)};SBGrid.CT.DataGrid.prototype.clearSelection=function(d,a){d=(d==undefined?this.fixedRows:d);a=(a==undefined?this.m_nRealRows-1:a);if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){for(var c=d;c<=a;c++){this.deSelectRow(c)}}else{if(SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){for(var c=this.fixedCols;c<this.cols;c++){this.deSelectCol(c)}}else{if(SBGrid.DEF.SBSM_FREE==this.getSelectionMode()){for(var f in this.m_htSelectCells){var b=this.m_htSelectCells[f];if(null!=b){if(b.row<d||b.row>a){continue}delete this.m_htSelectCells[f];this.setCellSelect(b,false)}}}}}if(null!=this.m_arSelectCols){this.m_arSelectCols=new Array()}if(d==this.fixedRows&&a==this.m_nRealRows-1){if(null!=this.m_arSelectRows){this.m_arSelectRows=new Array();this.selectedRows=0}if(null!=this.m_htSelectCells){for(var e in this.m_htSelectCells){delete this.m_htSelectCells[e]}}}};SBGrid.CT.DataGrid.prototype.isSelected=function(b){var a=SBGrid.DEF.arrFind_Value(this.m_arSelectRows,b);return -1!=a?true:false};SBGrid.CT.DataGrid.prototype.setIsSelected=function(b,a){if(a){this.selectRow(b)}else{this.deSelectRow(b)}};SBGrid.CT.DataGrid.prototype.deSelectRow=function(d){var a=SBGrid.DEF.arrFind_Value(this.m_arSelectRows,d);if(-1!=a){SBGrid.DEF.arrRemoveAt(this.m_arSelectRows,a);for(var c=this.fixedCols;c<this.cols;c++){var b=this.getCellEx(d,c);if(null!=b){this.setCellSelect(b,false)}}this.selectedRows=this.m_arSelectRows.length}if(this.m_bRowHeader&&this.getRowHeader()==SBGrid.DEF.SBRH_SELECT){var b=this.getCellEx(d,0);if(b!=null){SBGrid.CF.GridChangeRowHeadSelect(b,false)}}};SBGrid.CT.DataGrid.prototype.selectedRow=function(a){if(null!=a){if(this.m_arSelectRows!=null&&(this.m_arSelectRows instanceof Array)){if(null!=this.m_arSelectRows[a]){return this.m_arSelectRows[a]}}}return -1};SBGrid.CT.DataGrid.prototype.selectRow=function(f){if(f<this.fixedRows||this.m_nRealRows<=f||this.m_arSelectRows==undefined){return}var e=this.getLimitedSelectRows();if(e.length>0&&SBGrid.DEF.arrBinarySearch(f,e)!=-1){e=null;return}if(!this.m_bUseFrozenSelect&&this.isFrozenCol(this.m_nDownCol)){this.clearSelection();return}var b=SBGrid.DEF.arrFind_Value(this.m_arSelectRows,f);if(-1==b){this.m_arSelectRows.push(f);var a=0;if(!this.m_bUseFrozenSelect){a=this.frozenCols+this.fixedCols}else{a=this.fixedCols}for(var d=a;d<this.cols;d++){var c=this.getCellEx(f,d);if(null!=c){this.setCellSelect(c,true)}}this.selectedRows=this.m_arSelectRows.length}if(this.m_bRowHeader&&this.getRowHeader()==SBGrid.DEF.SBRH_SELECT){var c=this.getCellEx(f,0);if(c!=null){SBGrid.CF.GridChangeRowHeadSelect(c,true)}}};SBGrid.CT.DataGrid.prototype.getSelectedRows=function(){return this.m_arSelectRows};SBGrid.CT.DataGrid.prototype.getLastFocusRow=function(){var a=-1;if(this.m_arSelectRows&&(this.m_arSelectRows instanceof Array)){if(this.m_arSelectRows.length>0){a=this.m_arSelectRows[this.m_arSelectRows.length-1]}}return a};SBGrid.CT.DataGrid.prototype.deSelectCol=function(d){var a=SBGrid.DEF.arrFind_Value(this.m_arSelectCols,d);if(-1!=a){SBGrid.DEF.arrRemoveAt(this.m_arSelectCols,a);for(var c=this.fixedRows;c<this.rows;c++){var b=this.getCellEx(c,d);if(null!=b){this.setCellSelect(b,false)}}}};SBGrid.CT.DataGrid.prototype.selectCol=function(d){if(this.getSelectionMode()!=3){return}if(!this.m_bUseFrozenSelect&&this.isFrozenCol(d)){this.clearSelection();return}var a=SBGrid.DEF.arrFind_Value(this.m_arSelectCols,d);if(-1==a){this.m_arSelectCols.push(d);for(var c=this.fixedRows;c<this.rows;c++){var b=this.getCellEx(c,d);if(null!=b){this.setCellSelect(b,true)}}}};SBGrid.CT.DataGrid.prototype.addSelCells=function(c,d,b){if(!b){return}var a=this.m_htSelectCells[b.id];if(null==a){this.m_htSelectCells[b.id]=b;this.setCellSelect(b,true)}};SBGrid.CT.DataGrid.prototype.removeSelCells=function(b){if(null==b||""==b){return}var a=this.m_htSelectCells[b];if(null!=a){delete this.m_htSelectCells[b];this.setCellSelect(a,false)}};SBGrid.CT.DataGrid.prototype.getSelectedCellsInfo=function(e,a,f){e=(e==undefined?this.fixedRows:e);a=(a==undefined?this.m_nRealRows-1:a);f=(f==undefined?false:f);var m=new SBGrid.DS.Map();var n=this.getSelectedCells(f);var l=n.keys().sort();for(var g=0,o=n.count();g<o;g++){var d=n.item(l[g]);var c=d.row;var h=d.col;if(c<e||c>a){continue}if(m.find(c.toString())==undefined){var b=new SBGrid.DS.Set();b.add(h);m.add(c.toString(),b);b=null}else{m.find(c.toString()).add(h)}}return m};SBGrid.CT.DataGrid.prototype.getSelectedCells=function(a){var f=new SBGrid.DS.Collection();if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){for(var d=0;d<this.m_arSelectRows.length;d++){if(this.isRowHidden(d)&&!a){continue}for(var b=this.fixedCols;b<this.cols;b++){if(this.isColHidden(b)&&!a){continue}var c=this.getCellEx(this.m_arSelectRows[d],b);if(null!=c){f.add(c.id,c)}}}return f}else{if(SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){for(var d=0;d<this.m_arSelectCols.length;d++){for(var b=this.fixedRows;b<this.m_nRealRows;b++){var c=this.getCellEx(b,this.m_arSelectCols[d]);if(null!=c){f.add(c.id,c)}}}return f}else{if(SBGrid.DEF.SBSM_FREE==this.getSelectionMode()){var f=new SBGrid.DS.Collection();for(var e in this.m_htSelectCells){var c=this.m_htSelectCells[e];if(null!=c){f.add(e,c)}}return f}}}return f};SBGrid.CT.DataGrid.prototype.multiSelectCells=function(a,e,n,q,l,d,c){var g=a<n?a:n;var b=a<n?n:a;var m=e<q?e:q;var f=e<q?q:e;var p=this.getSelectionMode();var o=this.fixedCols;if(SBGrid.DEF.SBSM_LIST==p||SBGrid.DEF.SBSM_BYROW==p||SBGrid.DEF.SBSM_FREE==p){if(l){if(this.fixedRows>n){g=this.fixedRows;b=a}else{if((this.fixedRows+this.frozenRows)<=n){g=a;b=(this.fixedRows+this.frozenRows)-1}}}else{if(d){if((this.m_nRealRows-this.frozenBottomRows)>n){g=this.m_nRealRows-this.frozenBottomRows;b=a}else{if((this.m_nRealRows-1)<=n){g=a;b=this.m_nRealRows-1}}}else{if((this.fixedRows+this.frozenRows)>n){g=(this.fixedRows+this.frozenRows);b=a}else{if((this.m_nRealRows-this.frozenBottomRows)<=n){g=a;b=(this.m_nRealRows-this.frozenBottomRows)-1}}}}}if(SBGrid.DEF.SBSM_BYCOL==p||SBGrid.DEF.SBSM_FREE==p){if(c){if(o>q){m=o;f=e}else{if((o+this.frozenCols)<=q){m=e;f=(o+this.frozenCols)-1}}}else{if((o+this.frozenCols)>q){m=o+this.frozenCols;f=e}}}if(SBGrid.DEF.SBSM_LIST==p||SBGrid.DEF.SBSM_BYROW==p){for(var h=this.fixedRows;h<this.m_nRealRows;h++){if(h>=g&&h<=b){this.selectRow(h)}else{this.deSelectRow(h)}}}else{if(SBGrid.DEF.SBSM_BYCOL==p){for(var h=o;h<this.cols;h++){if(h>=m&&h<=f){this.selectCol(h)}else{this.deSelectCol(h)}}}else{if(SBGrid.DEF.SBSM_FREE==p){this.clearSelection();this.selectCells(g,m,b,f)}}}};SBGrid.CT.DataGrid.prototype.deSelectCells=function(f,g,b,e){if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){for(var d=f;d<=b;d++){this.deSelectRow(d)}}else{if(SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){for(var d=g;d<=e;d++){this.deSelectCol(d)}}else{if(SBGrid.DEF.SBSM_FREE==this.getSelectionMode()){for(var d=f;d<=b;d++){for(var a=g;a<=e;a++){var c=this.getCellEx(d,a);if(null!=c){this.removeSelCells(c.id)}}}}}}};SBGrid.CT.DataGrid.prototype.selectCells=function(f,g,b,e){if(!this.getAllowSelection()){f=b;g=e}if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){for(var d=f;d<=b;d++){this.selectRow(d)}}else{if(SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){for(var d=g;d<=e;d++){this.selectCol(d)}}else{if(SBGrid.DEF.SBSM_FREE==this.getSelectionMode()){var h=true;for(var d=f;d<=b;d++){for(var a=g;a<=e;a++){var c=this.getCellEx(d,a);if(null!=c){if(h){}else{}if(!this.m_bUseFrozenSelect&&this.isFrozenCell(d,a)){this.removeSelCells(c)}else{this.addSelCells(d,a,c)}}}}}else{if(SBGrid.DEF.SBSM_NONE==this.getSelectionMode()){}}}}};SBGrid.CT.DataGrid.prototype.getRowHidden=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".isRowHidden","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".isRowHidden","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}return this.isRowHidden(a)};SBGrid.CT.DataGrid.prototype.isRowHidden=function(a){if(true==this.m_arHiddenRowState[a]){return true}return false};SBGrid.CT.DataGrid.prototype.getMoveCell=function(d,f,a){var c=this.getCellEx(d,f);var b=d;var e=f;if(SBGrid.DEF.SBKE_NEXT==a){while(1){if(f==this.cols-1){f=this.fixedCols;d++}else{f++}if(d==this.rows){d=b;f=e;break}if(this.isRowHidden(d)||this.isColHidden(f)){continue}c=this.getCellEx(d,f);if(null==c||SBGrid.DEF.SBSM_HIDE!=c.mergeType){break}else{b=d;e=f}}}else{if(SBGrid.DEF.SBKE_PREVIOUS==a){while(1){if(f==this.fixedCols){f=this.cols-1;d--}else{f--}if(d<this.fixedRows){d=b;f=e;break}if(this.isRowHidden(d)||this.isColHidden(f)){continue}c=this.getCellEx(d,f);if(null==c||SBGrid.DEF.SBSM_HIDE!=c.mergeType){break}else{b=d;e=f}}}else{if(SBGrid.DEF.SBKE_MOVETOP==a){while(1){d--;if(d<this.fixedRows){d=b;f=e;break}if(this.isRowHidden(d)||this.isColHidden(f)){continue}c=this.getCellEx(d,f);if(null==c||SBGrid.DEF.SBSM_HIDE!=c.mergeType){break}else{b=d;e=f}}}else{if(SBGrid.DEF.SBKE_MOVEBOTTOM==a){while(1){d++;if(d==this.rows){d=b;f=e;break}if(this.isRowHidden(d)||this.isColHidden(f)){continue}c=this.getCellEx(d,f);if(null==c||SBGrid.DEF.SBSM_HIDE!=c.mergeType){break}else{b=d;e=f}}}}}}return new SBGrid.DS.Point(f,d)};SBGrid.CT.DataGrid.prototype.moveTop=function(d){var c=this.getRow();var f=this.getCol();var e=c;var a=this.getMoveCell(c,f,SBGrid.DEF.SBKE_MOVETOP);c=a.m_nY;f=a.m_nX;if(c<this.fixedRows){return}this.setRowValue(c);this.setColValue(f);this.clearSelection();this.selectCells(c,f,c,f);if(c!=e){this.dispatch("onrowchanged")}var b=this.getCellEx(c,f);if(b){SBGrid.DEF.setFocus(b.id);this.dispatch("onentercell")}};SBGrid.CT.DataGrid.prototype.moveDown=function(d){var c=this.getRow();var f=this.getCol();var e=c;var a=this.getMoveCell(c,f,SBGrid.DEF.SBKE_MOVEBOTTOM);c=a.m_nY;f=a.m_nX;if(c>this.rows-1){return}this.setRowValue(c);this.setColValue(f);this.clearSelection();this.selectCells(c,f,c,f);if(c!=e){this.dispatch("onrowchanged")}var b=this.getCellEx(c,f);if(b){SBGrid.DEF.setFocus(b.id);this.dispatch("onenterCell");this.topScrollCellEx(this.getRow(),true)}};SBGrid.CT.DataGrid.prototype.funcMoveUp=function(a){this.moveTop(a)};SBGrid.CT.DataGrid.prototype.funcMoveDown=function(a){this.moveDown(a)};SBGrid.CT.DataGrid.prototype.funcMoveLeft=function(a){if(this.row==this.fixedRows&&this.col==this.fixedCols){return}else{this.dispatch("onprevious")}};SBGrid.CT.DataGrid.prototype.funcMoveRight=function(a){if(this.row==this.rows-1&&this.col==this.cols-1){return}else{this.dispatch("onnext")}};SBGrid.CT.DataGrid.prototype.closePopUp=function(){for(var a=0;a<this.cols;a++){var b=this.m_arColumn[a];if(null!=b){if(null!=b.m_objCombo){b.onBlur(SBGrid.DEF.m_event);b.m_objCombo.showItemList(false);b.m_objCombo.showItemListBar(false)}else{if(null!=b.m_objCalendar){this.m_bIsShowItem=false;b.m_objCalendar.setVisible(false)}}}}if(this.m_objInput||this.m_objTextArea){this.stopEditing()}this.setConTextVisible(false)};SBGrid.CT.DataGrid.prototype.closePopUpEx=function(){if(this.m_bIsCellsInfoDiv!=null){this.m_bIsCellsInfoDiv.style.visibility="hidden"}if(null!=this.m_objTextArea){this.m_objTextArea.setVisible(false)}if(null!=this.m_objInput){this.m_objInput.setVisible(false)}if(this.m_objInput||this.m_objTextArea){this.stopEditing()}for(var a=0;a<this.cols;a++){var b=this.m_arColumn[a];if(null!=b){if(null!=b.m_objCombo){b.onBlur(SBGrid.DEF.m_event);b.m_objCombo.showItemList(false);b.m_objCombo.showItemListBar(false);b.m_objCombo.m_heItemList.style.left="0px";this.m_bIsShowCombo=false}else{if(null!=b.m_objCalendar){this.m_bIsShowItem=false;b.m_objCalendar.setVisible(false);b.m_objCalendar.m_heCtrl.style.left="0px"}}}}this.setConTextVisible(false)};SBGrid.CT.DataGrid.prototype.stopEditing=function(){if(this.isEditing()){this.setCellEditText()}};SBGrid.CT.DataGrid.prototype.getColCombo=function(b){var a=this.m_arColumn[b];if(null!=a){return a.m_objCombo}return null};SBGrid.CT.DataGrid.prototype.setCellEditText=function(){var b=this.getEditRow();var d=this.getEditCol();var a=this.getCellEx(b,d);if(null!=a&&this.isNormalCell(b,d)){var c=this.getColumnControl(d);if(null!=c&&c.onAfterEdit()&&c.getRefNode()){this.eventCaptionClear()}else{if(null!=c.getRefNode()){c.setValue("");c.setText("")}this.dispatch("onafteredit");this.dispatch("onendedit");this.eventCaptionClear()}this.autoResizeHeight(b)}document.getElementById("SBHE_"+this.id+"_input").removeAttribute("title")};SBGrid.CT.DataGrid.prototype.editCell=function(a){if(a==undefined){a=50}else{if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".editCell","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return false}}if(!this.isEditing()){window.setTimeout("SBGrid.getGrid('"+this.id+"').setEditCell(SBGrid.DEF.m_event);",a)}};SBGrid.CT.DataGrid.prototype.setEditCell=function(a){var d=this.getRow();var g=this.getCol();var i=this.m_bRowHeader?1:0;var m=document.getElementById(this.id+"_"+d+"_"+g+"_data");var l=document.getElementById(this.id+"_"+d+"_"+g+"_Button");if(d>=0&&g>=0){var e=this.getCellEx(d,g);if(null!=e&&this.isNormalCell(d,g)){if(e.disabled||e.m_bIsSubTotal){return}var c=this.getColumnControl(g);a.capture="";if(null!=c){var h=c.getInputType();if(SBGrid.DEF.SBIT_COMBO==h&&d==this.fixedRows){var f=document.getElementById("SBHE_"+this.m_strComboId+"_input");if(this.m_strUserCaption!=""){f.title=this.m_arUserCaption[g-this.fixedCols]+"열 입니다."}else{return}}else{if((SBGrid.DEF.SBIT_CHECK==h)&&(SBGrid.EVT.SPACE==a.keyCode||SBGrid.EVT.ENTER==a.keyCode)){c.setCheck(!c.getCheck())}else{if(SBGrid.DEF.SBIT_INPUTBUTTON==h&&m.getAttribute("Textflg")=="false"){return}else{if(l){if(SBGrid.DEF.SBIT_INPUTBUTTON==h&&l.getAttribute("Buttonflg")=="false"){return}}else{if(c.getEditable()){this.dispatch("onbeforeedit");document.getElementById("SBHE_"+this.id+"_input").setAttribute("title",c.getAttribute("title"));if(this.getColType(g)=="input"&&this.m_strUserCaption!=""&&d==this.fixedRows){document.getElementById("SBHE_"+this.id+"_input").title=this.m_arUserCaption[g-this.fixedCols]+"열 입니다."}else{if(this.getColType(g)=="textarea"&&this.m_strUserCaption!=""&&d==this.fixedRows){document.getElementById("SBHE_"+this.id+"_textarea").title=this.m_arUserCaption[g-this.fixedCols]+"열 입니다."}}}else{var b=document.getElementById("SBHE_"+this.m_strComboId+".input");if(b){b.title=""}else{return}}}}}}}}}};SBGrid.CT.DataGrid.prototype.isResizing=function(){return(this.getResizeType()!=SBGrid.DEF.SBRS_NONE)};SBGrid.CT.DataGrid.prototype.getResizeType=function(){if("v-resize"==this.getAttribute("cursor")&&this.m_bDown){return SBGrid.DEF.SBRS_HORZ}else{if("h-resize"==this.getAttribute("cursor")&&this.m_bDown){return SBGrid.DEF.SBRS_VERT}}return SBGrid.DEF.SBRS_NONE};SBGrid.CT.DataGrid.prototype.hitTestCell=function(d){if(this.m_bDown&&!(SBGrid.DEF.SBRS_NONE==this.getResizeType())){return}var c=this.getMouseRow();var g=this.getMouseCol();var b=this.getCellEx(c,g);if(null!=b&&this.isFixedCell(c,g)){if(!this.getAllowUserResize(g)){return}var f=d.clientX;var e=d.clientY;var a=this.getCellRect(c,g);if(f>=a.getRight()-6){this.setGridCursor("h-resize");return}if(e>=a.getBottom()-3&&e<=a.getBottom()+3&&0!=this.fixedCols){return}}this.restoreCursor()};SBGrid.CT.DataGrid.prototype.getControlRect=function(){var e=0;var c=0;var b=0;var a=0;var d=this.m_heCtrl;while(null!=d){e+=d.offsetLeft-(SBGrid.DEF.is_android?0:d.scrollLeft);c+=d.offsetTop-(SBGrid.DEF.is_android?0:d.scrollTop);d=d.offsetParent}b=this.m_heCtrl.offsetWidth;a=this.m_heCtrl.offsetHeight;return new SBGrid.DS.Rectangle(e,c,b,a)};SBGrid.CT.DataGrid.prototype.getCellRect=function(b,e){var i=0;var h=0;var f=0;var g=0;var c=this.getCellEx(b,e);if(null!=c){var a=c.m_heCtrl;if(null!=a){var d=a;while(null!=d){i+=d.offsetLeft;h+=d.offsetTop;if(this.m_heWhole==d){if(b<this.fixedRows&&e>=(this.fixedCols+this.frozenCols)){i-=d.scrollLeft}else{if(e<this.fixedCols&&b>=(this.fixedRows+this.frozenRows)){h-=d.scrollTop}}}else{i-=d.scrollLeft;h-=d.scrollTop}d=d.offsetParent}f=a.offsetWidth;g=a.offsetHeight}}return new SBGrid.DS.Rectangle(i,h,f,g)};SBGrid.CT.DataGrid.prototype.getCellContentRect=function(c,e,h){if(h==undefined){h=false}var d=this.getCellEx(c,e);if(null!=d){var b=d.getHtmlElement();var a=b;var l=0;var i=0;var f=0;var g=0;if(""!=a&&"undefined"!=a&&null!=a){while(this.m_heCtrl!=a&&""!=a&&"undefined"!=a&&null!=a){l+=a.offsetLeft;i+=a.offsetTop;a=a.offsetParent}if(!this.isFrozenCol(e)){l=l-this.m_heWhole.scrollLeft}if(!this.isFrozenRow(c)){i=i-this.m_heWhole.scrollTop}f=b.offsetWidth-1;g=b.offsetHeight-1}return new SBGrid.DS.Rectangle(l,i,f,g)}return null};SBGrid.CT.DataGrid.prototype.moveGridExpansion=function(){if(SBGrid.DEF.is_smartphone){if(this.bIsExpansion){var h=document.getElementById("SBHE_DATAGRID_EXPANSION_"+this.id);if(null!=h){var f=this.getControlRect();var g=f.getWidth();var e=f.getHeight();var b=window.scrollX+window.innerWidth-f.getX();var c=window.scrollY+window.innerHeight-f.getY();var d=(g>b)?b:g;var a=(e>c)?c:e;h.style.top=(a-20)+"px";h.style.left=(d-20)+"px"}}}};SBGrid.CT.DataGrid.prototype.remakeGrid=function(){var b=this.getRowCountFromInstance()+this.fixedRows;if(!SBGrid.DEF.is_smartphone){var e=this.m_bChangeFixedRows?0:this.fixedRows;var f=this.m_nMakeIndex;if(this.m_nBottomRowCount>0){this.m_nBottomRowCount=0;this.m_heFFBS.removeChild(this.m_heFFBS.firstChild);this.m_heFFBNS.removeChild(this.m_heFFBNS.firstChild)}this.physicalRemovePartRow(e,f-1);this.m_nMakeIndex=e;this.makePartially();this.m_objScroll.arTargetRow=new Array();for(var d=0;d<this.m_nRealRows;d++){this.m_objScroll.arTargetRow.push(d)}this.m_heFFBS=this.makeFixedFrozenBottomScrollingRow();this.m_heFFBNS=this.makeFixedFrozenBottomNoScrollingRow();this.m_heInitRow=this.makeInitRow()}else{for(var d=0;d<this.m_nRealRows;d++){for(var a=0;a<this.cols;a++){var c=this.getCellEx(d,a);if(null!=c){this.children.remove(c.id);SBGrid.DEF.__removeAll(c.id)}}}this.makeSmartPhoneGrid()}};SBGrid.CT.DataGrid.timer=null;SBGrid.CT.DataGrid.PartiallyCount=100;SBGrid.CT.DataGrid.prototype.makePartially=function(am){var Q=(this.m_nRenderingRows==null?0:parseInt(this.m_nRenderingRows)+this.fixedRows);this.m_nRealRows=this.rows=(null!=this.m_xlRefNode?this.fixedRows+this.m_xlRefNode.length+this.getSubTotalSize():this.fixedRows);if(this.m_bCreateAll){Q=this.m_nRealRows}var X;var K=this.m_replaceString;if(K!=""&&K!="undefined"&&K!=null){X=K.split("?")}var e=parseInt(this.m_heCtrl.clientHeight/this.dataHeight)+10;e=e>Q?e:Q;this.m_objScroll.nMaxLength=e;this.attribute.renderingrows=e;var C=0;var Z=null!=this.m_xlRefNode?this.m_xlRefNode.length:0;var a=this.fixedRows+this.frozenRows;var ae=this.fixedCols+this.frozenCols;var al=false;if(this.m_nRealRows>a&&this.frozenBottomRows>0){al=true}var an=document.getElementById("SBHE_DATAGRID_WHOLE_TBODY_"+this.id);var I=document.getElementById("SBHE_DATAGRID_FFS_TBODY_"+this.id);var ai=document.getElementById("SBHE_DATAGRID_FFN_TBODY_"+this.id);var f=document.getElementById("SBHE_DATAGRID_FFCOL_TBODY_"+this.id);var d=(this.m_nRealRows-this.fixedRows-this.frozenRows-this.frozenBottomRows);var U=d<0?d:0;d=null;var ar=new Array();var S=new Array();var c=new Array();var g=new Array();var ac=this.m_nMakeIndex;var aq=false;var b=false;var R=false;var W="";var r=SBGrid.DEF.is_ie?this.m_heCtrl.currentStyle.textAlign:window.getComputedStyle(this.m_heCtrl,null).textAlign;switch(r){case"center":W=" sbgrid_ac";break;case"right":W=" sbgrid_ar";break}var G=null;if(SBGrid.DEF.is_chrome&&!this.isJsonRef()){G=new Array();for(var aj=0;aj<Z;aj++){var q={};var w=this.m_xlRefNode.item(aj).firstChild;while(w){if("#text"!=w.nodeName){q[w.nodeName]=w}w=w.nextSibling}G.push(q)}}for(var aj=this.m_nMakeIndex;C<e&&aj<this.m_nRealRows;aj++){if(al&&aj>=(this.m_nRealRows-this.frozenBottomRows+U)){continue}var ak=false;var A=aj<this.fixedRows?this.m_nRowHeight:this.dataHeight;this.m_htRowHeight[aj]=A;if(A>0&&!(SBGrid.DEF.is_mozBrowser)){A--}if(null==this.m_arHiddenRowState[aj]){this.m_arHiddenRowState.push(false)}ar.push("<tr rowNum='"+this.id+"_"+aj+"' targetcell = 'who'>");if(aj<a){aq=true;b=true;S.push("<tr rowNum='"+this.id+"_"+aj+"' targetcell = 'ffs'>");c.push("<tr rowNum='"+this.id+"_"+aj+"' targetcell = 'ffn'>")}var P="";if(a<=aj){R=true;g.push("<tr rowNum='"+this.id+"_"+aj+"' targetcell = 'ffc'>")}var H=null;var aa=null;if(this.fixedRows<=aj){if(this.isJsonRef()){aa=this.m_xlRefNode[aj-this.fixedRows]}else{if(!SBGrid.DEF.is_chrome){H=this.m_xlRefNode.item(aj-this.fixedRows)}}if(""!=this.backColorAlternate&&((aj-this.fixedRows)%2)==1){ak=true}else{ak=false}}for(var ah=0;ah<this.cols;ah++){var F=true;if(al&&aj>=(this.m_nRealRows-this.frozenBottomRows+U)){F=false}if(aj<this.fixedRows+this.frozenRows||ah<this.fixedCols+this.frozenCols){F=false}var ag=aj<this.fixedRows||ah<this.fixedCols;var D=!ag&&(aj<this.fixedRows+this.frozenRows||ah<this.fixedCols+this.frozenCols);var t=(aj<this.fixedRows+this.frozenRows&&ah>=this.fixedCols+this.frozenCols);var N=(aj<this.fixedRows+this.frozenRows&&ah<this.fixedCols+this.frozenCols);var Y=(aj>=this.fixedRows)&&aj<(this.m_nRealRows-(this.frozenBottomRows+U));var J=this.m_arColumn[ah];var ap=J.getAttribute("type");var v=this.id+"_"+aj+"_"+ah;var m=null!=J.attribute["class"]?J.attribute["class"]:"";ar.push("<td sbgrid_select='false' rowNum='"+this.id+"_"+aj+"' colNum='"+this.id+"_"+ah+"' cellId='"+this.id+"."+aj+"."+ah+"' targetcell = 'who' ");if(F){ar.push("id='SBHE_"+v+"' ")}if(aq){S.push("<td sbgrid_select='false' rowNum='"+this.id+"_"+aj+"' colNum='"+this.id+"_"+ah+"' cellId='"+this.id+"."+aj+"."+ah+"' targetcell = 'ffs' ");if(t){S.push("id='SBHE_"+v+"' ")}if(D){S.push("frozencell='true' ")}}if(b&&ah<ae){c.push("<td sbgrid_select='false' rowNum='"+this.id+"_"+aj+"' colNum='"+this.id+"_"+ah+"' cellId='"+this.id+"."+aj+"."+ah+"' targetcell = 'ffn' ");if(N){c.push("id='SBHE_"+v+"' ")}if(D){c.push("frozencell='true' ")}}else{b=false}if(R&&ah<ae){g.push("<td sbgrid_select='false' rowNum='"+this.id+"_"+aj+"' colNum='"+this.id+"_"+ah+"' cellId='"+this.id+"."+aj+"."+ah+"' targetcell = 'ffc' ");if(Y){g.push("id='SBHE_"+v+"' ")}if(D){g.push("frozencell='true' ")}}else{R=false}var T=ak?this.id+"_altc ":this.id+"_dc ";T=ag?(Y?this.id+"_fhc":this.id+"_fc "):(D?this.id+"_fnc ":T);ar.push("cellname='"+T+"'");S.push(aq?"cellname='"+T+"'":"");c.push(b?"cellname='"+T+"'":"");g.push(R?"cellname='"+T+"'":"");var V=0==this.m_arColWidth[ah]||!J.visible?"none":"";var ab={};var B=null;var s=null;var O=null;ab.height=A+"px";if(aq){B={};B.height=A+"px"}if(b){s={};s.height=A+"px"}if(R){O={};O.height=A+"px"}ar.push(" class='");if(aj<this.fixedRows||ah<this.fixedCols){ar.push("sbgrid_datagrid_FixedCell_Temp ");ar.push("'");if(aq){S.push(" class='");S.push("sbgrid_datagrid_FixedCell ");S.push("sbgrid_"+this.id+"_fixed ");S.push(this.m_strClassFixed+"'")}if(b){c.push(" class='");c.push("sbgrid_datagrid_FixedCell ");c.push("sbgrid_"+this.id+"_fixed ");c.push(this.m_strClassFixed+"'")}if(R){g.push(" class='");g.push("sbgrid_datagrid_FixedCol_Cell ");g.push("sbgrid_"+this.id+"_fixed ");g.push(this.m_strClassFixed+"'")}}else{var l=false;var E=W;var ap=J.getAttribute("type");if("checkbox"==ap||"radio"==ap){E=" sbgrid_ac"}if(("inputdate"==ap||"inputbutton"==ap||"outputbutton"==ap)){E+=" sbgrid_vat";if(SBGrid.DEF.is_mozBrowser){l=true}}ar.push("sbgrid_datagrid_DataCell");ar.push(E);ar.push(" sbgrid_"+this.id+"_col_"+J.id);ar.push(" sbgrid_"+this.id+"_data ");ar.push(this.m_strClassData+" "+m+"'");if(F&&ak){ab["background-color"]=this.backColorAlternate}if(l){ab.height=(A-2)+"px"}if(aq){S.push(" class='");S.push("sbgrid_datagrid_DataCell");S.push(E);S.push(" sbgrid_"+this.id+"_col_"+J.id);S.push(" sbgrid_"+this.id+"_data ");S.push(this.m_strClassData+" "+m+"'");if(t&&ak){B["background-color"]=this.backColorAlternate}if(""!=this.backColorFrozen){B["background-color"]=this.backColorFrozen}if(""!=this.foreColorFrozen){B.color=this.foreColorFrozen}if(l){B.height=(A-2)+"px"}}if(b){c.push(" class='");c.push("sbgrid_datagrid_DataCell");c.push(E);c.push(" sbgrid_"+this.id+"_col_"+J.id);c.push(" sbgrid_"+this.id+"_data ");c.push(this.m_strClassData+" "+m+"'");if(N&&ak){s["background-color"]=this.backColorAlternate}if(""!=this.backColorFrozen){s["background-color"]=this.backColorFrozen}if(""!=this.foreColorFrozen){s.color=this.foreColorFrozen}if(l){s.height=(A-2)+"px"}}if(R){g.push(" class='");g.push("sbgrid_datagrid_DataCell ");g.push("sbgrid_datagrid_FrozenCell");g.push(E);g.push(" sbgrid_"+this.id+"_col_"+J.id);g.push(" sbgrid_"+this.id+"_data ");g.push(this.m_strClassData+" "+m+"'");if(Y&&ak){O["background-color"]=this.backColorAlternate}if(""!=this.backColorFrozen){O["background-color"]=this.backColorFrozen}if(""!=this.foreColorFrozen){O.color=this.foreColorFrozen}if(l){O.height=(A-2)+"px"}}}var z="";if(!F){ar.push(" style='"+this.getStyleString(ab)+"'>");ar.push("<span style='border-color:transparent'/></td>")}else{var u=null;var o=null;if(null!=J){if(this.m_bIsRealDataSync==false&&this.m_bIsSort){if(this.isJsonRef()){o=this.m_arSortJson[aj-this.fixedRows][ah]}else{u=this.m_arSortNodeList[aj-this.fixedRows][ah]}}else{var ao=J.getAttribute("ref");if(this.isJsonRef()){o=aa}else{if(SBGrid.DEF.is_chrome){u=G[aj-this.fixedRows][ao]}else{u=SBGrid.UT.XmlLib.selectSingleNode(H,ao)}}}if(this.isJsonRef()){if(this.m_bComboDataSync&&J.m_objCombo){o[ao]=J.m_objCombo.getComboLabel(o[ao])==""?"":o[ao]}if(K!=""&&K!="undefined"&&K!=null&&this.m_bIsDataReplaceValueChanged){o[ao]=String(o[ao])==X[0]?X[1]:o[ao]}z=o[ao]+""}else{if(null!=u){z=SBGrid.UT.XmlLib.getTextValue(u);if(this.m_bComboDataSync&&J.m_objCombo){if(J.m_objCombo.getComboLabel(z)==""){z="";SBGrid.UT.XmlLib.setTextValue(u,z)}}}}}var y=this.getCellByIdEx(v);if(null!=y){if(v!=y.id){y=null}}y=null==y?new SBGrid.CT.DataGridCell(this,ah,v,aj,"softbowl:cell"):y;y.setElement(J);this.setLinkedData(y,u,o);SBGrid.CF.GridSetMergeType(y,J.m_bMerge);ar.push(" style='"+this.getStyleString(ab)+"'>");ar.push(J.makeCellElement(z,this.m_arColWidth[ah],v,ab,""));ar.push("</td>")}if(aq){z="";if(t){if(aj<this.fixedRows){var y=this.getCellByIdEx(v);if(null!=y){if(v!=y.id){y=null}}y=null==y?new SBGrid.CT.DataGridCell(this,ah,v,aj,"softbowl:cell"):y;y.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(y,J.m_bMerge);if(this.m_arCaption[aj][ah]){z=this.m_arCaption[aj][ah].newlineCharConvert()}S.push(" style='"+this.getStyleString(B)+"'>");S.push("<span style='border-color:transparent;'>");S.push('<span style="white-space:nowrap;">');S.push(z);S.push("</span>");S.push("</span>");S.push("</td>")}else{var u=null;var o=null;if(null!=J){if(this.m_bIsRealDataSync==false&&this.m_bIsSort){if(this.isJsonRef()){o=this.m_arSortJson[aj-this.fixedRows][ah]}else{u=this.m_arSortNodeList[aj-this.fixedRows][ah]}}else{var ao=J.getAttribute("ref");if(this.isJsonRef()){o=aa}else{if(SBGrid.DEF.is_chrome){u=G[aj-this.fixedRows][ao]}else{u=SBGrid.UT.XmlLib.selectSingleNode(H,ao)}}}if(null!=o){if(this.m_bComboDataSync&&J.m_objCombo){o[ao]=J.m_objCombo.getComboLabel(o[ao])==""?"":o[ao]}z=o[ao]+""}else{if(null!=u){z=SBGrid.UT.XmlLib.getTextValue(u);if(this.m_bComboDataSync&&J.m_objCombo){if(J.m_objCombo.getComboLabel(z)==""){z="";SBGrid.UT.XmlLib.setTextValue(u,z)}}}}}var y=this.getCellByIdEx(v);if(null!=y){if(v!=y.id){y=null}}y=null==y?new SBGrid.CT.DataGridCell(this,ah,v,aj,"softbowl:cell"):y;y.setElement(J);this.setLinkedData(y,u,o);SBGrid.CF.GridSetMergeType(y,J.m_bMerge);S.push(" style='"+this.getStyleString(B)+"'>");S.push(J.makeCellElement(z,this.m_arColWidth[ah],v,B,""));S.push("</td>")}}else{S.push(" style='"+this.getStyleString(B)+"'>");S.push("<span style='border-color:transparent'/></td>")}}if(b){z="";if(N){if(aj<this.fixedRows){var y=this.getCellByIdEx(v);if(null!=y){if(v!=y.id){y=null}}y=null==y?new SBGrid.CT.DataGridCell(this,ah,v,aj,"softbowl:cell"):y;y.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(y,J.m_bMerge);if(this.m_arCaption[aj][ah]){z=this.m_arCaption[aj][ah].newlineCharConvert()}if(SBGrid.DEF.is_opera&&ah==0&&this.m_bRowHeader){c.push(" style='"+this.getStyleString(s)+"'>");c.push("<div style='border-color:transparent;'></div>")}else{c.push(" style='"+this.getStyleString(s)+"'>");c.push("<span style='border-color:transparent;'>");c.push('<span style="white-space:nowrap;">');c.push(z);c.push("</span>");c.push("</span>");c.push("</td>")}c.push("<span style='border-color:transparent;'></span>");c.push("</td>")}else{var u=null;var o=null;if(null!=J){var ao=J.getAttribute("ref");if(ao.isEmpty()){if(this.m_bRowHeader&&0==ah){if("seq"==this.rowheader){z=aj-this.fixedRows+1}else{if("reverseseq"==this.rowheader){z=Z-(aj-this.fixedRows)}}}}else{if(this.isJsonRef()){o=aa}else{if(SBGrid.DEF.is_chrome){u=G[aj-this.fixedRows][ao]}else{u=SBGrid.UT.XmlLib.selectSingleNode(H,ao)}}if(null!=o){if(this.m_bComboDataSync&&J.m_objCombo){o[ao]=J.m_objCombo.getComboLabel(o[ao])==""?"":o[ao]}z=o[ao]+""}else{if(null!=u){z=SBGrid.UT.XmlLib.getTextValue(u);if(this.m_bComboDataSync&&J.m_objCombo){if(J.m_objCombo.getComboLabel(z)==""){z="";SBGrid.UT.XmlLib.setTextValue(u,z)}}}}}}var y=this.getCellByIdEx(v);if(null!=y){if(v!=y.id){y=null}}y=null==y?new SBGrid.CT.DataGridCell(this,ah,v,aj,"softbowl:cell"):y;y.setElement(J);this.setLinkedData(y,u,o);SBGrid.CF.GridSetMergeType(y,J.m_bMerge);if(ah<this.fixedCols&&!(this.m_bRowHeader&&0==ah)){c.push(" style='"+this.getStyleString(s)+"'>");c.push(z+"</td>")}else{c.push(" style='"+this.getStyleString(s)+"'>");c.push(J.makeCellElement(z,this.m_arColWidth[ah],v,s,""));c.push("</td>")}}}else{c.push(" style='"+this.getStyleString(s)+"'>");c.push("<span style='border-color:transparent;'></span>");c.push("</td>")}}if(R){z="";if(!Y){g.push(" style='"+this.getStyleString(O)+"'>");g.push("<span style='border-color:transparent;'></span>");g.push("</td>")}else{var u=null;var o=null;if(null!=J){var ao=J.getAttribute("ref");if(ao.isEmpty()){if(this.m_bRowHeader&&0==ah){if("seq"==this.rowheader){z=aj-this.fixedRows+1}else{if("reverseseq"==this.rowheader){z=Z-(aj-this.fixedRows)}}}}else{if(this.isJsonRef()){o=aa}else{if(SBGrid.DEF.is_chrome){u=G[aj-this.fixedRows][ao]}else{u=SBGrid.UT.XmlLib.selectSingleNode(H,ao)}}if(null!=o){if(this.m_bComboDataSync&&J.m_objCombo){o[ao]=J.m_objCombo.getComboLabel(o[ao])==""?"":o[ao]}z=o[ao]+""}else{if(null!=u){z=SBGrid.UT.XmlLib.getTextValue(u);if(this.m_bComboDataSync&&J.m_objCombo){if(J.m_objCombo.getComboLabel(z)==""){z="";SBGrid.UT.XmlLib.setTextValue(u,z)}}}}}}if(ah<this.fixedCols&&!(this.m_bRowHeader&&0==ah)){var y=this.getCellByIdEx(v);if(null!=y){if(v!=y.id){y=null}}y=null==y?new SBGrid.CT.DataGridCell(this,ah,v,aj,"softbowl:cell"):y;y.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(y,J.m_bMerge);g.push(" style='"+this.getStyleString(O)+"'>");g.push("<span style='border-color:transparent;'></span>");g.push('<span style="white-space:nowrap;">');g.push(z);g.push("</span>");g.push("</td>")}else{var y=this.getCellByIdEx(v);if(null!=y){if(v!=y.id){y=null}}y=null==y?new SBGrid.CT.DataGridCell(this,ah,v,aj,"softbowl:cell"):y;y.setElement(J);this.setLinkedData(y,u,o);SBGrid.CF.GridSetMergeType(y,J.m_bMerge);g.push(" style='"+this.getStyleString(O)+"'>");g.push(J.makeCellElement(z,this.m_arColWidth[ah],v,O,""));g.push("</td>")}}}}ar.push("</tr>");if(aq){S.push("</tr>")}if(b){c.push("</tr>")}if(R){g.push("</tr>")}this.m_nMakeIndex++;C++;aq=false;b=false;R=false}jQuery(an).append(ar.join(""));jQuery(I).append(S.join(""));jQuery(ai).append(c.join(""));jQuery(f).append(g.join(""));ar=null;S=null;c=null;g=null;aq=null;b=null;R=null;for(var aj=ac;aj<this.m_nMakeIndex;aj++){for(var ah=0;ah<this.cols;ah++){var v=this.id+"_"+aj+"_"+ah;var L=this.getCellByIdEx(v);if(null!=L){SBGrid.CF.GridInit(L)}}}this.m_objScroll.nStartRow=this.fixedRows+this.frozenRows;this.m_objScroll.nTopRow=this.m_objScroll.nStartRow;var ad=this.m_nRealRows+this.m_objScroll.nStartRow-this.m_nMakeIndex-this.frozenBottomRows;this.m_objScroll.nBottomRow=this.m_nMakeIndex-1;this.m_objScroll.nEndRow=ad;this.m_objScroll.bScrollEvent=this.m_nRealRows>this.m_objScroll.nMaxLength;if(!this.m_bSMC){for(var ah=0;ah<this.cols;ah++){var J=this.m_arColumn[ah];var ao=J.getAttribute("ref");ao=""==ao?"fdsafdad":ao;if(this.isJsonRef()){var h=this.m_nMakeIndex-this.fixedRows;var n=J.m_bMerge?SBGrid.DEF.SBSM_NORMAL:SBGrid.DEF.SBSM_LOCK;var M=J.m_bMerge!=SBGrid.DEF.SBSM_COLHIDE?true:false;var p=this.m_nRealRows-this.frozenBottomRows;if(ah<this.fixedCols){for(var aj=this.m_nMakeIndex;aj<p;aj++){var y=new SBGrid.CT.DataGridCell(this,ah,this.id+"_"+aj+"_"+ah,aj,"softbowl:cell");y.m_objElement=this.m_objFixedCell;if(M){y.mergeType=n}}}else{for(var aj=this.m_nMakeIndex;aj<p;aj++){var y=new SBGrid.CT.DataGridCell(this,ah,this.id+"_"+aj+"_"+ah,aj,"softbowl:cell");y.m_objElement=J;y.m_jsonObject=this.m_xlRefNode[h++];if(this.m_bComboDataSync&&J.m_objCombo){y.m_jsonObject[ao]=J.m_objCombo.getComboLabel(y.m_jsonObject[ao])==""?"":y.m_jsonObject[ao]}if(M){y.mergeType=n}}}h=null;bColumnMerge=null}else{var x=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset+"/"+ao);for(var aj=this.m_nMakeIndex;aj<this.m_nRealRows-this.frozenBottomRows;aj++){var v=this.id+"_"+aj+"_"+ah;if(ah<this.fixedCols){var y=new SBGrid.CT.DataGridCell(this,ah,v,aj,"softbowl:cell");y.m_objElement=this.m_objFixedCell;SBGrid.CF.GridSetMergeType(y,J.m_bMerge)}else{var y=new SBGrid.CT.DataGridCell(this,ah,v,aj,"softbowl:cell");y.m_objElement=J;y.m_xnNodeElement=x.item(aj-this.fixedRows);if(this.m_bComboDataSync&&J.m_objCombo){if(SBGrid.UT.XmlLib.getTextValue(y.m_xnNodeElement)==""){SBGrid.UT.XmlLib.setTextValue(y.m_xnNodeElement,"")}}SBGrid.CF.GridSetMergeType(y,J.m_bMerge)}}}}}if(this._isHScroll()&&this.m_objHeArea.bChangeWidth){var af=this.m_heWhole.clientHeight-this.m_heFFNS.clientHeight;this.m_heFFC.style.height=(af<0?0:af).toString();+"px"}if(this._isVScroll()){if(null!=this.m_heFFS){this.m_heFFS.style.width=this.m_heWhole.clientWidth+"px"}if(null!=this.m_heFFBS){this.m_heFFBS.style.width=this.m_heWhole.clientWidth+"px"}}if(null==am){this.setSeqForRowHeader()}};SBGrid.CT.DataGrid.prototype.makeGrid=function(){this.m_xlRefNode=this.getControlNodeList();this.makeGuideLine();this.makeMoveColumnBar();this.m_heWhole=this.makeWholeGrid();this.m_heEmptyRecords=this.makeEmptyRecordsGrid();this.setEmptyRecordsGrid();this.m_heFFS=this.makeFixedFrozenScrollingRow();this.m_heFFNS=this.makeFixedFrozenNoScrollingRow();this.m_heFFC=this.makeFixedFrozenColumn();this.m_heGridDataSearchUI=this.makeDataSearchUI();for(var g=0;g<this.cols;g++){this.m_arrBeforeRefOfCol.add(this.getRefOfCol(g))}if(this.m_bIsAutoSavePsnlData==true&&this.m_strPsnlDataId!=null){if(document.cookie){this.loadPersonalInfo(this.m_strPsnlDataId)}}if(!SBGrid.DEF.is_smartphone){this.showWait(false);this.makePartially(true);this.m_heFFBS=this.makeFixedFrozenBottomScrollingRow();this.m_heFFBNS=this.makeFixedFrozenBottomNoScrollingRow();this.m_heInitRow=this.makeInitRow();this.m_heMergeCell=this.makeMergeTable();this.makeScrollDiv(this.m_heGridScrollDivCell,true);if(null!=this.m_heFFC){this.makeScrollDiv(this.m_heFFGridScrollDivCell,false)}if(this.m_objScroll.bScrollEvent){for(var g=0;g<this.m_nRealRows;g++){this.m_objScroll.arTargetRow.push(g)}}this.m_heFFS.style.height=this.getFixedFrozenRowHeight()+"px";this.m_heFFNS.style.height=this.getFixedFrozenRowHeight()+"px";this.m_heFFC.style.top=this.getFixedFrozenRowHeight()+"px";if(document.doctype==null){if(!SBGrid.DEF.is_ie7&&!SBGrid.DEF.is_ie8&&!SBGrid.DEF.is_ie9){this.m_heFFS.style.height=this.getFixedFrozenRowHeight()-1+"px";this.m_heFFNS.style.height=this.getFixedFrozenRowHeight()-1+"px";this.m_heFFC.style.top=this.getFixedFrozenRowHeight()-1+"px"}}this.scrollAttributeSetting();var c=this.id;window.onresize=function(){SBGrid.DEF.resizeWindow(c)}}else{this.m_heWhole=this.makeSmartPhoneGrid();this.m_heMergeCell=this.makeMergeTable()}if(this.m_style_theme=="claret"&&this.frozenRows>0){var h=this.fixedRows;var b=this.frozenRows;for(var e=0;e<this.cols;e++){var d=this.getCellEx(h+b-1,e);jQuery("#SBHE_"+d.id).addClass("sbgrid_datagrid_GridFFC_bottomBorder")}}if(this.m_strGridSummary!=""){document.getElementById("SBHE_"+this.id).setAttribute("title",this.m_strGridSummary);document.getElementById("SBHE_"+this.id).setAttribute("onKeyDown",'SBGrid.DEF.onkeydownGridSummary(event, "'+this.id+'")')}else{document.getElementById("SBHE_"+this.id).removeAttribute("onKeyDown")}if(this.m_strUserCaption!=""){this.m_arUserCaption=this.m_strUserCaption.split("^");for(var g=this.fixedRows-1;g<this.cols;g++){if(this.getColType(g)=="output"){var f=document.getElementById(this.id+"_"+this.fixedRows+"_"+g+"_data");f.title=f.firstChild.textContent+this.m_arUserCaption[g-this.fixedCols]+"열 입니다."}else{if(this.getColType(g)=="radio"){var n=document.getElementById("SBHE_"+this.id+"_"+this.fixedRows+"_"+g);var l=n.firstChild.title;n.firstChild.title=l+this.m_arUserCaption[g-this.fixedCols]+"열 입니다."}else{if(this.getColType(g)=="checkbox"){var m=document.getElementById("SBHE_"+this.id+"_"+this.fixedRows+"_"+g);var a=m.firstChild.title;m.firstChild.title=a+" "+this.m_arUserCaption[g-this.fixedCols]+"열 입니다."}}}}}else{return}};SBGrid.DEF.resizeWindow=function(strGridId){var objGridId=eval(strGridId);if(objGridId!=undefined&&!SBGrid.DEF.is_smartphone&&!SBGrid.DEF.is_android){objGridId.closePopUpEx()}};SBGrid.CT.DataGrid.prototype.makeGridCell=function(d,g){if(isNaN(d)){d=0}if(isNaN(g)){g=0}var b=this.m_arColumn[g];if(d>=this.m_nRealRows){return null}var f=this.id+"_"+d+"_"+g;var c=null;if(g<this.fixedCols){c=new SBGrid.CT.DataGridCell(this,g,f,d,"softbowl:cell");c.m_objElement=this.m_objFixedCell;if(b){SBGrid.CF.GridSetMergeType(c,b.m_bMerge)}}else{c=new SBGrid.CT.DataGridCell(this,g,f,d,"softbowl:cell");c.m_objElement=b;if(d>=this.fixedRows){if(this.isJsonRef()){jsonRowData=this.m_xlRefNode[d-this.fixedRows];c.m_jsonObject=jsonRowData}else{var e=b.getAttribute("ref");e=""==e?"fdsafdad":e;var a=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset+"/"+e);c.m_xnNodeElement=a.item(d-this.fixedRows)}}if(b){SBGrid.CF.GridSetMergeType(c,b.m_bMerge)}}return c};SBGrid.CT.DataGrid.prototype.resetScroll=function(){if(this.m_nReScrollPosition!=null){this.m_heWhole.scrolLTop=this.m_nReScrollPosition}else{this.m_heWhole.scrollTop=0;this.m_heWhole.scrollLeft=0}this.m_objScroll.heTargetTable.style.top="0px";this.m_objScroll.heTargetFFCTable.style.top="0px";this.m_nReScrollPosition=null};SBGrid.CT.DataGrid.prototype.scrollAttributeSetting=function(){this.m_objScroll.nScrollDivHeight=this.m_heWhole.offsetHeight;this.m_objScroll.heTargetTable=this.m_heWhole.firstChild;this.m_objScroll.heTargetFFCTable=this.m_heFFC.firstChild;this.m_objScroll.nTargetHeight=this.m_objScroll.heTargetTable.offsetHeight};SBGrid.CT.DataGrid.prototype.makeGuideLine=function(){if(SBGrid.DEF.is_smartphone){var b=document.getElementById("SBHE_"+this.id+"_HLine");var a=document.getElementById("SBHE_"+this.id+"_VLine");var c=b.parentNode;var d=a.parentNode;c.removeChild(b);d.removeChild(a);c=null;d=null;b=null;a=null}else{this.m_heHGuideLine=document.getElementById("SBHE_"+this.id+"_HLine");this.m_heVGuideLine=document.getElementById("SBHE_"+this.id+"_VLine")}};SBGrid.CT.DataGrid.prototype.showWait=function(a){if(null==this.m_heWait){this.m_heWait=document.createElement("img");this.m_heWait.setAttribute("alt","");this.m_heWait.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgWait;jQuery(this.m_heWait).addClass("sbgrid_datagrid_LoadingImg");this.m_heCtrl.appendChild(this.m_heWait)}if(null!=this.m_heWait){this.m_heWait.style.left=(this.m_heCtrl.offsetWidth/2-30)+"px";this.m_heWait.style.top=(this.m_heCtrl.offsetHeight/2-17)+"px"}if(a){this.m_heWait.style.display="block";if(null!=this.m_heWhole){jQuery(this.m_heWhole).addClass("sbgrid_StatusDiv");if(null!=this.m_heFFC){jQuery(this.m_heFFC).addClass("sbgrid_StatusDiv")}}}else{this.m_heWait.style.display="";if(null!=this.m_heWhole){jQuery(this.m_heWhole).removeClass("sbgrid_StatusDiv");if(null!=this.m_heFFC){jQuery(this.m_heFFC).removeClass("sbgrid_StatusDiv")}}}};SBGrid.CT.DataGrid.prototype.makeMoveColumnBar=function(){if(SBGrid.DEF.is_smartphone){var b=document.getElementById("SBHE_"+this.id+"_MoveColBar");var a=b.parentNode;a.removeChild(b);a=null;b=null}else{this.m_heMoveColumnBar=document.getElementById("SBHE_"+this.id+"_MoveColBar")}};SBGrid.CT.DataGrid.prototype.makeWholeGrid=function(){var l;var b=false;this.m_htRowHeight={};this.m_arHiddenRowState=new Array();if(SBGrid.DEF.is_smartphone){var e=document.getElementById("SBHE_DATAGRID_WHOLE_"+this.id);var m=e.parentNode;m.removeChild(e);m=null;e=null;return null}else{var h=document.getElementById("SBHE_DATAGRID_WHOLE_"+this.id);var a=new Array();var g=0;a[1]="<colgroup id='SBHE_DATAGRID_WHOLE_COLGROUP_"+this.id+"'>";for(var f=0;f<this.m_arColWidth.length;f++){g+=this.m_arColWidth[f];a.push("<col style='width:"+this.m_arColWidth[f]+"px'/>")}a.push("</colgroup>");a.push("<tbody id='SBHE_DATAGRID_WHOLE_TBODY_"+this.id+"'/>");a.push("</table>");a.push("</div>");var d=SBGrid.DEF.is_ie&&!(SBGrid.DEF.is_ie9)?"event.returnValue=false;":"event.preventDefault();";a[0]="<div id='SBHE_DATAGRID_WHOLE_"+this.id+"' class ='sbgrid_datagrid_GridWhole sbgrid_scroll' onkeydown='"+d+'\' onscroll=\'SBGrid.DEF._W_onProcessEvent(event, "onscroll", "'+this.id+"\")' onmousewheel='SBGrid.getGrid(\""+this.id+"\").onMouseWheel(event);'><table id='SBHE_DATAGRID_WHOLE_TABLE_"+this.id+"' onselectstart='return false' cellpadding=0 cellspacing=0 border=0 width='"+g+"px' class='sbgrid_datagrid_GridWhole_table' summary='"+this.getAttribute("summary")+"' >";jQuery(h).html(a.join(""));var c=h.firstChild;var m=h.parentNode;m.insertBefore(c,h);m.removeChild(h);switch(this.getAttribute("scroll")){case"vertical":c.style.overflowX="hidden";c.style.overflowY="scroll";break;case"horizontal":c.style.overflowX="scroll";c.style.overflowY="hidden";break;case"both":c.style.overflowX="scroll";c.style.overflowY="scroll";break;case"autovscroll":c.style.overflowX="hidden";c.style.overflowY="auto";break;case"autohscroll":c.style.overflowX="auto";c.style.overflowY="hidden";break;case"none":c.style.overflowX="visible";c.style.overflowY="visible";break;default:c.style.overflowX="auto";c.style.overflowY="auto";break}a=null;g=null;return c}};SBGrid.CT.DataGrid.prototype.makeEmptyRecordsGrid=function(){var d;var b=false;this.m_htRowHeight={};this.m_arHiddenRowState=new Array();if(SBGrid.DEF.is_smartphone){var d=document.getElementById("SBHE_DATAGRID_EMPTY_RECORDS_"+this.id);var c=d.parentNode;c.removeChild(d);c=null;d=null;return null}else{var d=document.getElementById("SBHE_DATAGRID_EMPTY_RECORDS_"+this.id);var e=new Array();e[0]="<div id='SBHE_DATAGRID_EMPTY_RECORDS_"+this.id+"' class ='sbgrid_datagrid_GridWhole' style='background-color:white;'>";e[1]="<table id='SBHE_DATAGRID_EMPTY_RECORDS_TABLE_"+this.id+"' style='width:100%; height:100%; text-align:center'><tr>";if(this.m_strEmptyRecordsFontStyle==""){e[2]="<td>"}else{this.m_strEmptyRecordsFontStyle=this.m_strEmptyRecordsFontStyle.replaceAll("'",'"');e[2]="<td style='width:100%;height:100%;"+this.m_strEmptyRecordsFontStyle+"'>"}e[3]=this.m_strEmptyRecords;e[4]="</td></tr></table>";e[5]="</div>";jQuery(d).append(e.join(""));var a=d.firstChild;var c=d.parentNode;c.insertBefore(a,d);c.removeChild(d);e=null;d=null;return a}};SBGrid.CT.DataGrid.prototype.setEmptyRecordsGrid=function(){if(this.isJsonRef()){if(eval(this.attribute.jsonref)){var nDataLength=0;if(this.m_xlRefNode){nDataLength=this.m_xlRefNode.length}if(nDataLength==0&&this.m_strEmptyRecords!=""){jQuery(this.m_heEmptyRecords).show()}else{jQuery(this.m_heEmptyRecords).hide()}nDataLength=null}else{if(this.m_strEmptyRecords!=""){jQuery(this.m_heEmptyRecords).show()}else{jQuery(this.m_heEmptyRecords).hide()}}}else{jQuery(this.m_heEmptyRecords).hide()}};SBGrid.CT.DataGrid.prototype.makeFixedFrozenScrollingRow=function(){var a=document.getElementById("SBHE_DATAGRID_FIXED_FROZEN_SCROLLING_ROW_"+this.id);if(SBGrid.DEF.is_smartphone){var e=a.parentNode;e.removeChild(a);e=null;a=null;return null}else{var d=new Array();var c=0;d[1]="<colgroup id='SBHE_DATAGRID_FFS_COLGROUP_"+this.id+"'>";for(var b=0;b<this.m_arColWidth.length;b++){c+=this.m_arColWidth[b];d.push("<col style='width:"+this.m_arColWidth[b]+"px'/>")}d.push("</colgroup>");d.push("<tbody id='SBHE_DATAGRID_FFS_TBODY_"+this.id+"'/>");d.push("</table>");d[0]="<table id='SBHE_DATAGRID_FFS_TABLE_"+this.id+"' onselectstart='return false' cellpadding=0 cellspacing=0 border=0 width='"+c+"px' class='sbgrid_datagrid_GridFFS_table'>";jQuery(a).html(d.join(""));d=null;c=null;a.style.width=this.m_heWhole.clientWidth+"px";a.style.height=((this.m_nRowHeight*this.fixedRows)+(this.dataHeight*this.frozenRows))+"px";return a}};SBGrid.CT.DataGrid.prototype.makeFixedFrozenNoScrollingRow=function(){var b=document.getElementById("SBHE_DATAGRID_FIXED_FROZEN_NOSCROLLING_ROW_"+this.id);if(SBGrid.DEF.is_smartphone){var e=b.parentNode;e.removeChild(b);e=null;b=null;return null}else{var d=new Array();var c=0;d[1]="<colgroup id='SBHE_DATAGRID_FFN_COLGROUP_"+this.id+"'>";for(var a=0;a<(this.fixedCols+this.frozenCols);a++){c+=this.m_arColWidth[a];d.push("<col style='width:"+this.m_arColWidth[a]+"px'/>")}d.push("</colgroup>");d.push("<tbody id='SBHE_DATAGRID_FFN_TBODY_"+this.id+"'/>");d.push("</table>");d[0]="<table id='SBHE_DATAGRID_FFNS_TABLE_"+this.id+"' onselectstart='return false' cellpadding=0 cellspacing=0 border=0 width='100%' height=100% class='sbgrid_datagrid_GridFFS_table'>";jQuery(b).html(d.join(""));d=null;c=null;if(SBGrid.DEF.is_ie7){b.style.width=(this.getFixedFrozenColWidth()+this.fixedCols)+"px"}else{b.style.width=(this.getFixedFrozenColWidth()+1)+"px"}b.style.height=((this.m_nRowHeight*this.fixedRows)+(this.dataHeight*this.frozenRows))+"px"}return b};SBGrid.CT.DataGrid.prototype.makeFixedFrozenColumn=function(){var nRefLength=null!=this.m_xlRefNode?this.m_xlRefNode.length:0;var nFixedFrozenCol=this.fixedCols+this.frozenCols;var nFixedFrozenRow=this.fixedRows+this.frozenRows;var heGridFFCol=document.getElementById("SBHE_DATAGRID_FIXED_FROZEN_COL_"+this.id);if(heGridFFCol.addEventListener){eval("heGridFFCol.addEventListener('mousewheel', function(){SBGridfrozenColMouseWheel('"+this.id+"', '"+this.m_bIsTextareaScroll+"');}, false)");eval("heGridFFCol.addEventListener('DOMMouseScroll', function(){SBGridfrozenColMouseWheel('"+this.id+"', '"+this.m_bIsTextareaScroll+"');}, false)");eval("heGridFFCol.addEventListener('scroll', function(){SBGrid.DEF.SBGridfrozenColScroll('"+this.id+"');}, false)")}else{if(heGridFFCol.attachEvent){eval("heGridFFCol.attachEvent('onmousewheel', function(){SBGridfrozenColMouseWheel('"+this.id+"', '"+this.m_bIsTextareaScroll+"');})");eval("heGridFFCol.attachEvent('onscroll', function(){SBGrid.DEF.SBGridfrozenColScroll('"+this.id+"');})")}}if(SBGrid.DEF.is_smartphone){var heParentFFC=heGridFFCol.parentNode;heParentFFC.removeChild(heGridFFCol);heParentFFC=null;heGridFFCol=null;return null}else{var arTagString=new Array();var nTotalWidth=0;arTagString[1]="<colgroup id='SBHE_DATAGRID_FFCOL_COLGROUP_"+this.id+"'>";for(var i=0;i<(this.fixedCols+this.frozenCols);i++){nTotalWidth+=this.m_arColWidth[i];arTagString.push("<col style='width:"+this.m_arColWidth[i]+"px'/>")}arTagString.push("</colgroup>");arTagString.push("<tbody id='SBHE_DATAGRID_FFCOL_TBODY_"+this.id+"'/>");arTagString.push("</table>");arTagString[0]="<table id='SBHE_DATAGRID_FFC_TABLE_"+this.id+"' onselectstart='return false' cellpadding=0 cellspacing=0 border=0 width='100%' class='sbgrid_datagrid_GridWhole_table'>";jQuery(heGridFFCol).html(arTagString.join("")).attr("onmouseover","mouseWheelStopPropagation('"+this.id+"', true);").attr("onmouseout","mouseWheelStopPropagation('"+this.id+"', false);");arTagString=null;nTotalWidth=null;heGridFFCol.style.top=this.getFixedFrozenRowHeight()+"px";if(SBGrid.DEF.is_ie7){heGridFFCol.style.width=(this.getFixedFrozenColWidth()+this.fixedCols)+"px"}else{heGridFFCol.style.width=(this.getFixedFrozenColWidth()+1)+"px"}heGridFFCol.style.height=this.m_heWhole.clientHeight-this.getFixedFrozenRowHeight()+"px"}return heGridFFCol};SBGrid.DEF.SBGridfrozenColScroll=function(a){var c=SBGrid.getGrid(a);if(c){var b=c.row;var d=c.col;if(c.isMerge(b,d)&&b==c.fixedRows&&d==(c.m_bRowHeader?1:0)){c.m_heWhole.scrollTop=c.m_heFFC.scrollTop}b=d=null}c=null};function SBGridfrozenColMouseWheel(a,e){if(e=="false"&&document.getElementById("SBHE_"+a+"_textarea").style.visibility=="visible"){return}var d=SBGrid.getGrid(a);if(d){var c=0;if(!b){var b=window.event;if("wheelDelta" in b){c=b.wheelDelta/120}else{c=-(b.detail/3)}if(c==-1){d.m_heWhole.scrollTop+=40}else{if(c==1){d.m_heWhole.scrollTop-=40}}}c=null}d=null}function mouseWheelStopPropagation(c,b){var f=document.getElementById("SBHE_"+c);if(f){var e=f.parentNode;var a="true";if(b){a="false"}for(var d=0;e!=null;d+=1){e.onmousewheel=new Function("return "+a);e=e.parentNode}e=null}f=null}SBGrid.CT.DataGrid.prototype.makeFixedFrozenBottomNoScrollingRow=function(){var r;var s=new Array();if(null!=this.m_heFFBNS){r=this.m_heFFBNS}else{r=document.createElement("div")}r.setAttribute("id","SBHE_DATAGRID_FIXED_FROZEN_BOTTOM_NOSCROLLING_ROW_"+this.id);jQuery(r).addClass("sbgrid_datagrid_GridFFB sbgrid_datagrid_LayoutDiv");r.style.width=this.getFixedFrozenColWidth()+"px";var g=new Array();g.push("<table onselectstart=\"return false\" cellpadding=0 cellspacing=0 border=0 class='sbgrid_datagrid_GridFFBN_table'>");g.push('<colgroup id="SBHE_DATAGRID_FFBN_COLGROUP_'+this.id+'">');for(var A=0;A<(this.fixedCols+this.frozenCols);A++){g.push('<col style="width:'+this.m_arColWidth[A]+'px">')}g.push('</colgroup><tbody id ="SBHE_DATAGRID_FFBN_TBODY_'+this.id+'">');if(1>this.frozenBottomRows||this.m_nRealRows<=(this.fixedRows+this.frozenRows)){r.style.height="0px";g.push("<tr><td/></tr></tbody></table>");jQuery(r).html(g.join(""));this.m_heCtrl.appendChild(r);return r}var o=null!=this.m_xlRefNode?this.m_xlRefNode.length:0;var B=this.fixedCols+this.frozenCols;var H="";var H="";var u=(this.m_nRealRows-this.fixedRows-this.frozenRows-this.frozenBottomRows);var w=u<0?u:0;u=null;var F="";var q=SBGrid.DEF.is_ie?this.m_heCtrl.currentStyle.textAlign:window.getComputedStyle(this.m_heCtrl,null).textAlign;switch(q){case"center":F=" sbgrid_ac";break;case"right":F=" sbgrid_ar";break}var c=true;for(var A=this.m_nRealRows-(this.frozenBottomRows+w);A<this.m_nRealRows;A++){var e=false;var f=A<this.fixedRows?this.m_nRowHeight:this.dataHeight;if(f>0&&!(SBGrid.DEF.is_mozBrowser)){if(c){f=f-2}else{f--}}g.push("<TR rowNum='"+this.id+"_"+A+"' targetcell='ffbn'>");var x=null;var y=null;if(this.fixedRows<=A){if(this.isJsonRef()){y=this.m_xlRefNode[A-this.fixedRows]}else{x=this.m_xlRefNode.item(A-this.fixedRows)}if(""!=this.backColorAlternate&&((A-this.fixedRows)%2)==1){e=true}else{e=false}}for(var z=0;z<B&&z<this.cols;z++){var m={};var p=(z<this.fixedCols+this.frozenCols);var G=z>=this.fixedCols;var v=this.m_arColumn[z];var h=this.id+"_"+A+"_"+z;var a=null!=v.attribute["class"]?v.attribute["class"]:"";g.push("<TD sbgrid_select='false' class=");var d=" rowNum='"+this.id+"_"+A+"' colNum='"+this.id+"_"+z+"'  cellId='"+this.id+"."+A+"."+z+"' targetcell = 'ffbn' ";if(p){d=' id="SBHE_'+h+"\" valign ='middle' rowNum='"+this.id+"_"+A+"' colNum='"+this.id+"_"+z+"'  cellId='"+this.id+"."+A+"."+z+"' targetcell = 'ffbn' "}if(G){d+="frozencell = 'true' "}m.height=f+"px";if(A<this.fixedRows||z<this.fixedCols){if(c){g.push("'sbgrid_datagrid_BFixedCell ")}else{g.push("'sbgrid_datagrid_FixedCell ")}g.push("sbgrid_"+this.id+"_fixed ");g.push(this.m_strClassFixed+"'")}else{var E=F;var b=v.getAttribute("type");if("checkbox"==b||"radio"==b){E=" sbgrid_ac"}if("inputdate"==b||"inputbutton"==b||"outputbutton"==b){E+=" sbgrid_vat";if(SBGrid.DEF.is_mozBrowser){m.height=(f-2)+"px"}}if(c){g.push("'sbgrid_datagrid_BDataCell")}else{g.push("'sbgrid_datagrid_DataCell")}g.push(E);g.push(" sbgrid_"+this.id+"_col_"+v.id);g.push(" sbgrid_"+this.id+"_data ");g.push(this.m_strClassData+" "+a+"'");m["background-color"]="";m.color="";m["background-color"]=p&&e?this.backColorAlternate:m["background-color"];m["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:m["background-color"];m.color=(""!=this.foreColorFrozen)?this.foreColorFrozen:m.color}var C="";g.push(d);if(p){if(A<this.fixedRows){var t=this.getCellByIdEx(h);if(null!=t){if(h!=t.id){t=null}}t=null==t?new SBGrid.CT.DataGridCell(this,z,h,A,"softbowl:cell"):t;t.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(t,v.m_bMerge);if(this.m_arCaption[A][z]){C=this.m_arCaption[A][z].newlineCharConvert()}g.push("style='"+this.getStyleString(m)+"'>");if(!(A==0&&z==0&&this.m_bRowHeader)){g.push('<span style="white-space:nowrap;">'+C+"</span>")}g.push('<span style="border-right-color:transparent; border-bottom-color:transparent; ');g.push('border-top-color:transparent; border-left-color:transparent;"></span>')}else{var D=null;var l=null;if(null!=v){var n=v.getAttribute("ref");if(n.isEmpty()){if(this.m_bRowHeader&&0==z){if("seq"==this.rowheader){C=A-this.fixedRows+1}else{if("reverseseq"==this.rowheader){C=o-(A-this.fixedRows)}}}}else{if(this.m_bIsRealDataSync==false&&this.m_bIsSort){if(this.isJsonRef()){l=this.m_arSortJson[A-this.fixedRows][z]}else{D=this.m_arSortNodeList[A-this.fixedRows][z]}}else{if(this.isJsonRef()){l=y}else{D=SBGrid.UT.XmlLib.selectSingleNode(x,n)}}if(l!=null){C=l}else{if(null!=D){C=SBGrid.UT.XmlLib.getTextValue(D)}}}}var t=this.getCellByIdEx(h);if(null!=t){if(h!=t.id){t=null}}t=null==t?new SBGrid.CT.DataGridCell(this,z,h,A,"softbowl:cell"):t;t.setElement(v);this.setLinkedData(t,D,l);SBGrid.CF.GridSetMergeType(t,v.m_bMerge);s.push(t);if(z<this.fixedCols&&!(this.m_bRowHeader&&0==z)){C=l[n];g.push("style='"+this.getStyleString(m)+"'>");g.push(v.makeCellElement(C,this.m_arColWidth[z],h,m))}else{g.push("style='"+this.getStyleString(m)+"'>");g.push(v.makeCellElement(C,this.m_arColWidth[z],h,m))}}}else{g.push("style='"+this.getStyleString(m)+"'>");g.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');g.push('border-top-color:transparent; border-left-color:transparent;"></div>')}g.push("</TD>")}g.push("</TR>");c=false}g.push("</tbody></TABLE>");jQuery(r).html(g.join(""));g=null;r.style.top=(this.m_heWhole.clientHeight-(this.dataHeight*this.m_nBottomRowCount))+"px";r.style.height=(this.dataHeight*this.m_nBottomRowCount)+"px";this.m_heCtrl.appendChild(r);for(var A=0;A<s.length;A++){SBGrid.CF.GridInit(s[A])}s=null;return r};SBGrid.CT.DataGrid.prototype.makeInitRow=function(){var d;var h=new Array();if(this.heGridTrialRow!=null){d=this.m_heInitRow}else{if(this.m_bIsTinit){var b=document.getElementById(this.parentId);if(b){jQuery("#SBHE_DATAGRID_TRIAL_ROW_"+this.id).remove();var f=this.m_heCtrl.style.width;d=document.createElement("div");var a=jQuery(d);a.attr("id","SBHE_DATAGRID_TRIAL_ROW_"+this.id);a.attr("width",f);var c=new Array();c.push("<table onselectstart=\"return false\" cellpadding=0 cellspacing=0 border=0 class='sbgrid_datagrid_GridFFBN_table'>");c.push('<colgroup id="SBHE_DATAGRID_TRIAL_ROW_COLGROUP_'+this.id+'">');c.push('<col style="width:'+f+'">');c.push("</colgroup><tbody>");var g=25;a.css("height",g);if(g>0&&!(SBGrid.DEF.is_mozBrowser)){g=g-2}c.push("<tr><td ");var e="'height:"+g.toString()+"px;";e+="border:1px; border-Style:solid; border-color: #D4D0C8; border-top-style:none!important; background-color: #FFFFFF; text-align: center;'";c.push("style="+e+">");c.push("<div style='font-weight:bold;'><span style='white-space:nowrap;'>");c.push("SBGrid 2.0 Trial Version");c.push("</span></div></td></tr></tbody></table>");a.html(c.join(""));b.appendChild(d);a=null}else{d=null}}else{d=null}}return d};SBGrid.CT.DataGrid.prototype.makeFixedFrozenBottomScrollingRow=function(){this.m_nBottomRowCount=0;var q=new Array();var b;if(null!=this.m_heFFBS){b=this.m_heFFBS}else{b=document.createElement("div")}var a=this.m_heWhole.clientHeight-(this.dataHeight*this.frozenBottomRows);b.setAttribute("id","SBHE_DATAGRID_FIXED_FROZEN_BOTTOM_SCROLLING_ROW_"+this.id);jQuery(b).addClass("sbgrid_datagrid_GridFFB sbgrid_datagrid_LayoutDiv");b.style.width=this.m_heWhole.clientWidth+"px";var y=this._getTotalColWidth();var f=new Array();f.push("<table onselectstart='return false' cellpadding=0 cellspacing=0 border=0 class='sbgrid_datagrid_GridFFS_table' style='width:"+y+"px'>");f.push('<colgroup id="SBHE_DATAGRID_FFBS_COLGROUP_'+this.id+'">');for(var A=0;A<this.cols;A++){f.push('<col style="width:'+this.m_arColWidth[A]+'px" >')}f.push("</colgroup><TBODY>");if(1>this.frozenBottomRows||this.m_nRealRows<=(this.fixedRows+this.frozenRows)){b.style.top="0px";b.style.height="0px";f.push("<tr><td/></tr></tbody></table>");jQuery(b).html(f.join(""));this.m_heCtrl.appendChild(b);return b}var s=(this.m_nRealRows-this.fixedRows-this.frozenRows-this.frozenBottomRows);var v=s<0?s:0;s=null;var E="";var o=SBGrid.DEF.is_ie?this.m_heCtrl.currentStyle.textAlign:window.getComputedStyle(this.m_heCtrl,null).textAlign;switch(o){case"center":E=" sbgrid_ac";break;case"right":E=" sbgrid_ar";break}for(var A=this.m_nRealRows-(this.frozenBottomRows+v);A<this.m_nRealRows;A++){this.m_nBottomRowCount++;var e=false;var g=this.dataHeight;this.m_htRowHeight[A]=this.dataHeight;if(g>0&&!(SBGrid.DEF.is_mozBrowser)){if(1==this.m_nBottomRowCount){g=g-2}else{g--}}f.push("<TR rowNum='"+this.id+"_"+A+"' targetcell='ffbs'>");var w=null;var x=null;if(this.fixedRows<=A){if(this.isJsonRef()){x=this.m_xlRefNode[A-this.fixedRows]}else{w=this.m_xlRefNode.item(A-this.fixedRows)}if(""!=this.backColorAlternate&&((A-this.fixedRows)%2)==1){e=true}else{e=false}}for(var z=0;z<this.cols;z++){var m={};var p=(z>=this.fixedCols+this.frozenCols);var u=this.m_arColumn[z];var h=this.id+"_"+A+"_"+z;var c=null!=u.attribute["class"]?u.attribute["class"]:"";f.push("<td sbgrid_select='false' class=");var t=" rowNum='"+this.id+"_"+A+"' colNum='"+this.id+"_"+z+"'  cellId='"+this.id+"."+A+"."+z+"' targetcell = 'ffbs' ";if(p){t=' id="SBHE_'+h+"\" valign ='middle' rowNum='"+this.id+"_"+A+"' colNum='"+this.id+"_"+z+"'  cellId='"+this.id+"."+A+"."+z+"' targetcell = 'ffbs' "}t+="frozencell = 'true' ";m.height=g+"px";if(A<this.fixedRows||z<this.fixedCols){if(1==this.m_nBottomRowCount){f.push("'sbgrid_datagrid_BFixedCell ")}else{f.push("'sbgrid_datagrid_FixedCell ")}f.push("sbgrid_"+this.id+"_fixed ");f.push(this.m_strClassFixed+"'")}else{var D=E;var d=u.getAttribute("type");if("checkbox"==d||"radio"==d){D=" sbgrid_ac"}if("inputdate"==d||"inputbutton"==d||"inputbutton"==d){D+=" sbgrid_vat";if(SBGrid.DEF.is_mozBrowser){m.height=(g-2)+"px"}}if(1==this.m_nBottomRowCount){f.push("'sbgrid_datagrid_BDataCell")}else{f.push("'sbgrid_datagrid_DataCell")}f.push(D);f.push(" sbgrid_"+this.id+"_col_"+u.id);f.push(" sbgrid_"+this.id+"_data ");f.push(this.m_strClassData+" "+c+"'");m["background-color"]="";m.color="";m["background-color"]=p&&e?this.backColorAlternate:m["background-color"];m["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:m["background-color"];m.color=(""!=this.foreColorFrozen)?this.foreColorFrozen:m.color}f.push(t);var B="";if(p){var C=null;var l=null;if(null!=u){if(this.m_bIsRealDataSync==false&&this.m_bIsSort){if(this.isJsonRef()){l=this.m_arSortJson[A-this.fixedRows][z]}else{C=this.m_arSortNodeList[A-this.fixedRows][z]}}else{var n=u.getAttribute("ref");if(this.isJsonRef()){l=x}else{C=SBGrid.UT.XmlLib.selectSingleNode(w,n)}}if(null!=l){B=l[n]+""}else{if(null!=C){B=SBGrid.UT.XmlLib.getTextValue(C)}}}var r=this.getCellByIdEx(h);if(null!=r){if(h!=r.id){r=null}}r=null==r?new SBGrid.CT.DataGridCell(this,z,h,A,"softbowl:cell"):r;r.setElement(u);this.setLinkedData(r,C,l);SBGrid.CF.GridSetMergeType(r,u.m_bMerge);q.push(r);var d=u.getAttribute("type");f.push("style='"+this.getStyleString(m)+"' >");f.push(u.makeCellElement(B,this.m_arColWidth[z],h,m))}else{f.push("style='"+this.getStyleString(m)+"' >");f.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');f.push('border-top-color:transparent; border-left-color:transparent;"></div>')}f.push("</TD>")}f.push("</TR>")}f.push("</TBODY></TABLE>");jQuery(b).html(f.join(""));f=null;b.style.top=(this.m_heWhole.clientHeight-(this.dataHeight*this.m_nBottomRowCount))+"px";b.style.height=(this.dataHeight*this.m_nBottomRowCount)+"px";this.m_heCtrl.appendChild(b);for(var A=0;A<q.length;A++){SBGrid.CF.GridInit(q[A])}q=null;return b};SBGrid.CT.DataGrid.prototype.makeSmartPhoneGrid=function(){var z=this.fixedCols+this.frozenCols;var q=document.getElementById("SBHE_DATAGRID_WHOLE_"+this.id);var r=false;var b=null;if(null!=q){var m=document.getElementById("SBHE_DATAGRID_WHOLE_TABLE_"+this.id);b=m.firstChild.cloneNode(true);q.removeChild(m);r=true}else{q=document.createElement("div");q.setAttribute("id","SBHE_DATAGRID_WHOLE_"+this.id);q.style.position="absolute";q.style.left="0px";q.style.top="0px";q.style.width="100%";q.style.height="100%";q.style.overflowX="hidden";q.style.overflowY="hidden"}var n='<table id="SBHE_DATAGRID_WHOLE_TABLE_'+this.id+'" cellpadding=0 cellspacing=0 border=0 style="table-layout:fixed;font-family:굴림;font-size:9pt;color:#000000;">';if(0!=this._getTotalColWidth()){n=n.insertAttribute("width",this._getTotalColWidth()+"px")}if(!r){var s='<colgroup id="SBHE_DATAGRID_WHOLE_COLGROUP_'+this.id+'">';for(var y=0;y<this.cols;y++){s+='<col style="width:'+this.m_arColWidth[y]+'px">'}s+="</colgroup>";n+=s}var o=null!=this.m_xlRefNode?this.m_xlRefNode.length:0;this.rows=this.fixedRows+o;this.m_nRealRows=this.rows;var D="";this.m_nMakeIndex=this.m_nRealRows;for(var y=0;y<this.m_nRealRows;y++){var c=false;var d=y<this.fixedRows?this.m_nRowHeight:this.dataHeight;var v="<TR rowNum='"+this.id+"_"+y+"'>";if(d>0&&!(SBGrid.DEF.is_mozBrowser)){d--}var u;if(this.fixedRows<=y){u=this.m_xlRefNode.item(y-this.fixedRows);if(""!=this.backColorAlternate&&((y-this.fixedRows)%2)==1){c=true}else{c=false}}for(var x=0;x<this.cols;x++){var h={};var t=this.m_arColumn[x];var e=this.id+"_"+y+"_"+x;var B;B='<td onmousedown=" "onmousemove=" "onmouseup=" "ondblclick=" "onkeydown=" "onkeypress=" "onkeyup=" " id="SBHE_'+e+"\" valign='middle'>";h.height=d+"px";h.overflow="hidden";h["background-repeat"]="no-repeat";h["text-align"]=(""==this.getAttribute("text-align"))?"left":this.getAttribute("text-align");var p=this.getCellByIdEx(e);if(null!=p){if(e!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,x,e,y,"softbowl:cell"):p;p.setElement(t);SBGrid.CF.GridSetMergeType(p,t.m_bMerge);var A="";if(y<this.fixedRows||x<this.fixedCols){h["text-align"]="center";h["background-color"]="#D4D0C8";h["border-right-color"]="#6F6F5F";h["border-bottom-color"]="#6F6F5F";this.setBaseCellStyle(h,"fixed");h["border-top-width"]="0px";h["border-left-width"]="0px";h["border-right-width"]="1px";h["border-bottom-width"]="1px";h["border-right-style"]="solid";h["border-bottom-style"]="solid"}else{h["background-color"]="#FFFFFF";h["border-right-color"]="#D4D0C8";h["border-bottom-color"]="#D4D0C8";this.setColStyleInheritanceCell(h,x);this.setBaseCellStyle(h,"data");h["background-color"]=c?this.backColorAlternate:h["background-color"];if(x<z||y<(this.fixedRows+this.frozenRows)||y>=(this.m_nRealRows-this.frozenBottomRows)){h["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:h["background-color"]}h["border-top-width"]="0px";h["border-left-width"]="0px";h["border-right-width"]="1px";h["border-bottom-width"]="1px";h["border-right-style"]="solid";h["border-bottom-style"]="solid"}if(y<this.fixedRows){if(this.m_arCaption[y][x]){A=this.m_arCaption[y][x].newlineCharConvert()}B=B.insertAttribute("style",this.getStyleString(h));B+='<span style="white-space:nowrap;">'+A+"</span>"}else{if(null!=t){var l=t.getAttribute("ref");if(l.isEmpty()){if(this.m_bRowHeader&&0==x){if("seq"==this.rowheader){A=y-this.fixedRows+1}else{if("reverseseq"==this.rowheader){A=o-(y-this.fixedRows)}}}}else{var C=null;var g=null;if(this.isJsonRef()){g=jsonRowData}else{C=SBGrid.UT.XmlLib.selectSingleNode(u,l)}if(null!=g){A=g[l]+""}else{if(null!=C){A=SBGrid.UT.XmlLib.getTextValue(C)}}this.setLinkedData(p,C,g)}}if(x<this.fixedCols&&!(this.m_bRowHeader&&0==x)){B=B.insertAttribute("style",this.getStyleString(h));B+=A}else{var a=t.getAttribute("type");if("checkbox"==a||"radio"==a){h["text-align"]="center"}B=B.insertAttribute("style",this.getStyleString(h));B+=t.makeCellElement(A,this.m_arColWidth[x],e,h)}}B+="</TD>";v+=B}v+="</TR>";D+=v}for(var y=this.m_nRealRows;y<(this.m_nDefaultRows+this.fixedRows);y++){var d=y<this.fixedRows?20:this.dataHeight;var v="<TR>";for(var x=0;x<this.cols;x++){var h={};var e=this.id+"_"+y+"_"+x;var B;B='<td onmousedown=" "onmousemove=" "onmouseup=" "ondblclick=" "onkeydown=" "onkeypress=" "onkeyup=" " id="SBHE_'+e+"\" valign='middle'>";h.height=d+"px";h.overflow="hidden";h["background-repeat"]="no-repeat";if(y<this.fixedRows||x<this.fixedCols){h["text-align"]="center";h["background-color"]="#D4D0C8";h["border-right-color"]="#6F6F5F";h["border-bottom-color"]="#6F6F5F";this.setBaseCellStyle(h,"fixed");h["border-top-width"]="0px";h["border-left-width"]="0px";h["border-right-width"]="1px";h["border-bottom-width"]="1px";h["border-right-style"]="solid";h["border-bottom-style"]="solid"}else{h["background-color"]="#FFFFFF";h["border-right-color"]="#D4D0C8";h["border-bottom-color"]="#D4D0C8";this.setColStyleInheritanceCell(h,x);this.setBaseCellStyle(h,"data");h["border-top-width"]="0px";h["border-left-width"]="0px";h["border-right-width"]="1px";h["border-bottom-width"]="1px";h["border-right-style"]="solid";h["border-bottom-style"]="solid"}B=B.insertAttribute("style",this.getStyleString(h));var w="<div>&nbsp;</div>";B+=w;B+="</TD>";v+=B}v+="</TR>";D+=v;this.rows++}var f=document.getElementById("SBHE_DATAGRID_EXPANSION_"+this.id);if(null==f){if(SBGrid.DEF.is_ie){f=document.createElement("<image onclick=\"SBGrid.CT.DataGrid.onClickExpansion(event, '"+this.id+"');\">")}else{f=document.createElement("image");f.setAttribute("onclick",'SBGrid.CT.DataGrid.onClickExpansion(event, "'+this.id+'")')}f.setAttribute("id","SBHE_DATAGRID_EXPANSION_"+this.id);f.setAttribute("src",SBGrid.DEF.__getAppName()+SBGrid.DEF.imgGridExpansion);f.style.position="absolute";f.style.top=(this.m_heCtrl.offsetHeight-20)+"px";f.style.left=(this.m_heCtrl.offsetWidth-20)+"px";if("visible"==this.getAttribute("overflow")||"hidden"==this.getAttribute("overflow")){f.style.display="none"}}n+=D;n+="</TABLE>";jQuery(q).html(n);if(r){var m=document.getElementById("SBHE_DATAGRID_WHOLE_TABLE_"+this.id);m.insertBefore(b,m.firstChild)}else{this.m_heCtrl.appendChild(q);this.m_heCtrl.appendChild(f)}return q};SBGrid.CT.DataGrid.prototype.resizeColumnWidth=function(){if(this.m_bIsUsePercentOfColWidth){var e=this.attribute.colwidth;e=e.replace(/%/g,"");var d=this.m_bRowHeader?1:0;var g=e.split(",");var f=Number(jQuery(this.m_heWhole).css("width").replace("px",""));if(isNaN(f)){return}if(SBGrid.DEF.is_ie8&&f==0){return}if(this._isVScroll()){f-=((jQuery(this.m_heWhole).prop("offsetWidth")-jQuery(this.m_heWhole).prop("clientWidth")))}if(d==1){f-=this.getColWidth(0);g.unshift(this.m_arColWidth[0])}while(this.m_arColWidth.length>g.length){g[g.length]=""}for(var a=d;a<this.cols;a++){var c=this.getColWidth(a);var b=0;if(g[a]!=""&&!isNaN(Number(g[a]))){b=f*g[a]/100}else{b=100}if(c!=b){this.setColWidth(a,b)}}}};SBGrid.CT.DataGrid.prototype.resize=function(){clearTimeout(this.resizeEvt);this.resizeEvt=setTimeout("if(SBGrid.getGrid('"+this.id+"')){SBGrid.getGrid('"+this.id+"').dispatch('onresize');}",300)};SBGrid.CT.DataGrid.prototype.onResize=function(b){if(this.m_objScroll.nTargetHeight==0){this.resetScroll();this.remakeGrid();this.scrollAttributeSetting()}if(null!=this.m_heWhole&&null!=this.m_heFFS){this.m_heFFS.style.width=this.m_heWhole.clientWidth+"px";this.m_heFFS.scrollLeft=this.m_heWhole.scrollLeft;if(null!=this.m_heFFBS){this.m_heFFBS.style.width=this.m_heWhole.clientWidth+"px";this.m_heFFBS.scrollLeft=this.m_heWhole.scrollLeft}}if(null!=this.m_heWhole&&null!=this.m_heFFC){this.m_heFFC.style.top=this.m_heWhole.scrollTop;if(null!=this.m_heFFS){var a=parseInt(this.m_heWhole.clientHeight)-parseInt(this.m_heFFS.clientHeight);this.m_heFFC.style.height=a<0?"0px":a+"px";this.m_heFFC.style.top=this.m_heFFS.clientHeight+"px";if(null!=this.m_heFFBS){this.m_heFFBNS.style.top=(this.m_heWhole.clientHeight-(this.dataHeight*this.m_nBottomRowCount))+"px";this.m_heFFBS.style.top=(this.m_heWhole.clientHeight-(this.dataHeight*this.m_nBottomRowCount))+"px"}}}this.resizeColumnWidth();if(this.m_heWhole.scrollTop==0&&this.m_objScroll.heTargetTable.style.top!="0px"){this.m_objScroll.heTargetTable.style.top="0px";this.clearSelection()}};SBGrid.CT.DataGrid.prototype.selectAllCells=function(){var a=this.getSelectionMode();this.clearSelection();if(SBGrid.DEF.SBSM_BYCOL==a){for(var b=this.getFixedCols();b<this.getCols();b++){this.selectCol(b)}}else{if(SBGrid.DEF.SBSM_FREE==a){this.selectCells(this.getFixedRows(),this.getFixedCols(),this.getRows(),this.getCols())}else{for(var b=0;b<this.getRows();b++){this.selectRow(b)}}}if(document.body.attachEvent){document.body.attachEvent("onkeydown",SBGrid.DEF.keyDownAllSelected)}else{document.body.addEventListener("keydown",SBGrid.DEF.keyDownAllSelected,false)}};SBGrid.DEF.keyDownAllSelected=function(a){if(!a){a=window.event}if((a.ctrlKey&&a.keyCode==SBGrid.EVT.A)){if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}}};SBGrid.CT.DataGrid.prototype.makeDataSearchUI=function(){var c=this.id;var a=document.getElementById("SBHE_DATAGRID_SEARCHING_DATA_"+this.m_strTargetGrid);var e=0;var d="";var b=[];var f=new Array();f.push("<font size='2' style='margin-left:5px; margin-top:15px;'>Find</font>");f.push("<input type='text' id='"+this.id+"_searchingData_inputtext' value='' style='width:200px; margin-top:5px; margin-left:6px;'/>");f.push("<input type='checkbox' id='"+this.id+"_searchingData_checkbox' style='border-style:none; margin-top:10px; margin-left:120px;'/>");f.push("<font size='2'>Match case(C)</font>");f.push("<input type='text' id='"+this.id+"_searchingData_resultTxt' value='Search result : ' style='margin-left:5px; width:200px; background-color:#eaeff3; border:none;' disabled='disabled' />");f.push("<input type='button' id='"+this.id+"_searchingData_NextSearchingBtn' class='sbgrid_datagrid_searchingdata_bnt' value='Find next(M)' style='margin-top:14px; width:115px; margin-left:5px; background-color:#8da4be;'></input>");f.push("<input type='button' id='"+this.id+"_searchingData_CloseBtn' class='sbgrid_datagrid_searchingdata_bnt'value='Close' style='width:115px; margin-left:8px;background-color:#8da4be;'></input>");jQuery(a).append(f.join(""));jQuery(a).attr("onKeyDown",'SBGrid.DEF.dokeyEvntSearching("'+this.id+'")');this.m_heGridDataSearchUI=a;jQuery("#"+c+"_searchingData_CloseBtn").attr("onclick",'SBGrid.DEF.doClose("'+this.id+'")');jQuery("#"+c+"_searchingData_NextSearchingBtn").attr("onclick",'SBGrid.DEF.doSearch("'+this.id+'")');this.actionFlg=false;f=null;a.style.left=(this.m_heCtrl.offsetLeft+(this.m_heCtrl.offsetWidth/2-125))+"px";a.style.top=(this.m_heCtrl.offsetTop+(this.m_heCtrl.offsetHeight/2-37))+"px";switch(this.m_style_theme){case"blue":a.style.backgroundColor="#c8f7fd";jQuery("#"+this.id+"_searchingData_NextSearchingBtn").attr("style","margin-top:14px; width:115px; margin-left:5px; background-color:#4587d8;");jQuery("#"+this.id+"_searchingData_CloseBtn").attr("style","width:115px; margin-left:8px;background-color:#4587d8;");jQuery("#"+this.id+"_searchingData_resultTxt").attr("style","margin-left:5px; width:200px; background-color:#c8f7fd; border:none;");break;case"pink":a.style.backgroundColor="#F7CCFA";jQuery("#"+this.id+"_searchingData_NextSearchingBtn").attr("style","margin-top:14px; width:115px; margin-left:5px; background-color:#E658FA;");jQuery("#"+this.id+"_searchingData_CloseBtn").attr("style","width:115px; margin-left:8px;background-color:#E658FA;");jQuery("#"+this.id+"_searchingData_resultTxt").attr("style","margin-left:5px; width:200px; background-color:#F7CCFA; border:none;");break;case"desert":a.style.backgroundColor="#e8d6bb";jQuery("#"+this.id+"_searchingData_NextSearchingBtn").attr("style","margin-top:14px; width:115px; margin-left:5px; background-color:#41a09c;");jQuery("#"+this.id+"_searchingData_CloseBtn").attr("style","width:115px; margin-left:8px;background-color:#41a09c;");jQuery("#"+this.id+"_searchingData_resultTxt").attr("style","margin-left:5px; width:200px; background-color:#e8d6bb; border:none;");break;case"gray":a.style.backgroundColor="#ebebeb";jQuery("#"+this.id+"_searchingData_NextSearchingBtn").attr("style","margin-top:14px; width:115px; margin-left:5px; background-color:#646464;  color:#ffffff;");jQuery("#"+this.id+"_searchingData_CloseBtn").attr("style","width:115px; margin-left:8px;background-color:#646464;  color:#ffffff;");jQuery("#"+this.id+"_searchingData_resultTxt").attr("style","margin-left:5px; width:200px; background-color:#ebebeb; border:none;");break;case"metal":a.style.backgroundColor="#c9c9c9";jQuery("#"+this.id+"_searchingData_NextSearchingBtn").attr("style","margin-top:14px; width:115px; margin-left:5px; background-color:#575757; color:#ffffff;");jQuery("#"+this.id+"_searchingData_CloseBtn").attr("style","width:115px; margin-left:8px;background-color:#575757; color:#ffffff;");jQuery("#"+this.id+"_searchingData_resultTxt").attr("style","margin-left:5px; width:200px; background-color:#e0e0e0; border:none;");break;case"claret":a.style.backgroundColor="#E8D1D1";jQuery("#"+this.id+"_searchingData_NextSearchingBtn").attr("style","margin-top:14px; width:115px; margin-left:5px; background-color:#BF4E6A; color:#ffffff;");jQuery("#"+this.id+"_searchingData_CloseBtn").attr("style","width:115px; margin-left:8px;background-color:#BF4E6A; color:#ffffff;");jQuery("#"+this.id+"_searchingData_resultTxt").attr("style","margin-left:5px; width:200px; background-color:#E8D1D1; border:none;");break;default:a.style.border="solid 1px #404040";a.style.backgroundColor="#eaeff3";jQuery("#"+this.id+"_searchingData_NextSearchingBtn").attr("style","margin-top:14px; width:115px; margin-left:5px; background-color:#87A0BB; color:#ffffff;");jQuery("#"+this.id+"_searchingData_CloseBtn").attr("style","width:115px; margin-left:8px;background-color:#87A0BB; color:#ffffff;");jQuery("#"+this.id+"_searchingData_resultTxt").attr("style","margin-left:5px; width:200px; background-color:#eaeff3; border:none;")}a.style.display="none";if(document.body.attachEvent){document.body.attachEvent("onkeydown",SBGrid.DEF.keyDownTextField)}else{document.body.addEventListener("keydown",SBGrid.DEF.keyDownTextField,false)}return a};SBGrid.DEF.keyDownTextField=function(a){if(!a){a=window.event}if((a.ctrlKey&&a.keyCode==SBGrid.EVT.F)){if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}}};SBGrid.CT.DataGrid.prototype.showDataSearchUI=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".showDataSearchUI","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".showDataSearchUI","Please check if first parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}if(a){jQuery("#SBHE_DATAGRID_SEARCHING_DATA_"+this.id).show();document.getElementById(this.id+"_searchingData_inputtext").focus()}else{document.getElementById(this.id+"_searchingData_inputtext").value="";document.getElementById(this.id+"_searchingData_resultTxt").value="Search result : ";jQuery("#SBHE_DATAGRID_SEARCHING_DATA_"+this.id).hide()}};SBGrid.CT.DataGrid.prototype.onScroll=function(c){if(c.target==this.m_objTextArea.id){this.m_bIsMouseWheel=false;c.preventDefault();return}if(this.m_bIsTextareaScroll==false){if(c.target==this.m_objTextArea.id||document.getElementById("SBHE_"+this.m_objTextArea.id).style.visibility=="visible"){this.m_bIsMouseWheel=false;if(SBGrid.DEF.is_ie&&!(SBGrid.DEF.is_ie9)&&!(SBGrid.DEF.is_ie10)){c.returnValue=false}else{c.preventDefault()}return}}if(!SBGrid.DEF.is_smartphone){if(null!=this.m_heWhole&&this.m_heFFS){this.m_heFFS.scrollLeft=this.m_heWhole.scrollLeft;this.m_heFFBS.scrollLeft=this.m_heWhole.scrollLeft}if(null!=this.m_heWhole&&this.m_heFFC){this.m_heFFC.scrollTop=this.m_heWhole.scrollTop}var d=false;var a=false;if(this.vscroll.getPrevScrollPosition()!=this.m_heWhole.scrollTop){d=true}if(this.hscroll.getPrevScrollPosition()!=this.m_heWhole.scrollLeft){a=true}this.vscroll.setScrollPosition(this.m_heWhole.scrollTop);this.vscroll.setScrollMax(this.m_heWhole.scrollHeight-this.m_heWhole.clientHeight);if(d){if(this.m_heWhole.scrollTop==0){this.vscroll.dispatch("onscrollmin")}else{if(this.m_heWhole.scrollHeight-this.m_heWhole.clientHeight==this.m_heWhole.scrollTop){this.vscroll.dispatch("onscrollmax")}}}this.hscroll.setScrollPosition(this.m_heWhole.scrollLeft);this.hscroll.setScrollMax(this.m_heWhole.scrollWidth-this.m_heWhole.clientWidth);if(a){if(this.m_heWhole.scrollLeft==0){this.hscroll.dispatch("onscrollmin")}else{if(this.m_heWhole.scrollWidth-this.m_heWhole.clientWidth==this.m_heWhole.scrollLeft){this.hscroll.dispatch("onscrollmax")}}}if(!SBGrid.DEF.is_smartphone&&this.m_objScroll.bScrollEvent&&this.m_objScroll.nPosition!=this.m_heWhole.scrollTop){var f=this.m_objScroll.nPosition-this.m_heWhole.scrollTop;if(this.m_bIsShowLoadingImage){if(Math.abs(f)<80){this.scrollButtonClick(f,this.m_heWhole.scrollTop);if(this.m_bUseWebAccess==true){if(this.getCellEx(this.getMouseRow(),this.getMouseCol()).getHtmlElement()!=null){this.getCellEx(this.getMouseRow(),this.getMouseCol()).getHtmlElement().firstChild.tabIndex="0";this.getCellEx(this.getMouseRow(),this.getMouseCol()).getHtmlElement().firstChild.focus()}else{document.getElementsByClassName("sbgrid_datagrid_DataCell")[this.getMouseCol()].firstChild.removeAttribute("tabIndex")}}}else{if(f>0){this.m_objScroll.heTargetTable.style.top=this.m_heWhole.scrollTop+"px";this.m_objScroll.heTargetFFCTable.style.top=this.m_heWhole.scrollTop+"px"}this.showWait(true);this.m_objScroll.arScrollLength.push(1);if(SBGrid.DEF.n_scrollingTimer!=null){window.clearTimeout(SBGrid.DEF.n_scrollingTimer)}SBGrid.DEF.n_scrollingTimer=window.setTimeout("SBGrid.DEF.n_scrollingTimer = null; SBGrid.getGrid('"+this.id+"').scrollingGrid(true);",this.m_nScrollingDelayTime)}}else{var e=parseInt(this.m_heFFS.style.height);var b=parseInt(Math.round((this.m_heWhole.offsetHeight/8)*7)-e);if(this.m_bIsMouseWheel){this.scrollButtonClick(f,this.m_heWhole.scrollTop);if(this.m_bUseWebAccess==true){if(this.getCellEx(this.getMouseRow(),this.getMouseCol()).getHtmlElement()!=null){this.getCellEx(this.getMouseRow(),this.getMouseCol()).getHtmlElement().firstChild.tabIndex="0";this.getCellEx(this.getMouseRow(),this.getMouseCol()).getHtmlElement().firstChild.focus()}else{document.getElementsByClassName("sbgrid_datagrid_DataCell")[this.getMouseCol()].firstChild.removeAttribute("tabIndex")}}}else{if(Math.abs(f)<b){if(SBGrid.DEF.n_scrollingTimer!=null){window.clearTimeout(SBGrid.DEF.n_scrollingTimer);SBGrid.DEF.n_scrollingTimer=window.setTimeout("SBGrid.DEF.n_scrollingTimer = null; SBGrid.getGrid('"+this.id+"').scrollingGrid(true);",this.m_nScrollingDelayTime)}else{this.scrollButtonClick(f,this.m_heWhole.scrollTop)}}else{this.showWait(true);this.m_objScroll.arScrollLength.push(1);if(SBGrid.DEF.n_scrollingTimer!=null){window.clearTimeout(SBGrid.DEF.n_scrollingTimer)}SBGrid.DEF.n_scrollingTimer=window.setTimeout("SBGrid.DEF.n_scrollingTimer = null; SBGrid.getGrid('"+this.id+"').scrollingGrid(true);",this.m_nScrollingDelayTime)}}}this.setTopBottomRowPosition()}this.m_bDown=false;if((this.m_heFFS!=null)&&(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11)){this.m_heWhole.scrollTop=this.m_heWhole.scrollTop}}};SBGrid.CT.DataGrid.prototype.onMouseDown=function(o){if(o.target=="datagrid1_textarea"){return}this.m_bIsMouseWheel=this.isCell(o.target);this.m_bMouseDown=true;this.m_bCapturing=false;var i=document.SBHE_allElement.m_htCollection[o.focus];if(i){var v=i.getElement();if(v&&v.tag=="softbowl:input"&&v.parent==this){SBGrid.CT.Group.prototype.onMouseDown.call(this,o);i=null;v=null;return}v=null}i=null;SBGrid.CT.Group.prototype.onMouseDown.call(this,o);if(!this.isDescendants(o.focus,true)){this.m_bDown=false;return}if(this.isScrollBar(o)){this.setComboHidden(false);this.setRowValue(-1);this.setColValue(-1);return}if(!this.isCell(o.target)&&!this.isDescendants(o.target)){this.setComboHidden(false);this.setRowValue(-1);this.setColValue(-1);return}if(3==o.button){if(this.m_bIsContextMenu==true){var b=this.m_arColumn[this.getMouseCol()];if(null!=b){if(b.m_bIsColContext){this.ContextMenuDisplay(o)}}}this.m_bDown=false;this.setComboHidden(false);return}this.m_nPrevX=o.x;this.m_nPrevY=o.y;if(-1==this.getMouseRow()||-1==this.getMouseCol()){return}var h=this.getAttribute("cursor");this.m_bLButtonDown=false;this.m_bDragStart=false;if("drag-move"==h){SBGrid.DEF.bDragDrop=true;this.m_bLButtonDown=true;return}else{if("h-resize"!=h&&"v-resize"!=h){this.restoreCursor()}else{this.m_bAfterResize=true}}var u=false;if(this.m_nDownRow!=this.getMouseRow()||this.m_nDownCol!=this.getMouseCol()){var b=this.m_arColumn[this.getMouseCol()];if(null!=b){var m=b.getInputType();if((SBGrid.DEF.SBIT_INPUTBUTTON==m||SBGrid.DEF.SBIT_INPUTDATE==m)&&b.inputDataPosition(this.parentId,this.id)<o.clientX){u=false}else{u=true}}else{u=true}}if(SBGrid.EVT.BUTTON_RIGHT!=o.button){this.m_bDown=true}if(!this.m_bIsShowItem&&this.isCell(o.target)){this.m_nDownRow=this.getMouseRow();this.m_nDownCol=this.getMouseCol()}else{this.m_bDown=false;return}var e=this.getRow();var d=this.getCol();this.setRowValue(this.m_nDownRow);this.setColValue(this.m_nDownCol);if(SBGrid.EVT.BUTTON_RIGHT!=o.button&&(this.isNormalCell(this.m_nDownRow,this.m_nDownCol)||this.isFixedCell(this.m_nDownRow,this.m_nDownCol))){o.capture=this.id;if(this.getSelectedCellsInfo().count()>=1){if(this.getSelectedCellsInfo().count()==1){var f=this.getSelectedCellsInfo().keys();if(this.getSelectedCellsInfo().find(f).count()>1){if(o.ctrlKey){o.capture=""}}}else{if(o.ctrlKey){o.capture=""}}}}var g=this.getCellEx(this.m_nDownRow,this.m_nDownCol);if(this.isFixedCell(this.m_nDownRow,this.m_nDownCol)&&this.m_bIsExplorerBar){this.m_moveColInfo=o.hover;this.m_bIsFirstMoveColumn=true;var g=this.getCellEx(this.m_nDownRow,this.m_nDownCol)}if(this.isFixedCell(this.m_nDownRow,this.m_nDownCol)&&!this.getAllowBigSelection()){this.stopEditing();if(!this.m_bIsExplorerBar){this.clearSelection()}return}if(g.getMergeByFree()==true){if(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11){if(window.event){var r=window.event.srcElement.className;var l=window.event.srcElement.tagName;if(r!="sbgrid_datagrid_Output"&&r.indexOf("sbgrid_datagrid_DataCell")==-1&&l!="SPAN"&&l!="TD"){this.m_bMouseDrag=false;this.m_bLButtonDown=false;o.capture="";r=l=null;return}}}}if(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11){if(!this.m_objScroll.bScrollEvent){this.initGridCell()}}if(null!=g){if(!o.shiftKey){this.m_nPrevDownRow=this.m_nDownRow;this.m_nPrevDownCol=this.m_nDownCol}if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()){if(this.isNormalCell(this.m_nDownRow,this.m_nDownCol)){if(!o.ctrlKey){this.clearSelection()}if(!this.getAllowSelection()){this.clearSelection();this.m_nPrevDownRow=this.m_nDownRow;this.m_nPrevDownCol=this.m_nDownCol}var a=SBGrid.DEF.arrFind_Value(this.m_arSelectRows,this.m_nDownRow);if(a>-1){this.deSelectRow(this.m_nDownRow)}else{if(!this.m_bUseFrozenSelect&&this.isFrozenCol(this.m_nDownCol)){this.clearSelection();return}this.selectRow(this.m_nDownRow)}if(o.shiftKey){this.clearSelection();var p=(this.m_nPrevDownRow<this.m_nDownRow)?this.m_nPrevDownRow:this.m_nDownRow;var n=(this.m_nPrevDownRow<this.m_nDownRow)?this.m_nDownRow:this.m_nPrevDownRow;var s=(this.m_nPrevDownCol<this.m_nDownCol)?this.m_nPrevDownCol:this.m_nDownCol;var t=(this.m_nPrevDownCol<this.m_nDownCol)?this.m_nDownCol:this.m_nPrevDownCol;this.selectCells(p,s,n,t)}}}else{if(this.isNormalCell(this.m_nDownRow,this.m_nDownCol)){var c=false;if(SBGrid.DEF.SBSM_FREE==this.getSelectionMode()){if(!o.ctrlKey){this.clearSelection()}else{if(!this.getAllowSelection()){this.clearSelection();this.m_nPrevDownRow=this.m_nDownRow;this.m_nPrevDownCol=this.m_nDownCol}var q=this.m_htSelectCells[g.id];if(null!=q){this.removeSelCells(g.id);c=true}}}else{this.clearSelection()}if(!c){if(!this.getAllowSelection()){this.m_nPrevDownRow=this.m_nDownRow;this.m_nPrevDownCol=this.m_nDownCol}var p=(this.m_nPrevDownRow<this.m_nDownRow)?this.m_nPrevDownRow:this.m_nDownRow;var n=(this.m_nPrevDownRow<this.m_nDownRow)?this.m_nDownRow:this.m_nPrevDownRow;var s=(this.m_nPrevDownCol<this.m_nDownCol)?this.m_nPrevDownCol:this.m_nDownCol;var t=(this.m_nPrevDownCol<this.m_nDownCol)?this.m_nDownCol:this.m_nPrevDownCol;if(SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){p=n}this.selectCells(p,s,n,t)}}}}if(!this.isFixedCell(this.m_nDownRow,this.m_nDownCol)&&!g.m_bIsSubTotal){if(u){this.dispatch("onentercell")}else{this.topScrollCell(this.m_nDownRow,false)}}if("h-resize"!=this.getAttribute("cursor")&&"v-resize"!=this.getAttribute("cursor")){if(e!=this.m_nDownRow){this.dispatch("onrowchanged")}if(d!=this.m_nDownCol){this.dispatch("oncolchanged")}}};SBGrid.CT.DataGrid.prototype.onMouseUp=function(d){this.m_bCapturing=false;this.m_bMouseDown=false;var b=document.SBHE_allElement.m_htCollection[d.focus];if(b){var a=b.getElement();if(a&&a.tag=="softbowl:input"&&a.parent==this){SBGrid.CT.Group.prototype.onMouseUp.call(this,d);b=null;a=null;return}a=null}b=null;this.m_bLButtonDown=false;SBGrid.CT.Group.prototype.onMouseUp.call(this,d);this.m_bDown=false;SBGrid.DEF.bIsAfterMouseUpFlg=true;if(this.getSelectedCellsInfo().count()>=1){if(this.getSelectedCellsInfo().count()==1){var c=this.getSelectedCellsInfo().keys();if(this.getSelectedCellsInfo().find(c).count()>1){this.dispatch("onselectedcells")}}else{this.dispatch("onselectedcells")}}if(!this.isCell(d.target)){return}};SBGrid.CT.DataGrid.prototype.onMouseMove=function(f){var b=document.SBHE_allElement.m_htCollection[f.focus];if(b){var a=b.getElement();if(a&&(a.tag=="softbowl:input"||a.tag=="softbowl:textarea")&&a.parent==this){SBGrid.CT.Group.prototype.onMouseMove.call(this,f);b=null;a=null;return}if(a&&((a.tag=="softbowl:select1"&&a.parent==this)||a.tag=="softbowl:combobutton")){f.hover=""}a=null}b=null;SBGrid.CT.Group.prototype.onMouseMove.call(this,f);var e=this.getMouseRow();var h=this.getMouseCol();var d=this.getCellEx(e,h);var g=this.getRow();var c=this.getCol();if(!this.isCell(f.target)&&SBGrid.DEF.SBRS_NONE==this.getResizeType()){this.restoreCursor();return}if(this.m_bLButtonDown&&""!=this.getAttribute("dragmode")&&"false"!=this.getAttribute("dragmode")&&!this.m_bDragStart){this.m_bDragStart=true;this.m_bLButtonDown=false;f.capture="";f.drag=this.id;this.dispatch("ondragstart");return}if(this.getAllowUserResize()){if(SBGrid.DEF.SBRS_NONE==this.getResizeType()&&""==f.capture){this.hitTestCell(f)}var d=this.getCellEx(e,h);if(null!=d){if(!this.m_bDown&&""!=this.getAttribute("dragmode")&&"false"!=this.getAttribute("dragmode")&&this.isDragCellSelect(e,h,d)){this.setGridCursor("drag-move");this.m_bDragStart=true}else{this.m_bDragStart=false}}}if(e!=this.prevMouseRow||h!=this.prevMouseCol){this.dispatch("onmouseovercell")}this.prevMouseRow=e;this.prevMouseCol=h};SBGrid.CT.DataGrid.prototype.onMouseWheel=function(b){if(0!=b.mouseWheel){if(b.target==this.m_objTextArea.id){this.m_bIsMouseWheel=true;b.preventDefault();return}if(SBGrid.DEF.is_firefox&&b.target==this.m_objTextArea.id&&b.hover==this.m_objTextArea.id&&b.focus==this.m_objTextArea.id){this.m_bIsMouseWheel=true;b.preventDefault();return}if(this.m_bIsTextareaScroll==false){if(b.target==this.m_objTextArea.id||document.getElementById("SBHE_"+this.m_objTextArea.id).style.visibility=="visible"){this.m_bIsMouseWheel=true;if(SBGrid.DEF.is_ie&&!(SBGrid.DEF.is_ie9)&&!(SBGrid.DEF.is_ie10)){b.returnValue=false}else{b.preventDefault()}return}}else{this.m_objTextArea.setVisible(false)}this.m_bIsMouseWheel=true;if(!this.isCell(b.target)&&!this.isDescendants(b.target)){return}var a=this.getCellEx(this.m_nDownRow,this.m_nDownCol);if(null!=a&&((this.fixedCols+this.frozenCols)>a.col||(this.fixedRows+this.frozenRows)>a.row)){this.m_heWhole.scrollTop=this.m_heWhole.scrollTop-(b.mouseWheel*18)}this.closePopUp()}};SBGrid.CT.DataGrid.prototype.onClick=function(p){this.setConTextVisible(false);if(this.m_bIsCellsInfoDisplay==true&&this.m_bIsCellsInfoDiv!=null){this.m_bIsCellsInfoDiv.style.visibility="hidden"}var m=document.SBHE_allElement.m_htCollection[p.focus];if(m){var u=m.getElement();if(u&&(u.tag=="softbowl:input"||u.tag=="softbowl:textarea")&&u.parent==this){SBGrid.CT.Group.prototype.onClick.call(this,p);m=null;u=null;return}u=null}m=null;this.deleteShowExplorerUI();SBGrid.CT.Group.prototype.onClick.call(this,p);if(SBGrid.DEF.is_ie){if(null!=this.m_heFFS){this.m_heFFS.scrollTop=0}if(null!=this.m_heGridFFNScrollRow){this.m_heGridFFNScrollRow.scrollTop=0}}if(!this.isCell(p.target)&&!this.isDescendants(p.target)){return}if(!this.m_bUseFrozenSelect&&this.isFrozenCol(this.m_nDownCol)){return}var g=this.getCellEx(this.m_nDownRow,this.m_nDownCol);if(this.isScrollBar(p.target)==false){if(this.isFixedRow(this.m_nDownRow)){if(null!=g&&SBGrid.DEF.SBIT_CHECK==g.m_fixedInputType){return}if(this.getFixedRows()>1){var b=this.fixedRows;var r=this.getCellEx(0,this.m_nDownCol);if(null!=r){if(r.m_heCtrl){b=r.m_heCtrl.rowSpan}}if(b<this.fixedRows){if(this.m_nDownRow<this.fixedRows-1){return}}}if(this.isShowExplorerUI()){var h=this.getCellRect(this.m_nDownRow,this.m_nDownCol);this.getShowExplorerUI(h)}else{if(this.isSortable()){if(this.m_bUseMultiSorting){var l=this.getAttribute("cursor");if(l=="arrow"&&SBGrid.DEF.bIsAfterMouseUpFlg==true){var n=this.fixedRows;var a=this.m_nRealRows-1;if(!(this.m_bIsSortFrozenRows)){n+=this.frozenRows}if(!(this.m_bIsSortFrozenBottomRows)){a-=this.frozenBottomRows}var o=this.m_clMultiSortingHistory.item(this.m_nDownCol.toString());if(o==undefined){this.initMultiSortShowIcon(g,this.m_nDownCol);o=[[this.m_nDownRow,this.m_nDownCol],SBGrid.DEF.SBST_ASC];this.m_clMultiSortingHistory.add(this.m_nDownCol,o);this.multiSortEx(this.getMultiSortingInfoList(),n,a,true)}else{var t=p.m_browserEvent.srcElement;var s=t.getAttribute("multisorttype");if(s=="init"){if(this.m_clMultiSortingHistory.count()==1){if(o[1]==SBGrid.DEF.SBST_ASC){o[1]=SBGrid.DEF.SBST_DESC}else{if(o[1]==SBGrid.DEF.SBST_DESC){o[1]=SBGrid.DEF.SBST_ASC}}this.multiSortEx(this.getMultiSortingInfoList(),n,a,true)}else{if(this.m_clMultiSortingHistory.count()>1){this.m_clMultiSortingHistory.clear();this.deleteMultiSortShowIcon();this.initMultiSortShowIcon(g,this.m_nDownCol);o=[[this.m_nDownRow,this.m_nDownCol],SBGrid.DEF.SBST_ASC];this.m_clMultiSortingHistory.add(this.m_nDownCol,o);this.multiSortEx(this.getMultiSortingInfoList(),n,a,true)}}}else{if(s=="normal"){if(o[1]==SBGrid.DEF.SBST_ASC){o[1]=SBGrid.DEF.SBST_DESC}else{if(o[1]==SBGrid.DEF.SBST_DESC){o[1]=SBGrid.DEF.SBST_ASC}}this.multiSortEx(this.getMultiSortingInfoList(),n,a,true)}}t=s=null}n=a=o=null}}else{this.sortCaptionColumn(this.m_nDownCol)}}}}}if(null!=g){var g=this.getCellEx(this.row,this.col);var f=g.getElement();if(this._isShowCombo()&&!this.m_bIsShowItem&&f.attribute.editmode!="search"){this.setComboHidden(false)}else{if(!(this.isFixedCell(this.row,this.col))){this.setComboHidden(true)}}if(this.getAllowBigSelection()&&this.isFixedCell(this.m_nDownRow,this.m_nDownCol)){this.clearSelection();if(0<this.fixedRows&&0<this.fixedCols&&0==this.m_nDownRow&&0==this.m_nDownCol){if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){for(var q=this.fixedRows;q<this.rows;q++){this.selectRow(q)}}if(SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){for(var q=this.fixedCols;q<this.cols;q++){this.selectCol(q)}}}else{if(this.isFixedRow(this.m_nDownRow)&&SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){this.selectCol(this.m_nDownCol)}else{if(this.isFixedCol(this.m_nDownCol)&&(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode())){this.selectRow(this.m_nDownRow)}}}}if(!this.isEditing()&&this.m_bIsOneclickEdit==true&&this.getColType(this.col)!="inputdate"){if(this.row>=this.fixedRows){this.dispatch("onentercell");this.setEditCell(p)}}var e=this.m_objInput.m_heCtrl;if(!this.isEditing()&&f.attribute.editmode=="search"&&this.getColType(this.col)=="combo"){var d=document.getElementById("SBHE_"+f.m_objCombo.id+"_input");d.removeAttribute("readonly");d.setAttribute("editmode","search");var c=d.value.length;window.setTimeout(d.id+".setSelectionRange("+c+", "+c+");",0);window.setTimeout(d.id+".focus();",0);this.dispatch("onentercell");this.setEditCell(p)}}};SBGrid.CT.DataGrid.prototype.onDblClick=function(c){SBGrid.CT.Group.prototype.onDblClick.call(this,c);if(!this.isCell(c.target)){return}if(!this.isDescendants(c.focus,true)){return}if(!this.m_bUseFrozenSelect&&this.isFrozenCol(this.m_nDownCol)){return}if(!this.isEditing()){this.setEditCell(c)}if(this.getAutoSizeMouse()){if("h-resize"==this.getAttribute("cursor")){var b=this.childReturnObj(c.focus);if(null!=b){var a=this.m_arColumn[b.col];if(a){this.autoResizeWidth(b.col)}a=null}}this.restoreCursor()}};SBGrid.CT.DataGrid.prototype.onKeyUp=function(b){SBGrid.CT.Group.prototype.onKeyUp.call(this,b);if(b.keyCode==SBGrid.EVT.DOWN||b.keyCode==SBGrid.EVT.UP||b.keyCode==SBGrid.EVT.RIGHT||b.keyCode==SBGrid.EVT.LEFT){if(this.getSelectedCellsInfo().count()>=1){if(this.getSelectedCellsInfo().count()==1){var a=this.getSelectedCellsInfo().keys();if(this.getSelectedCellsInfo().find(a).count()>1){this.dispatch("onselectedcells")}}else{this.dispatch("onselectedcells")}}}};SBGrid.CT.DataGrid.prototype.onKeyDown=function(a){SBGrid.CT.Group.prototype.onKeyDown.call(this,a);if(this.m_bIsDataSearching==true){if((a.ctrlKey&&a.keyCode==SBGrid.EVT.F)){if(this.m_heGridDataSearchUI.style.display=="none"){a.preventDefault();this.showDataSearchUI(true)}else{this.showDataSearchUI(false)}}}var i=true;if(this.m_bIsContextMenu==true){var f=this.m_heContextMenu;if(f.style.visibility=="visible"){if(a.preventDefault){a.preventDefault()}a.returnValue=false;this.ContextMenuOnclick(a);return false}f=null}if(!this.isCell(a.target)&&this.id!=a.target){return}if(a.ctrlKey&&SBGrid.EVT.C==a.keyCode){this.dispatch("oncopy");return}if(a.ctrlKey&&SBGrid.EVT.V==a.keyCode){this.dispatch("onpaste");return}if(a.ctrlKey&&SBGrid.EVT.A==a.keyCode){if(this.m_objTextArea!=null){if(this.m_objTextArea.m_heCtrl.style.visibility=="visible"){return}}if(this.m_objInput!=null){if(this.m_objInput.m_heCtrl.style.visibility=="visible"){return}}this.selectAllCells();return}if(SBGrid.EVT.CONTROL==a.keyCode||SBGrid.EVT.SHIFT==a.keyCode||SBGrid.EVT.TAB==a.keyCode){return}if(null!=this.m_heCtrl&&"softbowl:input"!=a.pTarget.tag&&"softbowl:textarea"!=a.pTarget.tag&&(SBGrid.EVT.LEFT==a.keyCode||SBGrid.EVT.RIGHT==a.keyCode)){this.m_heCtrl.focus()}if(this.isEditing()&&(SBGrid.EVT.ENTER==a.keyCode)&&!a.ctrlKey&&!a.shiftKey){this.setCellEditText();i=false}if(this.isEditing()&&this.getColType(this.col)=="textarea"){if(!SBGrid.DEF.is_ie8&&!SBGrid.DEF.is_ie7){if(SBGrid.EVT.ENTER==a.keyCode&&a.shiftKey){var h=this.getEditControl(SBGrid.DEF.SBIT_TEXTAREA);var c=SBGrid.DEF.getCaretPosition(h.m_heCtrl).start;var b=SBGrid.DEF.getCaretPosition(h.m_heCtrl).end;var d=parseInt(c)+1;var l=parseInt(b)+1;var m="";m=h.getWindowText();var g=m.substr(0,c);var e=m.substr(b,h.length);m=g+"\n"+e;h.m_heCtrl.value=m;SBGrid.DEF.setCaretPosition(h.m_heCtrl,d,l);g=null;e=null;m=null}}}if(!this.isEditing()&&i&&!this.m_bIsMaxLength&&(SBGrid.EVT.ENTER==a.keyCode||SBGrid.EVT.SPACE==a.keyCode||(SBGrid.EVT.ZERO<=a.keyCode&&SBGrid.EVT.NINE>=a.keyCode)||(SBGrid.EVT.A<=a.keyCode&&SBGrid.EVT.Z>=a.keyCode)||(96<=a.keyCode&&111>=a.keyCode)||(186<=a.keyCode&&222>=a.keyCode))){this.onFocus(a);this.setComboHidden(true);this.setEditCell(a)}this.m_bIsMaxLength=false;if(!this.isEditing()){switch(a.keyCode){case SBGrid.EVT.LEFT:this.funcMoveLeft(a);break;case SBGrid.EVT.RIGHT:this.funcMoveRight(a);break;case SBGrid.EVT.UP:this.funcMoveUp(a);break;case SBGrid.EVT.DOWN:this.funcMoveDown(a);break;case SBGrid.EVT.HOME:if(!a.ctrlKey){}else{}break;case SBGrid.EVT.END:if(!a.ctrlKey){}else{}break;case SBGrid.EVT.PAGEUP:this.funcMovePageUp(a);break;case SBGrid.EVT.PAGEDOWN:this.funcMovePageDown(a);break}}this.selectKeyDown(a)};SBGrid.CT.DataGrid.prototype.onCopy=function(o){if(this.m_bIsAllowCopy){var s,r,b,u;s=r=b=u=-1;var d="";var g=this.getRowHeader()>0?1:0;switch(this.getSelectionMode()){case SBGrid.DEF.SBSM_BYCOL:if(this.col!=-1){var c=this.getColType(this.col);if(c=="combo"){for(var q=this.fixedRows;q<this.rows;q++){d+=this.labelMatrix(q,this.col).replaceAll("\n","");d+="\n"}}else{for(var q=this.fixedRows;q<this.rows;q++){d+=this.getTextMatrix(q,this.col).replaceAll("\n","");d+="\n"}}}else{return}break;case SBGrid.DEF.SBSM_FREE:var p=this.getSelectedCellsInfo();var l=p.keys();if(l.length>0){for(var q=0;q<l.length;q++){if(q!=0){d+="\n"}var v=parseInt(l[q]);var h=p.find(l[q]);var m=h.keys();m.sort(SBGrid.DEF.numberASC);for(var n=0;n<m.length;n++){var t=parseInt(m[n]-g);if(n!=0){d+="\t"}var c=this.getColType(t);var e="";if(c=="combo"){e=this.labelMatrix(v,t+g).replaceAll("\n","")}else{e=this.getTextMatrix(v,t+g).replaceAll("\n","")}if(e=="undefined"||e==undefined){e=""}d+=e;t=null}v=h=m=null}}p=l=null;break;case SBGrid.DEF.SBSM_NONE:return;default:var l=SBGrid.DEF.__deepCopy(this.m_arSelectRows).sort(SBGrid.DEF.numberASC);if(l.length>0){s=l[0];b=l[l.length-1];r=this.fixedCols;u=this.cols-1;for(var q=s;q<=b;q++){if(q!=s){d+="\n"}for(var n=r;n<=u;n++){if(n!=r){d+="\t"}var c=this.getColType(n);if(c=="combo"){d+=this.labelMatrix(q,n).replaceAll("\n","")}else{d+=this.getTextMatrix(q,n).replaceAll("\n","")}}}}else{l=null;return}l=null;break}if(window.clipboardData){window.clipboardData.setData("text",d)}else{var a=document.createElement("div");a.setAttribute("id","SBHE_ClipboardDataDiv");var f=document.createElement("textarea");f.style.height=f.style.width="0px";f.value=d;a.appendChild(f);document.body.appendChild(a);f.focus();f.select();window.setTimeout(function(){document.body.removeChild(document.getElementById("SBHE_ClipboardDataDiv"))},100);a=f=null}}};SBGrid.CT.DataGrid.prototype.onPaste=function(f){if(this.m_bIsAllowPaste&&window.clipboardData){var b=window.clipboardData.getData("text").split("\n");if(!(b instanceof Array)){return}var e=this.row;var a=this.col;if(e<this.fixedRows||e>=this.rows){return}if(a<this.fixedCols||a>=this.cols){return}for(var d=0;d<b.length;d++){var g=b[d].split("\t");if(d==b.length-1&&g==""){return}for(var c=0;c<g.length;c++){this.setTextMatrix(e+d,a+c,g[c])}}}};SBGrid.CT.DataGrid.prototype.funcMovePageUp=function(c){var a;if(!SBGrid.DEF.is_ie&&!SBGrid.DEF.is_opera){var d=this.m_heWhole;a=Math.round((d.offsetHeight/8)*7);var e=d.scrollTop;if(0<e-a){d.scrollTop=e-a}else{d.scrollTop=0}}if("true"==this.attribute.pageselection){if(null==a){a=Math.round((this.m_heWhole.offsetHeight/8)*7)}var b=this.row;while(a>0){b--;a-=null!=this.m_htRowHeight[b]?this.m_htRowHeight[b]:this.dataHeight}b=b<=this.fixedRows?this.fixedRows:b;this.setRow(b)}};SBGrid.CT.DataGrid.prototype.funcMovePageDown=function(c){if(!SBGrid.DEF.is_ie&&!SBGrid.DEF.is_opera){var d=this.m_heWhole;var a=Math.round((d.offsetHeight/8)*7);var e=d.scrollTop;d.scrollTop=e+a}if("true"==this.attribute.pageselection){if(null==a){a=Math.round((this.m_heWhole.offsetHeight/8)*7)}var b=this.row;while(a>0){b++;a-=null!=this.m_htRowHeight[b]?this.m_htRowHeight[b]:this.dataHeight}b=b>=(this.m_nRealRows-1)?(this.m_nRealRows-1):b;this.setRow(b)}};SBGrid.CT.DataGrid.prototype.onRowChanged=function(a){if(this._isShowCombo()){this.setComboHidden(false)}};SBGrid.CT.DataGrid.prototype.onbeforeNext=function(b){var a=this.getNextElementId();if(a!=""){var c=document.getElementById(a);if(c){if(this.row==this.rows-1&&this.col==this.cols-1&&b.keyCode==SBGrid.EVT.TAB){c.focus()}}}};SBGrid.CT.DataGrid.prototype.onbeforePrevious=function(a){};SBGrid.CT.DataGrid.prototype.onNext=function(a){this.stopEditing();this.dispatch("onbeforenext");var d=this.getRow();var g=this.getCol();var h=this.rows-1;var f=this.cols-1;var i=d;var b=g;var e=this.getMoveCell(d,g,SBGrid.DEF.SBKE_NEXT);d=e.m_nY;g=e.m_nX;if(d<this.fixedRows){return}this.dispatch("SBUx_next");this.setRowValue(d);this.setColValue(g);this.clearSelection();this.selectCells(d,g,d,g);if(i!=d){this.dispatch("onrowchanged")}if(b!=g){this.dispatch("oncolchanged")}if(d==i&&g==b){return}var c=this.getCellEx(d,g);if(null!=c){SBGrid.DEF.setFocus(c.id);this.setComboHidden(true);this.dispatch("onentercell");this.setEditCell(a);this.topScrollCellEx(this.getRow(),true)}};SBGrid.CT.DataGrid.prototype.onPrevious=function(a){this.stopEditing();this.dispatch("onbeforeprevious");var d=this.getRow();var g=this.getCol();var h=this.rows-1;var f=this.cols-1;var i=d;var b=g;var e=this.getMoveCell(d,g,SBGrid.DEF.SBKE_PREVIOUS);d=e.m_nY;g=e.m_nX;if(d<this.fixedRows){return}this.dispatch("SBUx_previous");this.setRowValue(d);this.setColValue(g);this.clearSelection();this.selectCells(d,g,d,g);if(i!=d){this.dispatch("onrowchanged")}if(b!=g){this.dispatch("oncolchanged")}var c=this.getCellEx(d,g);if(null!=c){SBGrid.DEF.setFocus(c.id);this.setComboHidden(true);this.dispatch("onentercell");this.setEditCell(a);this.topScrollCell(this.getRow(),true)}};SBGrid.CT.DataGrid.prototype.onSelectedCells=function(s){if(""!=this.m_strCellFocusColor&&this.getSelectionMode()!="free"){var x,o,c,a;for(var u=0;u<this.getSelectedCellsInfo().count();u++){x=this.getSelectedCellsInfo().keys();for(var q=0;q<this.getSelectedCellsInfo().find(x[u]).count();q++){o=this.getSelectedCellsInfo().find(x[u]).keys();c=parseInt(x[u]);a=parseInt(o[q]);var f=this.getCellEx(c,a);var d=f.m_heCtrl;if(null!=d){var w=jQuery(d);if(f.row!=this.row){if(w.hasClass("sbgrid_"+this.id+"_CellfocusColor")){w.removeClass("sbgrid_"+this.id+"_CellfocusColor").addClass("sbgrid_"+this.id+"_focusColor");w.addClass("sbgrid_"+this.id+"_focusColor")}}}}}}if(this.m_bIsCellsInfoDisplay==true){var g=this.m_bIsCellsInfoDiv;var e=jQuery("#SBHE_spanCells_"+this.id);var m="";e.text("");g.style.left=jQuery(this.m_heWhole).offset().left+"px";g.style.width=this.m_heWhole.clientWidth+"px";var x,o,c,a;var h=0;var b=0;var r=0;var t=0;var n=0;var l=parseInt(this.getSelectedCellsInfo().count());var p=true;for(var u=0;u<this.getSelectedCellsInfo().count();u++){x=this.getSelectedCellsInfo().keys();for(var q=0;q<this.getSelectedCellsInfo().find(x[u]).count();q++){o=this.getSelectedCellsInfo().find(x[u]).keys();c=parseInt(x[u]);a=parseInt(o[q]);var v=parseInt(this.getTextMatrix(c,a));if(!isNaN(v)){b+=v;if(p){t=v;n=v;p=false}t=t<v?v:t;n=n>v?v:n;r++}}}h=b/r;if(isNaN(h)){h=0}m=" 선택된 개수 "+(l*o.length)+" , ";m+=" 합계 "+b+" , ";m+=" 평균 "+h+" , ";m+=" 최대값 "+t+" , ";m+=" 최소값 "+n;e.text(m);g.style.visibility="visible";g.style.top=(parseInt(jQuery(this.m_heWhole).offset().top)+this.m_heWhole.offsetHeight)+2+"px";if(e.height()>25){g.style.height=e.height()+4+"px"}else{g.style.height="25px"}}};SBGrid.CT.DataGrid.prototype.getMouseColPosition=function(d){var a,b,e;a=this.m_heCtrl.getBoundingClientRect().left+jQuery(window).scrollLeft();e=d.clientX+jQuery(window).scrollLeft();b=this.m_heCtrl;for(var c=0;c<(this.fixedCols+this.frozenCols);c++){if(a<e&&(a+this.m_arColWidth[c])>e){return c}a+=this.m_arColWidth[c]}a-=this.m_heWhole.scrollLeft;for(var c=(this.fixedCols+this.frozenCols);c<this.cols;c++){if(a<e&&(a+this.m_arColWidth[c])>e){return c}a+=this.m_arColWidth[c]}return -1};SBGrid.CT.DataGrid.prototype.colMove=function(c,b,a,d){if(this.fixedCols>b){return}switch(a){case"after":if((c+1)==this.cols){break}c++;case"before":default:break}if(this.fixedCols>c){return}this.moveColumn(b,c);d=null==d?true:d;if(d){this.refresh()}};SBGrid.CT.DataGrid.prototype.moveColumn=function(F,d){if(F==d){return}this.deleteMultiSortShowIcon();this.clearSelection();this.clearMerge();var y=this.m_arColumn[F];var e=new Array();var w=this.fixedCols+this.frozenCols;if((w<=F&&w<=d)||(w>F&&w>d)){var c;var B=false;if(F<d){c=d+1;if(this.cols==c||((w>F&&w>d)&&w==c)){B=true;c=d}}else{c=d}for(var O=0;O<this.m_nRealRows;O++){var n=this.getCellEx(O,F);var x=this.getCellEx(O,c);if(null!=n&&null!=x){e.push(n);var z=x.m_heCtrl;if(z==null){SBGrid.CF.GridInit(x);z=n.m_heCtrl}if(n.m_heCtrl==null){SBGrid.CF.GridInit(n)}if(null!=z){if(SBGrid.DEF.is_firefox){z=z.parentNode}else{z=z.parentElement}if(B){z.appendChild(n.m_heCtrl)}else{z.insertBefore(n.m_heCtrl,x.m_heCtrl)}}}}}else{if(w<=F&&w>d){for(var O=0;O<this.m_nRealRows;O++){var n=this.getCellEx(O,F);var x=this.getCellEx(O,d);var P=this.getCellEx(O,(w-1));var H=this.getCellEx(O,w);if(null!=n&&null!=x&&null!=P&&null!=H){e.push(n);var J=P.m_heCtrl;if(J==null){SBGrid.CF.GridInit(P);J=P.m_heCtrl}if(H.m_heCtrl==null){SBGrid.CF.GridInit(H)}if(null!=J){if(SBGrid.DEF.is_firefox){J=J.parentNode}else{J=J.parentElement}var z=H.m_heCtrl;if(SBGrid.DEF.is_firefox){z=z.parentNode}else{z=z.parentElement}J.insertBefore(n.m_heCtrl,x.m_heCtrl);if(n==H){H=this.getCellEx(O,(w+1));if(null!=H){z.insertBefore(P.m_heCtrl,H.m_heCtrl)}else{z.appendChild(P.m_heCtrl)}}else{z.insertBefore(P.m_heCtrl,H.m_heCtrl)}}}}}else{var c;var B=false;c=d+1;if(this.cols==c){B=true;c=d}for(var O=0;O<this.m_nRealRows;O++){var n=this.getCellEx(O,F);var x=this.getCellEx(O,c);var H=this.getCellEx(O,w);if(null!=n&&null!=x&&null!=H){e.push(n);var J=n.m_heCtrl;if(J==null){SBGrid.CF.GridInit(n);J=n.m_heCtrl}if(n.m_heCtrl==null){SBGrid.CF.GridInit(n)}if(null!=J){if(SBGrid.DEF.is_firefox){J=J.parentNode}else{J=J.parentElement}var z=H.m_heCtrl;if(SBGrid.DEF.is_firefox){z=z.parentNode}else{z=z.parentElement}J.appendChild(H.m_heCtrl);if(B){z.appendChild(n.m_heCtrl)}else{z.insertBefore(n.m_heCtrl,x.m_heCtrl)}}}}}}if(F>d){for(var O=(F-1);O>=d;O--){for(var M=0;M<this.m_nRealRows;M++){var s=this.getCellEx(M,O);if(null!=s){var q=this.id+"_"+M+"_"+(O+1);s.col=O+1;s.id=q;s.attribute.id=q;if(s.m_heCtrl){var m=s.m_heCtrl;m.id="SBHE_"+q;m.setAttribute("cellId",this.id+"."+M+"."+(O+1));m.setAttribute("colNum",this.id+"_"+(O+1));if(this.isFrozenCell(M,(O+1))){m.setAttribute("frozencell","true")}else{m.setAttribute("frozencell","false")}m=null}if(s.m_heDCtrl){s.m_heDCtrl.id=q+"_data"}this.children.add(q,s);SBGrid.DEF.__appendAll(q,s)}}}}else{for(var O=(F+1);O<=d;O++){for(var M=0;M<this.m_nRealRows;M++){var s=this.getCellEx(M,O);if(null!=s){var q=this.id+"_"+M+"_"+(O-1);s.col=O-1;s.id=q;s.attribute.id=q;if(s.m_heCtrl){var m=s.m_heCtrl;m.id="SBHE_"+q;m.setAttribute("cellId",this.id+"."+M+"."+(O-1));m.setAttribute("colNum",this.id+"_"+(O-1));if(this.isFrozenCell(M,(O-1))){m.setAttribute("frozencell","true")}else{m.setAttribute("frozencell","false")}m=null}if(s.m_heDCtrl){s.m_heDCtrl.id=q+"_data"}this.children.add(q,s);SBGrid.DEF.__appendAll(q,s)}}}}for(var M=0;M<this.m_nRealRows;M++){var s=e[M];if(null!=s){var q=this.id+"_"+M+"_"+d;s.col=d;s.id=q;s.attribute.id=q;if(s.m_heCtrl){var m=s.m_heCtrl;m.id="SBHE_"+q;m.setAttribute("cellId",this.id+"."+M+"."+d);m.setAttribute("colNum",this.id+"_"+d);if(this.isFrozenCell(M,d)){m.setAttribute("frozencell","true")}else{m.setAttribute("frozencell","false")}m=null}if(s.m_heDCtrl){s.m_heDCtrl.id=q+"_data"}this.children.add(q,s);SBGrid.DEF.__appendAll(q,s)}}if(this.m_bIsRealDataSync==false&&this.m_bIsSort){var f=null;if(this.isJsonRef()){for(var O=0;O<this.m_arSortJson.length;O++){f=this.m_arSortJson[O][F];this.m_arSortJson[O].splice(F,1);this.m_arSortJson[O].splice(d,0,f)}}else{for(var O=0;O<this.m_arSortNodeList.length;O++){f=this.m_arSortNodeList[O][F];this.m_arSortNodeList[O].splice(F,1);this.m_arSortNodeList[O].splice(d,0,f)}}f=null}this.m_arColumn.splice(F,1);this.m_arColumn.splice(d,0,y);var u=this.m_arColWidth[F];this.m_arColWidth.splice(F,1);this.m_arColWidth.splice(d,0,u);u=this.m_arHiddenCol[F];this.m_arHiddenCol.splice(F,1);this.m_arHiddenCol.splice(d,0,u);for(var h=0;h<this.m_arCaption.length;h++){u=this.m_arCaption[h][F];this.m_arCaption[h].splice(F,1);this.m_arCaption[h].splice(d,0,u)}this.caption=this.getCurrentCaption();this.attribute.caption=this.getCurrentCaption();var v=this.children.getCollection();for(var a in v){var C=v[a];if(null!=C){SBGrid.CF.GridInit(C)}}v=null;var A=this.m_objScroll;for(var O=A.nTopRow,h=0,t=A.nBottomRow;O<=t;O++){for(var M=0;M<this.cols;M++){var s=this.getCellEx(A.arTargetRow[O],M);if(null!=s){if(this.m_arTempMatrix){if(s.m_heCtrl==null){SBGrid.CF.GridInit(s)}this.m_arTempMatrix[h].data[M]={first:s.m_heCtrl,last:s.m_heDCtrl}}}}h++}A=null;if(this.isSortable()){if(this.m_bUseMultiSorting){var K=this.m_clMultiSortingHistory.keys();var D=new SBGrid.DS.Collection();for(var O=0;O<K.length;O++){var I=K[O];if(F==I){D.add(I,d)}else{if(F<I){if(d>=I){D.add(I,I-1)}}else{if(F>I){if(d<=I){D.add(I,I+1)}}}}}var Q=new SBGrid.DS.Collection();for(var O=0;O<K.length;O++){var I=K[O];var E=D.item(I.toString());if(E==undefined){Q.add(I,SBGrid.DEF.__deepCopy(this.m_clMultiSortingHistory.item(I.toString())))}else{var r=this.m_clMultiSortingHistory.item(I.toString());r[0][1]=E;Q.add(E,SBGrid.DEF.__deepCopy(r));r=null}I=E=null}this.m_clMultiSortingHistory.clear();D.clear();this.m_clMultiSortingHistory=SBGrid.DEF.__deepCopy(Q);Q.clear();D=K=Q=null}else{if(this.m_objSortIcon){if(F==this.m_objSortIcon.nSortedCol){this.m_objSortIcon.nSortedCol=d}if(F<this.m_objSortIcon.nSortedCol){if(d>=this.m_objSortIcon.nSortedCol){this.m_objSortIcon.nSortedCol-=1}}else{if(F>this.m_objSortIcon.nSortedCol){if(d<=this.m_objSortIcon.nSortedCol){this.m_objSortIcon.nSortedCol+=1}}}}}}mapGridStyleInfoTemp=new SBGrid.DS.Map();var b=this.m_mapGridStyleInfo.keys();for(var O=0,o=b.length;O<o;O++){var p=this.m_mapGridStyleInfo.find(b[O]);var g=p.keys();var G=new SBGrid.DS.Map();for(var M=0,l=g.length;M<l;M++){var N=parseInt(g[M]);var L=SBGrid.DEF.__deepCopy(p.find(g[M]));if(F==N){G.add(d,L)}else{if(F<N){if(d>=N){G.add(N-1,L)}else{G.add(N,L)}}else{if(F>N){if(d<=N){G.add(N+1,L)}else{G.add(N,L)}}}}}mapGridStyleInfoTemp.add(b[O],G)}if(this.m_objScroll.bScrollEvent){this.rebuildStyle()}this.m_mapGridStyleInfo.clear();this.m_mapGridStyleInfo=mapGridStyleInfoTemp;this.defaultAttributeSetting();for(var O=0;O<this.cols;O++){this.setColWidth(O,this.m_arHiddenCol[O])}if(this.autoMerge){this.merge()}};SBGrid.CT.DataGrid.prototype.onCapture=function(a){SBGrid.CT.Group.prototype.onCapture.call(this,a);var i=new SBGrid.DS.Point(a.clientX,a.clientY);var c=-1;var f=-1;if(this.m_bClearCaption){a.capture="";this.m_bClearCaption=false}else{if("onmouseup"==a.name){this.m_bMouseDrag=false;this.m_bLButtonDown=false;a.capture="";var d=this.getCellEx(this.m_nDownRow,this.m_nDownCol);if(null!=d){d.down=false}if(this.isResizing()){if(SBGrid.DEF.bIsResizeFlg){this.hideGuideLine();this.resizeCell(a);this.autoResizeHeight();this.restoreCursor();this.dispatch("onafteruserresize")}}else{if(this.isMoveColumn(true)){this.hideGuideColumn();var o=this.getMouseColPosition(a);if(this.m_nDownCol!=o&&-1!=o){if(this.m_nDownCol>=this.fixedCols&&o>=this.fixedCols&&this.m_bIsCaptionDrag){this.mouseCol=o;this.moveColumn(this.m_nDownCol,o);this.dispatch("onaftermovecolumn");var e=document.getElementById("fixedCheckbox_"+this.id+"_"+this.m_nDownCol);if(e!=null){e.id="fixedCheckbox_"+this.id+"_"+this.mouseCol}}}this.m_bIsFirstMoveColumn=false}else{this.m_nOldX=-1;this.m_nOldY=-1}}this.m_bDown=false;this.m_bIsCaptionDrag=false}else{if("onmousemove"==a.name){this.m_bCapturing=true;if(this.isMoveColumn()){if(this.m_bIsFirstMoveColumn){var o=this.getMouseColPosition(a);if(this.id==a.capture&&this.m_nDownCol!=o&&this.fixedCols<=o){this.dispatch("onbeforemovecolumn");this.m_bIsFirstMoveColumn=false}}this.drawMoveLine(a);this.m_bIsCaptionDrag=true}else{if(this.isResizing()){this.drawGuideLine(a);if(this.m_bAfterResize){this.m_bAfterResize=false;this.dispatch("onbeforeuserresize");SBGrid.DEF.bIsAfterMouseUpFlg=false}}else{if(this.m_bDown&&null!=a.ctrlKey&&null!=a.shiftKey){var m=this.getControlRect();if(this.isFixedCell(this.m_nDownRow,this.m_nDownCol)){return}if(!this.getAllowSelection()){var h=this.getRowHeader()>0?1:0;if(this.getMouseRow()>0&&(this.getMouseCol()-h)>=0){var g=this.getMouseRow();var l=this.getMouseCol();var n=this.getRow();var b=this.getCol();var d=this.getCellEx(g,l);if(null!=d){this.clearSelection();this.selectCells(g,l,g,l);this.setRowValue(g);this.setColValue(l);if("h-resize"!=this.getAttribute("cursor")&&"v-resize"!=this.getAttribute("cursor")){if(n!=this.m_nDownRow){this.dispatch("onrowchanged")}if(b!=this.m_nDownCol){this.dispatch("oncolchanged")}}this.dispatch("onentercell");SBGrid.DEF.setFocus(d.getId())}}return}this.onMouseDrag(a)}else{if(this.m_bMouseDrag){this.onMouseDrag(a)}}}}if(this.isResizing()||this.isMoveColumn()){a.defaultAction="cancel";a.propagate="stop"}}}}};SBGrid.CT.DataGrid.prototype.onMouseDrag=function(e){if(this.getAttribute("dragmode")==""||this.getAttribute("dragmode")=="false"){return}var h,a,d,f,g,c;d=this.getControlRect();if((this.fixedRows+this.frozenRows)>0||this.fixedCols+this.frozenCols>0){d.m_nX=d.getX()+this.getFixedFrozenColWidth();d.m_nY=d.getY()+this.getFixedFrozenRowHeight()}if(this.frozenBottomRows>0){for(var b=this.m_nRealRows-1;b>=(this.m_nRealRows-this.frozenBottomRows);b--){d.m_nBottom-=this.m_htRowHeight[b]}}h=this.getRow();a=this.getCol();f=(h>=this.fixedRows&&h<this.fixedRows+this.frozenRows)?true:false;c=(h>=this.m_nRealRows-this.frozenBottomRows&&h<this.m_nRealRows)?true:false;g=(a>=this.fixedCols&&a<this.fixedCols+this.frozenCols)?true:false;if(!g&&e.clientX>d.m_nRight){if(this._isHScroll()){this.dispatch("onscrolldown")}}if(!g&&e.clientX<d.m_nX){if(this._isHScroll()){this.dispatch("onscrollup")}}if(!f&&!c&&e.clientY>d.m_nBottom-13){this.m_bMouseDrag=true;if(this._isVScroll()){if(this.m_nMouseDragRow>=this.getMouseRow()){this.m_nMouseDragRow++}if(this.m_nMouseDragRow<this.m_nRealRows){this.topScrollCell(this.m_nMouseDragRow,true)}else{this.m_nMouseDragRow--}this.dispatch("onscrolldown")}else{this.m_nMouseDragRow=this.getMouseRow()}}else{if(!f&&!c&&e.clientY<d.m_nY){this.m_bMouseDrag=true;if(this._isVScroll()){if(this.getMouseRow()<this.fixedRows){this.m_nMouseDragRow--;this.topScrollCell(this.m_nMouseDragRow,true)}else{this.m_nMouseDragRow=this.getMouseRow()}this.dispatch("onscrollup")}else{if(this.getMouseRow()<this.fixedRows){this.m_nMouseDragRow--;this.topScrollCell(this.m_nMouseDragRow,true)}else{this.m_nMouseDragRow=this.getMouseRow()}}}else{if(this.getMouseRow()>=this.fixedRows){this.m_nMouseDragRow=this.getMouseRow()}}}if(!this.m_bIsShowItem){this.multiSelectCells(this.m_nDownRow,this.m_nDownCol,this.m_nMouseDragRow,this.getMouseCol(),f,c,g)}};SBGrid.CT.DataGrid.prototype.onFocus=function(a){SBGrid.CT.Group.prototype.onFocus.call(this,a)};SBGrid.CT.DataGrid.prototype.onBlur=function(a){SBGrid.CT.Group.prototype.onBlur.call(this,a);if(this.isEditing()&&(a.target==this.m_objInput.getId()||a.target==this.m_objTextArea.getId())){this.setCellEditText()}if(!this.isDescendants(a.target,true)&&!this.isCell(a.target)){this.m_nDownRow=-1;this.m_nDownCol=-1}if(this.id==a.currentTarget&&-1==a.down.indexOf("combo")){this.setComboHidden(false)}this.setConTextVisible(false)};SBGrid.CT.DataGrid.prototype._isShowCombo=function(){for(var b=0;b<this.m_arCombo.length;b++){var a=this.m_arCombo[b];if(true==a.visible){return true}}return false};SBGrid.CT.DataGrid.prototype.setComboHidden=function(a){if(a){if(this.isFixedCell(this.row,this.col)){return}var g=this.getCellEx(this.row,this.col);if(null!=g){var h=this.getColumnControl(this.col);if(h){h.dispatch("onfocus");if(h.getInputType()==SBGrid.DEF.SBIT_COMBO){if(h.m_objCombo.isnodeset){var d=g.getAttribute("nodeset");var f=g.getAttribute("jsonnodeset");if(null!=d){h.m_objCombo.nodeset=d;h.m_objCombo.refresh()}else{if(null!=f){h.m_objCombo.jsonnodeset=f;h.m_objCombo.refresh()}else{if(null!=h.m_strComboNodeSet&&h.m_strComboNodeSet!=h.m_objCombo.nodeset){h.m_objCombo.nodeset=h.m_strComboNodeSet;h.m_objCombo.refresh()}}}}var c=this.getCellContentRect(this.row,this.col);h.m_objCombo.setHeControlGridPosition(g,c);if(!h.disabled&&!g.getIsReadOnly()){this.m_bIsShowCombo=true;h.m_objCombo.setVisible(true);h.m_objCombo.dispatch("onfocus")}var b=null;if(g.m_heCtrl==null){return}for(var e=0;e<g.m_heCtrl.childNodes.length;e++){b=g.m_heCtrl.childNodes.item(e);if("DIV"==b.tagName){b.style.width="98%";b.style.overflow="hidden"}}}}h=null}}else{for(var e=0;e<this.m_arColumn.length;e++){var h=this.m_arColumn[e];if(SBGrid.DEF.SBIT_COMBO==h.m_nInputType){h.m_objCombo.setVisible(false)}h=null}this.m_bIsShowCombo=false}};SBGrid.CT.DataGrid.prototype.onBeforeEdit=function(d){var b=this.getRow();var e=this.getCol();if(b<0&&e<0){return}var a=this.getCellEx(b,e);if(null!=a){if(this.isNormalCell(b,e)){var c=this.getColumnControl(e);if(null!=c&&c.onBeforeEdit()){this.m_nEditRow=b;this.m_nEditCol=e;this.dispatch("onstartedit")}}}};SBGrid.CT.DataGrid.prototype.onAfterEdit=function(){var c=this.getEditRow();var e=this.getEditCol();if(c<0&&e<0){return}var b=this.getCellEx(c,e);if(null!=b){if(this.isNormalCell(c,e)){this.m_bEditing=false;if(null!=this.m_objInput){this.m_objInput.setVisible(false)}if(null!=this.m_objTextArea){var a=this.getCellContentRect(c,e);this.m_objTextArea.setVisible(false);a.setHeight(this.dataHeight);this.m_objTextArea.setPosition(a)}var d=this.m_arColumn[e];if(null!=d&&"true"==d.getAttribute("#update-text")){this.m_objUpdate.setUpdateFlag(SBGrid.DEF.SBCH_TEXT);this.m_objUpdate.setModifyRow(c);this.m_objUpdate.setModifyCol(e);this.m_objUpdate.setModifyText(d.getText());this.onCellChanged();this.refreshCurrentModel(d.attribute.ref)}if(this.m_bUseWebAccess==true||SBGrid.DEF.is_chrome){this.m_heCtrl.focus();SBGrid.DEF.setFocus(b.getId())}this.m_nEditRow=-1;this.m_nEditCol=-1}}};SBGrid.CT.DataGrid.prototype.onCellChanged=function(){var b=this.m_objUpdate.getUpdateFlag();var a=this.m_objUpdate.getModifyRow();var c=this.m_objUpdate.getModifyCol();if(b&SBGrid.DEF.SBCH_TEXT){if(this.getColStatus(this.m_objUpdate.getModifyCol())){this.setRowStatus(a,this.getRowStatus(a)|SBGrid.DEF.SBGS_UPDATE)}this.m_bModify=true}else{if(b&SBGrid.DEF.SBCH_ROWINS){this.setRowStatus(a,this.getRowStatus(a)|SBGrid.DEF.SBGS_INSERT);this.m_bModify=true}else{if(b&SBGrid.DEF.SBCH_ROWDEL){this.m_bModify=true}}}};SBGrid.CT.DataGrid.prototype.topScrollCell=function(d,c){var g=this.m_objScroll;var f=0;var a=0;if(this.isFrozenRow(d)){return}if(this.m_bMouseDown){return}if(g.nStartRow<=d){for(var b=g.nStartRow;b<d;b++){f+=this.m_arHiddenRowState[b]?0:null!=this.m_htRowHeight[b]?this.m_htRowHeight[b]:this.dataHeight}if(f<this.m_heWhole.scrollTop){this.m_heWhole.scrollTop=f;return}f+=this.m_arHiddenRowState[d]?0:null!=this.m_htRowHeight[d]?this.m_htRowHeight[d]:this.dataHeight;for(var b=0;b<(this.fixedRows+this.frozenRows);b++){a+=this.m_arHiddenRowState[d]?0:null!=this.m_htRowHeight[b]?this.m_htRowHeight[b]:this.dataHeight}for(var b=(this.m_nRealRows-this.m_nBottomRowCount);b<this.m_nRealRows;b++){a+=this.m_arHiddenRowState[d]?0:null!=this.m_htRowHeight[b]?this.m_htRowHeight[b]:this.dataHeight}var e=(this.m_heWhole.scrollTop+g.nScrollDivHeight-a);if(f>e){if(!c){g.nPosition+=(f-e)}this.m_heWhole.scrollTop+=(f-e)}}};SBGrid.CT.DataGrid.prototype.topScrollCellEx=function(c,d){var l=this.m_objScroll;var h=this.getFixedFrozenRowHeight();if(this.isFrozenRow(c)){return}if(this.m_bMouseDown){return}if(l.nStartRow<=c){for(var e=l.nStartRow;e<c;e++){h+=this.m_arHiddenRowState[e]?0:null!=this.m_htRowHeight[e]?this.m_htRowHeight[e]:this.dataHeight}if(h<this.m_heWhole.scrollTop){this.m_heWhole.scrollTop=h;return}var b,f,g;if(this.m_nBottomRowCount>0){b=this.m_nRealRows-this.m_nBottomRowCount;f=this.getCellContentRect(b,this.fixedCols+this.frozenCols).getY()}if(c>=0){g=this.getCellContentRect(c,this.fixedCols+this.frozenCols).getBottom()}var a=this.m_nBottomRowCount<1?this.m_heWhole.clientHeight:f;if(a<g){if(!d){l.nPosition+=g-a}this.m_heWhole.scrollTop+=g-a}}l=h=b=f=g=a=null};SBGrid.CT.DataGrid.prototype.setComboFiltering=function(d,c){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setComboFiltering","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof d!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setComboFiltering","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(!(c instanceof Array)){SBGrid.DEF.APIerrorMsg(this.id+".setComboFiltering","Please check if second parameter's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}var a=this.getCellEx(this.fixedRows,d);if(null!=a){var b=a.getElement();if(b.getInputType()==SBGrid.DEF.SBIT_COMBO){b.m_objCombo.m_bIsComboFiltering=true;b.m_objCombo.m_arrComboFilteringInfoList=c}}};SBGrid.CT.DataGrid.prototype.getIsComboFiltering=function(c){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".getIsComboFiltering","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return false}var a=this.getCellEx(this.fixedRows,c);if(null!=a){var b=a.getElement();if(b.getInputType()==SBGrid.DEF.SBIT_COMBO){return b.m_objCombo.m_bIsComboFiltering}}return false};SBGrid.CT.DataGrid.prototype.initComboFiltering=function(h){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".initComboFiltering","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return false}if(this.getIsComboFiltering(h)){for(var f=this.fixedRows,e=this.rows;f<e;f++){var d=this.getCellEx(f,h);if(d!=null){var g=d.getElement();if(g.getInputType()==SBGrid.DEF.SBIT_COMBO){g.m_objCombo.showItemList(false);g.m_objCombo.m_bIsComboFiltering=false;g.m_objCombo.m_arrComboFilteringInfoList=new Array();g.m_objCombo.m_arrFilteringHiddenIndexList=new Array();var c=g.m_objCombo.itemLength;for(var b=0;b<c;b++){var a="SBHE_"+g.m_objCombo.id+"_"+b.toString()+"_0";jQuery("#"+a).parent().show()}c=null}}}return true}return false};SBGrid.CT.DataGrid.prototype.onEnterCell=function(event){var nRow=this.getRow();var nCol=this.getCol();var objCell=this.getCellEx(nRow,nCol);if(null!=objCell){if(0==event.keyCode){this.topScrollCell(nRow,false)}var objCol=objCell.getElement();if(objCol.getInputType()==SBGrid.DEF.SBIT_COMBO){if(this.getIsComboFiltering(nCol)){var arrComboFilteringInfoList=objCol.m_objCombo.m_arrComboFilteringInfoList;var nItemLength=objCol.m_objCombo.itemLength;var arrFilteringHiddenIndexList=new Array();for(var i=0;i<nItemLength;i++){var bIsVisible=false;for(var j=0,nArrLength=arrComboFilteringInfoList.length;j<nArrLength;j++){var objArrItem=arrComboFilteringInfoList[j];var strAttrValue=eval(objCol.m_objCombo.jsonnodeset+"["+i.toString()+"]."+objArrItem.strAttrName);if(strAttrValue==objArrItem.strAttrValue){break}else{arrFilteringHiddenIndexList.sort(SBGrid.DEF.numberASC);if(SBGrid.DEF.arrBinarySearch(i,arrFilteringHiddenIndexList)==-1){arrFilteringHiddenIndexList.push(i)}}objArrItem=strAttrValue=null}strComboItemID=null}objCol.m_objCombo.m_arrFilteringHiddenIndexList=arrFilteringHiddenIndexList;arrComboFilteringInfoList=arrFilteringHiddenIndexList=nItemLength=null}}return}if(this.isNormalCell(nRow,nCol)){var objCol=this.getColumnControl(nCol);objCol.onEnterCell();objCol=null}nRow=nCol=objCell=null};SBGrid.CT.DataGrid.prototype.onLeaveCell=function(a){};SBGrid.CT.DataGrid.prototype.onStartEdit=function(d){var b=this.getEditRow();var e=this.getEditCol();var a=this.getCellEx(b,e);if(null!=a&&!a.getIsReadOnly()&&this.isNormalCell(b,e)){var c=this.getColumnControl(e);if(null!=c&&!c.disabled&&c.onStartEdit()){this.m_bEditing=true;a.setEditingMode(true)}}};SBGrid.CT.DataGrid.prototype.setCellHide=function(e,g,a,f){if(arguments.length<3){SBGrid.DEF.APIerrorMsg(this.id+".setCellHide","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof e!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setCellHide","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof g!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setCellHide","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setCellHide","Please check if third parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}if(f==undefined){f=true}else{if((typeof f)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setCellHide","Please check if 4th parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}var d=this.getCellEx(e,g);if(null!=d){d.setHidden(a);if(f&&(e>=this.m_objScroll.nTopRow&&e<=this.m_objScroll.nBottomRow)){var c;var b=this.m_replaceString;if(b!=""&&b!="undefined"&&b!=null){c=b.split("?")}SBGrid.CF.GridSetTextRefresh(d,SBGrid.CF.GridGetText(d),c,this.m_bIsDataReplaceValueChanged)}}};SBGrid.CT.DataGrid.prototype.getCellHide=function(b,c){if(arguments.length!=2){SBGrid.DEF.APIerrorMsg(this.id+".getCellHide","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getCellHide","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getCellHide","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}var a=this.getCellEx(b,c);if(a!=null){return a.getHidden()}};SBGrid.CT.DataGrid.prototype.setCellsReadOnly=function(f,a,d,g,b){if(arguments.length!=5){SBGrid.DEF.APIerrorMsg(this.id+".setCellsReadOnly","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof f!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setCellsReadOnly","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setCellsReadOnly","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof d!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setCellsReadOnly","Please check if third  parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof g!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setCellsReadOnly","Please check if forth  parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setCellsReadOnly","Please check if fifth parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}for(var e=f;e<=d;e++){for(var c=a;c<=g;c++){this.setCellReadOnly(e,c,b)}}};SBGrid.CT.DataGrid.prototype.getCellReadOnly=function(b,c){if(arguments.length!=2){SBGrid.DEF.APIerrorMsg(this.id+".getCellReadOnly","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getCellReadOnly","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getCellReadOnly","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}var a=this.getCellEx(b,c);if(a!=null){return a.getIsReadOnly()}};SBGrid.CT.DataGrid.prototype.setCellReadOnly=function(c,d,a){if(arguments.length!=3){SBGrid.DEF.APIerrorMsg(this.id+".setCellReadOnly","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setCellReadOnly","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof d!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setCellReadOnly","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setCellReadOnly","Please check if third parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}var b=this.getCellEx(c,d);if(b!=null){b.isReadOnly=a}};SBGrid.CT.DataGrid.prototype.getRowDisabled=function(c){var d=this.m_bRowHeader?1:0;for(var a=d,b=this.getCols();a<b;a++){if(!this.getCellDisabled(c,a)){return false}}return true};SBGrid.CT.DataGrid.prototype.setRowDisabled=function(d,a){var e=this.m_bRowHeader?1:0;for(var b=e,c=this.getCols();b<c;b++){this.setCellDisabled(d,b,a)}};SBGrid.CT.DataGrid.prototype.getColDisabled=function(b){var a=this.m_arColumn[b];if(null!=a){return a.disabled}};SBGrid.CT.DataGrid.prototype.setColDisabled=function(c,a){var b=this.m_arColumn[c];if(null!=b){b.disabled=a}};SBGrid.CT.DataGrid.prototype.onBeforeMoveColumn=function(a){};SBGrid.CT.DataGrid.prototype.onAfterMoveColumn=function(a){};SBGrid.CT.DataGrid.prototype.onAfterUserResize=function(b){SBGrid.DEF.bIsResizeFlg=false;var a=this.m_bisHScrollFlag;if(!this.isHorizontalScroll()){this.m_bisHScrollFlag=false}else{this.m_bisHScrollFlag=true}if(a!=this.m_bisHScrollFlag){this.dispatch("onresize")}else{return}};SBGrid.CT.DataGrid.prototype.onBeforeUserResize=function(a){SBGrid.DEF.bIsResizeFlg=true;if(this.isHorizontalScroll()){this.m_bisHScrollFlag=true}else{this.m_bisHScrollFlag=false}};SBGrid.CT.DataGrid.prototype.drawMoveLine=function(d){var e=this.getMouseCol();var a=this.getMouseRow();if(this.getFixedRows()>1){a=0}var c=this.getCellEx(a,e);if(!c){return}var b=this.getCellContentRect(c.row,e);this.m_heMoveColumnBar.style.left=b.getX()+"px";this.m_heMoveColumnBar.style.width=b.getWidth()+"px";this.m_heMoveColumnBar.style.display="block"};SBGrid.CT.DataGrid.prototype.drawGuideLine=function(d){var b=this.getControlRect();if("h-resize"==this.getAttribute("cursor")){var c=d.clientX-b.getX();if(1>c){c=1}else{if(b.getWidth()-1<c){c=b.getWidth()-1}}this.m_heHGuideLine.style.left=c+"px";this.m_heHGuideLine.style.visibility="visible";this.m_resizeInfo.m_nCurX=c}else{if("v-resize"==this.getAttribute("cursor")){var a=d.clientY-b.getY();if(1>a){a=1}else{if(b.getHeight()-1<a){a=b.getHeight()-1}}this.m_heVGuideLine.style.top=a+"px";this.m_heVGuideLine.style.visibility="visible";this.m_resizeInfo.m_nCurY=a}}};SBGrid.CT.DataGrid.prototype.hideGuideColumn=function(){if(null!=this.m_heMoveColumnBar){this.m_heMoveColumnBar.style.display="none"}};SBGrid.CT.DataGrid.prototype.hideGuideLine=function(){if(null!=this.m_heHGuideLine){this.m_heHGuideLine.style.visibility="hidden"}if(null!=this.m_heVGuideLine){this.m_heVGuideLine.style.visibility="hidden"}};SBGrid.CT.DataGrid.prototype.resizeCell=function(n){var h=this.getCellEx(this.m_nDownRow,this.m_nDownCol);if(null!=h){var f;var t=this.m_nDownRow;var r=this.m_nDownCol;var o=0;var m=0;f=this.getCellRect(t,r);var c=this.getControlRect();var l=f.getX()-c.getX()+o;var i=f.getY()-c.getY()+m;var g=f.getWidth();var q=f.getHeight();if("h-resize"==this.getAttribute("cursor")){var b=Math.max(this.m_resizeInfo.m_nCurX-l,2);if(b>2){var p=this.colWidthMin;var s=this.colWidthMax;if(SBGrid.DEF.SBSM_MERGED==h.mergeType){if(1<h.m_nColSpan){r=r+h.m_nColSpan-1;var g=this.m_arColWidth[r]+(b-g);p=0==r&&this.m_bRowHeader?20:p;g=g<p?p:g;g=g>s?s:g;this.setColWidth(r,g)}else{p=0==r&&this.m_bRowHeader?20:p;b=b<p?p:b;b=b>s?s:b;this.setColWidth(r,b)}}else{p=0==r&&this.m_bRowHeader?20:p;b=b<p?p:b;b=b>s?s:b;this.setColWidth(r,b)}this.setExtendLastCol(this.extendLastCol)}}else{if("v-resize"==this.getAttribute("cursor")){var a=Math.max(this.m_resizeInfo.m_nCurY-i,19);if(a>this.rowHeightMin){var d=this.rowHeightMin;var e=this.rowHeightMax;if(SBGrid.DEF.SBSM_MERGED==h.mergeType){if(1<h.m_nRowSpan){t=t+h.m_nRowSpan-1;this.setRowHeight(t,this.m_htRowHeight[t]+(a-q))}else{a=b<d?d:a;a=b>e?e:a;this.setRowHeight(t,a)}}else{a=b<d?d:a;a=b>e?e:a;this.setRowHeight(t,a)}this.setMergeCellResize(t,(a-q))}}}this.gridSetTables()}};SBGrid.CT.DataGrid.prototype.setRowHeightMax=function(c){this.rowHeightMax=c;var b=false;for(var a=0;a<this.m_nRealRows;a++){if(null!=this.m_htRowHeight[a]&&c<this.m_htRowHeight[a]){if(a<this.fixedRows){this.setRowHeight(a,c,true);b=true}else{if(this.isPhysicalRow(a)){this.setRowHeight(a,c,true);b=true}else{this.m_htRowHeight[a]=c}}}else{if(null==this.m_htRowHeight[a]){this.m_htRowHeight[a]=c}}}if(b){this.rowHeightResize()}};SBGrid.CT.DataGrid.prototype.lockedUpHeight=function(a){if(!this.autoResize&&!a){var c=this.fixedRows;var d=this.m_nMakeIndex;for(var b=c;b<d;b++){this.setRowHeight(b,this.dataHeight,true)}}};SBGrid.CT.DataGrid.prototype.autoResizeHeight=function(g){if(!this.autoResize){return}if(this.m_bNotRunAutoResize){return}if(g){this.m_htRowHeight[g]=this.dataHeight}var f=true;var e=new Array();for(var d=0;d<this.cols;d++){if(null!=this.m_arColumn[d]){if(!this.m_arColumn[d].m_bHiddenState){if(this.m_arColumn[d].m_bSkipAutoResize){continue}for(var b=this.fixedRows;b<this.rows;b++){if(this.isPhysicalRow(b)){var c=this.getCellEx(b,d);if(c&&c.m_heDCtrl){if(f){this.m_htRowHeight[b]=this.dataHeight;e.push(b)}if(null!=c&&SBGrid.DEF.SBSM_HIDE!=c.mergeType){var a=c.m_heDCtrl;if(null!=a){var h=a.offsetHeight;if(this.m_htRowHeight[c.row]<h){this.m_htRowHeight[c.row]=h+4}}}}}}f=false}}}for(var d=0;d<e.length;d++){this.setRowHeight(e[d],this.m_htRowHeight[e[d]],true)}};SBGrid.CT.DataGrid.prototype.autoResizeCaptionWidth=function(){var a=this.fixedRows,f=this.cols;for(var e=0;e<f;e++){this.m_arColWidth[e]=20}for(var b=0;b<a;b++){for(var e=0;e<f;e++){var c=this.getCellEx(b,e);if(null!=c){if(c.m_heCtrl!=null){for(k=0;k<c.m_heCtrl.childNodes.length;k++){if("SPAN"==c.m_heCtrl.childNodes.item(k).tagName){var d=(c.m_heCtrl.childNodes.item(k).offsetWidth)+20;if(this.m_arColWidth[c.col]<d){this.m_arColWidth[c.col]=d}}}}}}}for(var e=0;e<f;e++){this.setColWidth(e,this.m_arColWidth[e])}};SBGrid.CT.DataGrid.prototype.getAutoSizeMouse=function(){return this.autoSizeMouse};SBGrid.CT.DataGrid.prototype.setAutoSizeMouse=function(a){this.autoSizeMouse=a};SBGrid.CT.DataGrid.prototype.autoResizeWidth=function(h){if(this.autoSizeMouse){var e=h-1;var f=h+1;if(this.autoResize){this.setAutoResize(false)}for(var c=(e+1);c<f;c++){this.m_arColWidth[c]=20}for(var c=(e+1);c<f;c++){for(var a=this.fixedRows;a<this.rows;a++){var b=this.getCellEx(a,c);if(null!=b){if(b.m_heCtrl!=null){if(this.getColType(h)=="inputdate"||this.getColType(h)=="inputbutton"||this.getColType(h)=="outputbutton"){if("DIV"==b.m_heDCtrl.tagName){var g=b.m_heDCtrl.getAttribute("id");var d=jQuery("#"+g).children().prop("offsetWidth")+25;if(this.m_arColWidth[b.col]<d){this.m_arColWidth[b.col]=d}}}else{for(k=0;k<b.m_heCtrl.childNodes.length;k++){if("DIV"==b.m_heCtrl.childNodes.item(k).tagName){var g=b.m_heCtrl.childNodes.item(k).getAttribute("id");var d=jQuery("#"+g).children().prop("offsetWidth")+10;console.log(jQuery("#"+g).children());if(this.m_arColWidth[b.col]<d){this.m_arColWidth[b.col]=d}}}}}}}}for(var c=(e+1);c<f;c++){this.setColWidth(c,this.m_arColWidth[c])}}};SBGrid.CT.DataGrid.prototype.colWidth=function(b){var a=0;if(null!=this.m_arColWidth[b]){a=this.m_arColWidth[b]}return a};SBGrid.CT.DataGrid.prototype.getColWidth=function(a){return this.colWidth(a)};SBGrid.CT.DataGrid.prototype.setColWidth=function(l,n,o){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setColWidth","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof l!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setColWidth","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof n!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setColWidth","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(o==null){o=false}if((0>l||this.cols<=l)){return}var f=this.m_arColumn[l];if(f.m_bHiddenState){this.m_arHiddenCol[l]=n;n=0}else{this.m_arHiddenCol[l]=n}var b=false;var a=null;if(!o){a=0==n?"none":"block";if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7||SBGrid.DEF.is_ie9){jQuery('col[colNum="'+this.id+"_"+l+'"]').css("display",a);if(SBGrid.DEF.is_ie8||SBGrid.DEF.is_ie9){jQuery('td[colNum="'+this.id+"_"+l+'"]').css("display",a)}}else{b=true}}this.m_arColWidth[l]=n;if(!o){this.setColGroupWidth(l,n);if(this.extendLastCol&&!this.m_objHeArea.bTotalHiddenCheck){this.setExtendLastCol(this.extendLastCol,true)}}var d=SBGrid.DEF.SBSM_COLHIDE;var p=a=="none"?true:false;if(0==n){for(var h=0;h<=this.m_objScroll.nBottomRow;h++){if(h<this.fixedRows||h>=this.m_objScroll.nTopRow){var g=this.getCellEx(h,l);if(null!=g){if(b){if(null!=g.m_heCtrl){var c=null!=g.m_heCtrl.lastChild&&null!=g.m_heCtrl.lastChild.tagName?g.m_heCtrl.lastChild:g.m_heCtrl;if(p){c.style.display=a}else{c.style.display=""}}}g.mergeType=d}}}}else{var e=SBGrid.DEF.SBSM_NORMAL;var m=SBGrid.DEF.SBSM_LOCK;for(var h=0;h<=this.m_objScroll.nBottomRow;h++){if(h<this.fixedRows||h>=this.m_objScroll.nTopRow){var g=this.getCellEx(h,l);if(null!=g){if(b){if(null!=g.m_heCtrl){var c=null!=g.m_heCtrl.lastChild&&null!=g.m_heCtrl.lastChild.tagName?g.m_heCtrl.lastChild:g.m_heCtrl;if(p){c.style.display=a}else{c.style.display=""}}}if(g.mergeType==d){if(f.m_bMerge){g.mergeType=e}else{g.mergeType=m}}}}}this.TableColumnReDraw(l);e=null;m=null}d=null;if(o){return}if(!this.m_objHeArea.bTotalHiddenCheck){this.gridSetTables()}};SBGrid.CT.DataGrid.prototype.gridSetTables=function(){var h=this.fixedCols+this.frozenCols;var d=this.fixedRows+this.frozenRows;var e=this._getTotalColWidth();var l=this.getFixedFrozenColWidth();if(this.m_strStyle.indexOf("%")>-1){if(SBGrid.DEF.is_chrome||SBGrid.DEF.is_ie7){l+=1}}if(this.m_bIsUsePercentOfColWidth){if(SBGrid.DEF.is_chrome||SBGrid.DEF.is_ie7){l+=1}}var q=this.m_heWhole.firstChild;e=0>=e?"":e+"px";q.width=e;q.style.width="";var n=q.lastChild;var o;var i;var g;var r;var p;var m;var c;if(null!=this.m_heFFS){o=this.m_heFFS.firstChild;o.width=e;o.style.width="";i=o.lastChild;if(SBGrid.DEF.is_ie7){this.m_heFFNS.style.width=(this.getFixedFrozenColWidth()+this.fixedCols)+"px"}else{this.m_heFFNS.style.width=(this.getFixedFrozenColWidth()+1)+"px"}g=this.m_heFFNS.firstChild;if(0!=l){g.width=l+"px"}if(SBGrid.DEF.is_ie7){this.m_heFFC.style.width=(this.getFixedFrozenColWidth()+this.fixedCols)+"px"}else{this.m_heFFC.style.width=(this.getFixedFrozenColWidth()+1)+"px"}r=this.m_heFFC.firstChild;if(0!=l){r.width=l+"px"}if(SBGrid.DEF.is_chrome&&this.frozenCols>0){if(this.getCellContentRect(0,this.frozenCols+this.fixedCols)!=null){var f=this.getCellContentRect(0,this.frozenCols+this.fixedCols).getX();this.m_heFFC.style.width=f+"px";this.m_heFFNS.style.width=f+"px";r.width=f+"px";g.width=f+"px"}}if(null!=this.m_heFFBS){if(null!=this.m_heFFBS.firstChild){p=this.m_heFFBS.firstChild;if(e==""){e="0"}if(SBGrid.DEF.is_ie8||SBGrid.DEF.is_ie7){if(e!=0){p.width=e+"px"}}else{p.width=e+"px"}if(typeof e=="string"&&e.indexOf("px")!=-1){p.style.width=e}else{p.style.width=e+"px"}m=p.lastChild;this.m_heFFBNS.style.width=l+"px";c=this.m_heFFBNS.firstChild;if(0!=l){c.width=l+"px"}}}}if(!SBGrid.DEF.is_smartphone){if(this._isHScroll()&&this.m_objHeArea.bChangeWidth){this.m_heFFC.style.height=this.m_heWhole.clientHeight-this.m_heFFNS.clientHeight+"px";if(null!=this.m_heFFBS){this.m_heFFBS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBS.clientHeight)+"px";this.m_heFFBNS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBNS.clientHeight)+"px"}}else{if(this.m_objHeArea.bChangeWidth){var b=this.m_heWhole.clientHeight-this.getFixedFrozenRowHeight();this.m_heFFC.style.height=(b<0?0:b).toString();+"px";if(null!=this.m_heFFBS){this.m_heFFBS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBS.clientHeight)+"px";this.m_heFFBNS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBNS.clientHeight)+"px"}}}}if(SBGrid.DEF.is_ie||SBGrid.DEF.is_ie11){var a=this.m_arColumn[this.cols-1];if(a.m_bHiddenState){this.m_heFFS.style.width=this.m_heWhole.clientWidth-1+"px"}}};SBGrid.CT.DataGrid.prototype.gridToInstance=function(){var f=this.cols-1;if(this.isJsonRef()){}else{var e=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceSinglePart(null,this.nodeset);if(null!=e){e=e.parentNode}else{return}for(var c=this.fixedRows;c<this.m_nRealRows;c++){for(var a=f;a>=this.fixedCols;a--){var b=this.getCellEx(c,a);if(null!=b){var d=b.getNodeElement();if(null!=d){e.appendChild(d.parentNode);break}}}}this.m_xlRefNode=this.getControlNodeList()}};SBGrid.CT.DataGrid.prototype.colGroupNameSpace=function(){var m=document.getElementById("SBHE_DATAGRID_WHOLE_COLGROUP_"+this.id);var n=document.getElementById("SBHE_DATAGRID_FFS_COLGROUP_"+this.id);var l=document.getElementById("SBHE_DATAGRID_FFN_COLGROUP_"+this.id);var o=document.getElementById("SBHE_DATAGRID_FFCOL_COLGROUP_"+this.id);var e=document.getElementById("SBHE_DATAGRID_FFBS_COLGROUP_"+this.id);var d=document.getElementById("SBHE_DATAGRID_FFBN_COLGROUP_"+this.id);for(var f=0;f<this.cols;f++){var c=(0==this.m_arColWidth[f]||!this.m_arColumn[f].visible)&&(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7)?"none":"";var p=m.children[f];if(null!=p){p.setAttribute("colNum",this.id+"_"+f);p.setAttribute("targetCol","who");p.style.display=c}if(!SBGrid.DEF.is_smartphone){var b=n.children[f];if(null!=b){b.setAttribute("colNum",this.id+"_"+f);b.setAttribute("targetCol","ffs");b.style.display=c}var h=l.children[f];if(null!=h){h.setAttribute("colNum",this.id+"_"+f);h.setAttribute("targetCol","ffn");h.style.display=c}var q=o.children[f];if(null!=q){q.setAttribute("colNum",this.id+"_"+f);q.setAttribute("targetCol","ffc");q.style.display=c}if(null!=e){var a=e.children[f];if(null!=a){a.setAttribute("colNum",this.id+"_"+f);a.setAttribute("targetCol","ffbs");a.style.display=c}var g=d.children[f];if(null!=g){g.setAttribute("colNum",this.id+"_"+f);g.setAttribute("targetCol","ffbn");g.style.display=c}}}}};SBGrid.CT.DataGrid.prototype.setColGroupWidth=function(f,b){if(SBGrid.DEF.is_chrome){if(f<this.frozenCols+this.fixedCols){b=Math.ceil(b)}}if(!SBGrid.DEF.is_smartphone){jQuery('col[colNum="'+this.id+"_"+f+'"]').css("width",b+"px");if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7){if(null!=this.m_htMergeColList[this.id+"_"+f]){var e=this.m_htMergeColList[this.id+"_"+f];jQuery('col[colNum="'+this.id+"_"+f+'"][targetCol="'+e.targetCol+'"]').css("width",(b+1)+"px");e=null}if(null!=this.m_htMergeFRColList[this.id+"_"+f]){var e=this.m_htMergeFRColList[this.id+"_"+f];jQuery('col[colNum="'+this.id+"_"+f+'"][targetCol="'+e.targetCol+'"]').css("width",(b+1)+"px");e=null}if(null!=this.m_htMergeFCColList[this.id+"_"+f]){var e=this.m_htMergeFCColList[this.id+"_"+f];jQuery('col[colNum="'+this.id+"_"+f+'"][targetCol="'+e.targetCol+'"]').css("width",(b+1)+"px");e=null}}if(SBGrid.DEF.is_ie9){if(null!=this.m_arIe9MergeCellWidth){for(var c=0;c<this.m_arIe9MergeCellWidth.length;c++){var d=this.m_arIe9MergeCellWidth[c];if(f==d.nLastCol){d.target.style.width=(this.getMergePartColWidth(d.nStartCol,d.nLastCol)+b)+"px"}}}}if(SBGrid.DEF.is_ie10){jQuery('td[colNum="'+this.id+"_"+f+'"]').width((b-1)+"px")}}else{var a=document.getElementById("SBHE_DATAGRID_WHOLE_COLGROUP_"+this.id);if(null!=a){a.children[f].style.width=b+"px";if(SBGrid.DEF.is_ie){a.children[f].style.pixelWidth--}}}};SBGrid.CT.DataGrid.prototype.setColGroupCount=function(c){if(!SBGrid.DEF.is_smartphone){var f=document.getElementById("SBHE_DATAGRID_WHOLE_COLGROUP_"+this.id);var e=document.getElementById("SBHE_DATAGRID_FFN_COLGROUP_"+this.id);var g=document.getElementById("SBHE_DATAGRID_FFCOL_COLGROUP_"+this.id);var b=document.getElementById("SBHE_DATAGRID_FFBN_COLGROUP_"+this.id);if(this.frozenCols<c){var h=null;for(var d=(this.fixedCols+this.frozenCols);d<(this.fixedCols+c);d++){h=f.children[d];var a=h.cloneNode(true);a.setAttribute("targetCol","ffn");var m=h.cloneNode(true);m.setAttribute("targetCol","ffc");e.appendChild(a);g.appendChild(m);if(null!=b){var l=h.cloneNode(true);l.setAttribute("targetCol","ffbn");b.appendChild(l)}}h=null}else{for(var d=0;d<(this.frozenCols-c);d++){e.removeChild(e.lastChild);g.removeChild(g.lastChild);if(null!=b){b.removeChild(b.lastChild)}}}}};SBGrid.CT.DataGrid.prototype.setColGroupAddCol=function(e,f){var d=document.getElementById("SBHE_DATAGRID_WHOLE_COLGROUP_"+this.id);var h=document.getElementById("SBHE_DATAGRID_FFS_COLGROUP_"+this.id);var c=document.getElementById("SBHE_DATAGRID_FFN_COLGROUP_"+this.id);var i=document.getElementById("SBHE_DATAGRID_FFCOL_COLGROUP_"+this.id);var b=document.getElementById("SBHE_DATAGRID_FFBS_COLGROUP_"+this.id);var a=document.getElementById("SBHE_DATAGRID_FFBN_COLGROUP_"+this.id);var l=document.createElement("col");l.style.width=String(f)+"px";if(!SBGrid.DEF.is_smartphone){l.setAttribute("colNum",this.id+"_"+e);var g=l.cloneNode(true);g.setAttribute("targetCol","who");d.appendChild(g);g=l.cloneNode(true);g.setAttribute("targetCol","ffs");h.appendChild(g);if(null!=b){g=l.cloneNode(true);g.setAttribute("targetCol","ffbs");b.appendChild(g)}if(this.cols<(this.fixedCols+this.frozenCols)){g=l.cloneNode(true);g.setAttribute("targetCol","ffn");c.appendChild(g);g=l.cloneNode(true);g.setAttribute("targetCol","ffc");i.appendChild(g);if(null!=b){g=l.cloneNode(true);g.setAttribute("targetCol","ffnc");a.appendChild(g)}}g=null;l=null}else{if(null!=d){d.appendChild(l.cloneNode(true))}}};SBGrid.CT.DataGrid.prototype.setColGroupInsertCol=function(g,h){var f=document.getElementById("SBHE_DATAGRID_WHOLE_COLGROUP_"+this.id);var m=document.getElementById("SBHE_DATAGRID_FFS_COLGROUP_"+this.id);var e=document.getElementById("SBHE_DATAGRID_FFN_COLGROUP_"+this.id);var n=document.getElementById("SBHE_DATAGRID_FFCOL_COLGROUP_"+this.id);var d=document.getElementById("SBHE_DATAGRID_FFBS_COLGROUP_"+this.id);var b=document.getElementById("SBHE_DATAGRID_FFBN_COLGROUP_"+this.id);var o=document.createElement("col");o.style.width=String(h)+"px";if(!SBGrid.DEF.is_smartphone){o.setAttribute("colNum",this.id+"_"+g);var l=o.cloneNode(true);l.setAttribute("targetCol","who");for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=f.children[c];if(null!=a){a.setAttribute("colNum",p)}}f.insertBefore(l,f.children[g]);l=o.cloneNode(true);l.setAttribute("targetCol","ffs");for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=m.children[c];if(null!=a){a.setAttribute("colNum",p)}}m.insertBefore(l,m.children[g]);if(null!=d){l=o.cloneNode(true);l.setAttribute("targetCol","ffbs");for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=d.children[c];if(null!=a){a.setAttribute("colNum",p)}}d.insertBefore(l,d.children[g])}if(this.cols<(this.fixedCols+this.frozenCols)){l=o.cloneNode(true);l.setAttribute("targetCol","ffn");for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=e.children[c];if(null!=a){a.setAttribute("colNum",p)}}e.insertBefore(l,e.children[g]);l=o.cloneNode(true);l.setAttribute("targetCol","ffc");for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=n.children[c];if(null!=a){a.setAttribute("colNum",p)}}n.insertBefore(l,n.children[g]);if(null!=d){l=o.cloneNode(true);l.setAttribute("targetCol","ffbn");for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=b.children[c];if(null!=a){a.setAttribute("colNum",p)}}b.insertBefore(l,b.children[g])}}else{if(g<(this.fixedCols+this.frozenCols)){e.children[g].style.width=String(h)+"px";n.children[g].style.width=String(h)+"px";if(null!=d){for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=b.children[c];if(null!=a){a.setAttribute("colNum",p)}}b.children[g].style.width=String(h)+"px"}}}}else{if(null!=f){for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=f.children[c];if(null!=a){a.setAttribute("colNum",p)}}f.insertBefore(o.cloneNode(true),f.children[g])}}o=null};SBGrid.CT.DataGrid.prototype.setColGroupRemoveCol=function(){var b=document.getElementById("SBHE_DATAGRID_WHOLE_COLGROUP_"+this.id);var d=document.getElementById("SBHE_DATAGRID_FFS_COLGROUP_"+this.id);var f=document.getElementById("SBHE_DATAGRID_FFN_COLGROUP_"+this.id);var a=document.getElementById("SBHE_DATAGRID_FFCOL_COLGROUP_"+this.id);var c=document.getElementById("SBHE_DATAGRID_FFBS_COLGROUP_"+this.id);var e=document.getElementById("SBHE_DATAGRID_FFBN_COLGROUP_"+this.id);if(!SBGrid.DEF.is_smartphone){b.removeChild(b.lastChild);d.removeChild(d.lastChild);if(null!=c){c.removeChild(c.lastChild)}if(this.cols<=(this.fixedCols+this.frozenCols)){f.removeChild(f.lastChild);a.removeChild(a.lastChild);if(null!=c){e.removeChild(e.lastChild)}}}else{if(null!=b){b.removeChild(b.lastChild)}}};SBGrid.CT.DataGrid.prototype.setColGroupDeleteCol=function(g){var f=document.getElementById("SBHE_DATAGRID_WHOLE_COLGROUP_"+this.id);var h=document.getElementById("SBHE_DATAGRID_FFS_COLGROUP_"+this.id);var e=document.getElementById("SBHE_DATAGRID_FFN_COLGROUP_"+this.id);var l=document.getElementById("SBHE_DATAGRID_FFCOL_COLGROUP_"+this.id);var c=document.getElementById("SBHE_DATAGRID_FFBS_COLGROUP_"+this.id);var b=document.getElementById("SBHE_DATAGRID_FFBN_COLGROUP_"+this.id);if(!SBGrid.DEF.is_smartphone){for(var d=(g+1);d<this.cols;d++){var n=this.id+"_"+(d-1);var a=f.children[d];if(null!=a){a.setAttribute("colNum",n)}}f.removeChild(f.children[g]);for(var d=(g+1);d<this.cols;d++){var n=this.id+"_"+(d-1);var a=h.children[d];if(null!=a){a.setAttribute("colNum",n)}}h.removeChild(h.children[g]);if(null!=c){for(var d=(g+1);d<this.cols;d++){var n=this.id+"_"+(d-1);var a=c.children[d];if(null!=a){a.setAttribute("colNum",n)}}c.removeChild(c.children[g])}if(this.cols<=(this.fixedCols+this.frozenCols)){for(var d=(g+1);d<this.cols;d++){var n=this.id+"_"+(d-1);var a=e.children[d];if(null!=a){a.setAttribute("colNum",n)}}e.removeChild(e.children[g]);for(var d=(g+1);d<this.cols;d++){var n=this.id+"_"+(d-1);var a=l.children[d];if(null!=a){a.setAttribute("colNum",n)}}l.removeChild(l.children[g]);if(null!=c){for(var d=(g+1);d<this.cols;d++){var n=this.id+"_"+(d-1);var a=b.children[d];if(null!=a){a.setAttribute("colNum",n)}}b.removeChild(b.children[g])}}else{if(g<(this.fixedCols+this.frozenCols)){for(var d=g;d<(this.fixedCols+this.frozenCols);d++){var m=f.children[d+1];if(null!=m){e.children[d].style.width=m.style.width;l.children[d].style.width=m.style.width;if(null!=c){b.children[d].style.width=m.style.width}}}}}}else{if(null!=f){for(var d=(g+1);d<this.cols;d++){var n=this.id+"_"+(d-1);var a=f.children[d];if(null!=a){a.setAttribute("colNum",n)}}f.removeChild(f.children[g])}}};SBGrid.CT.DataGrid.prototype.setSeqForRowHeader=function(){var e=this.getRowHeader();if(e!=SBGrid.DEF.SBRH_SEQ&&e!=SBGrid.DEF.SBRH_REVERSESEQ){return}var c=String(this.m_nRealRows-this.fixedRows).length;if(c>1){if((c*10)>this.m_arColWidth[0]){this._sCW(0,c*10)}}else{if(20>this.m_arColWidth[0]){this._sCW(0,20)}}var d;var a;var b=this.seqRowHeader;if(e==SBGrid.DEF.SBRH_SEQ){a=this.fixedRows;while(a<=this.m_objScroll.nBottomRow){if(this.isPhysicalRow(a)){d=this.getCellEx(a,0);if(null!=d){SBGrid.CF.GridSetFixedWindowText(d,String(b));a++;b++}else{a++;b++}}else{a++;b++}}}else{if(e==SBGrid.DEF.SBRH_REVERSESEQ){a=this.m_nRealRows-1;while(a>=this.fixedRows){if(this.isPhysicalRow(a)){d=this.getCellEx(a,0);if(null!=d){SBGrid.CF.GridSetFixedWindowText(d,String(b));a--;b++}else{a--;b++}}else{a--;b++}}}}e=null;c=null;d=null;a=null;b=null};SBGrid.CT.DataGrid.prototype.setSeqRowHeader=function(a){this.seqRowHeader=a;this.setSeqForRowHeader()};SBGrid.CT.DataGrid.prototype.rowHeightResize=function(){var c=this.fixedCols+this.frozenCols;var b=this.fixedRows+this.frozenRows;var g=this.m_nRealRows-this.frozenBottomRows;var f=this.m_heWhole.firstChild.lastChild;var d;var a;var h;var e;var i;if(null!=this.m_heFFS){this.m_heFFS.style.height=this.getFixedFrozenRowHeight()+"px";this.m_heFFNS.style.height=this.getFixedFrozenRowHeight()+"px";this.m_heFFC.style.top=this.getFixedFrozenRowHeight()+"px";if(document.doctype==null){if(!SBGrid.DEF.is_ie7&&!SBGrid.DEF.is_ie8&&!SBGrid.DEF.is_ie9){this.m_heFFS.style.height=this.getFixedFrozenRowHeight()-1+"px";this.m_heFFNS.style.height=this.getFixedFrozenRowHeight()-1+"px";this.m_heFFC.style.top=this.getFixedFrozenRowHeight()-1+"px"}}d=this.m_heFFS.firstChild.lastChild;a=this.m_heFFNS.firstChild.lastChild;jQuery(this.m_heFFC).height(this.m_heWhole.clientHeight-this.getFixedFrozenRowHeight()+"px");h=this.m_heFFC.firstChild.lastChild}if(null!=this.m_heFFBS){this.m_heFFBS.style.height=this.getFrozenBottomRowHeight()+"px";this.m_heFFBS.style.top=this.m_heWhole.clientHeight-this.getFrozenBottomRowHeight()+"px";e=this.m_heFFBS.firstChild.lastChild;this.m_heFFBNS.style.height=this.getFrozenBottomRowHeight()+"px";this.m_heFFBNS.style.top=this.m_heWhole.clientHeight-this.getFrozenBottomRowHeight()+"px";i=this.m_heFFBNS.firstChild.lastChild}if(this._isHScroll()&&this.m_objHeArea.bChangeWidth){this.m_heFFC.style.height=this.m_heWhole.clientHeight-this.m_heFFNS.clientHeight+"px";if(null!=this.m_heFFBS){this.m_heFFBS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBS.clientHeight)+"px";this.m_heFFBNS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBNS.clientHeight)+"px"}}else{if(this.m_objHeArea.bChangeWidth){this.m_heFFC.style.height=this.m_heWhole.clientHeight-this.getFixedFrozenRowHeight()+"px";if(null!=this.m_heFFBS){this.m_heFFBS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBS.clientHeight)+"px";this.m_heFFBNS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBNS.clientHeight)+"px"}}}};SBGrid.CT.DataGrid.prototype.rowHeight=function(a){if(null!=a&&isFinite(a)){return this.m_htRowHeight[a]}};SBGrid.CT.DataGrid.prototype.getRowHeight=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".getRowHeight","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getRowHeight","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}return this.rowHeight(a)};SBGrid.CT.DataGrid.prototype.setRowHeight=function(c,b,a){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setRowHeight","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setRowHeight","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setRowHeight","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(a==null){a=false}if(0>c||this.m_nRealRows<=c){return}this.m_htRowHeight[c]=parseInt(b);if(b>0){b--}jQuery('td[rowNum="'+this.id+"_"+c+'"]').css("height",b+"px");if(c<this.fixedRows){this.m_heFFS.style.height=this.getFixedFrozenRowHeight()+"px";this.m_heFFNS.style.height=this.getFixedFrozenRowHeight()+"px";this.m_heFFC.style.top=this.getFixedFrozenRowHeight()+"px";if(document.doctype==null){if(!SBGrid.DEF.is_ie7&&!SBGrid.DEF.is_ie8&&!SBGrid.DEF.is_ie9){this.m_heFFS.style.height=this.getFixedFrozenRowHeight()-1+"px";this.m_heFFNS.style.height=this.getFixedFrozenRowHeight()-1+"px";this.m_heFFC.style.top=this.getFixedFrozenRowHeight()-1+"px"}}}if(!a){this.rowHeightResize()}};SBGrid.CT.DataGrid.prototype.selectKeyDown=function(d){var e;var a;var b;var c;if(d.shiftKey){e=(this.m_nPrevDownRow<this.getRow())?this.m_nPrevDownRow:this.getRow();a=(this.m_nPrevDownRow<this.getRow())?this.getRow():this.m_nPrevDownRow;b=(this.m_nPrevDownCol<this.getCol())?this.m_nPrevDownCol:this.getCol();c=(this.m_nPrevDownCol<this.getCol())?this.getCol():this.m_nPrevDownCol}else{this.m_nPrevDownRow=this.getRow();this.m_nPrevDownCol=this.getCol();e=a=this.getRow();b=c=this.getCol()}this.clearSelection();this.selectCells(e,b,a,c);this.topScrollCell(this.getRow(),true)};SBGrid.CT.DataGrid.prototype.getColAttribute=function(b,a){if(null==b||(0>b||this.cols<=b)){return}return this.m_arColumn[b].getAttribute(a)};SBGrid.CT.DataGrid.prototype.setColAttribute=function(c,a,b){if(null==c||(0>c||this.cols<=c)){return}this.m_arColumn[c].setAttribute(a,b)};SBGrid.CT.DataGrid.prototype.reSetRowHidden=function(){for(var a=0;a<this.m_nRealRows&&a<this.m_arHiddenRowState.length;a++){if(true==this.m_arHiddenRowState[a]){this.setRowDisplay(a,"none");if(this.m_objScroll.bScrollEvent){this.setScrollDivRow(a,true)}}}};SBGrid.CT.DataGrid.prototype.getRowData=function(c){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".getRowData","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getRowData","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}var b=this.getCellEx(c,0);if(null!=b){if(this.m_bIsRealDataSync==false&&this.m_bIsSort){var f=new Object();for(var a=this.fixedCols,e=this.cols;a<e;a++){var d=this.m_arColumn[a].getAttribute("ref");f[d]=this.getTextMatrix(c,a)}return f}else{return this.m_xlRefNode[c-this.fixedRows]}}return};SBGrid.CT.DataGrid.prototype.setRowData=function(e,n,l){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setRowData","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof e!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setRowData","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof n!="object"){SBGrid.DEF.APIerrorMsg(this.id+".setRowData","Please check if second parameter type is 'object'.",SBGrid.DEF.DEBUG_MODE);return}if(l==undefined){l=false}else{if(typeof l!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setRowData","Please check if 3rd parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}var c=this.m_xlRefNode[this.getRealDataSequence()[e]];var a=SBGrid.DEF.getPropertyNameList(n);var f=this.getCellEx(e,0);if(null!=f){for(var g=this.fixedCols,b=this.cols;g<b;g++){var d=this.m_arColumn[g].getAttribute("ref");var m=n[d];if(this.m_bComboDataSync&&this.m_arColumn[g].m_objCombo){if(this.m_arColumn[g].m_objCombo.getComboLabel(m)==""){m=n[d]=""}}if(this.m_bIsRealDataSync){var o=a.indexOf(d);if(o>-1){a.splice(o,1)}}if(n[d]=="string"){m=n[d]}else{if(n[d]==undefined){continue}else{m=n[d].toString()}}this.setValueMatrix(e,g,m)}if(this.m_bIsRealDataSync){for(var g=0,h=a.length;g<h;g++){c[a[g]]=n[a[g]]}}if(l){this.refresh()}}SBGrid.DEF.clearArray(a);c=a=null};SBGrid.CT.DataGrid.prototype.isHiddenAboutKey=function(e,c){var d;d=this.m_clIndexes.item(this.m_clIndexes.keys()[c]).item(e);var b=true;for(var a=0;a<d.length;a++){if(this.isRowHidden(d[a])==false){b=false;break}}return b};SBGrid.CT.DataGrid.prototype.getFilteringHistory=function(a){var e=SBGrid.DEF.__deepCopy(a);var f=e.keys();var d=e.item(f[0]);if(f.length<=1){return d.splice(0,d.length)}else{var c=1;while(c<f.length){var b=e.item(f[c]);d=SBGrid.DEF.arrDifferenceOfSets(d,b);c++}return d}};SBGrid.CT.DataGrid.prototype.rowHidden=function(a){return this.m_arHiddenRowState[a]};SBGrid.CT.DataGrid.prototype.setRowHidden=function(b,a,c){if(null==b||null==a||(0>b||this.m_nRealRows<=b)){return}if((null==this.m_arHiddenRowState[b]&&false==a)||this.m_arHiddenRowState[b]==a){return}this.m_arHiddenRowState[b]=a;if(a){this.setRowDisplay(b,"none",c);if(this.m_objScroll.bScrollEvent){this.setScrollDivRow(b,true)}}else{this.setRowDisplay(b,"",c);if(this.m_objScroll.bScrollEvent){this.setScrollDivRow(b,false)}}};SBGrid.CT.DataGrid.prototype.savePersonalInfo=function(b){if(b==null){return}var d="";d=this.id+"_"+b;var a=new Date();a.setDate(a.getDate()+10000);this.m_arrHiddenCol.clear();this.m_arChangedColInfo.clear();for(var c=0;c<this.cols;c++){if(this.m_arColumn[c].m_bHiddenState==true){this.m_arrHiddenCol.add(c)}this.m_arChangedColInfo.add(this.getRefOfCol(c))}this.m_objPersonalize=[{arColHiddenInfo:this.m_arrHiddenCol.keys(),arChangedColInfo:this.m_arChangedColInfo.keys()}];var e=JSON.stringify(this.m_objPersonalize);cookies=d+"="+e+"; path=/; expires="+a.toGMTString()+";";document.cookie=cookies};SBGrid.CT.DataGrid.prototype.loadPersonalInfo=function(l){if(l==null){return}if(document.cookie!=null){var c=this.id+"_"+l;c=c+"=";var a=document.cookie;var b=a.indexOf(c);var g="";if(b!=-1){b+=c.length;var d=a.indexOf(";",b);if(d==-1){d=a.length}g=a.substring(b,d)}else{return}var h=JSON.parse(g);for(var e=0;e<h[0].arChangedColInfo.length;e++){this.nBeforeCol=this.getColRef(h[0].arChangedColInfo[e]);this.nAfterCol=null;if(e==0){this.nAfterCol=this.fixedCols}else{if(e>0){this.nAfterCol=this.getColRef(h[0].arChangedColInfo[e-1])+1}}this.moveColumn(this.nBeforeCol,this.nAfterCol)}for(var f=0;f<h[0].arColHiddenInfo.length;f++){this.setColHidden(parseInt(h[0].arColHiddenInfo[f]),true)}}};SBGrid.CT.DataGrid.prototype.removePersonalInfo=function(b){if(b==null){return}var c=this.id+"_"+b;var a=new Date();a.setDate(a.getDate()-1);document.cookie=c+"=; path=/ expires="+a.toGMTString()};SBGrid.CT.DataGrid.prototype.initPersonalInfo=function(){var c=0;if(document.cookie!=""){var e=document.cookie.split(";");c=e.length;var b=new Date();b.setDate(b.getDate()-1);for(var d=0;d<c;d++){var a=e[d].split("=")[0];document.cookie=a+"=; path=/ expires="+b.toGMTString()}}};SBGrid.CT.DataGrid.prototype.setRowDisplay=function(a,c,b){if(this.m_objScroll.bScrollEvent){this.setScrollDisplayRow(a,c,b)}else{jQuery('tr[rowNum="'+this.id+"_"+a+'"]').css("display",c)}};SBGrid.CT.DataGrid.prototype.setColDisplay=function(e,c){if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7||SBGrid.DEF.is_ie9){c="none"==c?"none":"block";jQuery('col[colNum="'+this.id+"_"+e+'"]').css("display",c);if(SBGrid.DEF.is_ie8||SBGrid.DEF.is_ie9){jQuery('td[colNum="'+this.id+"_"+e+'"]').css("display",c)}return}else{for(var b=0;b<this.m_nRealRows;b++){var a=this.getCellEx(b,e);if(null!=a){if(null!=a.m_heCtrl){var d=null!=a.m_heCtrl.lastChild&&null!=a.m_heCtrl.lastChild.tagName?a.m_heCtrl.lastChild:a.m_heCtrl;if("none"==c){d.style.display=c}else{d.style.display=""}}}}}};SBGrid.CT.DataGrid.prototype.setExtendLastCol=function(b,a){if(null==b||null==this.m_heWhole){return}this.extendLastCol=b;this.attribute.extendlastcol=b;var c;var l;var h=0;var f;var d=17;var g=0;for(var e=this.fixedCols;e<this.cols;e++){if(0==this.m_arColWidth[e]){continue}else{g++;c=e}}if(null==c){return}if(this._isVScroll()){l=true}else{l=false}for(var e=0;e<c;e++){h+=this.m_arColWidth[e]}var m=this._getGridWidth();if(h<m){f=(m-h)}else{b="false"}if(SBGrid.DEF.is_ie7){f-=(g+2)}else{if(SBGrid.DEF.is_ie11||SBGrid.DEF.is_ie10){f-=1}}switch(b){case"scroll":if(l){this.m_arColWidth[e]=f-d;if(a){this.setColGroupWidth(c,f-d)}else{this.setColWidth(c,f-d)}break}case"noscroll":this.m_arColWidth[e]=f;if(a){this.setColGroupWidth(c,f)}else{this.setColWidth(c,f)}break;case"false":default:if(a){this.setColGroupWidth(c,this.m_arHiddenCol[c])}else{}break}};SBGrid.CT.DataGrid.prototype.setEllipsis=function(a){if(null==this.m_heWhole){return}if(this.ellipsis!=a){this.ellipsis=a;for(var d=this.fixedRows;d<this.m_nRealRows;d++){for(var b=this.fixedCols;b<this.cols;b++){var c=this.getCellEx(d,b);if(null!=c){if(null!=c.m_heDCtrl){if(a){if(SBGrid.DEF.is_firefox){}else{c.m_heDCtrl.style.textOverflow="ellipsis"}}else{if(SBGrid.DEF.is_firefox){}else{c.m_heDCtrl.style.textOverflow=""}}}}}}}};SBGrid.CT.DataGrid.prototype.getExplorerBar=function(){return this.m_nExplorerBarType};SBGrid.CT.DataGrid.prototype.setExplorerBar=function(a){switch(a){case"sort":this.m_nExplorerBarType=SBGrid.DEF.SBEB_SORT;break;case"move":this.m_nExplorerBarType=SBGrid.DEF.SBEB_MOVE;break;case"sortshow":this.m_nExplorerBarType=SBGrid.DEF.SBEB_SORT_SHOW;break;case"sortmove":this.m_nExplorerBarType=SBGrid.DEF.SBEB_SORT_MOVE;break;case"sortshowmove":this.m_nExplorerBarType=SBGrid.DEF.SBEB_SORT_SHOW_MOVE;break;default:return}this.m_bIsExplorerBar=true;this.attribute.explorerbar=a;this.explorerbar=a};SBGrid.CT.DataGrid.prototype.getExplorerUI=function(){return this.m_nExplorerUIType};SBGrid.CT.DataGrid.prototype.setExplorerUI=function(a){switch(a){case"filteringshow":this.m_nExplorerUIType=SBGrid.DEF.SBEB_UI_FILTERING_SHOW;break;case"hideshow":this.m_nExplorerUIType=SBGrid.DEF.SBEB_UI_HIDE_SHOW;break;case"filteringshowhideshow":this.m_nExplorerUIType=SBGrid.DEF.SBEB_UI_FILTERING_SHOW_HIDE_SHOW;break;case"filtering":this.m_nExplorerUIType=SBGrid.DEF.SBEB_UI_FILTERING;case"hide":this.m_nExplorerUIType=SBGrid.DEF.SBEB_UI_HIDE;case"filteringhide":this.m_nExplorerUIType=SBGrid.DEF.SBEB_UI_FILTERING_HIDE;default:this.m_bIsExplorerUI=false;return}this.m_bIsExplorerUI=true;this.attribute.explorerui=a;this.explorerui=a};SBGrid.CT.DataGrid.prototype.isShowExplorerUI=function(){return this.m_bIsExplorerUI};SBGrid.CT.DataGrid.prototype.isMoveColumn=function(f){var b=false;if(this.isResizing()){return false}var i=this.m_bRowHeader?1:0;if(this.m_bDown&&this.m_nDownCol>=this.fixedCols&&this.isFixedCell(this.m_nDownRow,this.m_nDownCol)){var g=this.getExplorerBar();switch(g){case SBGrid.DEF.SBEB_MOVE:case SBGrid.DEF.SBEB_SORT_MOVE:case SBGrid.DEF.SBEB_SORT_SHOW_MOVE:case SBGrid.DEF.SBEB_FILTER_SHOW_MOVE:case SBGrid.DEF.SBEB_SORT_FILTER_SHOW_MOVE:case SBGrid.DEF.SBEB_HIDE_SHOW_MOVE:case SBGrid.DEF.SBEB_SORT_HIDE_SHOW_MOVE:case SBGrid.DEF.SBEB_FILTER_HIDE_SHOW_MOVE:case SBGrid.DEF.SBEB_SORT_FILTER_HIDE_SHOW_MOVE:b=true;break}}if(b){var h=this.getMouseCol();var d=this.getMouseRow();var e=this.getCellEx(d,h);if(null!=e){var a=e.mergeType;if(SBGrid.DEF.SBSM_HIDE==a||SBGrid.DEF.SBSM_MERGED==a){var c=this.getMouseRow();if(this.getFixedRows()>1){c=0}if(d!=c){b=false}}}}if(!b){return false}return true};SBGrid.CT.DataGrid.prototype._isVScroll=function(){if(this.getAttribute("scroll")!="horizontal"&&this.getAttribute("scroll")!="autohscroll"&&this.getAttribute("scroll")!="none"){return this.m_heWhole.clientHeight<this.m_heWhole.scrollHeight}return false};SBGrid.CT.DataGrid.prototype.isVerticalScroll=function(){return this._isVScroll()};SBGrid.CT.DataGrid.prototype._isHScroll=function(){if(this.getAttribute("scroll")!="vertical"&&this.getAttribute("scroll")!="autovscroll"&&this.getAttribute("scroll")!="none"){var a=this.m_heWhole.clientWidth<this.m_heWhole.scrollWidth;if(null==this.m_objHeArea.bCheckWidth||this.m_objHeArea.bCheckWidth!=a){this.m_objHeArea.bChangeWidth=true}else{this.m_objHeArea.bChangeWidth=false}this.m_objHeArea.bCheckWidth=a;return a}return false};SBGrid.CT.DataGrid.prototype.isHorizontalScroll=function(){return this._isHScroll()};SBGrid.CT.DataGrid.prototype._getGridHeight=function(){if(SBGrid.DEF.is_ie){return this.m_heCtrl.offsetHeight}else{return this.m_heCtrl.clientHeight}};SBGrid.CT.DataGrid.prototype._getGridWidth=function(){return this.m_heWhole.offsetWidth};SBGrid.CT.DataGrid.prototype._getTotalRowHeight=function(){var a=0;for(var b=0;b<this.m_nRealRows;b++){if(null!=this.m_htRowHeight[b]){a+=this.m_htRowHeight[b]}}return a};SBGrid.CT.DataGrid.prototype._getTotalColWidth=function(){var a=0;for(var b=0;b<this.cols;b++){if(b<this.m_arColWidth.length){a+=this.m_arColWidth[b]}}a=parseInt(a);return a};SBGrid.CT.DataGrid.prototype._getBorder=function(a){switch(a){case"top":return parseInt(this.m_heCtrl.style.borderTopWidth);case"right":return parseInt(this.m_heCtrl.style.borderRightWidth);case"bottom":return parseInt(this.m_heCtrl.style.borderBottomWidth);case"left":return parseInt(this.m_heCtrl.style.borderLeftWidth);default:return 0}};SBGrid.CT.DataGrid.prototype.selectImage=function(b){var a=this.m_arColumn[b];if(null!=a){return this.getAttribute("selectimage")}return""};SBGrid.CT.DataGrid.prototype.setSelectImage=function(c,b){var a=this.m_arColumn[c];if(null!=a){a.attribute.selectimage=b;if(SBGrid.DEF.SBIT_RADIO==a.getInputType()){this.refreshCol(c)}}};SBGrid.CT.DataGrid.prototype.unSelectImage=function(b){var a=this.m_arColumn[b];if(null!=a){return this.getAttribute("unselectimage")}return""};SBGrid.CT.DataGrid.prototype.setUnSelectImage=function(c,b){var a=this.m_arColumn[c];if(null!=a){a.attribute.unselectimage=b;if(SBGrid.DEF.SBIT_RADIO==a.getInputType()){this.refreshCol(c)}}};SBGrid.CT.DataGrid.prototype.checkImage=function(b){var a=this.m_arColumn[b];if(null!=a){return this.getAttribute("checkimage")}return""};SBGrid.CT.DataGrid.prototype.unCheckImage=function(b){var a=this.m_arColumn[b];if(null!=a){return this.getAttribute("uncheckimage")}return""};SBGrid.CT.DataGrid.prototype.setUnCheckImage=function(c,b){var a=this.m_arColumn[c];if(null!=a){a.attribute.uncheckimage=b;if(SBGrid.DEF.SBIT_CHECK==a.getInputType()){this.refreshCol(c)}}};SBGrid.CT.DataGrid.prototype.setCheckImage=function(c,b){var a=this.m_arColumn[c];if(null!=a){a.attribute.Checkimage=b;if(SBGrid.DEF.SBIT_CHECK==a.getInputType()){this.refreshCol(c)}}};SBGrid.CT.DataGrid.prototype.refreshCol=function(e){if(!SBGrid.DEF.is_smartphone){var d;var a=this.m_replaceString;if(a!=""&&a!="undefined"&&a!=null){d=a.split("?")}for(var c=this.fixedRows;c<this.fixedRows+this.frozenRows;c++){var b=this.getCellEx(c,e);if(null!=b){SBGrid.CF.GridSetTextRefresh(b,SBGrid.CF.GridGetText(b),d,this.m_bIsDataReplaceValueChanged)}}for(var c=this.m_objScroll.nTopRow;c<=this.m_objScroll.nBottomRow;c++){var b=this.getCellEx(c,e);if(null!=b){SBGrid.CF.GridSetTextRefresh(b,SBGrid.CF.GridGetText(b),d,this.m_bIsDataReplaceValueChanged)}}for(var c=this.m_nRealRows-this.m_nBottomRowCount;c<this.m_nRealRows;c++){var b=this.getCellEx(c,e);if(null!=b){SBGrid.CF.GridSetTextRefresh(b,SBGrid.CF.GridGetText(b),d,this.m_bIsDataReplaceValueChanged)}}}};SBGrid.CT.DataGrid.prototype.setAttribute=function(a,c){SBGrid.CT.Group.prototype.setAttribute.call(this,a,c);switch(a){case"width":this.adjustWidth();this.m_nOriginWidth=SBGrid.DEF.is_smartphone?parseInt(c):0;break;case"height":this.adjustWidth();this.m_nOriginHeight=SBGrid.DEF.is_smartphone?parseInt(c):0;break;case"allowbigselection":this.allowBigSelection=("true"==c);break;case"allowselection":this.allowSelection=("true"==c);break;case"allowuserresize":this.allowUserResize=("true"==c);break;case"backcoloralternate":this.backColorAlternate=c;break;case"col":this.mouseCol=parseInt(c);break;case"dataheight":this.dataHeight=parseInt(c);this.setDataHeight(this.dataHeight);break;case"deleteflagimage":this.m_strDeleteFlagImage=(""==c?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHDelete:c);break;case"ellipsis":var b="true"==c?true:false;this.setEllipsis(b);break;case"extendlastcol":this.setExtendLastCol(c);break;case"explorerbar":this.setExplorerBar(c);break;case"explorerui":this.setExplorerUI(c);break;case"focuscolor":this.setFocusColor(c);break;case"insertflagimage":this.m_strInsertFlagImage=(""==c?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHInsert:c);break;case"multitotal":this.multiTotals="true"==c?true:false;break;case"normalflagimage":this.m_strNormalFlagImage=(""==c?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHNew:c);break;case"row":this.mouseRow=parseInt(c);break;case"rowheight":this.m_bIsRowHeight=true;this.m_nRowHeight=parseInt(c);break;case"subtotalposition":this.subtotalPosition=c;break;case"updateflagimage":this.m_strUpdateFlagImage=(""==c?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHUpdate:c);break;case"datatype":if(c=="delimeter"){if(this.jsonref==""){strJsonRef=this.id+"_delimeterData";this.attribute.jsonref=strJsonRef;this.jsonref=strJsonRef;SBGrid.DEF.m_arLightgrid.push({id:this.id,nodeset:this.nodeset,jsonref:this.id+"_delimeterData"});this.m_xlRefNode=this.getControlNodeList()}}else{}}};SBGrid.CT.DataGrid.prototype.adjustWidth=function(){if(!SBGrid.DEF.is_smartphone){if(null!=this.m_heWhole){if(0<this.frozenBottomRows){this.m_heFFC.style.height=(this.m_heWhole.clientHeight-this.m_heFFNS.clientHeight)+"px"}else{this.m_heFFC.style.height=this.m_heWhole.clientHeight-this.getFixedFrozenRowHeight()+"px"}this.__FFRowMove();this.bottomRowMove()}}};SBGrid.CT.DataGrid.prototype.setAllowBigSelection=function(a){this.attribute.allowbigselection=new String(a);this.allowBigSelection=a};SBGrid.CT.DataGrid.prototype.setAllowSelection=function(a){this.attribute.allowselection=new String(a);this.allowSelection=a};SBGrid.CT.DataGrid.prototype.setAllowUserResize=function(a){this.attribute.allowuserresize=new String(a);this.allowUserResize=a};SBGrid.CT.DataGrid.prototype.setCellBCAColor=function(b,c){var a=this.getCellEx(b,c);if(null!=a.m_heCtrl){if((((b)-this.fixedRows)%2)==1){a.m_heCtrl.style.backgroundColor=this.backColorAlternate}else{a.m_heCtrl.style.backgroundColor=""}}};SBGrid.CT.DataGrid.prototype.setBackColorFrozen=function(b,a){if(null==a||!a){if(""!=b){this.attribute.backcolorfrozen=b;this.backColorFrozen=b;if(null==a){jQuery('td[rowNum^="'+this.id+'"][frozencell="true"]').css("background-color",b)}}}};SBGrid.CT.DataGrid.prototype.setForeColorFrozen=function(b,a){if(""!=b){this.attribute.foreColorFrozen=b;this.foreColorFrozen=b;if(null==a){jQuery('td[rowNum^="'+this.id+'"][frozencell="true"]').css("color",b)}}};SBGrid.CT.DataGrid.prototype.defaultAttributeStyleSetting=function(a){if(this.backColorAlternate){this.setBackColorAlternate(this.backColorAlternate,a)}if(this.backColorFrozen){this.setBackColorFrozen(this.backColorFrozen,a)}};SBGrid.CT.DataGrid.prototype.defaultAttributeSetting=function(a){this.defaultAttributeStyleSetting(a);this.reSetRowHidden();this._rCH();this.setAutoResize(this.autoResize,true);this.setExtendLastCol(this.extendLastCol);this.setExplorerBar(this.explorerbar);this.setExplorerUI(this.explorerui);this.setNewLineHeader();if(SBGrid.DEF.is_smartphone){this.extendGrid();if("visible"==this.getAttribute("overflow")){this.m_heCtrl.style.width=this.m_heWhole.firstChild.clientWidth+"px";this.m_heCtrl.style.height=this.m_heWhole.firstChild.clientHeight+"px";var b=document.getElementById("SBHE_DATAGRID_EXPANSION_"+this.id);b.style.display="none"}}};SBGrid.CT.DataGrid.prototype.setNewLineHeader=function(){if(this.m_bIsRealDataSync==false&&this.m_bIsSort){var c=this.fixedRows;for(var b=this.fixedRows;b<this.m_nRealRows;b++){var a=this.getCellEx(b,0);if(null!=a&&!a.m_bIsSubTotal){if(this.m_arSortJson[c-this.fixedRows]!=undefined){if(this.isJsonRef()){this.setRowStatus(b,this.m_arSortJson[c-this.fixedRows][this.cols])}else{this.setRowStatus(b,this.m_arSortNodeList[c-this.fixedRows][this.cols])}}c++}}}};SBGrid.CT.DataGrid.prototype.applyCellValign=function(){var d=null;var e=null;for(var c=this.fixedCols;c<this.cols;c++){var d=this.m_arColumn[c];if(null!=d){e=d.getAttribute("type");if("inputdate"==e||"inputbutton"==e||"outputbutton"==e){var b=null;for(var a=this.fixedRows;a<this.m_nRealRows;a++){b=this.getCellEx(a,c);if(null!=b){b.m_heCtrl.vAlign="top"}}b=null}}}objColl=null;e=null};SBGrid.CT.DataGrid.prototype.applyCellStyle=function(a){for(var e=0;e<this.m_nRealRows;e++){if(!this.isPhysicalRow(e)){continue}for(var c=0;c<this.cols;c++){var d=this.getCellEx(e,c);if(null!=d){for(var b in d.m_objCellStyle){if(SBGrid.DEF.SB_STYLELIST[b]){if(a){d.attribute[b]=d.m_objCellStyle[b]}else{d.setAttribute(b,d.m_objCellStyle[b])}}}}}}};SBGrid.CT.DataGrid.prototype.setNodeset=function(b){var a=this.attribute.nodeset;if(null!=a&&!a.isEmpty()){if(null!=SBGrid.DEF.SB_REF_ATTR[a]){SBGrid.DEF.SB_REF_ATTR[a][this.id]=null}}this.m_arUpdateDeleteList=new Array();this.attribute.nodeset=b;this.nodeset=b;if(null!=b&&!b.isEmpty()){if(null==SBGrid.DEF.SB_REF_ATTR[b]){SBGrid.DEF.SB_REF_ATTR[b]={};SBGrid.DEF.SB_REF_ATTR[b][this.id]=this}else{SBGrid.DEF.SB_REF_ATTR[b][this.id]=this}this.m_bBinded=true}this.rebuild();this.m_xlRefNode=this.getControlNodeList()};SBGrid.CT.DataGrid.prototype.setFocusColor=function(a){if(""!=a.trim()){this.attribute.focuscolor=a;this.focusColor=a}this.applyFocusColorCss(a)};SBGrid.CT.DataGrid.prototype.setTableWidthChange=function(a){var c=this.m_heWhole.firstChild;var d;var b;if(null!=this.m_heFFS){d=this.m_heFFS.firstChild;heFFScrollTBody=d.firstChild}if(null!=this.m_heFFBS){b=this.m_heFFBS.firstChild}if(null!=c){c.style.width=a+"px"}if(null!=d){d.style.width=a+"px"}if(null!=b){b.style.width=a+"px"}};SBGrid.CT.DataGrid.prototype.physicalRemovePartRow=function(s,c,b){if(null==b){b=this.m_nRealRows}var o=this.fixedCols+this.frozenCols;var r=this.fixedRows+this.frozenRows;var g=b-this.frozenBottomRows;var l=this.frozenBottomRows-this.m_nBottomRowCount;var q=this.m_heWhole.firstChild;var f=q.lastChild;if(!SBGrid.DEF.is_smartphone){var e;var i;var p;var n;var h;var a;var d;if(null!=this.m_heFFS){e=this.m_heFFS.firstChild;i=e.lastChild;p=this.m_heFFNS.firstChild.lastChild;n=this.m_heFFC.firstChild.lastChild;h=this.m_heFFBS.firstChild;a=null!=h?h.lastChild:null;d=null!=this.m_heFFBNS.firstChild?this.m_heFFBNS.firstChild.lastChild:null}for(var t=c;t>=s;t--){if(null!=f.children[t]){f.removeChild(f.children[t]);if(t<(r)){if(null!=i.children[t]){i.removeChild(i.children[t])}}if(t<(r)&&null!=p){if(null!=p.children[t]){p.removeChild(p.children[t])}}if(t>=(r)&&null!=false){if(null!=n.children[t-r]){n.removeChild(n.children[t-r])}}}if(t>=g&&t>=r&&null!=a){var m=a.children[(t+1)-(g+l)];if(null!=m&&"undefined"!=m){a.removeChild(m)}if(null!=d.children[t-(g+l)]){d.removeChild(d.children[t-(g+l)])}l--;this.m_nBottomRowCount--}}}else{for(var t=c;t>=s;t--){f.removeChild(f.children[t])}}};SBGrid.CT.DataGrid.prototype.physicalRemoveCell=function(v,u){var p=this.fixedCols+this.frozenCols;var s=this.fixedRows+this.frozenRows;var i=this.m_nRealRows-this.frozenBottomRows;var r=this.m_heWhole.firstChild;var f=r.lastChild;if(!SBGrid.DEF.is_smartphone){var d;var m;var q;var n;var l;var a;var c;if(null!=this.m_heFFS){d=this.m_heFFS.firstChild;m=d.lastChild;q=this.m_heFFNS.firstChild.lastChild;n=this.m_heFFC.firstChild.lastChild;l=this.m_heFFBS.firstChild;a=l.lastChild;c=this.m_heFFBNS.firstChild.lastChild}var g=f.children[v];if(null!=g){g.removeChild(g.children[u])}if(v<(s)){var e=m.children[v];if(null!=e){e.removeChild(e.children[u])}}if(u<p){if(v<(s)&&null!=q){var h=q.children[v];if(null!=h){h.removeChild(h.children[u])}}if(v>=(s)&&null!=false){var o=n.children[v-s];if(null!=o){o.removeChild(o.children[u])}}if(v>=i){var t=c.children[v-i];if(null!=t){t.removeChild(t.children[u])}}}if(v>=i){var b=a.children[v-i];if(null!=b){b.removeChild(b.children[u])}}}else{var g=f.children[v];if(null!=g){g.removeChild(g.children[u])}}};SBGrid.CT.DataGrid.prototype.physicalCreateCell=function(i,b,d,J,F,N,L,H){L=null==L?0:L;H=null==H?0:H;var U=null!=this.m_xlRefNode?this.m_xlRefNode.length:0;var X=this.fixedCols+this.frozenCols;var a=this.fixedRows+this.frozenRows;var z=this.m_nRealRows-this.frozenBottomRows;var M=this.m_heWhole.firstChild;var ab=M.lastChild;var s=i<this.fixedRows?this.m_nRowHeight:this.dataHeight;if(s>0&&!(SBGrid.DEF.is_mozBrowser)){s--}var Y=false;var K="";var m=SBGrid.DEF.is_ie?this.m_heCtrl.currentStyle.textAlign:window.getComputedStyle(this.m_heCtrl,null).textAlign;switch(m){case"center":K=" sbgrid_ac";break;case"right":K=" sbgrid_ar";break}var B=null;var V=null;if(this.fixedRows<=(i+L)){if(this.isJsonRef()){V=this.m_xlRefNode[(i+L)-this.fixedRows]}else{B=this.m_xlRefNode.item((i+L)-this.fixedRows)}if(""!=this.backColorAlternate&&(((i+L)-this.fixedRows)%2)==1){Y=true}else{Y=false}}if(!SBGrid.DEF.is_smartphone){var t;var C;var Q;var e;var I;var T;var r;if(null!=this.m_heFFS){t=this.m_heFFS.firstChild;C=t.lastChild;Q=this.m_heFFNS.firstChild.lastChild;e=this.m_heFFC.firstChild.lastChild;I=this.m_heFFBS.firstChild;T=I.lastChild;r=this.m_heFFBNS.firstChild.lastChild;if(null==C){C=document.createElement("tbody");t.appendChild(C)}if(null==Q){Q=document.createElement("tbody");this.m_heFFNS.firstChild.appendChild(Q)}if(null==e){e=document.createElement("tbody");this.m_heFFC.firstChild.appendChild(e)}if(null==T){T=document.createElement("tbody");I.appendChild(T)}if(null==r){r=document.createElement("tbody");this.m_heFFBNS.firstChild.appendChild(r)}}var aa=false;var O=true;var W=true;if(this.m_nRealRows>this.fixedRows+this.frozenRows&&this.frozenBottomRows>0){aa=true}if(aa&&(i+L)>=z&&!N){O=false}var D=this.m_arColumn[b];var o=this.id+"_"+(i+L)+"_"+(b);var h=null!=D.attribute["class"]?D.attribute["class"]:"";if(O){var x=K;var ad=D.getAttribute("type");if("checkbox"==ad||"radio"==ad){x=" sbgrid_ac"}if("inputdate"==ad||"inputbutton"==ad||"outputbutton"==ad){x+=" sbgrid_vat"}var Z=null;if(d){var c=document.createElement("tr");c.setAttribute("targetcell","who");c.setAttribute("rowNum",this.id+"_"+(i+L));if(null!=ab.children[i]){ab.insertBefore(c,ab.children[i]);Z=c}else{ab.appendChild(c);Z=c}}else{if(null!=ab.children[i]){Z=ab.children[i]}else{var c=document.createElement("tr");c.setAttribute("targetcell","who");c.setAttribute("rowNum",this.id+"_"+(i+L));ab.appendChild(c);Z=c}}if(null!=Z){var S="";var P={};if(this.m_nRealRows>this.fixedRows+this.frozenCols&&this.frozenBottomRows>0){aa=true}if(aa&&i>=z){W=false}if(i<this.fixedRows+this.frozenRows||b<this.fixedCols+this.frozenCols){W=false}var ag=new Array();if(W){ag.push('<TD id="SBHE_'+o+"\" valign ='middle' rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'who' ")}else{ag.push("<TD rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'who' ")}if(SBGrid.DEF.is_ie6){if(D.m_bHiddenState||0==this.m_arHiddenCol[b]){P.display="none"}}P.height=s+"px";ag.push(" class='");if(i<this.fixedRows||b<this.fixedCols){ag.push("sbgrid_datagrid_FixedCell ");ag.push("sbgrid_"+this.id+"_fixed ");ag.push(this.m_strClassFixed+"'")}else{ag.push("sbgrid_datagrid_DataCell");ag.push(x);ag.push(" sbgrid_"+this.id+"_col_"+D.id);ag.push(" sbgrid_"+this.id+"_data ");ag.push(this.m_strClassData+" "+h+"'");P["background-color"]="";P["background-color"]=W&&Y?this.backColorAlternate:P["background-color"]}var q="";if(!W){ag.push(" style='"+this.getStyleString(P)+"'>");ag.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');ag.push('border-top-color:transparent; border-left-color:transparent;"></div>')}else{if(J){if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}ag.push(" style='"+this.getStyleString(P)+"'>");var G=this.autoResize?"break-word":"normal";ag.push("<div id='"+o+"_data' style=\"border-right-color:transparent; border-bottom-color:transparent; ");ag.push("border-top-color:transparent; border-left-color:transparent;word-wrap:"+G+';">');if(!this.autoResize){ag.push('<span style="white-space:nowrap;"></span>')}ag.push("</div>")}else{var n=null;var l=null;if(null!=D){var ac=D.getAttribute("ref");if(this.isJsonRef()){l=V}else{n=SBGrid.UT.XmlLib.selectSingleNode(B,ac)}if(null!=l){q=V[ac]+""}else{if(null!=n){q=SBGrid.UT.XmlLib.getTextValue(n)}}}if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);this.setLinkedData(p,n,l);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}ag.push(" style='"+this.getStyleString(P)+"'>");ag.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}}ag.push("</TD>");if(Z.children[b]){jQuery(Z.children[b]).before(ag.join(""))}else{jQuery(Z).append(ag.join(""))}}if(i<(a)&&null!=C){if(d){var c=document.createElement("tr");c.setAttribute("targetcell","ffs");c.setAttribute("rowNum",this.id+"_"+(i+L));if(null!=C.children[i]){C.insertBefore(c,C.children[i]);heFFScrollRow=c}else{C.appendChild(c);heFFScrollRow=c}}else{heFFScrollRow=i<a?C.children[i]:null;if(null==heFFScrollRow){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffs");C.appendChild(c);heFFScrollRow=c}}if(null!=heFFScrollRow){var S="";var P={};var W=(i<this.fixedRows+this.frozenRows&&b>=this.fixedCols+this.frozenCols);var af=W&&(i>=this.fixedRows);var v=new Array();if(W){v.push('<TD id="SBHE_'+o+"\" valign ='middle' rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffs' ");if(af){v.push("frozencell='true' ")}}else{v.push("<TD rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffs' ")}if((SBGrid.DEF.is_ie)&&(!SBGrid.DEF.is_ie7)){if(D.m_bHiddenState||0==this.m_arHiddenCol[b]){}}P.height=s+"px";v.push(" class='");if(i<this.fixedRows||b<this.fixedCols){v.push("sbgrid_datagrid_FixedCell ");v.push("sbgrid_"+this.id+"_fixed ");v.push(this.m_strClassFixed+"'")}else{v.push("sbgrid_datagrid_DataCell");v.push(x);v.push(" sbgrid_"+this.id+"_col_"+D.id);v.push(" sbgrid_"+this.id+"_data ");v.push(this.m_strClassData+" "+h+"'");P["background-color"]="";P["background-color"]=W&&Y?this.backColorAlternate:P["background-color"];P["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:P["background-color"]}var q="";if(W){if(i<this.fixedRows){if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,i,"softbowl:cell"):p;p.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}if(this.m_arCaption[i][b]){q=this.m_arCaption[i][b].newlineCharConvert()}v.push(" style='"+this.getStyleString(P)+"'>");v.push('<span style="border-right-color:transparent; border-bottom-color:transparent; ');v.push('border-top-color:transparent; border-left-color:transparent;"><span style="white-space:nowrap;">'+q+"</span></span>")}else{if(J){if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}v.push(" style='"+this.getStyleString(P)+"'>");var G=this.autoResize?"break-word":"normal";v.push("<div id='"+o+"_data' style=\"border-right-color:transparent; border-bottom-color:transparent; ");v.push("border-top-color:transparent; border-left-color:transparent;word-wrap:"+G+';">');if(!this.autoResize){v.push('<span style="white-space:nowrap;"></span>')}v.push("</div>")}else{var n=null;var l=null;if(null!=D){var ac=D.getAttribute("ref");if(this.isJsonRef()){l=V}else{n=SBGrid.UT.XmlLib.selectSingleNode(B,ac)}if(null!=l){q=l[V]+""}else{if(null!=n){q=SBGrid.UT.XmlLib.getTextValue(n)}}}if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);this.setLinkedData(p,n,l);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}v.push(" style='"+this.getStyleString(P)+"'>");v.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}}}else{v.push(" style='"+this.getStyleString(P)+"'>");v.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');v.push('border-top-color:transparent; border-left-color:transparent;"></div>')}v.push("</TD>");if(heFFScrollRow.children[b]){jQuery(heFFScrollRow.children[b]).before(v.join(""))}else{jQuery(heFFScrollRow).append(v.join(""))}}}}if(b<X){if(i<(a)&&null!=Q){if(d){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffn");if(null!=Q.children[i]){Q.insertBefore(c,Q.children[i]);heFFNoScrollRow=c}else{Q.appendChild(c);heFFNoScrollRow=c}}else{heFFNoScrollRow=i<a?Q.children[i]:null;if(null==heFFNoScrollRow){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffn");Q.appendChild(c);heFFNoScrollRow=c}}if(null!=heFFNoScrollRow){var S="";var P={};var W=(i<this.fixedRows+this.frozenRows&&b<this.fixedCols+this.frozenCols);var af=W&&(i>=this.fixedRows&&b>=this.fixedCols);var A=new Array();if(W){A.push('<TD id="SBHE_'+o+"\" valign ='middle' rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffn' ");if(af){A.push("frozencell = 'true' ")}}else{A.push("<TD rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffn' ")}if((SBGrid.DEF.is_ie)&&(!SBGrid.DEF.is_ie7)){if(D.m_bHiddenState||0==this.m_arHiddenCol[b]){}}P.height=s+"px";A.push(" class='");if(i<this.fixedRows||b<this.fixedCols){A.push("sbgrid_datagrid_FixedCell ");A.push("sbgrid_"+this.id+"_fixed ");A.push(this.m_strClassFixed+"'")}else{A.push("sbgrid_datagrid_DataCell");A.push(x);A.push(" sbgrid_"+this.id+"_col"+b);A.push(" sbgrid_"+this.id+"_data ");A.push(this.m_strClassData+" "+h+"'");P["background-color"]="";P["background-color"]=W&&Y?this.backColorAlternate:P["background-color"];P["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:P["background-color"]}var q="";if(W){if(i<this.fixedRows){if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}if(this.m_arCaption[i][b]){q=this.m_arCaption[i][b].newlineCharConvert()}A.push(" style='"+this.getStyleString(P)+"'>");A.push('<span style="border-right-color:transparent; border-bottom-color:transparent; ');A.push('border-top-color:transparent; border-left-color:transparent;"><span style="white-space:nowrap;">'+q+"</span></span>")}else{var n=null;var l=null;if(null!=D){var ac=D.getAttribute("ref");if(ac.isEmpty()){if(this.m_bRowHeader&&0==b){if("seq"==this.rowheader){q=i-this.fixedRows+i}else{if("reverseseq"==this.rowheader){q=U-(i-this.fixedRows)}}}}else{if(this.isJsonRef()){l=V}else{n=SBGrid.UT.XmlLib.selectSingleNode(B,ac)}if(null!=l){q=l[ac]+""}else{if(null!=n){q=SBGrid.UT.XmlLib.getTextValue(n)}}}}if(J){if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}if(b<this.fixedCols&&!(this.m_bRowHeader&&0==b)){A.push(" style='"+this.getStyleString(P)+"'>");A.push(q)}else{if(b<this.fixedCols&&this.m_bRowHeader){A.push(" style='"+this.getStyleString(P)+"'>");A.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}else{A.push(" style='"+this.getStyleString(P)+"'>");var G=this.autoResize?"break-word":"normal";A.push("<div id='"+o+"_data' style=\"border-right-color:transparent; border-bottom-color:transparent; ");A.push("border-top-color:transparent; border-left-color:transparent;word-wrap:"+G+';">');if(!this.autoResize){A.push('<span style="white-space:nowrap;"></span>')}A.push("</div>")}}}else{if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);this.setLinkedData(p,n,l);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}if(b<this.fixedCols&&!(this.m_bRowHeader&&0==b)){A.push(" style='"+this.getStyleString(P)+"'>");A.push(q)}else{A.push(" style='"+this.getStyleString(P)+"'>");A.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}}}}else{A.push(" style='"+this.getStyleString(P)+"'>");A.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');A.push('border-top-color:transparent; border-left-color:transparent;"></div>')}A.push("</TD>");if(heFFNoScrollRow.children[b]){jQuery(heFFNoScrollRow.children[b]).before(A.join(""))}else{jQuery(heFFNoScrollRow).append(A.join(""))}}}if(O&&i>=(a)&&null!=false&&null!=e){if(d){var c=document.createElement("tr");c.setAttribute("targetcell","ffc");c.setAttribute("rowNum",this.id+"_"+(i+L));if(null!=e.children[i-(a)]){e.insertBefore(c,e.children[i-(a)]);heFFColRow=c}else{e.appendChild(c);heFFColRow=c}}else{heFFColRow=(i-(a)>=0)?e.children[i-(a)]:null;if(null==heFFColRow){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffc");e.appendChild(c);heFFColRow=c}}if(null!=heFFColRow){var S="";var P={};var W=(i>=this.fixedRows);W=i<(this.m_nRealRows-this.frozenBottomRows);var af=W&&(b>=this.fixedCols);var R=new Array();if(W){R.push('<TD id="SBHE_'+o+"\" valign ='middle'  rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffs' ");if(af){R.push("frozencell='true' ")}}else{R.push("<TD  rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffs' ")}if((SBGrid.DEF.is_ie)&&(!SBGrid.DEF.is_ie7)){if(D.m_bHiddenState||0==this.m_arHiddenCol[b]){}}P.height=s+"px";R.push(" class='");if(i<this.fixedRows||b<this.fixedCols){R.push("sbgrid_datagrid_FixedCell ");R.push("sbgrid_"+this.id+"_fixed ");R.push(this.m_strClassFixed+"'")}else{R.push("sbgrid_datagrid_DataCell");R.push(x);R.push(" sbgrid_"+this.id+"_col_"+D.id);R.push(" sbgrid_"+this.id+"_data ");R.push(this.m_strClassData+" "+h+"'");P["background-color"]="";P["background-color"]=W&&Y?this.backColorAlternate:P["background-color"];P["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:P["background-color"]}var q="";if(!W){R.push(" style ='"+this.getStyleString(P)+"'>");R.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');R.push('border-top-color:transparent; border-left-color:transparent;"></div>')}else{var n=null;var l=null;if(null!=D){var ac=D.getAttribute("ref");if(ac.isEmpty()){if(this.m_bRowHeader&&0==b){if("seq"==this.rowheader){q=i-this.fixedRows+1}else{if("reverseseq"==this.rowheader){q=U-(i-this.fixedRows)}}}}else{if(this.isJsonRef()){l=V}else{n=SBGrid.UT.XmlLib.selectSingleNode(B,ac)}if(null!=l){q=l[ac]+""}else{if(null!=n){q=SBGrid.UT.XmlLib.getTextValue(n)}}}}if(b<this.fixedCols&&!(this.m_bRowHeader&&0==b)){if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}R.push(" style ='"+this.getStyleString(P)+"'>");R.push(q)}else{if(J&&b>=this.fixedCols){if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}R.push(" style ='"+this.getStyleString(P)+"'>");var G=this.autoResize?"break-word":"normal";R.push("<div id='"+o+"_data' style=\"border-right-color:transparent; border-bottom-color:transparent; ");R.push("border-top-color:transparent; border-left-color:transparent;word-wrap:"+G+';">');if(!this.autoResize){R.push('<span style="white-space:nowrap;"></span>')}R.push("</div>")}else{if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);this.setLinkedData(p,n,l);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}R.push(" style ='"+this.getStyleString(P)+"'>");R.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}}}R.push("</TD>");if(heFFColRow.children[b]){jQuery(heFFColRow.children[b]).before(R.join(""))}else{jQuery(heFFColRow).append(R.join(""))}R=null}}if(i>=(z)&&i>=a&&null!=r){var ae=null;if(d){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffbn");if(null!=r.children[this.m_nBottomRowCount]){r.insertBefore(c,r.children[this.m_nBottomRowCount]);ae=c}else{r.appendChild(c);ae=c}}else{ae=i>=(z)?r.children[this.m_nBottomRowCount]:null;if(null==ae){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffbn");r.appendChild(c);ae=c}}if(null!=ae){var S="";var P={};var W=(b<this.fixedCols+this.frozenCols);var af=W&&(b>=this.fixedCols);var g=new Array();g.push("<TD rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffbn' ");if(W){g.push('id="SBHE_'+o+"\" valign ='middle' ");if(af){g.push("frozencell='true' ")}}if((SBGrid.DEF.is_ie)&&(!SBGrid.DEF.is_ie7)){if(D.m_bHiddenState||0==this.m_arHiddenCol[b]){}}P.height=s+"px";g.push(" class=");if(i<this.fixedRows||b<this.fixedCols){g.push("'sbgrid_datagrid_BFixedCell ");g.push("sbgrid_"+this.id+"_fixed ");g.push(this.m_strClassFixed+"'")}else{g.push("'sbgrid_datagrid_BDataCell");g.push(x);g.push(" sbgrid_"+this.id+"_col_"+D.id);g.push(" sbgrid_"+this.id+"_data ");g.push(this.m_strClassData+" "+h+"'");P["background-color"]="";P.color="";P["background-color"]=W&&Y?this.backColorAlternate:P["background-color"];P["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:P["background-color"];P.color=(""!=this.foreColorFrozen)?this.foreColorFrozen:P.color}var q="";if(W){if(i<this.fixedRows){if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}if(this.m_arCaption[i][b]){q=this.m_arCaption[i][b].newlineCharConvert()}g.push(" style='"+this.getStyleString(P)+"'>");g.push('<span style="border-right-color:transparent; border-bottom-color:transparent; ');g.push('border-top-color:transparent; border-left-color:transparent;"><span style="white-space:nowrap;">'+q+"</span></span>")}else{var n=null;var l=null;if(null!=D){var ac=D.getAttribute("ref");if(ac.isEmpty()){if(this.m_bRowHeader&&0==b){if("seq"==this.rowheader){q=i-this.fixedRows+1}else{if("reverseseq"==this.rowheader){q=U-(i-this.fixedRows)}}}}else{if(this.isJsonRef()){l=V}else{n=SBGrid.UT.XmlLib.selectSingleNode(B,ac)}if(null!=l){q=l[ac]+""}else{if(null!=n){q=SBGrid.UT.XmlLib.getTextValue(n)}}}}if(J){if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}if(b<this.fixedCols&&!(this.m_bRowHeader&&0==b)){g.push(" style='"+this.getStyleString(P)+"'>");g.push(q)}else{if(b<this.fixedCols&&this.m_bRowHeader){g.push(" style='"+this.getStyleString(P)+"'>");g.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}else{g.push(" style='"+this.getStyleString(P)+"'>");var G=this.autoResize?"break-word":"normal";g.push("<div id='"+o+"_data' style=\"border-right-color:transparent; border-bottom-color:transparent; ");g.push("border-top-color:transparent; border-left-color:transparent;word-wrap:"+G+';">');if(!this.autoResize){g.push('<span style="white-space:nowrap;"></span>')}g.push("</div>")}}}else{if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);this.setLinkedData(p,n,l);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}if(b<this.fixedCols&&!(this.m_bRowHeader&&0==b)){g.push(" style='"+this.getStyleString(P)+"'>");g.push(q)}else{g.push(" style='"+this.getStyleString(P)+"'>");g.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}}}}else{g.push(" style='"+this.getStyleString(P)+"'>");g.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');g.push('border-top-color:transparent; border-left-color:transparent;"></div>')}g.push("</TD>");if(ae.children[b]){jQuery(ae.children[b]).before(g.join(""))}else{jQuery(ae).append(g.join(""))}}}}if(i>=(z)&&i>=a&&null!=T){var f=null;if(d){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffbs");if(null!=T.children[this.m_nBottomRowCount]){T.insertBefore(c,T.children[this.m_nBottomRowCount]);f=c}else{T.appendChild(c);f=c}}else{f=i>=(z)?T.children[this.m_nBottomRowCount]:null;if(null==f){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffbs");T.appendChild(c);f=c}}if(null!=f){var S="";var P={};var W=(b>=this.fixedCols+this.frozenCols);var w=new Array();w.push("<TD rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffbs' ");if(W){w.push('id="SBHE_'+o+"\" valign ='middle' frozencell='true' ")}if((SBGrid.DEF.is_ie)&&(!SBGrid.DEF.is_ie7)){if(D.m_bHiddenState||0==this.m_arHiddenCol[b]){}}P.height=s+"px";w.push(" class=");if(i<this.fixedRows||b<this.fixedCols){w.push("'sbgrid_datagrid_BFixedCell ");w.push("sbgrid_"+this.id+"_fixed ");w.push(this.m_strClassFixed+"'")}else{w.push("'sbgrid_datagrid_BDataCell");w.push(x);w.push(" sbgrid_"+this.id+"_col_"+D.id);w.push(" sbgrid_"+this.id+"_data ");w.push(this.m_strClassData+" "+h+"'");P["background-color"]="";P.color="";P["background-color"]=W&&Y?this.backColorAlternate:P["background-color"];P["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:P["background-color"];P.color=(""!=this.foreColorFrozen)?this.foreColorFrozen:P.color}var q="";if(W){if(J){if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}w.push(" style='"+this.getStyleString(P)+"'>");var G=this.autoResize?"break-word":"normal";w.push("<div id='"+o+"_data' style=\"border-right-color:transparent; border-bottom-color:transparent; ");w.push("border-top-color:transparent; border-left-color:transparent;word-wrap:"+G+';">');if(!this.autoResize){w.push('<span style="white-space:nowrap;"></span>')}w.push("</div>")}else{var n=null;var l=null;if(null!=D){var ac=D.getAttribute("ref");if(this.isJsonRef()){l=V}else{n=SBGrid.UT.XmlLib.selectSingleNode(B,ac)}if(null!=l){q=l[ac]+""}else{if(null!=n){q=SBGrid.UT.XmlLib.getTextValue(n)}}}if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);this.setLinkedData(p,n,l);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}w.push(" style='"+this.getStyleString(P)+"'>");w.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}}else{w.push(" style='"+this.getStyleString(P)+"'>");w.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');w.push('border-top-color:transparent; border-left-color:transparent;"></div>')}w.push("</TD>");if(f.children[b]){jQuery(f.children[b]).before(w.join(""))}else{jQuery(f).append(w.join(""))}}}}else{var P={};var Z=null;if(d){var c=document.createElement("tr");if(null!=ab.children[i]){ab.insertBefore(c,ab.children[i]);Z=c}else{ab.appendChild(c);Z=c}}else{if(null!=ab.children[i]){Z=ab.children[i]}else{var c=document.createElement("tr");ab.appendChild(c);Z=c}}var D=this.m_arColumn[b];var o=this.id+"_"+i+"_"+b;var E;E='<td onmousedown=" "onmousemove=" "onmouseup=" "ondblclick=" "onkeydown=" "onkeypress=" "onkeyup=" " id="SBHE_'+o+"\" valign='middle'>";P.height=s+"px";P["text-align"]=(""==this.getAttribute("text-align"))?"left":this.getAttribute("text-align");P["border-right-style"]="solid";P["border-bottom-style"]="solid";P["border-right-width"]="1px";P["border-bottom-width"]="1px";P.overflow="hidden";if(true!=F){var p=this.getCellByIdEx(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,i,"softbowl:cell"):p;p.setElement(D);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}var q="";if(i<this.fixedRows||b<this.fixedCols){P["text-align"]="center";P["background-color"]="#D4D0C8";P["border-right-color"]="#6F6F5F";P["border-bottom-color"]="#6F6F5F";this.setBaseCellStyle(P,"fixed")}else{P["background-color"]="#FFFFFF";P["border-right-color"]="#D4D0C8";P["border-bottom-color"]="#D4D0C8";this.setColStyleInheritanceCell(P,b);this.setBaseCellStyle(P,"data");P["background-color"]=W&&Y?this.backColorAlternate:P["background-color"];if(i<(this.fixedRows+this.frozenRows)||b<(this.fixedCols+this.frozenCols)){P["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:P["background-color"]}}if(i<this.fixedRows){if(this.m_arCaption[i][b]){q=this.m_arCaption[i][b].newlineCharConvert()}E=E.insertAttribute("style",this.getStyleString(P));E+=q}else{if(null!=D){var ac=D.getAttribute("ref");if(ac.isEmpty()){if(this.m_bRowHeader&&0==b){if("seq"==this.rowheader){q=i-this.fixedRows+1}else{if("reverseseq"==this.rowheader){q=U-(i-this.fixedRows)}}}}else{if(this.isJsonRef()){l=V}else{n=SBGrid.UT.XmlLib.selectSingleNode(B,ac)}if(null!=l){q=l[ac]+""}else{if(null!=n){q=SBGrid.UT.XmlLib.getTextValue(n)}}}}if(b<this.fixedCols&&!(this.m_bRowHeader&&0==b)){E=E.insertAttribute("style",this.getStyleString(P));E+=q}else{if(J&&b>=this.fixedCols){E=E.insertAttribute("style",this.getStyleString(P));var G=this.autoResize?"break-word":"normal";var u="<div id='"+o+"_data' style=\"border-right-color:transparent; border-bottom-color:transparent; border-top-color:transparent; border-left-color:transparent;word-wrap:"+G+';">';if(!this.autoResize){u+='<span style="white-space:nowrap;"></span>'}u+="</div>";var y=u;E+=y;S=y}else{if(true!=F){this.setLinkedData(p,n,l)}var ad=D.getAttribute("type");if("checkbox"==ad||"radio"==ad){P["text-align"]="center"}E=E.insertAttribute("style",this.getStyleString(P));E+=D.makeCellElement(q,this.m_arColWidth[b],o,P)}}}E+="</TD>";jQuery(Z).html(jQuery(Z).html()+E);if(Z.children[b]){Z.insertBefore(Z.lastChild,Z.children[b])}}};SBGrid.CT.DataGrid.prototype.applyColStyleInheritanceCellCSS=function(){var b;for(var c=0;c<this.m_arColumn.length;c++){b=this.m_arColumn[c];if(null!=b){var f=b.attribute;var e=new Array();for(var a in f){if(SBGrid.DEF.SB_STYLELIST[a]){if("background-image"!=SBGrid.DEF.SB_STYLELIST[a]){e.push(a+":"+f[a]+";")}else{var d=f[a];if(-1==d.indexOf("url")&&-1==d.indexOf("URL")){e.push(a+":url("+f[a]+");")}else{e.push(a+":"+f[a]+";")}}}}SBGrid.DEF.makeStyleSheetClass("sbgrid_"+this.id+"_col_"+b.id,e.join(""))}}};SBGrid.CT.DataGrid.prototype.setColStyleInheritanceCell=function(d,f,c){var b=this.m_arColumn[f];if(null!=b){var e=b.attribute;if("tag"==c){for(var a in e){if(SBGrid.DEF.SB_STYLELIST[a]){SBGrid.UT.HtmlLib.setStyle(d,a,e[a])}}}else{for(var a in b.attribute){if(SBGrid.DEF.SB_STYLELIST[a]){d[a]=b.attribute[a]}}}}};SBGrid.CT.DataGrid.prototype.getStyleString=function(c){var b=new Array();for(var a in c){if(SBGrid.DEF.SB_STYLELIST[a]){b.push((a+":"+c[a]+";"))}}return b.join("")};SBGrid.CT.DataGrid.prototype.userGridCss=function(){this.m_strClassFixed="";this.m_strClassFixed+=null!=this.attribute.datagrid_fixed?this.attribute.datagrid_fixed+" ":"";this.m_strClassFixed+=null!=this.attribute.datagrid_gridfixedcell?this.attribute.datagrid_gridfixedcell+" ":"";this.m_strClassFixed+=null!=this.attribute["datagrid_fixed-cell"]?this.attribute["datagrid_fixed-cell"]+" ":"";this.m_strClassData="";this.m_strClassData+=null!=this.attribute.datagrid_data?this.attribute.datagrid_data+" ":"";this.m_strCGInput="";this.m_strCGInput+=null!=this.attribute.datagrid_gridinput?this.attribute.datagrid_gridinput+" ":"";this.m_strCGInput+=null!=this.attribute.datagrid_input?this.attribute.datagrid_input+" ":"";this.m_strCGTextarea="";this.m_strCGTextarea+=null!=this.attribute.datagrid_gridtextarea?this.attribute.datagrid_gridtextarea+" ":"";this.m_strCGTextarea+=null!=this.attribute.datagrid_textarea?this.attribute.datagrid_textarea+" ":"";this.m_strCGButton="";this.m_strCGButton+=null!=this.attribute.datagrid_gridbutton?this.attribute.datagrid_gridbutton+" ":""};SBGrid.CT.DataGrid.prototype.setDefaultThemeName=function(){var a=document.getElementsByTagName("link");var f="";var b="";for(var d=0;d<a.length;d++){var e=a[d].href.split("/");for(var c=0;c<e.length;c++){if(e[c]=="Sbgrid_default.css"){this.m_default_theme="default"}}}};SBGrid.CT.DataGrid.prototype.applyFocusColorCss=function(){var e=this.focusColor,a=this.getAttribute("selectfontcolor"),d="";var c="";var b="";if(this.m_default_theme=="default"){c="white";b="#3161C6"}if(a==""){a=c}if(null!=e&&""!=e){d="background-color:"+e+" !important;"}else{d="background-color:"+b+" !important;"}if(""!=this.m_style_theme&&"undefined"!=this.m_style_theme){switch(this.m_style_theme){case"metal":if(a==""){a="#000000"}if(null==e||""==e){d="background-color:#EBF6FA !important;"}break;case"blue":if(a==""){a="#000000"}if(null==e||""==e){d="background-color:#EBF4FA !important;"}break;case"gray":if(a==""){a="#EAEAEA"}if(null==e||""==e){d="background-color:#4B4B4B !important;"}break;case"pink":if(a==""){a="#660033"}if(null==e||""==e){d="background-color:#FFF2FF !important;"}break;case"desert":if(a==""){a="#660033"}if(null==e||""==e){d="background-color:#A7DBD8 !important;"}break;case"pastelblue":if(a==""){a="#660033"}if(null==e||""==e){d="background-color:#8AA8CC !important;"}break;case"claret":if(a==""){a="#FFFFFF"}if(null==e||""==e){d="background-color:#DA5859 !important;"}break;case"darkgray":if(a==""){a="#808080"}if(null==e||""==e){d="background-color:#F9F198 !important;"}break;case"graypurple":if(a==""){a="#727272"}if(null==e||""==e){d="background-color:#DADDF5 !important;"}break;case"lightgreen":if(a==""){a="#6C7D74"}if(null==e||""==e){d="background-color:#BFE1D0 !important;"}break;case"oceanblue":if(a==""){a="#5a5d5f"}if(null==e||""==e){d="background-color:#BADDB1 !important;"}break;case"blackgray":if(a==""){a="#464849"}if(null==e||""==e){d="background-color:#CCCBE5 !important;"}break;case"pinkgray":if(a==""){a="#5A5D5F"}if(null==e||""==e){d="background-color:#F8BACD !important;"}break;case"bluishgreen":if(a==""){a="#5A5D5F"}if(null==e||""==e){d="background-color:#FEE299 !important;"}break;case"skyblue":if(a==""){a="#636e7b"}if(null==e||""==e){d="background-color:#C5DCF0 !important;"}break;default:if(a==""){a=jQuery(this.m_heCtrl).css("background-color")}}if("none"!=this.selectFontColorStyle){d+="color:"+a+" !important;"}}if("none"!=this.selectFontColorStyle){d+="color:"+a+" !important;"}d+="font-weight : bold;";SBGrid.DEF.makeStyleSheetClass("sbgrid_"+this.id+"_focusColor",d);if(""!=this.m_strCellFocusColor){var f="background-color:"+this.m_strCellFocusColor+" !important;";if("none"!=this.selectFontColorStyle){f+="color:"+a+" !important;"}f+="font-weight : bold;";SBGrid.DEF.makeStyleSheetClass("sbgrid_"+this.id+"_CellfocusColor",f)}};SBGrid.CT.DataGrid.prototype.applyBaseCellCSS=function(c){var e;if("fixed"==c){e=this.m_htFixedStyle}else{e=this.m_htDataStyle}var d=new Array();for(var a in e){if(SBGrid.DEF.SB_STYLELIST[a]){if("background-image"!=SBGrid.DEF.SB_STYLELIST[a]){d.push(a+":"+e[a]+";")}else{var b=e[a];if(-1==b.indexOf("url")&&-1==b.indexOf("URL")){d.push(a+":url("+e[a]+");")}else{d.push(a+":"+e[a]+";")}}}}SBGrid.DEF.makeStyleSheetClass("sbgrid_"+this.id+"_"+c,d.join(""))};SBGrid.CT.DataGrid.prototype.setBaseCellStyle=function(c,b,e){var d;if("fixed"==b){d=this.m_htFixedStyle}else{d=this.m_htDataStyle}if(null==d){return}if("tag"==e){for(var a in d){if(SBGrid.DEF.SB_STYLELIST[a]){SBGrid.UT.HtmlLib.setStyle(c,a,d[a])}}}else{for(var a in d){if(SBGrid.DEF.SB_STYLELIST[a]){c[a]=d[a]}}}};SBGrid.CT.DataGrid.prototype._removeDivStyle=function(){this.m_heCtrl.style.textAlign=""};SBGrid.CT.DataGrid.prototype.loadExcel=function(a,c,q,b){if(arguments.length<4){SBGrid.DEF.APIerrorMsg(this.id+".loadExcel","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".loadExcel","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof c)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".loadExcel","Please check if second parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof q)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".loadExcel","Please check if 3rd parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof b)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".loadExcel","Please check if 4th parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(b==""){return}var r=q!=null?q:"json";var p=document.getElementById(a).value;if(null==this.m_heLodExcelForm){this.m_heLodExcelForm=document.getElementById(c);this.m_heLodExcelForm.setAttribute("enctype","multipart/form-data");this.m_heLodExcelForm.action=b;this.m_heLodExcelForm.method="post";this.m_heLodExcelForm.target="SBHE___SB_LoadExcel"}if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7){var v="<input type='hidden' name='nodeset'/>";v+="<input type='hidden' name='Type' id='SBHE___SB_ExcelLoad_Type' value='"+r+"'/>";v+="<input type='file' name='excel' value='"+p+"' />";jQuery(this.m_heLodExcelForm).html(v)}else{var u=document.createElement("input");u.type="hidden";u.name="nodeset";var d=document.createElement("input");d.type="hidden";d.name="Type";d.value=r;this.m_heLodExcelForm.appendChild(u);this.m_heLodExcelForm.appendChild(d)}if(null!=this.parent.m_heCtrl){this.parent.m_heCtrl.appendChild(this.m_heLodExcelForm)}if(this.isJsonRef()){if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7){var s="<input type='hidden' name='targetGrid' value='"+this.m_strTargetGrid+"'/>";s+="<input type='hidden' name='gridJsonRef' value='"+m_strGridJsonReg+"'/>";jQuery(this.m_heLodExcelForm).html(s)}else{var e=document.createElement("input");e.type="hidden";e.name="targetGrid";e.value=this.m_strTargetGrid;var g=document.createElement("input");g.type="hidden";g.name="gridJsonRef";g.value=this.m_strGridJsonReg;this.m_heLodExcelForm.appendChild(e);this.m_heLodExcelForm.appendChild(g)}}var m=p;m=m.substring(m.lastIndexOf(".")+1,m.length).toLowerCase();if("xlsx"!=m&&"xls"!=m&&"cell"!=m){SBGrid.DEF.errorMsg("올바른 Excel File 형식이 아닙니다.");return}var h=document.SBHE_allElement.item(this.m_strTargetGrid);if(null!=h){var l=h.nodeset+"@";var o=true;for(var t=0;t<h.m_arColumn.length;t++){var f=h.m_arColumn[t].getAttribute("ref");if(""!=f.trim()){if(o){l+=f;o=false}else{l+=","+f}}}u.value=encodeURI(l+"@"+m)}else{SBGrid.DEF.errorMsg("Load Excel을 적용할 Target Grid가 존재하지 않습니다.");return}SBGrid.DEF.SBLE_GRID=this.m_strTargetGrid;SBGrid.DEF.SBLE_BUTTON=this;var n=document.getElementById("SBHE___SB_LoadExcel");if(n){n.setAttribute("targetGrid",this.m_strTargetGrid);if(n.attachEvent){n.attachEvent("onload",SBGrid.CT.Button.uploadComplete)}else{n.addEventListener("load",SBGrid.CT.Button.uploadComplete,false)}}this.m_heLodExcelForm.submit()};SBGrid.CT.DataGrid.prototype.loadHcell=function(b,a,d,c){if(arguments.length<4){SBGrid.DEF.APIerrorMsg(this.id+".loadHcell","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof b)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".loadHcell","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".loadHcell","Please check if second parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof d)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".loadHcell","Please check if 3rd parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof c)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".loadHcell","Please check if 4th parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(c==""){return}this.loadExcel(b,a,d,c)};SBGrid.CT.DataGrid.prototype.saveExcel=function(strFileName,strAction,bSaveComboLabel){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".saveExcel","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof strFileName)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".saveExcel","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof strFileName)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".saveExcel","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(strAction==""){return}if(bSaveComboLabel==undefined){bSaveComboLabel=true}else{if((typeof bSaveComboLabel)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".saveExcel","Please check if 3rd parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}var docDatagrid=SBGrid.UT.XmlLib.createXML("datagrid");var xnDatagrid=docDatagrid.firstChild;xnDatagrid.setAttribute("caption",this.caption);xnDatagrid.setAttribute("dataHeight",this.dataHeight);xnDatagrid.setAttribute("rowHeight",this.m_nRowHeight);var xnFixedCell=SBGrid.UT.XmlLib.createChild(xnDatagrid,"fixedcell");xnFixedCell.setAttribute("fontFamily",this.m_objFixedCell.attribute["font-family"]);xnFixedCell.setAttribute("fontSize",this.m_objFixedCell.attribute["font-size"]);xnFixedCell.setAttribute("fontWeight",this.m_objFixedCell.attribute["font-weight"]);xnFixedCell.setAttribute("fontStyle",this.m_objFixedCell.attribute["font-style"]);xnFixedCell.setAttribute("color",this.m_objFixedCell.attribute.color);xnFixedCell.setAttribute("textAlign",this.m_objFixedCell.attribute["text-align"]);xnFixedCell.setAttribute("textDecoration",this.m_objFixedCell.attribute["text-decoration"]);xnFixedCell.setAttribute("verticalAlign",this.m_objFixedCell.attribute["vertical-align"]);xnFixedCell.setAttribute("backgroundColor",this.m_objFixedCell.attribute["background-color"]);xnFixedCell.setAttribute("borderColor",this.m_objFixedCell.attribute["border-color"]);xnFixedCell.setAttribute("borderLeftColor",this.m_objFixedCell.attribute["border-left-color"]);xnFixedCell.setAttribute("borderTopColor",this.m_objFixedCell.attribute["border-top-color"]);xnFixedCell.setAttribute("borderRightColor",this.m_objFixedCell.attribute["border-right-color"]);xnFixedCell.setAttribute("borderBottomColor",this.m_objFixedCell.attribute["border-bottom-color"]);xnFixedCell.setAttribute("borderWidth",this.m_objFixedCell.attribute["border-width"]);xnFixedCell.setAttribute("borderLeftWidth",this.m_objFixedCell.attribute["border-left-width"]);xnFixedCell.setAttribute("borderTopWidth",this.m_objFixedCell.attribute["border-top-width"]);xnFixedCell.setAttribute("borderRightWidth",this.m_objFixedCell.attribute["border-right-width"]);xnFixedCell.setAttribute("borderBottomWidth",this.m_objFixedCell.attribute["border-bottom-width"]);xnFixedCell.setAttribute("borderStyle",this.m_objFixedCell.attribute["border-style"]);xnFixedCell.setAttribute("borderLeftStyle",this.m_objFixedCell.attribute["border-left-style"]);xnFixedCell.setAttribute("borderTopStyle",this.m_objFixedCell.attribute["border-top-style"]);xnFixedCell.setAttribute("borderRightStyle",this.m_objFixedCell.attribute["border-right-style"]);xnFixedCell.setAttribute("borderBottomStyle",this.m_objFixedCell.attribute["border-bottom-style"]);for(var i=(0+this.m_bRowHeader?1:0);i<this.cols;i++){var objColumn=this.m_arColumn[i];var xnCol=SBGrid.UT.XmlLib.createChild(xnDatagrid,"col");xnCol.setAttribute("ref",objColumn.attribute.ref);xnCol.setAttribute("width",this.m_arColWidth[i]);xnCol.setAttribute("fontFamily",objColumn.attribute["font-family"]);xnCol.setAttribute("fontSize",objColumn.attribute["font-size"]);xnCol.setAttribute("fontWeight",objColumn.attribute["font-weight"]);xnCol.setAttribute("fontStyle",objColumn.attribute["font-style"]);xnCol.setAttribute("color",objColumn.attribute.color);xnCol.setAttribute("textAlign",objColumn.attribute["text-align"]);xnCol.setAttribute("borderColor",objColumn.attribute["border-color"]);xnCol.setAttribute("borderWidth",objColumn.attribute["border-width"]);xnCol.setAttribute("borderStyle",objColumn.attribute["border-style"]);xnCol.setAttribute("verticalAlign",objColumn.attribute["vertical-align"]);xnCol.setAttribute("backgroundColor",objColumn.attribute["background-color"]);xnCol.setAttribute("textDecoration",objColumn.attribute["text-decoration"]);xnCol.setAttribute("borderLeftColor",objColumn.attribute["border-left-color"]);xnCol.setAttribute("borderTopColor",objColumn.attribute["border-top-color"]);xnCol.setAttribute("borderRightColor",objColumn.attribute["border-right-color"]);xnCol.setAttribute("borderBottomColor",objColumn.attribute["border-bottom-color"]);xnCol.setAttribute("borderLeftWidth",objColumn.attribute["border-left-width"]);xnCol.setAttribute("borderTopWidth",objColumn.attribute["border-top-width"]);xnCol.setAttribute("borderRightWidth",objColumn.attribute["border-right-width"]);xnCol.setAttribute("borderBottomWidth",objColumn.attribute["border-bottom-width"]);xnCol.setAttribute("borderLeftStyle",objColumn.attribute["border-left-style"]);xnCol.setAttribute("borderTopStyle",objColumn.attribute["border-top-style"]);xnCol.setAttribute("borderRightStyle",objColumn.attribute["border-right-style"]);xnCol.setAttribute("borderBottomStyle",objColumn.attribute["border-bottom-style"])}var xnExcelDownForm=document.getElementById("SBHE___SB_ExcelDownload");var xnExcelDownName=document.getElementById("SBHE___SB_ExcelDownload_Name");var xnExcelDownData=document.getElementById("SBHE___SB_ExcelDownload_Data");var xnExcelDownData1=document.getElementById("SBHE___SB_ExcelDownload_Data1");var xnExcelDownType=document.getElementById("SBHE___SB_ExcelDownload_Type");if(null!=xnExcelDownForm&&null!=xnExcelDownData){var strDocDatagrid="";var strDocDatagrid1="";if(this.isJsonRef()){if(bSaveComboLabel){var arrGridData=SBGrid.DEF.__deepCopy(eval(this.jsonref));for(var j=this.fixedCols;j<this.cols;j++){if(this.getColType(j)=="combo"){var strRef=this.getRefOfCol(j);for(var i=this.fixedRows;i<this.rows;i++){arrGridData[i-this.fixedRows][strRef]=this.labelMatrix(i,j)}}}strDocDatagrid=JSON.stringify(arrGridData);arrGridData=null}else{strDocDatagrid=JSON.stringify(eval(this.jsonref))}strDocDatagrid1=SBGrid.UT.XmlLib.serializeToString(docDatagrid);xnExcelDownData1.value=strDocDatagrid1;xnExcelDownType.value="json"}else{strDocDatagrid=SBGrid.UT.XmlLib.serializeToString(docDatagrid);xnExcelDownType.value="xml"}xnExcelDownName.value=strFileName;xnExcelDownData.value=strDocDatagrid;if(SBGrid.DEF.is_chromeFrame){var strPath=SBGrid.DS.XMLStorage.getUniqueStorage().m_objHttpClient.post(strAction,"Name="+SBGrid.UT.URIEncoder.encode(strFileName,"UTF-8")+"&Data="+SBGrid.UT.URIEncoder.encode(strDocDatagrid,"UTF-8"),false,"application/x-www-form-urlencoded","utf-8",false);var heTargetIframe=document.getElementById("SBSBHE___SB_SaveExcelFrame");if(null!=heTargetIframe){heTargetIframe.src=SBGrid.DEF.__getAppName()+"kr/co/softbowl/jsp/download.jsp?ExcelDown=true&strFilePath="+SBGrid.DEF.__getAppName()+strPath}}else{xnExcelDownForm.setAttribute("action",strAction);xnExcelDownForm.submit()}}};SBGrid.CT.DataGrid.prototype.saveHcell=function(a,b,c){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".saveHcell","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".saveHcell","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".saveHcell","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(b==""){return}if(c==undefined){c=true}else{if((typeof c)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".saveHcell","Please check if 3rd parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}this.saveExcel(a,b,c)};SBGrid.CT.DataGrid.prototype.saveExcelEx=function(G,L,c,x,o){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".saveExcelEx","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof G)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".saveExcelEx","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(L==""){return}else{if((typeof L)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".saveExcelEx","Please check if second parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(c==undefined){c=false}else{if((typeof c)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".saveExcelEx","Please check if 3rd parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(x==undefined){x=false}else{if((typeof x)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".saveExcelEx","Please check if 4th parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(o==undefined){o=true}else{if((typeof o)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".saveExcelEx","Please check if 5th parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}var D=new SBGrid.DS.Map();D.add("font-weight","fontWeight");D.add("font-style","fontStyle");D.add("text-align","textAlign");D.add("vertical-align","verticalAlign");D.add("background-color","backgroundColor");D.add("color","color");var s={};s.strFileName=G;s.strType="JSON";s.arrCaption=null;s.arrColWidth=null;s.arrColRef=[];s.objFixedRowsStyleInfo={};s.objDefaultColStyleInfo={};s.objCellStyleInfo={};s.arrData=[];s.arrCaption=SBGrid.DEF.__deepCopy(this.m_arCaption);s.arrColWidth=SBGrid.DEF.__deepCopy(this.m_arColWidth);if(x==false){if(this.m_arColWidth.length!=this.m_arColumn.length){SBGrid.DEF.APIerrorMsg(this.id+".saveExcelEx","Please check m_arColWidth's count is "+this.m_arColumn.length.toString()+".",SBGrid.DEF.DEBUG_MODE);return}for(var K=0;K<s.arrCaption.length;K++){if(s.arrCaption[K].length!=this.m_arColumn.length){SBGrid.DEF.APIerrorMsg(this.id+".saveExcelEx","Please check m_arCaption's count is "+this.m_arColumn.length.toString()+".",SBGrid.DEF.DEBUG_MODE);return}else{for(var J=this.m_arColumn.length-1;J>=0;J--){if(this.m_arColumn[J].m_bHiddenState||this.m_arColWidth[J]<1){s.arrCaption[K].splice(J,1)}}}}for(var J=this.m_arColumn.length-1;J>=0;J--){if(this.m_arColumn[J].m_bHiddenState||this.m_arColWidth[J]<1){s.arrColWidth.splice(J,1)}}}else{var w=SBGrid.DEF.linearSearch(s.arrColWidth,0);while(w!=-1){s.arrColWidth[w]=100;w=SBGrid.DEF.linearSearch(s.arrColWidth,0)}}if(c){for(var K=0;K<this.fixedRows;K++){var A={};var y=0;var N=0;for(var J=0;J<this.cols;J++){if(x==false&&(this.m_arColumn[J].m_bHiddenState||this.m_arColWidth[J]<1)){y++;continue}var f=this.getCellEx(K,J);if(f){if(f.m_heCtrl){var t={};var B=D.keys();var z=0;for(var I=0;I<B.length;I++){var M=jQuery(f.m_heCtrl).css(B[I]);if(B[I].indexOf("color")!=-1){M=SBGrid.DEF.rgb2hex(M)}if(B[I]=="font-style"){if(M=="normal"){M=""}}if(M!=""){t[B[I]]=M;z++}M=null}if(z>0){A[(J-y).toString()]=SBGrid.DEF.__deepCopy(t);N++}SBGrid.DEF.destroy(t);t=B=z=null}}f=null}if(N>0){s.objFixedRowsStyleInfo[K.toString()]=SBGrid.DEF.__deepCopy(A)}SBGrid.DEF.destroy(A);A=y=N=null}for(var J=0;J<this.cols;J++){var F={};var y=0;if(x==false&&(this.m_arColumn[J].m_bHiddenState||this.m_arColWidth[J]<1)){continue}for(var I=0,C=J;I<C;I++){if(x==false&&(this.m_arColumn[I].m_bHiddenState||this.m_arColWidth[J]<1)){y++}}var l=this.m_arColumn[J].m_strStyle;if(l!=""){var p=l.split(";");var q=p.indexOf("");while(q!=-1){p.splice(q,1);q=p.indexOf("")}for(var I=0,r=p.length;I<r;I++){var b=p[I].split(":");var v=b[0].trim();var e=b[1];if(D.find(v)!=undefined){e=e.replace(/!important/gi,"");if(v.indexOf("color")!=-1){e=SBGrid.DEF.rgb2hex(e);e=SBGrid.DEF.colorNameToHex(e,true)}else{if(v.indexOf("font-weight")!=-1){if(e=="normal"){e="400"}else{if(e=="bold"||e=="bolder"){e="700"}else{if(e=="lighter"){e="100"}else{if(e=="initial"||e=="inherit"){continue}}}}}}}F[v]=e}s.objDefaultColStyleInfo[J-y]=F}}if(o){var a=this.m_mapGridStyleInfo.keys();a.sort(SBGrid.DEF.numberASC);for(var K=0,m=a.length;K<m;K++){if(parseInt(a[K])<this.fixedRows){continue}var A={};var N=0;var n=this.m_mapGridStyleInfo.find(a[K]);var g=n.keys();g.sort(SBGrid.DEF.numberASC);for(var J=0,h=g.length;J<h;J++){var y=0;if(x==false&&(this.m_arColumn[parseInt(g[J])].m_bHiddenState||this.m_arColWidth[parseInt(g[J])]<1)){continue}for(var I=0,C=parseInt(g[J]);I<C;I++){if(x==false&&(this.m_arColumn[I].m_bHiddenState||this.m_arColWidth[I]<1)){y++}}var E=n.find(g[J]);var t={};var B=D.keys();var z=0;for(var I=0;I<B.length;I++){var M=E[B[I]];if(M==undefined){continue}else{if(B[I]!="background-color"){M=M.replace(/!important/gi,"")}if(B[I].indexOf("color")!=-1){M=SBGrid.DEF.rgb2hex(M);M=SBGrid.DEF.colorNameToHex(M,true)}else{if(B[I].indexOf("font-weight")!=-1){if(M=="normal"){M="400"}else{if(M=="bold"||M=="bolder"){M="700"}else{if(M=="lighter"){M="100"}else{if(M=="initial"||M=="inherit"){continue}}}}}}t[B[I]]=M;z++}M=null}if(z>0){A[(parseInt(g[J])-y).toString()]=SBGrid.DEF.__deepCopy(t);N++}SBGrid.DEF.destroy(t);y=E=t=B=z=null}if(N>0){s.objCellStyleInfo[a[K]]=SBGrid.DEF.__deepCopy(A)}SBGrid.DEF.destroy(A);A=N=n=null}SBGrid.DEF.clearArray(a);a=null}}if(o){var d=SBGrid.DEF.__deepCopy(this.m_xlRefNode);for(var J=this.fixedCols;J<this.cols;J++){if(null!=this.m_arColumn[J]){if(x==false&&(this.m_arColumn[J].m_bHiddenState||this.m_arColWidth[J]<1)){continue}var u=this.m_arColumn[J].getAttribute("ref");s.arrColRef.push(u);if(this.getColType(J)=="combo"){var H=this.getRefOfCol(J);for(var K=this.fixedRows;K<this.rows;K++){d[K-this.fixedRows][H]=this.labelMatrix(K,J)}}u=null}}s.arrData=d}if(s.arrColWidth.length<s.arrColRef.length){while(s.arrColWidth.length<s.arrColRef.length){s.arrColWidth.push(100)}}else{if(s.arrColWidth.length>s.arrColRef.length){while(s.arrColWidth.length>s.arrColRef.length){s.arrColWidth.pop()}}}s.strTimes=new Date().getTime();jQuery.download(L,{SBHE___SB_ExcelDownload_Data:JSON.stringify(s)},"post");SBGrid.DEF.destroy(s);D.clear();D=s=heExcelDownForm=heExcelDownData=null};SBGrid.CT.DataGrid.prototype.saveHcellEx=function(a,d,b,e,c){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".saveHcellEx","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".saveHcellEx","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(d==""){return}else{if((typeof d)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".saveHcellEx","Please check if second parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(b==undefined){b=false}else{if((typeof b)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".saveHcellEx","Please check if 3rd parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e==undefined){e=false}else{if((typeof e)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".saveHcellEx","Please check if 4th parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(c==undefined){c=true}else{if((typeof c)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".saveHcellEx","Please check if 5th parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}this.saveExcelEx(a,d,b,e,c)};SBGrid.CT.DataGrid.onClickExpansion=function(a,i){var f=this.getCellByIdEx(i);var h=document.getElementById("SBHE_"+i);var d=document.getElementById("SBHE_DATAGRID_WHOLE_"+i);var e=document.getElementById("SBHE_DATAGRID_EXPANSION_"+i);if(null!=h){if(!f.bIsExpansion){f.bIsExpansion=true;h.style.width=d.scrollWidth+"px";h.style.height=d.scrollHeight+"px";e.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgGridReturn;var g=h.offsetLeft+h.offsetWidth;var m=h.offsetTop+h.offsetHeight;var b=window.scrollX+window.innerWidth;var l=window.scrollY+window.innerHeight;var c=((g)>b)&&0<b?b:(g);var n=((m)>l)&&0<l?l:(m);e.style.left=(c-h.offsetLeft-20)+"px";e.style.top=(n-h.offsetTop-20)+"px"}else{f.bIsExpansion=false;h.style.width=f.m_nOriginWidth+"px";h.style.height=f.m_nOriginHeight+"px";e.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgGridExpansion;e.style.top=(h.offsetHeight-20)+"px";e.style.left=(h.offsetWidth-20)+"px"}window.setTimeout("SBGrid.getGrid('"+f.id+'\').dispatch("smartexpansion")',0)}};SBGrid.DEF.doSearch=function(strSBGridID){var objTargetGrid=eval(strSBGridID);var valueId=document.getElementById(strSBGridID+"_searchingData_inputtext").value;var bchecked=document.getElementById(strSBGridID+"_searchingData_checkbox");var checked=bchecked.checked;var resultId=document.getElementById(strSBGridID+"_searchingData_resultTxt");var crrentCnt="";objTargetGrid.clearSelection();if(checked){if(this.actionFlg){objTargetGrid.m_strDataSearchHistory="";this.actionFlg=false}if(objTargetGrid.m_strDataSearchHistory!=valueId){arrList=[];objTargetGrid.m_nDataSearchResultCount=0;cntClick=0;objTargetGrid.rebuild();var nGridcols=objTargetGrid.cols;var nGridrows=objTargetGrid.rows;for(var i=0;i<nGridrows;i++){for(var j=0;j<nGridcols;j++){var objCell=objTargetGrid.getCellEx(i,j);if(null!=objCell){var strCellValue=SBGrid.CF.GridGetText(objCell);if(strCellValue.indexOf(valueId)!=-1){arrList.push({nRow:i,nCol:j,seq:objTargetGrid.m_nDataSearchResultCount});objTargetGrid.m_nDataSearchResultCount++}}}}}objTargetGrid.m_strDataSearchHistory=valueId}else{if(!this.actionFlg){objTargetGrid.m_strDataSearchHistory="";this.actionFlg=true}if(objTargetGrid.m_strDataSearchHistory!=valueId){objTargetGrid.m_nDataSearchResultCount=0;arrList=[];cntClick=0;objTargetGrid.rebuild();var nGridcols=objTargetGrid.cols;var nGridrows=objTargetGrid.rows;for(var i=0;i<nGridrows;i++){for(var j=0;j<nGridcols;j++){var objCell=objTargetGrid.getCellEx(i,j);if(null!=objCell){var strCellValue=SBGrid.CF.GridGetText(objCell);strCellValue=strCellValue.toUpperCase();var test=valueId;test=test.toUpperCase();if(strCellValue.indexOf(test)!=-1){arrList.push({nRow:i,nCol:j,seq:objTargetGrid.m_nDataSearchResultCount});objTargetGrid.m_nDataSearchResultCount++}}}}}objTargetGrid.m_strDataSearchHistory=valueId;this.actionFlg=true}if(objTargetGrid.m_nDataSearchResultCount==0){resultId.value="Can't find the text '"+valueId+"'";cntClick=0;jQuery("#"+objTargetGrid.id+"_sbgrid_searchingData_inputtext").focus()}else{cntClick++;resultId.value="Search result : "+(arrList[cntClick-1].seq+1)+"/"+arrList.length;objTargetGrid.setCol(arrList[cntClick-1].nCol);objTargetGrid.setTopRow(arrList[cntClick-1].nRow);jQuery("#"+objTargetGrid.id+"_searchingData_inputtext").focus()}if(arrList.length==cntClick){cntClick=0}if(cntClick==objTargetGrid.m_nDataSearchResultCount){cntClick=0}objTargetGrid=null};SBGrid.DEF.doClose=function(strSBGridID){var objTargetGrid=eval(strSBGridID);var searchId=document.getElementById(strSBGridID+"_searchingData_inputtext");searchId.value="";jQuery("#SBHE_DATAGRID_SEARCHING_DATA_"+objTargetGrid.id).hide()};SBGrid.DEF.dokeyEvntSearching=function(b){var c=this.m_heWhole;if(event.ctrlKey&&event.keyCode==67){if(document.getElementById(b+"_searchingData_checkbox").checked==false){document.getElementById(b+"_searchingData_checkbox").checked=true}else{document.getElementById(b+"_searchingData_checkbox").checked=false}}else{if((event.ctrlKey&&event.keyCode==77)||event.keyCode==13){SBGrid.DEF.doSearch(b)}}if((event.ctrlKey&&event.keyCode==70)){var a=document.getElementById("SBHE_DATAGRID_SEARCHING_DATA_"+b);if(a.style.display=="block"){cntClick=0;document.getElementById(b+"_searchingData_inputtext").value="";document.getElementById(b+"_searchingData_resultTxt").value="Search result : ";jQuery("#SBHE_DATAGRID_SEARCHING_DATA_"+b).hide();SBGrid.DEF.setFocus(b)}}};SBGrid.DEF.doClickcheckbox=function(c){var f=SBGrid.getGrid(c);var g=f.getCol();var e=f.getRow();var a="fixedCheckbox_"+f.id+"_"+g;var b=document.getElementById(a);if(f&&b){var i=f.getCellEx(e,f.getMouseCol());if(i){var h=i.m_fixedCheckStatus;f.setFixedcellcheckboxChecked(i.row,i.col,!h);h=null;var d=f.getCellEx(e,g);if(d){if(d.m_fixedCheckStatus){b.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgCheck;b.style.verticalAlign="middle"}else{b.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgUnCheck;b.style.verticalAlign="middle"}}d=null}}};SBGrid.CT.DataGrid.prototype.smartexpansion=function(){};SBGrid.DEF.onkeydownGridSummary=function(event,strId){var GridId=eval(strId);var nRow=GridId.getFixedRows();var nCol=GridId.getFixedCols();var objFirstDataCell=GridId.getCellEx(GridId.getFixedRows(),GridId.getFixedCols());if(objFirstDataCell){var objFirstDataCellElement=objFirstDataCell.m_heDCtrl;if(objFirstDataCellElement){SBGrid.DEF.setFocus(objFirstDataCell.id);GridId.setTopRow(GridId.getFixedRows());GridId.setCol(GridId.getFixedCols());objFirstDataCellElement.tabIndex="0";document.getElementById(GridId.parentId).focus();GridId.m_heCtrl.focus();if(GridId.row==nRow&&GridId.col==nCol){document.getElementById("SBHE_"+GridId.id).removeAttribute("onKeyDown")}}else{GridId.setTopRow(GridId.getFixedRows());GridId.m_bScrollMoveFirstCell=true}}};SBGrid.CT.DataGrid.prototype.extendGrid=function(){if(this.bIsExpansion){this.bIsExpansion=false;SBGrid.CT.DataGrid.onClickExpansion(event,this.id)}};SBGrid.CT.DataGrid.prototype.isMerge=function(b,c){if(null!=b&&null!=c){var a=this.getCellEx(b,c);if(null!=a){if(SBGrid.DEF.SBSM_MERGED==a.mergeType||SBGrid.DEF.SBSM_HIDE==a.mergeType){return true}return false}return false}return false};SBGrid.CT.DataGrid.prototype.merge=function(){this.mergeCancellation(this.m_arMergeFixedRowList,this.m_htMergeFRColList);this.mergeCancellation(this.m_arMergeFixedColList,this.m_htMergeFCColList);this.mergeCancellation(this.m_arMergeList,this.m_htMergeColList);this.m_arMergeFixedRowList=new Array();this.m_arMergeFixedColList=new Array();this.m_arMergeList=new Array();this.m_htMergeFRColList={};this.m_htMergeFCColList={};this.m_htMergeColList={};this.mergeFixedRows();this.mergeFixedCols();this.mergeDataCells()};SBGrid.CT.DataGrid.prototype.mergeArea=function(b,f,e){if(null==e||""==e){e=","}if(this.isMerge(b,f)){var a=this.getCellEx(b,f);if(null!=a){a=this.getCellByIdEx(a.mergeParentId);var c=a.m_heCtrl;var d=a.row+e+a.col+e;d+=(a.row+c.rowSpan-1)+e;d+=(a.col+c.colSpan-1);a=null;c=null;return d}return""}else{var a=this.getCellEx(b,f);if(null!=a){var d=(a.row+e+a.col+e+a.row+e+a.col);a=null;return d}return""}};SBGrid.CT.DataGrid.prototype.setMergeByFree=function(f,b,d,g,c,a,e){if(arguments.length!=5&&arguments.length!=6&&arguments.length!=7){SBGrid.DEF.APIerrorMsg(this.id+".setMergeByFree","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof f!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setMergeByFree","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setMergeByFree","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof d!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setMergeByFree","Please check if third parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof g!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setMergeByFree","Please check if forth parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setMergeByFree","Please check if forth parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}if(0>f||0>b){return}if(c==true){this.mergeByFree(f,b,d,g,a,e)}else{if(c==false){this.unmergeByFree(f,b,d,g)}}};SBGrid.CT.DataGrid.prototype.getMergeByFree=function(b,c){if(arguments.length!=2){SBGrid.DEF.APIerrorMsg(this.id+".getMergeByFree","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getMergeByFree","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getMergeByFree","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}var a=this.getCellEx(b,c);return a.m_bMergeByFree};SBGrid.CT.DataGrid.prototype.mergeByFree=function(I,G,b,K,z,s,c){var e=this.m_arMergeByFreeList;var n=this.m_htMergeBFColList;var A=true;var x;var t;var v=null;var q=this._gridLastCol();var J=new Array();var f=(!(SBGrid.DEF.is_mozBrowser))?1:0;var h=this.getTextMatrix(I,G);if(this.getColType(G)=="combo"){h=this.getColCombo(G).getComboLabel(h)}if(h==undefined||h=="null"){h=""}if(this.getColType(G)=="output"){if(z!=null&&z!=undefined){h=z}}for(var E=I;E<=b;E++){for(var C=G;C<=K;C++){t=this.getCellEx(E,C);if(null!=t){if(E==I&&C==G){if(this.isFixedCell(E,C)){return}x=this.isFrozenCell(E,C)}else{if(x!=this.isFrozenCell(E,C)){return}}}else{return}}}if(x){}else{for(var E=G;E<=K;E++){for(var C=I;C<=b;C++){if(this.isMerge(C,E)==true){return}}}this.m_bIsMergeByFree=true;if((c==undefined||c==null)&&c!=true){if(this.m_mapMergeByFree!=null){var r=I+"_"+G;this.m_mapMergeByFree.add(r,arguments)}}var m=this.m_objScroll.nTopRow;if(m!=1&&m>I){I=m}if(m>I&&this.m_objScroll.nBottomRow<b){b=this.m_objScroll.nBottomRow}if(I>b){return}var o=null;var t=null;var v=null;for(var E=G;E<=K;E++){o=this.m_arColumn[E];for(var C=I;C<=b;C++){t=this.getCellEx(C,E);t.m_bMergeByFree=true;if(null!=t){if(SBGrid.DEF.SBSM_LOCK==t.mergeType){t.mergeType=SBGrid.DEF.SBSM_NORMAL}v=t.m_heCtrl;var p=null;var l=b-I+1;if(v!=null){if(SBGrid.DEF.SBSM_NORMAL==t.mergeType||SBGrid.DEF.SBSM_MERGED==t.mergeType){var H=false;for(var B=C+1;B<=b;B++){p=this.getCellEx(B,E);if(null!=p&&null!=p.m_heCtrl){if(p.m_bMerge){H=true;p.mergeType=SBGrid.DEF.SBSM_HIDE;p.mergeParentId=t.id;this.m_heMergeCell.appendChild(p.m_heCtrl)}else{break}}else{break}}if(H){if(this.fixedCols==0){v.style.height=(this.getMergePartRowHeight(C,B)-f)+"px"}if(SBGrid.DEF.SBSM_MERGED!=t.mergeType){e.push(t)}v.rowSpan=l;t.m_nRowSpan=l;t.mergeType=SBGrid.DEF.SBSM_MERGED;t.mergeParentId=t.id}}p=null}v=null}t=null}}for(var E=I;E<=b;E++){for(var C=G;C<=K;C++){o=this.m_arColumn[C];t=this.getCellEx(E,C);if(null!=t&&null!=o){if(SBGrid.DEF.SBSM_LOCK==t.mergeType){t.mergeType=SBGrid.DEF.SBSM_NORMAL}v=t.m_heCtrl;t.m_bMergeByFree=true;if(v!=null){var H=false;var a=false;var g=false;var l=K-G+1;var y=null;for(var B=C+1;B<=K;B++){o=this.m_arColumn[B];y=this.getCellEx(E,B);if(null!=y&&null!=o){if(SBGrid.DEF.SBSM_LOCK==y.mergeType){y.mergeType=SBGrid.DEF.SBSM_NORMAL}if(t.m_nRowSpan==y.m_nRowSpan&&y.m_bMerge){if(SBGrid.DEF.is_ie9){if(B==q){a=true}}if(SBGrid.DEF.SBSM_MERGED==y.mergeType){g=true}H=true;y.mergeType=SBGrid.DEF.SBSM_HIDE;y.mergeParentId=t.id;if(null==n[this.id+"_"+B]){n[this.id+"_"+B]={targetCol:y.m_heCtrl.getAttribute("targetcell"),width:this.m_arColWidth[B]}}this.m_heMergeCell.appendChild(y.m_heCtrl);y.m_heCtrl.rowSpan=1}else{break}}else{break}}if(H){v.colSpan=l;t.m_nColSpan=l;if(!g){t.mergeType=SBGrid.DEF.SBSM_MERGED;t.mergeParentId=t.id;e.push(t)}if(a){var w=v.parentNode.parentNode;var F=w.querySelectorAll("td[colNum="+this.id+"_"+q+"]");if(0==F.length){var d=w.parentNode;var D=d.querySelector("col[colNum="+this.id+"_"+C+"]");if(null!=D){if(null==this.m_arIe9MergeCellWidth){this.m_arIe9MergeCellWidth=new Array()}this.m_arIe9MergeCellWidth.push({target:D,width:D.style.width,nStartCol:C,nLastCol:q})}}}}}v=null}t=null}}var u=this.getCellEx(I,G);SBGrid.CF.GridSetWindowText(u,h,false,"");if(s!=null&&s!=""){}}e=n=A=x=q=J=f=h=u=null};SBGrid.CT.DataGrid.prototype.reMergeByFree=function(){var c=this.m_mapMergeByFree;if(c.count()>0){for(var b=0;b<c.count();b++){var d=c.keys();var a=c.find(d[b]);this.mergeByFree(a[0],a[1],a[2],a[3],a[4],a[5],true)}}d,a=null};SBGrid.CT.DataGrid.prototype.mergeByFreeEx=function(c,a,b,d){};SBGrid.CT.DataGrid.prototype.unmergeByFree=function(f,a,c,h){this.mergeCancellation(this.m_arMergeByFreeList,this.m_htMergeBFColList);var e=this.m_mapMergeByFree;var b=f+"_"+a;if(e.count()>0){for(var d=0;d<e.count();d++){var g=e.keys();if(g[d]==b){this.m_mapMergeByFree.remove(g[d])}}}g,b=null;arMergeCancel=null;this.reMergeByFree()};SBGrid.CT.DataGrid.prototype.mergeByFreeClear=function(){this.unmergeByFreeAll()};SBGrid.CT.DataGrid.prototype.unmergeByFreeAll=function(){this.mergeCancellation(this.m_arMergeByFreeList,this.m_htMergeBFColList);this.m_mapMergeByFree.clear();this.refresh()};SBGrid.CT.DataGrid.prototype.mergeFreePartMakeCell=function(b,d,a,c){};SBGrid.CT.DataGrid.prototype.appendMergeCellMode=function(){this.setMergeCells(this.mergeCells);this.setMergeCellsFixedCols(this.mergeCellsFixedCols);this.setMergeCellsFixedRows(this.mergeCellsFixedRows)};SBGrid.CT.DataGrid.prototype.setMergeCellsFixedCols=function(a){if(this.autoMerge){if(this.mergeCellsFixedCols!=a){this.mergeCancellation(this.m_arMergeFixedColList,this.m_htMergeFCColList);this.m_htMergeFCColList={}}this.mergeCellsFixedCols=a;this.mergeFixedCols()}else{this.mergeCellsFixedCols=a}};SBGrid.CT.DataGrid.prototype.setMergeCellsFixedRows=function(a){if(this.autoMerge){if(this.mergeCellsFixedRows!=a){this.mergeCancellation(this.m_arMergeFixedRowList,this.m_htMergeFRColList);this.m_htMergeFRColList={}}this.mergeCellsFixedRows=a;this.mergeFixedRows()}else{this.mergeCellsFixedRows=a}};SBGrid.CT.DataGrid.prototype.mergeDataCells=function(){var b=null;var a=null;if(0<this.frozenRows){if(0<this.frozenCols){this.mergePartMakeCell(this.fixedRows,this.fixedCols,this.fixedRows+this.frozenRows,(this.fixedCols+this.frozenCols),this.mergeCells,this.m_arMergeList,"cell",this.m_htMergeColList,true)}this.mergePartMakeCell(this.fixedRows,(this.fixedCols+this.frozenCols),this.fixedRows+this.frozenRows,this.cols,this.mergeCells,this.m_arMergeList,"cell",this.m_htMergeColList,true)}if(0<this.m_nBottomRowCount){if(0<this.frozenCols){this.mergePartMakeCell(this.m_nRealRows-this.m_nBottomRowCount,this.fixedCols,this.m_nRealRows,(this.fixedCols+this.frozenCols),this.mergeCells,this.m_arMergeList,"cell",this.m_htMergeColList,true)}this.mergePartMakeCell(this.m_nRealRows-this.m_nBottomRowCount,(this.fixedCols+this.frozenCols),this.m_nRealRows,this.cols,this.mergeCells,this.m_arMergeList,"cell",this.m_htMergeColList,true)}var c=this.m_objScroll;if(c.bScrollEvent){b=c.nTopRow;a=c.nBottomRow+1}else{b=this.fixedRows+this.frozenRows;a=this.m_nRealRows-this.m_nBottomRowCount}if(0<this.frozenCols){this.mergePartMakeCell(b,this.fixedCols,a,(this.fixedCols+this.frozenCols),this.mergeCells,this.m_arMergeList,"cell",this.m_htMergeColList,true)}this.mergePartMakeCell(b,(this.fixedCols+this.frozenCols),a,this.cols,this.mergeCells,this.m_arMergeList,"cell",this.m_htMergeColList,true)};SBGrid.CT.DataGrid.prototype.mergeFixedCols=function(){var a=(this.m_bRowHeader)?1:0;if(0<(this.fixedRows+this.frozenRows)){this.mergePartMakeCell(0,a,this.fixedRows,this.fixedCols,this.mergeCellsFixedCols,this.m_arMergeFixedColList,null,this.m_htMergeFCColList,false)}if(0<this.m_nBottomRowCount){this.mergePartMakeCell(this.m_nRealRows-this.m_nBottomRowCount,a,this.m_nRealRows,this.fixedCols,this.mergeCellsFixedCols,this.m_arMergeFixedColList,null,this.m_htMergeFCColList,false)}this.mergePartMakeCell(this.fixedRows,a,this.m_nRealRows-this.m_nBottomRowCount,this.fixedCols,this.mergeCellsFixedCols,this.m_arMergeFixedColList,null,this.m_htMergeFCColList,false)};SBGrid.CT.DataGrid.prototype.mergeFixedRows=function(){this.deleteMultiSortShowIcon();if(0<(this.fixedCols+this.frozenCols)){this.mergePartMakeCell(0,0,this.fixedRows,(this.fixedCols+this.frozenCols),this.mergeCellsFixedRows,this.m_arMergeFixedRowList,null,this.m_htMergeFRColList,false)}this.mergePartMakeCell(0,(this.fixedCols+this.frozenCols),this.fixedRows,this.cols,this.mergeCellsFixedRows,this.m_arMergeFixedRowList,null,this.m_htMergeFRColList,false);this.setMultiSortShowIcon()};SBGrid.CT.DataGrid.prototype.mergeCol=function(b){var a=this.m_arColumn[b];if(null!=a){return a.m_bMerge}else{return false}};SBGrid.CT.DataGrid.prototype.setMergeCol=function(d,a,c){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setMergeCol","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof d)!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setMergeCol","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setMergeCol","Please check if second parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c==undefined){c=false}var b=this.m_arColumn[d];if(null!=b){if(c!=null&&c==false){b.m_bDataMerge=a}else{b.m_bMerge=a}}if(this.autoMerge){this.mergeCancellation(this.m_arMergeList,this.m_htMergeColList);this.m_htMergeColList={};if(c){if(a){this.mergeFixedRows();this.mergeFixedCols()}else{this.mergeCancellation(this.m_arMergeFixedRowList,this.m_htMergeFRColList);this.mergeCancellation(this.m_arMergeFixedColList,this.m_htMergeFCColList);this.m_arMergeFixedRowList=new Array;this.m_arMergeFixedColList=new Array}}this.mergeDataCells()}};SBGrid.CT.DataGrid.prototype.setMergeColEx=function(e,b,d,a){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setMergeColEx","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof e)!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setMergeColEx","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof b)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setMergeColEx","Please check if second parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof d==undefined){d=false}if(typeof a==undefined){a=true}var c=this.m_arColumn[e];if(null!=c){if(d!=null&&d==false){c.m_bDataMerge=b}else{c.m_bMerge=b}}if(a&&this.autoMerge){this.mergeCancellation(this.m_arMergeList,this.m_htMergeColList);this.m_htMergeColList={};if(d){if(b){this.mergeFixedRows();this.mergeFixedCols()}else{this.mergeCancellation(this.m_arMergeFixedRowList,this.m_htMergeFRColList);this.mergeCancellation(this.m_arMergeFixedColList,this.m_htMergeFCColList);this.m_arMergeFixedRowList=new Array;this.m_arMergeFixedColList=new Array}}this.mergeDataCells()}};SBGrid.CT.DataGrid.prototype.mergeRow=function(c){if(null!=c){for(var b=0;b<this.cols;b++){var a=this.getCellEx(c,b);if(null!=a){if(SBGrid.DEF.SBSM_MERGED==a.mergeType||SBGrid.DEF.SBSM_HIDE==a.mergeType){return true}}else{return false}}return false}return false};SBGrid.CT.DataGrid.prototype.setMergeRow=function(e,a){for(var d=this.fixedCols;d<this.cols;d++){var c=this.getCellEx(e,d);if(null!=c){c.m_bMerge=a;if(a){c.mergeType=SBGrid.DEF.SBSM_NORMAL}else{c.mergeType=SBGrid.DEF.SBSM_LOCK}}}if(this.autoMerge){this.mergeCancellation(this.m_arMergeList,this.m_htMergeColList);this.m_htMergeColList={};var b=this.mergeCells;this.mergeCells="byrow";this.mergeDataCells();this.mergeCells=b}};SBGrid.CT.DataGrid.prototype.makeMergeTable=function(){var e=document.createElement("div");jQuery(e).addClass("sbgrid_datagrid_MergeTable");var d=document.createElement("table");var c=document.createElement("tbody");var a=document.createElement("tr");var b=document.createElement("td");this.m_heCtrl.appendChild(e);e.appendChild(d);d.appendChild(c);c.appendChild(a);a.appendChild(b);return a};SBGrid.CT.DataGrid.prototype.gridStatusDiv=function(){if(null==this.m_heHiddenDiv){var a=document.createElement("div");jQuery(a).addClass("sbgrid_StatusDiv");this.m_heCtrl.insertBefore(a,this.m_heWhole.nextSibling);this.m_heCtrl.insertBefore(this.m_heFFC,a);this.m_heHiddenDiv=a}};SBGrid.CT.DataGrid.prototype.makeScrollDiv=function(d,a){var c=this.m_heFFS.offsetHeight;var b=null!=this.m_xlRefNode?this.m_xlRefNode.length-this.frozenRows:0;b=b<0?0:b;if(null==d){d=document.createElement("div");jQuery(d).addClass("sbgrid_ScrollDiv")}if(a){d.style.height=(c+(b*this.dataHeight))+"px";this.m_heWhole.appendChild(d);this.m_heGridScrollDivCell=d;this.m_objScroll.nBottom=d.offsetHeight}else{d.style.height=(b*this.dataHeight)+"px";this.m_heFFC.appendChild(d);this.m_heFFGridScrollDivCell=d}};SBGrid.CT.DataGrid.prototype.reSizeScrollDiv=function(){if(this.m_objScroll.bScrollEvent&&this._isVScroll()){var c=this.m_heFFS.offsetHeight;if(null!=this.m_heGridScrollDivCell){var e=this.fixedRows+this.frozenRows;var d=0;for(var a=e;a<this.m_nRealRows;a++){if(this.isRowHidden(a)==false){var b=this.m_htRowHeight[a];if(b==null){b=this.dataHeight}else{if(b<0){b=0}}d+=b}}this.m_heGridScrollDivCell.style.height=(c+d)+"px";this.m_objScroll.nBottom=this.m_heGridScrollDivCell.offsetHeight;if(this.m_heFFGridScrollDivCell!=null){this.m_heFFGridScrollDivCell.style.height=(d)+"px"}}}else{if(null!=this.m_heGridScrollDivCell){this.m_heGridScrollDivCell.style.height="0px"}if(null!=this.m_heFFGridScrollDivCell){this.m_heFFGridScrollDivCell.style.height="0px"}}};SBGrid.CT.DataGrid.prototype.getMergePartRowHeight=function(d,b){var a=0;for(var c=d;c<b;c++){if(this.m_htRowHeight[c]){a+=this.m_htRowHeight[c]}else{a+=this.dataHeight}}return a};SBGrid.CT.DataGrid.prototype.getMergePartColWidth=function(a,d){var b=0;for(var c=a;c<d;c++){b+=this.m_arColWidth[c]}return b};SBGrid.CT.DataGrid.prototype.mergeCellTrPosition=function(a,d){var c=this.m_objScroll;if(a<(this.fixedRows+this.frozenRows)){return a}else{if(a>=(this.m_nRealRows-this.frozenBottomRows)){if(this.m_nRealRows<this.fixedRows+this.frozenRows+this.frozenBottomRows){return a-(this.fixedRows+this.frozenRows)}return a-(this.m_nRealRows-this.frozenBottomRows)}else{if(d<(this.fixedCols+this.frozenCols)){return a-c.nTopRow}else{var b=this.fixedRows+this.frozenRows;return b+(a-c.nTopRow)}}}};SBGrid.CT.DataGrid.prototype._gridLastCol=function(){var a=0;for(var b=this.fixedCols;b<this.cols;b++){if(0==this.m_arColWidth[b]){continue}else{a=b}}return a};SBGrid.CT.DataGrid.prototype.clearMerge=function(){if(0<this.m_arMergeList.length){this.m_bScrollMergeCell=true}this.mergeCancellation(this.m_arMergeFixedRowList,this.m_htMergeFRColList);this.mergeCancellation(this.m_arMergeFixedColList,this.m_htMergeFCColList);this.mergeCancellation(this.m_arMergeByFreeList,this.m_htMergeBFColList);this.mergeCancellation(this.m_arMergeList,this.m_htMergeColList);this.m_arMergeFixedRowList=new Array;this.m_arMergeFixedColList=new Array;this.m_arMergeByFreeList=new Array;this.m_htMergeFRColList={};this.m_htMergeFCColList={};this.m_htMergeColList={};this.m_htMergeBFColList={};this.m_arMergeList=new Array};SBGrid.CT.DataGrid.prototype.mergeCancellation=function(c,f){var d=(!(SBGrid.DEF.is_mozBrowser))?1:0;for(var t=0;t<c.length;t++){var m=c[t];if(null!=m){var A=parseInt(m.row);var x=parseInt(m.col);var y=m.m_heCtrl;var q=SBGrid.DEF.is_smartphone?A:this.mergeCellTrPosition(A,x);var w=m.m_nColSpan;var u=m.m_nRowSpan;var a=this.m_htRowHeight[A];a=null!=a?a:this.dataHeight;var p=a-d;y.style.height=p>-1?p+"px":"0px";y.rowSpan=1;y.colSpan=1;m.m_nRowSpan=1;m.m_nColSpan=1;var h=null;var l=null;if(SBGrid.DEF.is_firefox){h=y.parentNode;l=h.parentNode}else{h=y.parentElement;l=h.parentElement}for(var s=0;s<u;s++){var n=null;var b=l.children[q+s];for(var r=0;r<w;r++){if(0==s&&0==r){continue}if(b!=null){if(null!=b.children[x+r]){n=b.children[x+r]}var g=this.getCellEx(A+s,x+r);if(null!=g){if(null==n){b.appendChild(g.m_heCtrl)}else{b.insertBefore(g.m_heCtrl,n)}g.mergeParentId=null;if(SBGrid.DEF.SBSM_LOCK!=g.mergeType){g.mergeType=SBGrid.DEF.SBSM_NORMAL}}}}}m.mergeParentId=null;if(SBGrid.DEF.SBSM_LOCK!=m.mergeType){m.mergeType=SBGrid.DEF.SBSM_NORMAL}}}if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7){for(var z in f){var o=f[z];jQuery('col[colNum="'+z+'"][targetCol="'+o.targetCol+'"]').css("width",(o.width)+"px")}}f={};c=new Array();if(SBGrid.DEF.is_ie9){if(null!=this.m_arIe9MergeCellWidth){for(var t=0;t<this.m_arIe9MergeCellWidth.length;t++){var e=this.m_arIe9MergeCellWidth[t].target;var v=this.m_arIe9MergeCellWidth[t].width;e.style.width=v}this.m_arIe9MergeCellWidth=null}}};SBGrid.CT.DataGrid.prototype.setMergeCellResize=function(e,a){for(var d=0;d<this.cols;d++){for(var b=e;b>=0;b--){var c=this.getCellEx(b,d);if(null!=c){if(SBGrid.DEF.SBSM_HIDE==c.mergeType){continue}else{if(SBGrid.DEF.SBSM_MERGED==c.mergeType&&1<c.m_nRowSpan){var f=parseInt(c.m_heCtrl.style.height);c.m_heCtrl.style.height=(f+a)+"px"}else{if(SBGrid.DEF.SBSM_NORMAL==c.mergeType){break}}}}else{break}}}};SBGrid.CT.DataGrid.prototype.mergePartMakeCell=function(p,b,J,D,o,l,q,r,S){var B=(!(SBGrid.DEF.is_mozBrowser))?1:0;var A=this._gridLastCol();switch(o){case"never":break;case"bycol":var s=null;var I=null;var f=null;for(var O=b;O<D;O++){I=this.m_arColumn[O];for(var N=p;N<J;N++){var c=this.m_arHiddenRowState[N];if(c){continue}s=this.getCellEx(N,O);if(null!=s&&null!=I){if(S&&!I.m_bDataMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}if(!I.m_bMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}else{if(SBGrid.DEF.SBSM_LOCK==s.mergeType){s.mergeType=SBGrid.DEF.SBSM_NORMAL}}if(s.m_bMergeByFree){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}f=s.m_heCtrl;if(SBGrid.DEF.SBSM_NORMAL==s.mergeType||SBGrid.DEF.SBSM_MERGED==s.mergeType){var E=false;var G=SBGrid.CF.GridGetWindowText(s);var Q=s.m_nRowSpan;var h=null;for(var K=N+Q;K<J;K++){var c=this.m_arHiddenRowState[K];if(c){break}h=this.getCellEx(K,O);if(null!=h){var P=SBGrid.CF.GridGetWindowText(h);if(G==P&&SBGrid.DEF.SBSM_LOCK!=h.mergeType&&h.m_bMerge){E=true;h.mergeType=SBGrid.DEF.SBSM_HIDE;h.mergeParentId=s.id;this.m_heMergeCell.appendChild(h.m_heCtrl);Q++}else{break}}else{break}}if(E){f.style.height=(this.getMergePartRowHeight(N,K)-B)+"px";f.rowSpan=Q;if(SBGrid.DEF.SBSM_MERGED!=s.mergeType){l.push(s)}s.m_nRowSpan=Q;s.mergeType=SBGrid.DEF.SBSM_MERGED;s.mergeParentId=s.id}h=null}f=null}s=null}}break;case"byrow":var s=null;var I=null;var f=null;for(var O=p;O<J;O++){for(var N=b;N<D;N++){I=this.m_arColumn[N];s=this.getCellEx(O,N);if(null!=s&&null!=I){if(S&&!I.m_bDataMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}if(!I.m_bMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}else{if(SBGrid.DEF.SBSM_LOCK==s.mergeType){s.mergeType=SBGrid.DEF.SBSM_NORMAL}}if(s.m_bMergeByFree){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}f=s.m_heCtrl;if(SBGrid.DEF.SBSM_NORMAL==s.mergeType||SBGrid.DEF.SBSM_MERGED==s.mergeType){var E=false;var x=false;var G=SBGrid.CF.GridGetWindowText(s);var Q=s.m_nColSpan;var v=null;for(var K=N+Q;K<D;K++){I=this.m_arColumn[K];v=this.getCellEx(O,K);if(null!=v&&null!=I){if(!I.m_bMerge){v.mergeType=SBGrid.DEF.SBSM_LOCK;break}else{if(!I.m_bDataMerge){v.mergeType=SBGrid.DEF.SBSM_LOCK;break}else{if(SBGrid.DEF.SBSM_LOCK==v.mergeType){v.mergeType=SBGrid.DEF.SBSM_NORMAL}}}var T=SBGrid.CF.GridGetWindowText(v);if(G==T&&SBGrid.DEF.SBSM_LOCK!=v.mergeType&&v.m_bMerge){E=true;if(SBGrid.DEF.is_ie9){if(K==A){x=true}}v.mergeType=SBGrid.DEF.SBSM_HIDE;v.mergeParentId=s.id;if(null==r[this.id+"_"+K]){r[this.id+"_"+K]={targetCol:v.m_heCtrl.getAttribute("targetcell"),width:this.m_arColWidth[K]}}this.m_heMergeCell.appendChild(v.m_heCtrl);Q++}else{break}}else{break}}if(E){f.colSpan=Q;if(SBGrid.DEF.SBSM_MERGED!=s.mergeType){l.push(s)}s.m_nColSpan=Q;s.mergeType=SBGrid.DEF.SBSM_MERGED;s.mergeParentId=s.id;if(x){var F=f.parentNode.parentNode;var n=F.querySelectorAll("td[colNum="+this.id+"_"+A+"]");if(0==n.length){var z=F.parentNode;var M=z.querySelector("col[colNum="+this.id+"_"+N+"]");if(null!=M){if(null==this.m_arIe9MergeCellWidth){this.m_arIe9MergeCellWidth=new Array()}this.m_arIe9MergeCellWidth.push({target:M,width:M.style.width,nStartCol:N,nLastCol:A})}}}}v=null}f=null}s=null}}break;case"bycolrec":var s=null;var I=null;var f=null;for(var O=b;O<D;O++){I=this.m_arColumn[O];for(var N=p;N<J;N++){var c=this.m_arHiddenRowState[N];if(c){continue}s=this.getCellEx(N,O);if(null!=s&&null!=I){if(S&&!I.m_bDataMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}if(!I.m_bMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}else{if(SBGrid.DEF.SBSM_LOCK==s.mergeType){s.mergeType=SBGrid.DEF.SBSM_NORMAL}}if(s.m_bMergeByFree){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}f=s.m_heCtrl;if(SBGrid.DEF.SBSM_NORMAL==s.mergeType||SBGrid.DEF.SBSM_MERGED==s.mergeType){var E=false;var G=SBGrid.CF.GridGetWindowText(s);var Q=s.m_nRowSpan;var h=null;for(var K=N+Q;K<J;K++){var c=this.m_arHiddenRowState[K];if(c){break}h=this.getCellEx(K,O);if(null!=h&&null!=h.m_heCtrl){var P=SBGrid.CF.GridGetWindowText(h);if(G==P&&SBGrid.DEF.SBSM_LOCK!=h.mergeType&&h.m_bMerge){E=true;h.mergeType=SBGrid.DEF.SBSM_HIDE;h.mergeParentId=s.id;this.m_heMergeCell.appendChild(h.m_heCtrl);Q++}else{break}}else{break}}if(E){if(this.fixedCols==0){f.style.height=(this.getMergePartRowHeight(N,K)-B)+"px"}f.rowSpan=Q;if(SBGrid.DEF.SBSM_MERGED!=s.mergeType){l.push(s)}s.m_nRowSpan=Q;s.mergeType=SBGrid.DEF.SBSM_MERGED;s.mergeParentId=s.id}h=null}f=null}s=null}}for(var O=p;O<J;O++){for(var N=b;N<D;N++){I=this.m_arColumn[N];s=this.getCellEx(O,N);if(null!=s&&null!=I){if(S&&!I.m_bDataMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}if(!I.m_bMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}else{if(SBGrid.DEF.SBSM_LOCK==s.mergeType){s.mergeType=SBGrid.DEF.SBSM_NORMAL}}if(s.m_bMergeByFree){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}var f=null;if(SBGrid.DEF.SBSM_NORMAL==s.mergeType||SBGrid.DEF.SBSM_MERGED==s.mergeType){var E=false;var x=false;var L=false;var G=SBGrid.CF.GridGetWindowText(s);f=s.m_heCtrl;var Q=s.m_nColSpan;for(var K=N+Q;K<D;K++){I=this.m_arColumn[K];var v=this.getCellEx(O,K);if(null!=v&&null!=v.m_heCtrl&&null!=I){if(!I.m_bMerge){v.mergeType=SBGrid.DEF.SBSM_LOCK;break}else{if(SBGrid.DEF.SBSM_LOCK==v.mergeType){v.mergeType=SBGrid.DEF.SBSM_NORMAL}}var T=SBGrid.CF.GridGetWindowText(v);if(G==T&&SBGrid.DEF.SBSM_LOCK!=v.mergeType&&s.mergeType==v.mergeType&&s.m_nRowSpan==v.m_nRowSpan&&v.m_bMerge){if(SBGrid.DEF.is_ie9){if(K==A){x=true}}var H=v.m_heCtrl;if(SBGrid.DEF.SBSM_MERGED==v.mergeType){L=true}E=true;v.mergeType=SBGrid.DEF.SBSM_HIDE;v.mergeParentId=s.id;if(null==r[this.id+"_"+K]){r[this.id+"_"+K]={targetCol:v.m_heCtrl.getAttribute("targetcell"),width:this.m_arColWidth[K]}}this.m_heMergeCell.appendChild(H);H.rowSpan=1;Q++}else{break}}else{break}}if(E){f.colSpan=Q;s.m_nColSpan=Q;if(!L){s.mergeType=SBGrid.DEF.SBSM_MERGED;s.mergeParentId=s.id;l.push(s)}if(x){var F=f.parentNode.parentNode;var n=F.querySelectorAll("td[colNum="+this.id+"_"+A+"]");if(0==n.length){var z=F.parentNode;var M=z.querySelector("col[colNum="+this.id+"_"+N+"]");if(null!=M){if(null==this.m_arIe9MergeCellWidth){this.m_arIe9MergeCellWidth=new Array()}this.m_arIe9MergeCellWidth.push({target:M,width:M.style.width,nStartCol:N,nLastCol:A})}}}}}f=null}s=null}}break;case"byrowrec":var I=null;var s=null;var f=null;for(var O=p;O<J;O++){for(var N=b;N<D;N++){I=this.m_arColumn[N];s=this.getCellEx(O,N);if(null!=s&&null!=I){if(S&&!I.m_bDataMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}if(!I.m_bMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}else{if(SBGrid.DEF.SBSM_LOCK==s.mergeType){s.mergeType=SBGrid.DEF.SBSM_NORMAL}}if(s.m_bMergeByFree){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}f=s.m_heCtrl;if(f!=null){if(SBGrid.DEF.SBSM_NORMAL==s.mergeType||SBGrid.DEF.SBSM_MERGED==s.mergeType){var E=false;var x=false;var G=SBGrid.CF.GridGetWindowText(s);var Q=s.m_nColSpan;var v=null;for(var K=N+Q;K<D;K++){I=this.m_arColumn[K];v=this.getCellEx(O,K);if(null!=v&&null!=I){if(!I.m_bMerge){v.mergeType=SBGrid.DEF.SBSM_LOCK;break}else{if(SBGrid.DEF.SBSM_LOCK==v.mergeType){v.mergeType=SBGrid.DEF.SBSM_NORMAL}}var T=SBGrid.CF.GridGetWindowText(v);if(G==T&&SBGrid.DEF.SBSM_LOCK!=v.mergeType&&v.m_bMerge){if(SBGrid.DEF.is_ie9){if(K==A){x=true}}E=true;v.mergeType=SBGrid.DEF.SBSM_HIDE;v.mergeParentId=s.id;if(null==r[this.id+"_"+K]){r[this.id+"_"+K]={targetCol:v.m_heCtrl.getAttribute("targetcell"),width:this.m_arColWidth[K]}}this.m_heMergeCell.appendChild(v.m_heCtrl);Q++}else{break}}else{break}}if(E){f.colSpan=Q;if(SBGrid.DEF.SBSM_MERGED!=s.mergeType){l.push(s)}s.m_nColSpan=Q;s.mergeType=SBGrid.DEF.SBSM_MERGED;s.mergeParentId=s.id;if(x){var F=f.parentNode.parentNode;var n=F.querySelectorAll("td[colNum="+this.id+"_"+A+"]");if(0==n.length){var z=F.parentNode;var M=z.querySelector("col[colNum="+this.id+"_"+N+"]");if(null!=M){if(null==this.m_arIe9MergeCellWidth){this.m_arIe9MergeCellWidth=new Array()}this.m_arIe9MergeCellWidth.push({target:M,width:M.style.width,nStartCol:N,nLastCol:A})}}}}v=null}}f=null}s=null}}for(var O=b;O<D;O++){I=this.m_arColumn[O];for(var N=p;N<J;N++){var c=this.m_arHiddenRowState[N];if(c){continue}s=this.getCellEx(N,O);if(null!=s){if(S&&!I.m_bDataMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}if(!I.m_bMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}else{if(SBGrid.DEF.SBSM_LOCK==s.mergeType){s.mergeType=SBGrid.DEF.SBSM_NORMAL}}if(s.m_bMergeByFree){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}var f=null;if(SBGrid.DEF.SBSM_NORMAL==s.mergeType||SBGrid.DEF.SBSM_MERGED==s.mergeType){var E=false;var L=false;G=SBGrid.CF.GridGetWindowText(s);f=s.m_heCtrl;var h=null;var Q=s.m_nRowSpan;if(f!=null){for(var K=N+Q;K<J;K++){var c=this.m_arHiddenRowState[K];if(c){break}h=this.getCellEx(K,O);if(null!=h){var P=SBGrid.CF.GridGetWindowText(h);if(G==P&&SBGrid.DEF.SBSM_LOCK!=h.mergeType&&s.mergeType==h.mergeType&&s.m_nColSpan==h.m_nColSpan&&h.m_bMerge){var H=h.m_heCtrl;if(H!=null){if(SBGrid.DEF.SBSM_MERGED==h.mergeType){H.style.width=this.m_arColWidth[O]+"px";L=true}E=true;h.mergeType=SBGrid.DEF.SBSM_HIDE;h.mergeParentId=s.id;this.m_heMergeCell.appendChild(H);H.colSpan=1;Q++}}else{break}}else{break}}if(E){f.style.height=(this.getMergePartRowHeight(N,K)-B)+"px";f.rowSpan=Q;s.m_nRowSpan=Q;if(!L){s.mergeType=SBGrid.DEF.SBSM_MERGED;s.mergeParentId=s.id;var C=0;var w=true;while(C<l.length){if(s.col<l[C].col){l.splice(C,0,s);w=false;break}C++}if(w){l.push(s)}}}}}f=null}s=null}}break;case"byrestriccol":var s=null;var I=null;var f=null;var t=null;var y=false;for(var O=b;O<D;O++){I=this.m_arColumn[O];for(var N=p;N<J;N++){var c=this.m_arHiddenRowState[N];if(c){continue}s=this.getCellEx(N,O);if(null!=s&&null!=I){if(S&&!I.m_bDataMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}if(!I.m_bMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;if(t==null){t=O}continue}else{if(SBGrid.DEF.SBSM_LOCK==s.mergeType){s.mergeType=SBGrid.DEF.SBSM_NORMAL}}if(s.m_bMergeByFree){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}y=true;f=s.m_heCtrl;if(SBGrid.DEF.SBSM_NORMAL==s.mergeType||SBGrid.DEF.SBSM_MERGED==s.mergeType){var E=false;var G=SBGrid.CF.GridGetWindowText(s);var Q=s.m_nRowSpan;var h=null;var m=J;var g=t!=null?t:O;var e=this.getCellEx(N,g-1);if(null!=e){if(null!=e.mergeParentId){e=this.getCellByIdEx(e.mergeParentId)}if(O-1>=this.fixedCols){m=e.row+e.m_nRowSpan}}for(var K=N+Q;K<J&&K<m;K++){var c=this.m_arHiddenRowState[K];if(c){break}h=this.getCellEx(K,O);if(null!=h){var P=SBGrid.CF.GridGetWindowText(h);if(G==P&&SBGrid.DEF.SBSM_LOCK!=h.mergeType&&h.m_bMerge){E=true;h.mergeType=SBGrid.DEF.SBSM_HIDE;h.mergeParentId=s.id;this.m_heMergeCell.appendChild(h.m_heCtrl);Q++}else{break}}else{break}}if(E){f.style.height=(this.getMergePartRowHeight(N,K)-B)+"px";f.rowSpan=Q;if(SBGrid.DEF.SBSM_MERGED!=s.mergeType){l.push(s)}s.m_nRowSpan=Q;s.mergeType=SBGrid.DEF.SBSM_MERGED;s.mergeParentId=s.id}h=null}f=null}s=null}if(y){t=null;y=false}}break;case"byrestricrow":var s=null;var I=null;var f=null;for(var O=p;O<J;O++){for(var N=b;N<D;N++){I=this.m_arColumn[N];s=this.getCellEx(O,N);if(null!=s&&null!=I){if(S&&!I.m_bDataMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}if(!I.m_bMerge){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}else{if(SBGrid.DEF.SBSM_LOCK==s.mergeType){s.mergeType=SBGrid.DEF.SBSM_NORMAL}}if(s.m_bMergeByFree){s.mergeType=SBGrid.DEF.SBSM_LOCK;continue}f=s.m_heCtrl;if(SBGrid.DEF.SBSM_NORMAL==s.mergeType||SBGrid.DEF.SBSM_MERGED==s.mergeType){var E=false;var x=false;var G=SBGrid.CF.GridGetWindowText(s);var Q=s.m_nColSpan;var v=null;var a=D;var R=this.getCellEx(O-1,N);if(null!=R){if(null!=R.mergeParentId){R=this.getCellByIdEx(R.mergeParentId)}if(O-1>=this.fixedRows){a=R.col+R.m_nColSpan}}for(var K=N+Q;K<D&&K<a;K++){I=this.m_arColumn[K];v=this.getCellEx(O,K);if(null!=v&&null!=I){if(!I.m_bMerge){v.mergeType=SBGrid.DEF.SBSM_LOCK;break}else{if(SBGrid.DEF.SBSM_LOCK==v.mergeType){v.mergeType=SBGrid.DEF.SBSM_NORMAL}}var T=SBGrid.CF.GridGetWindowText(v);if(G==T&&SBGrid.DEF.SBSM_LOCK!=v.mergeType&&v.m_bMerge){E=true;if(SBGrid.DEF.is_ie9){if(K==A){x=true}}v.mergeType=SBGrid.DEF.SBSM_HIDE;v.mergeParentId=s.id;if(null==r[this.id+"_"+K]){r[this.id+"_"+K]={targetCol:v.m_heCtrl.getAttribute("targetcell"),width:this.m_arColWidth[K]}}this.m_heMergeCell.appendChild(v.m_heCtrl);Q++}else{break}}else{break}}if(E){f.colSpan=Q;if(SBGrid.DEF.SBSM_MERGED!=s.mergeType){l.push(s)}s.m_nColSpan=Q;s.mergeType=SBGrid.DEF.SBSM_MERGED;s.mergeParentId=s.id;if(x){var F=f.parentNode.parentNode;var n=F.querySelectorAll("td[colNum="+this.id+"_"+A+"]");if(0==n.length){var z=F.parentNode;var M=z.querySelector("col[colNum="+this.id+"_"+N+"]");if(null!=M){if(null==this.m_arIe9MergeCellWidth){this.m_arIe9MergeCellWidth=new Array()}this.m_arIe9MergeCellWidth.push({target:M,width:M.style.width,nStartCol:N,nLastCol:A})}}}}v=null}f=null}s=null}}break}if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7){for(var u in r){var d=r[u];jQuery('col[colNum="'+u+'"][targetCol="'+d.targetCol+'"]').css("width",(d.width+1)+"px")}}};SBGrid.CT.DataGrid.prototype.setCellTooltip=function(b,d,c){if(null==b||null==d||null==c){if(null!=window.console){console.log("setCellTooltip()에 대한 올바른 인자값이 아닙니다.")}return}var a=this.getCellEx(b,d);if(null!=a){if(null!=a.m_heCtrl){a.m_heCtrl.title=c}}};SBGrid.CT.DataGrid.prototype.getCellTooltip=function(b,c){if(null==b||null==c){if(null!=window.console){console.log("getCellTooltip()에 대한 올바른 인자값이 아닙니다.")}return""}var a=this.getCellEx(b,c);if(null!=a){if(null!=a.m_heCtrl){return a.m_heCtrl.title}}};SBGrid.CT.DataGrid.prototype.isPhysicalRow=function(a){if((a>=this.fixedRows&&a<this.fixedRows+this.frozenRows)||(a>=this.m_objScroll.nTopRow&&a<=this.m_objScroll.nBottomRow)||(a>=this.m_nRealRows-this.frozenBottomRows&&a<this.m_RealRows)){return true}return false};SBGrid.CT.DataGrid.prototype.scrollButtonClick=function(e,d){if(this.mbScrollRock){return}if(this.m_objScroll.nPosition==d){return}if(this.m_objScroll.nTargetHeight==0){this.scrollAttributeSetting()}this.m_bScrollRock=true;this.m_objScroll.nPosition=d;var c=d+this.m_objScroll.nScrollDivHeight/2;var b=this.m_objScroll.nTargetTop+this.m_objScroll.nTargetHeight/2;var a=Math.ceil((Math.abs(e)/this.dataHeight));if(0>e&&this.m_objScroll.bDownProcess){if(b-c<0){if(this.m_bIsShowLoadingImage){this.scrollUpDownTable(true,a)}else{this.scrollingGrid(true,false)}}}else{if(this.m_objScroll.bUpProcess){if(b-c>0){if(this.m_bIsShowLoadingImage){this.scrollUpDownTable(false,a)}else{this.scrollingGrid(true,false)}}}}this.m_bScrollRock=false};SBGrid.CT.DataGrid.prototype.isScrollPosition=function(a){var b=this.m_objScroll;if(b.bScrollEvent){return b.nTopRow<=a&&a<=b.nBottomRow}b=null;return false};SBGrid.CT.DataGrid.prototype.setScrollDivRow=function(c,a){if(a){var b=parseInt(this.m_heGridScrollDivCell.style.height);b=null!=this.m_htRowHeight[c]?(b-this.m_htRowHeight[c]):b-this.dataHeight;jQuery(this.m_heGridScrollDivCell).height(b+"px");if(null!=this.m_heFFC){b=parseInt(this.m_heFFGridScrollDivCell.style.height);b=null!=this.m_htRowHeight[c]?(b-this.m_htRowHeight[c]):b-this.dataHeight;jQuery(this.m_heFFGridScrollDivCell).height(b+"px")}}else{var b=parseInt(this.m_heGridScrollDivCell.style.height);b=null!=this.m_htRowHeight[c]?(b+this.m_htRowHeight[c]):b+this.dataHeight;jQuery(this.m_heGridScrollDivCell).height(b+"px");if(null!=this.m_heFFC){b=parseInt(this.m_heFFGridScrollDivCell.style.height);b=null!=this.m_htRowHeight[c]?(b+this.m_htRowHeight[c]):b+this.dataHeight;jQuery(this.m_heFFGridScrollDivCell).height(b+"px")}}};SBGrid.CT.DataGrid.prototype.setScrollDisplayRow=function(e,b,f){var g=this.m_objScroll;var a=null;if("none"==b){for(var d=0;d<g.arTargetRow.length;d++){if(g.arTargetRow[d]==e){a=this.isScrollPosition(d);if(a&&!f){this.gridCellUnInit(g.nTopRow,g.nBottomRow)}else{if(!f){if(null==this.m_scrollSetTime){this.gridCellUnInit(g.nTopRow,g.nBottomRow);this.m_scrollSetTime=window.setTimeout("SBGrid.getGrid('"+this.id+"').scrollingGrid(true);SBGrid.getGrid('"+this.id+"').m_scrollSetTime = null;",0)}}}g.arTargetRow.splice(d,1);if(g.nEndRow>g.nStartRow){g.nEndRow--}break}}}else{var c=true;for(var d=0;d<g.arTargetRow.length;d++){if(g.arTargetRow[d]==e){return}}for(var d=0;d<g.arTargetRow.length;d++){if(g.arTargetRow[d]>e){a=this.isScrollPosition(d);if(a&&!f){this.gridCellUnInit(g.nTopRow,g.nBottomRow)}else{if(!f){if(null==this.m_scrollSetTime){this.gridCellUnInit(g.nTopRow,g.nBottomRow);this.m_scrollSetTime=window.setTimeout("SBGrid.getGrid('"+this.id+"').scrollingGrid(true);SBGrid.getGrid('"+this.id+"').m_scrollSetTime = null;",0)}}}g.arTargetRow.splice(d,0,e);if(g.nEndRow<(this.m_nRealRows+this.m_objScroll.nStartRow-this.m_nMakeIndex-this.frozenBottomRows)){g.nEndRow++}c=false;break}}if(c){a=this.isScrollPosition(d);if(a&&!f){this.gridCellUnInit(g.nTopRow,g.nBottomRow)}else{if(!f){if(null==this.m_scrollSetTime){this.gridCellUnInit(g.nTopRow,g.nBottomRow);this.m_scrollSetTime=window.setTimeout("SBGrid.getGrid('"+this.id+"').scrollingGrid(true);SBGrid.getGrid('"+this.id+"').m_scrollSetTime = null;",0)}}}g.arTargetRow.push(e);if(g.nEndRow<(this.m_nRealRows+this.m_objScroll.nStartRow-this.m_nMakeIndex-this.frozenBottomRows)){g.nEndRow++}}}if(a&&!f){this.scrollTableReDraw()}};SBGrid.CT.DataGrid.prototype.scrollUpDownTop=function(a,e,h){var l=this.m_objScroll;var b=0;var f=0;var g=0;if(h){f=e+1;g=l.nBottomRow}else{f=l.nTopRow;g=a-1}if(!h&&f==this.fixedRows+this.frozenRows){return l.nTargetTop}for(var d=f;d<=g;d++){if(this.isRowHidden(d)==false){var c=this.m_htRowHeight[d];if(c==null){c=this.dataHeight}else{if(c<0){c=0}}b+=c}}return b};SBGrid.CT.DataGrid.prototype.scrollUpDownTable=function(a,b){this.clearMerge();var c=null;var d=null;var e=this.m_objScroll;this.gridCellUnInit(e.nTopRow,e.nBottomRow);if(a){b=b>((e.arTargetRow.length)-this.frozenBottomRows-1)-e.nBottomRow?((e.arTargetRow.length)-this.frozenBottomRows-1)-e.nBottomRow:b;e.nTargetTop=e.nTargetTop+(this.dataHeight*b);c=e.nTopRow+b;d=e.nBottomRow+b}else{b=b>e.nTopRow-this.fixedRows?e.nTopRow-this.fixedRows:b;e.nTargetTop=e.nTargetTop-(this.dataHeight*b);c=e.nTopRow-b;d=e.nBottomRow-b}e.heTargetTable.style.top=e.nTargetTop+"px";e.heTargetFFCTable.style.top=e.nTargetTop+"px";e.nTopRow=c;e.nBottomRow=d;this.scrollTableReDraw();e.bUpProcess=this.fixedRows+this.frozenRows!=c;e.bDownProcess=((e.arTargetRow.length)-this.frozenBottomRows-1)!=d;if(this.autoResize){this.autoResizeHeight();this.reSizeScrollDiv();this.scrollAttributeSetting()}else{if(this.bExistImageType){this.reSizeScrollDiv();this.scrollAttributeSetting()}}if(this.m_bScrollMergeCell){this.m_bScrollMergeCell=false;this.merge()}else{if(this.mergeCellsFixedRows!=undefined&&this.mergeCellsFixedRows!="never"){this.mergeFixedRows()}if(this.mergeCellsFixedCols!=undefined){this.mergeFixedCols()}}if(this.m_bIsMergeByFree){this.reMergeByFree()}};SBGrid.CT.DataGrid.prototype.scrollingGrid=function(c,o,n){o=((o==undefined||typeof o!="boolean")?true:o);n=((n==undefined||typeof o!="boolean")?true:n);if(o){this.closePopUp()}var r=this.m_objScroll;if(this.mbScrollRock){return}this.m_bScrollRock=true;if(c){this.clearMerge()}if(n){this.showWait(false)}var e=null;var g=null;var d=0;if(this.m_xlRefNode){d=this.m_xlRefNode.length}r.nPosition=this.m_heWhole.scrollTop;var h=r.nPosition+(r.nScrollDivHeight/2)-(r.nTargetHeight/2);var a=null;if(d){if(this.autoResize){var f=h;var b=0;for(var m=0;m<this.m_nRealRows;m++){var l=this.m_htRowHeight[m];l=null!=l?l:this.dataHeight;f-=l;if(f<=0){break}b++}a=b+this.frozenRows}else{a=parseInt(h/this.dataHeight)+this.frozenRows}if(a<r.nStartRow){a=r.nStartRow}else{if(a>r.nEndRow){a=r.nEndRow}}this.gridCellUnInit(r.nTopRow,r.nBottomRow);e=a;g=r.nBottomRow-r.nTopRow+a;if(this.autoResize){var q=(a);var f=0;for(var m=this.fixedRows+this.frozenRows;m<q;m++){var l=this.m_htRowHeight[m];l=null!=l?l:this.dataHeight;f+=l}r.nTargetTop=f}else{r.nTargetTop=this.dataHeight*(a-this.fixedRows-this.frozenRows)}}else{r.nTargetTop=0;r.nTopRow=this.fixedRows+this.frozenRows;r.nBottomRow=0;e=this.fixedRows+this.frozenRows;g=0}r.heTargetTable.style.top=r.nTargetTop+"px";r.heTargetFFCTable.style.top=r.nTargetTop+"px";r.nTopRow=e;r.nBottomRow=g;r.arScrollLength=new Array();this.scrollTableReDraw();r.bUpProcess=this.fixedRows+this.frozenRows!=e;r.bDownProcess=(this.m_nRealRows-this.frozenBottomRows-1)!=g;if(this.m_style_theme=="claret"){for(var m=0;m<this.getCols();m++){var p=document.getElementById("SBHE_"+this.id+"_"+parseInt(this.rows-1)+"_"+m);if(p){if(this.frozenBottomRows>0||this.frozenCols>0){jQuery(p).addClass("sbgrid_last_row_frozen_cell")}else{jQuery(p).addClass("sbgrid_last_row_cell")}}}}if(this.autoResize){this.autoResizeHeight();this.reSizeScrollDiv();this.scrollAttributeSetting()}else{if(this.bExistImageType){this.reSizeScrollDiv();this.scrollAttributeSetting()}}if(this.m_bScrollMergeCell){this.m_bScrollMergeCell=false;this.merge()}else{if(this.mergeCellsFixedRows!=undefined&&this.mergeCellsFixedRows!="never"){this.mergeFixedRows()}if(this.mergeCellsFixedCols!=undefined){this.mergeFixedCols()}}if(this.m_bIsMergeByFree){this.reMergeByFree()}if(null!=this.m_heWhole&&this.m_heFFS){this.m_heFFS.scrollLeft=this.m_heWhole.scrollLeft;this.m_heFFBS.scrollLeft=this.m_heWhole.scrollLeft}this.m_bScrollRock=false;this.m_bDown=false};SBGrid.CT.DataGrid.prototype.setTableMatrix=function(b,g){var f=this.m_objScroll.arTargetRow;this.m_arTempMatrix=new Array();var a=0;for(var e=b;e<=g;e++){this.m_arTempMatrix.push({data:new Array(),hidden:false});for(var c=0;c<this.cols;c++){var d=this.getCellEx(f[e],c);if(null!=d){this.m_arTempMatrix[a].data[c]={first:d.m_heCtrl,last:d.m_heDCtrl}}}a++}a=null;f=null};SBGrid.CT.DataGrid.prototype.gridCellUnInit=function(a,f){if(!this.m_objScroll.bScrollEvent){var e=this.m_objScroll.arTargetRow;for(var d=a;d<=f;d++){if(this.autoResize){jQuery("td[rowNum='"+this.id+"_"+d+"']").attr("rowNum","").css("height",(this.dataHeight-1)+"px")}}return}var e=this.m_objScroll.arTargetRow;for(var d=a;d<=f;d++){if(this.autoResize){jQuery("td[rowNum='"+this.id+"_"+d+"']").attr("rowNum","").css("height",(this.dataHeight-1)+"px")}for(var b=0;b<this.cols;b++){var c=this.getCellEx(e[d],b);if(null!=c){SBGrid.CF.GridUnInit(c)}}}e=null};SBGrid.CT.DataGrid.prototype.scrollTableReDraw=function(){if(!this.m_objScroll.bScrollEvent){return}var R=this.m_objScroll.arTargetRow;var c=this.m_objScroll.nTopRow;c=c<this.m_objScroll.nStartRow?this.m_objScroll.nStartRow:c;var K=this.m_objScroll.nBottomRow;var Q=null;var b=0;var E;var r=this.m_replaceString;if(r!=""&&r!="undefined"&&r!=null){E=r.split("?")}var f=new Array();for(var P=0;P<this.cols;P++){if((SBGrid.DEF.is_ie)&&(!SBGrid.DEF.is_ie7)&&(!SBGrid.DEF.is_ie8)&&(!SBGrid.DEF.is_ie10)){if(this.m_arColumn[P].m_bHiddenState||0==this.m_arHiddenCol[P]){f[P]="display:none;"}else{f[P]=""}}else{f[P]=""}}for(var P=c;P<=K&&P<R.length;P++){var d=R[P];var w=this.m_objGroup[d];var h=null!=this.m_htRowHeight[d]?this.m_htRowHeight[d]:this.dataHeight;h=!(SBGrid.DEF.is_mozBrowser)&&h>0?h-1:h;if(""!=this.backColorAlternate&&(((d)-this.fixedRows)%2)==1){Q=true}else{Q=false}var S=this.m_mapGridStyleInfo.find(d.toString());for(var O=0;O<this.cols;O++){var J=this.m_arColumn[O];if(J.m_bHiddenState||0==J){var l=this.getCellEx(d,O);var z=this.m_arTempMatrix[b].data[O];z.first.id="SBHE_"+this.id+"_"+(d)+"_"+O;l.m_heCtrl=z.first;z.first.setAttribute("rowNum",this.id+"_"+d);if(null!=z.last){var M=(f[O]==""?"block":"none");z.last.style.display=M;z.last.id=this.id+"_"+(d)+"_"+O+"_data";l.m_heDCtrl=z.last}l=null;z=null;continue}if(SBGrid.DEF.is_mozBrowser&&(SBGrid.DEF.SBIT_INPUTBUTTON==J.m_nInputType||SBGrid.DEF.SBIT_INPUTDATE==J.m_nInputType||SBGrid.DEF.SBIT_OUTPUTBUTTON==J.m_nInputType)){h-=2}var l=this.getCellEx(d,O);var u=this.getCellEx(this.row,O);var s=this.getSelectedRows(false);var C=new SBGrid.DS.Map();var D=new SBGrid.DS.Map();if(s){for(var L=0;L<s.length;L++){C.add(s[L]);D.add(L,this.getCellEx(s[L],0))}}if(null!=l){if(O==0){if(this.m_arTempMatrix[b].hidden){var F=this.m_arTempMatrix[b].data[O].first;var v=F.parentNode.getAttribute("rownum");jQuery('tr[rownum="'+v+'"]').css("display","")}}var z=this.m_arTempMatrix[b].data[O];z.first.id="SBHE_"+this.id+"_"+(d)+"_"+O;l.m_heCtrl=z.first;z.first.setAttribute("rowNum",this.id+"_"+d);if(null!=z.last){var M=(f[O]==""?"block":"none");z.last.style.display=M;z.last.id=this.id+"_"+(d)+"_"+O+"_data";l.m_heDCtrl=z.last}var A=new Array();var p=this.isFrozenCell(d,O);var N="";A[0]="height:"+h+"px;"+N;A[1]=(this.fixedCols<=O)&&Q&&""!=this.backColorAlternate?"background-color:"+this.backColorAlternate+";":"";A[1]=p&&""!=this.backColorFrozen?"background-color:"+this.backColorFrozen+";":A[1];A[2]=p&&""!=this.foreColorFrozen?"color:"+this.foreColorFrozen+";":"";A[3]="";var n=this.m_mapColStyleInfo.find(O.toString());if(n!=undefined){if(n.type!="fixed"){var o="";var H=SBGrid.DEF.getPropertyNameList(n.style);for(var L=0,I=H.length;L<I;L++){o+=H[L]+":";o+=n.style[H[L]]+";"}A[3]=o;SBGrid.DEF.clearArray(H);H=o=null}}n=null;if(S!=undefined){var t=S.find(O.toString());if(t!=undefined){var H=SBGrid.DEF.getPropertyNameList(t);var o="";for(var L=0,I=H.length;L<I;L++){o+=H[L]+":";o+=t[H[L]]+";"}A[3]=o;SBGrid.DEF.clearArray(H);H=o=null}t=null}A[4]=f[O];z.first.style.cssText=A.join("");if(null!=w&&O==this.groupCol&&0<this.group){if(null!=l.m_heCtrl){var y=l.m_heCtrl.firstChild.firstChild.firstChild.firstChild;var N=(18*w.depth)+"px";var a=null!=this.m_objGroup[d+1]&&(w.depth+1)==this.m_objGroup[d+1].depth;if(y!=null){y.className=a?(w.collapsed?this.m_objTreeClass.plus:this.m_objTreeClass.subtraction):this.m_objTreeClass.normal;y.style.width=N;y.setAttribute("row",d)}w.isChild=a;w.heControl=y;if(this.fixedCols<=O){this.setCellSelect(l,l.selected);SBGrid.CF.GridSetTextRefreshGroup(l,SBGrid.CF.GridGetText(l),E,this.m_bIsDataReplaceValueChanged);continue}}}if(this.getColType(O)=="inputbutton"){if(document.getElementById("SBHE_"+this.id+"_"+d+"_"+O)){document.getElementById("SBHE_"+this.id+"_"+d+"_"+O).firstChild.firstChild.firstChild.lastChild.firstChild.id=this.id+"_"+d+"_"+O+"_button"}}else{if(this.getColType(O)=="inputdate"){if(document.getElementById("SBHE_"+this.id+"_"+d+"_"+O)){document.getElementById("SBHE_"+this.id+"_"+d+"_"+O).firstChild.firstChild.firstChild.lastChild.firstChild.id=this.id+"_"+d+"_"+O+"_button"}}}if(this.fixedCols<=O){this.setCellSelect(l,l.selected);SBGrid.CF.GridSetTextRefresh(l,SBGrid.CF.GridGetText(l),E,this.m_bIsDataReplaceValueChanged)}else{if(null!=l.text&&""!=l.text){SBGrid.CF.GridSetFixedWindowText(l,l.text)}else{if(O==0&&this.m_bRowHeader){if("seq"==this.rowheader){var m=String(d-this.fixedRows+1);SBGrid.CF.GridSetFixedWindowText(l,m)}else{if("reverseseq"==this.rowheader){var m=String(this.m_nRealRows-d);SBGrid.CF.GridSetFixedWindowText(l,m)}else{if("select"==this.rowheader){if(s){if(s.length==1){if(l==u){SBGrid.CF.GridChangeRowHeadSelect(u,true)}else{SBGrid.CF.GridChangeRowHeadSelect(l,false)}}else{if(s.length>1){if(D.find(P-s[0])==l){SBGrid.CF.GridChangeRowHeadSelect(D.find(P-s[0]),true)}else{SBGrid.CF.GridChangeRowHeadSelect(l,false)}}}}}else{if("update"==this.rowheader){l.setStatus(l.rowstatus);SBGrid.CF.GridChangeRowHeadUpdate(l,l.rowstatus)}}}}}else{var q=this.getRefOfCol(O);var G=this.getRowData(P);var x=G[q];var U=this.getColType(O);if(U=="combo"){x=this.getColCombo(O).getComboLabel(x)}else{if(r!=undefined&&E){x=(x==E[0]?E[1]:x);if(this.m_bIsDataReplaceValueChanged){G[q]=x;this.setRowData(P,G,false)}}}SBGrid.CF.GridSetFixedWindowText(l,x);q=G=x=U=null}}}}}S=null;b++}this.nHiddenTrTagCount=0;if(b!=this.m_arTempMatrix.length){for(var P=b;P<this.m_arTempMatrix.length;P++){this.m_arTempMatrix[P].hidden=true;var B=this.m_arTempMatrix[P].data[0].first;var v=B.parentNode.getAttribute("rownum");jQuery('tr[rownum="'+v+'"]').css("display","none");this.nHiddenTrTagCount+=1;B=null}}if(this.m_style_theme=="claret"&&this.m_nCSSBottomBorderFlg==true){jQuery("#SBHE_DATAGRID_FFCOL_TBODY_"+this.id+" td").addClass("sbgrid_datagrid_GridFFC_bottomBorder");jQuery("#SBHE_DATAGRID_FFN_TBODY_"+this.id+" td").addClass("sbgrid_datagrid_GridFFC_bottomBorder")}if(this.m_bScrollMoveFirstCell){var T=this.getCellEx(this.getFixedRows(),this.getFixedCols());if(T){var J=T.getElement();SBGrid.DEF.setFocus(T.id);this.setCol(this.getFixedCols());if(SBGrid.DEF.SBIT_CHECK==J.getColType()){var g=T.m_heCtrl.firstChild;g.tabIndex="0"}else{if(T.m_heDCtrl){var e=T.m_heDCtrl;e.tabIndex="0"}}}}this.m_bScrollMoveFirstCell=false;c=null;K=null;b=null;R=null;f=null};SBGrid.CT.DataGrid.prototype.TableColumnReDraw=function(a){var P=this.m_objScroll.arTargetRow;var e=this.m_objScroll.nTopRow;var J=this.m_objScroll.nBottomRow;var O=null;var d=0;var D;if(e>=J){return}if(this.m_arTempMatrix==undefined){return}var q=this.m_replaceString;if(q!=""&&q!="undefined"&&q!=null){D=q.split("?")}var b="";if((SBGrid.DEF.is_ie)&&(!SBGrid.DEF.is_ie7)&&(!SBGrid.DEF.is_ie10)){if(this.m_arColumn[a].m_bHiddenState||0==this.m_arHiddenCol[a]){b="display:none;"}else{b=""}}else{b=""}for(var N=e;N<=J&&N<P.length;N++){var f=P[N];var v=this.m_objGroup[f];var g=null!=this.m_htRowHeight[f]?this.m_htRowHeight[f]:this.dataHeight;g=!(SBGrid.DEF.is_mozBrowser)&&g>0?g-1:g;if(""!=this.backColorAlternate&&(((f)-this.fixedRows)%2)==1){O=true}else{O=false}var Q=this.m_mapGridStyleInfo.find(f.toString());var I=this.m_arColumn[a];if(I.m_bHiddenState||0==I){continue}if(SBGrid.DEF.is_mozBrowser&&(SBGrid.DEF.SBIT_INPUTBUTTON==I.m_nInputType||SBGrid.DEF.SBIT_INPUTDATE==I.m_nInputType)){g-=2}var h=this.getCellEx(f,a);var t=this.getCellEx(this.row,a);var r=this.getSelectedRows(false);var B=new SBGrid.DS.Map();var C=new SBGrid.DS.Map();if(r){for(var K=0;K<r.length;K++){B.add(r[K]);C.add(K,this.getCellEx(r[K],0))}}if(null!=h){if(a==0){if(this.m_arTempMatrix[d].hidden){var E=this.m_arTempMatrix[d].data[a].first;var u=E.parentNode.getAttribute("rownum");jQuery('tr[rownum="'+u+'"]').css("display","")}}var y=this.m_arTempMatrix[d].data[a];y.first.id="SBHE_"+this.id+"_"+(f)+"_"+a;h.m_heCtrl=y.first;y.first.setAttribute("rowNum",this.id+"_"+f);if(null!=y.last){var L=(b==""?"block":"none");y.last.style.display=L;y.last.id=this.id+"_"+(f)+"_"+a+"_data"}var z=new Array();var o=this.isFrozenCell(f,a);var M="";z[0]="height:"+g+"px;"+M;z[1]=(this.fixedCols<=a)&&O&&""!=this.backColorAlternate?"background-color:"+this.backColorAlternate+";":"";z[1]=o&&""!=this.backColorFrozen?"background-color:"+this.backColorFrozen+";":z[1];z[2]=o&&""!=this.foreColorFrozen?"color:"+this.foreColorFrozen+";":"";z[3]="";var m=this.m_mapColStyleInfo.find(a.toString());if(m!=undefined){if(m.type!="fixed"){var n="";var G=SBGrid.DEF.getPropertyNameList(m.style);for(var K=0,H=G.length;K<H;K++){n+=G[K]+":";n+=m.style[G[K]]+";"}z[3]=n;SBGrid.DEF.clearArray(G);G=n=null}}m=null;if(Q!=undefined){var s=Q.find(a.toString());if(s!=undefined){var G=SBGrid.DEF.getPropertyNameList(s);var n="";for(var K=0,H=G.length;K<H;K++){n+=G[K]+":";n+=s[G[K]]+";"}z[3]=n;SBGrid.DEF.clearArray(G);G=n=null}s=null}z[4]=b;y.first.style.cssText=z.join("");if(null!=v&&a==this.groupCol&&0<this.group){if(null!=h.m_heCtrl){var x=h.m_heCtrl.firstChild.firstChild.firstChild.firstChild;var M=(18*v.depth)+"px";var c=null!=this.m_objGroup[f+1]&&(v.depth+1)==this.m_objGroup[f+1].depth;x.className=c?(v.collapsed?this.m_objTreeClass.plus:this.m_objTreeClass.subtraction):this.m_objTreeClass.normal;x.style.width=M;x.setAttribute("row",f);v.isChild=c;v.heControl=x}}if(this.fixedCols<=a){this.setCellSelect(h,h.selected);SBGrid.CF.GridSetTextRefresh(h,SBGrid.CF.GridGetText(h),D,this.m_bIsDataReplaceValueChanged)}else{if(null!=h.text&&""!=h.text){SBGrid.CF.GridSetFixedWindowText(h,h.text)}else{if(a==0&&this.m_bRowHeader){if("seq"==this.rowheader){var l=String(f-this.fixedRows+1);SBGrid.CF.GridSetFixedWindowText(h,l)}else{if("reverseseq"==this.rowheader){var l=String(this.m_nRealRows-f);SBGrid.CF.GridSetFixedWindowText(h,l)}else{if("select"==this.rowheader){if(r){if(r.length==1){if(h==t){SBGrid.CF.GridChangeRowHeadSelect(t,true)}else{SBGrid.CF.GridChangeRowHeadSelect(h,false)}}else{if(r.length>1){if(C.find(N-r[0])==h){SBGrid.CF.GridChangeRowHeadSelect(C.find(N-r[0]),true)}else{SBGrid.CF.GridChangeRowHeadSelect(h,false)}}}}}else{if("update"==this.rowheader){h.setStatus(h.rowstatus);SBGrid.CF.GridChangeRowHeadUpdate(h,h.rowstatus)}}}}}else{var p=this.getRefOfCol(a);var F=this.getRowData(N);var w=F[p];var R=this.getColType(a);if(R=="combo"){w=this.getColCombo(a).getComboLabel(w)}else{if(q!=undefined&&D){w=(w==D[0]?D[1]:w);if(this.m_bIsDataReplaceValueChanged){F[p]=w;this.setRowData(N,F,false)}}}SBGrid.CF.GridSetFixedWindowText(h,w);p=F=w=R=null}}}}Q=null;d++}this.nHiddenTrTagCount=0;if(d!=this.m_arTempMatrix.length){for(var N=d;N<this.m_arTempMatrix.length;N++){this.m_arTempMatrix[N].hidden=true;var A=this.m_arTempMatrix[N].data[0].first;var u=A.parentNode.getAttribute("rownum");jQuery('tr[rownum="'+u+'"]').css("display","none");this.nHiddenTrTagCount+=1;A=null}}e=null;J=null;d=null;P=null;arDisplaySet=null};SBGrid.CT.DataGrid.prototype.scrollingCellStyle=function(b,c){var a=this.getCellEx(b,c);if(null!=a){if(null!=a.m_heCtrl){if(""!=this.backColorAlternate&&((b-this.fixedRows)%2)==1){strBGColor=this.backColorAlternate}else{strBGColor=""}a.m_heCtrl.style.backgroundColor=strBGColor;if(j<(this.fixedCols+this.frozenCols)){if(""!=this.backColorFrozen){a.m_heCtrl.style.backgroundColor=this.backColorFrozen}if(""!=this.foreColorFrozen){a.m_heCtrl.style.color=this.foreColorFrozen}}}}};SBGrid.CT.DataGrid.prototype.applyScrollCellStyle=function(b){if(null!=b){for(var a in b.m_objCellStyle){if(SBGrid.DEF.SB_STYLELIST[a]){b.setAttribute(a,b.m_objCellStyle[a])}}}};SBGrid.CT.DataGrid.prototype.reSetScrollRowVisible=function(c,a){for(var b=c;b<=a;b++){if(true==this.m_arHiddenRowState[b]){this.setRowDisplay(b,"")}}};SBGrid.CT.DataGrid.prototype.reSetScrollRowHidden=function(c,a){for(var b=c;b<=a;b++){if(true==this.m_arHiddenRowState[b]){this.setRowDisplay(b,"none")}}};SBGrid.CT.DataGrid.prototype.setLinkedData=function(b,a,c){if(this.isJsonRef()){b.setJsonObject(c)}else{b.setNodeElement(a)}};SBGrid.CT.DataGrid.prototype.setCellSelect=function(f,a,c){if(!c){f.selected=a}var g=f.m_heCtrl;if(null!=g){var b=g.getAttribute("sbgrid_select");var e=this.attribute.cellfocusclass;if(a&&"true"!=b){var d=jQuery(g);if(null!=e&&f.row==this.row&&f.col==this.col){d.addClass(e)}else{if(""!=this.m_strCellFocusColor&&f.col==this.col&&f.row==this.row){d.addClass("sbgrid_"+this.id+"_CellfocusColor")}else{d.addClass("sbgrid_"+this.id+"_focusColor")}}if(f.col==this.col){d.addClass("sb_cell_focus")}d.attr("sbgrid_select","true")}else{if(!a&&"false"!=b){var d=jQuery(g);if(null!=e){d.removeClass(e)}d.removeClass("sbgrid_"+this.id+"_focusColor").attr("sbgrid_select","false");if(""!=this.m_strCellFocusColor){d.removeClass("sbgrid_"+this.id+"_CellfocusColor").attr("sbgrid_select","false")}d.removeClass("sb_cell_focus")}}b=null}g=null};SBGrid.CT.DataGrid.prototype.setOverflowGrid=function(a){switch(a){case"visible":this.m_heCtrl.style.overflowX="visible";this.m_heCtrl.style.overflowY="visible";if(null!=this.m_heWhole){this.m_heWhole.style.overflowX="visible";this.m_heWhole.style.overflowY="visible"}this.resetHeightOverflow(a);break;case"hidden":this.m_heCtrl.style.overflowX="hidden";this.m_heCtrl.style.overflowY="hidden";if(null!=this.m_heWhole){this.m_heWhole.style.overflowX="hidden";this.m_heWhole.style.overflowY="hidden"}this.resetHeightOverflow(a);break;case"scroll":this.m_heCtrl.style.overflowX="hidden";this.m_heCtrl.style.overflowY="hidden";this.resetHeightOverflow(a);this.setScrollGrid(this.attribute.scroll);break;default:break}};SBGrid.CT.DataGrid.prototype.resetHeightOverflow=function(b){if(null!=this.m_heWhole){var c=this.m_heWhole.firstChild;if("visible"==b){var a=document.getElementById("SBHE_"+this.id+"_VLine").clientHeight;this.m_heCtrl.style.height=(c.clientHeight+a)+"px";this.m_heCtrl.style.width=(c.clientWidth+a)+"px"}else{this.m_heCtrl.style.width=this.getAttribute("width");this.m_heCtrl.style.height=this.getAttribute("height")}}};SBGrid.CT.DataGrid.prototype.setScrollGrid=function(a){if(null!=this.m_heWhole){switch(a){case"vertical":this.m_heWhole.style.overflowX="hidden";this.m_heWhole.style.overflowY="scroll";break;case"horizontal":this.m_heWhole.style.overflowX="scroll";this.m_heWhole.style.overflowY="hidden";break;case"both":this.m_heWhole.style.overflowX="scroll";this.m_heWhole.style.overflowY="scroll";break;case"autovscroll":this.m_heWhole.style.overflowX="hidden";this.m_heWhole.style.overflowY="auto";break;case"autohscroll":this.m_heWhole.style.overflowX="auto";this.m_heWhole.style.overflowY="hidden";break;case"none":this.m_heWhole.style.overflowX="visible";this.m_heWhole.style.overflowY="visible";break;default:this.m_heWhole.style.overflowX="auto";this.m_heWhole.style.overflowY="auto";break}}};SBGrid.CT.DataGrid.prototype.ContextMenu=function(a){var c=document.body;var d=document.createElement("div");var b=document.createElement("table");d.id="SBHE_ContextDiv_"+this.m_strTargetGrid;d.style.position="absolute";d.style.backgroundColor="white";d.style.border="2px outset #F2F2F2";d.style.verticalAlign="top";d.style.textAlign="left";d.style.zIndex="9999";d.style.visibility="hidden";b.id="SBHE_ContextMenuTable";b.style.top="0px";b.style.width="210px";b.border=0;b.cellPadding=0;b.cellSpacing=0;c.appendChild(d);d.appendChild(b);this.m_heContextMenu=d;c=null;d=null;b=null};SBGrid.CT.DataGrid.prototype.ContextMenuOnclick=function(event){if(this.m_bIsContextMenu!=true){return}if(this.m_heContextMenu){var ConTable=this.m_heContextMenu.firstChild.firstChild;var length=ConTable.childElementCount;for(var i=0;i<length;i++){var keyValue=ConTable.children[i].id;if(keyValue==null||keyValue==""){keyValue="ESC"}if(eval("SBGrid.EVT."+keyValue)==event.keyCode&&keyValue!="ESC"){if(ConTable.children[i].getAttribute("function")==null){return}ConTable.children[i].onclick()}else{if(keyValue=="ESC"){this.setConTextVisible(false)}}}this.setConTextVisible(false);ConTable=null;length=null}};SBGrid.CT.DataGrid.prototype.ContextAddItem=function(f,i,e,g,h){if(this.m_bIsContextMenu!=true){return}if(arguments.length<5){SBGrid.DEF.APIerrorMsg(this.m_strTargetGrid+".ContextAddItem","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof f!="boolean"){SBGrid.DEF.APIerrorMsg(this.m_strTargetGrid+".ContextAddItem","Please check if first parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof i!="string"){SBGrid.DEF.APIerrorMsg(this.m_strTargetGrid+".ContextAddItem","Please check if second parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof e!="string"){SBGrid.DEF.APIerrorMsg(this.m_strTargetGrid+".ContextAddItem","Please check if third parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof g!="function"){SBGrid.DEF.APIerrorMsg(this.m_strTargetGrid+".ContextAddItem","Please check if fourth parameter's type is 'function'.",SBGrid.DEF.DEBUG_MODE);return}if(!(h instanceof Array)){SBGrid.DEF.APIerrorMsg(this.m_strTargetGrid+".ContextAddItem","Please check if fifth parameter's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}if(f!=true){e="";g=null;f=false}var d=this.m_ContextIndex;var a=this.m_heContextMenu.firstChild.insertRow(d++);a.setAttribute("function",g);a.setAttribute("id",e);a.onmouseover=function(){this.style.fontWeight="bold";this.style.backgroundColor="#EBF4FA"};a.onmouseout=function(){this.style.backgroundColor="#F2F2F2";this.style.fontWeight="normal"};var b=this.m_strTargetGrid;a.onclick=function(){if(f!=true){return}g.apply(undefined,h);document.getElementById("SBHE_ContextDiv_"+b).style.visibility="hidden"};a.style.fontFamily=SBGrid.DEF.Lan_DefaultFontFamily;a.style.fontSize="10pt";a.style.fontWeight="normal";a.style.backgroundColor="#F2F2F2";if(f==true){a.style.color="#000000"}else{a.style.color="#808080"}a.style.cursor="default";var c=a.insertCell(0);c.style.width="185px";c.style.height="25px";c.style.textAlign="left";c.style.verticalAlign="middle";c.style.fontStyle="normal";c.style.paddingLeft="20px";c.innerHTML=i?i:"&nbsp;";c.style.borderTop="2px solid #F2F2F2";c.style.borderBottom="2px solid #F2F2F2";c.style.borderRight="2px solid #F2F2F2";this.m_ContextIndex++;a=null;d=null};SBGrid.CT.DataGrid.prototype.ContextAddSeparatorItem=function(){if(this.m_bIsContextMenu!=true){return}var c=this.m_ContextIndex;var b=this.m_heContextMenu.firstChild.insertRow(c++);b.style.cursor="default";var a=b.insertCell(0);a.style.width="185px";a.style.height="1px";a.style.backgroundColor="white";this.m_ContextIndex++;b=null;c=null};SBGrid.CT.DataGrid.prototype.ContextMenuDisplay=function(b){if(this.m_bIsContextMenu!=true){return}this.row=this.getMouseRow();this.col=this.getMouseCol();var a=this.m_heContextMenu;a.oncontextmenu=new Function("return false");a.style.left=b.clientX+jQuery(window).scrollLeft()+"px";a.style.top=b.clientY+jQuery(window).scrollTop()+"px";a.style.visibility="visible";a=null};SBGrid.CT.DataGrid.prototype.setConTextVisible=function(a){if(this.m_bIsContextMenu==true){if(this.m_heContextMenu){if(!a){this.m_heContextMenu.style.visibility="hidden"}else{if(a){this.m_heContextMenu.style.visibility="visible"}}}}};SBGrid.CT.DataGrid.prototype.createDefaultHtmlTag=function(e,a,z){var y=document.getElementById(e);if(y==null&&e=="body"){y=document.body}else{if(typeof SBUx!="undefined"&&y==null){y=document.getElementById("SBHE_"+e)}}if(this.m_bUseWebAccess==true){y.setAttribute("aria-hidden","true")}if(this.m_bIsContextMenu==true){this.ContextMenu(e)}if(this.m_arContextMenuList.length>0){for(var v=this.m_arContextMenuList.length-1;v>=0;v--){var m=this.m_arContextMenuList[v].bEnabled;var q=this.m_arContextMenuList[v].strTitle;var u=this.m_arContextMenuList[v].strShortcutKey;var r=this.m_arContextMenuList[v].fnFunction;var g=this.m_arContextMenuList[v].arArguments;if(q!=""&&q!=null&&q!=undefined){this.ContextAddItem(m,q,u,r,g)}if(q==""||q==null||q==undefined){this.ContextAddSeparatorItem()}}m=null;q=null;u=null;r=null;g=null}if(this.m_bIsCellsInfoDisplay==true){var t=document.createElement("div");t.setAttribute("id","SBHE_CellsInfoDiv_"+a);t.setAttribute("style"," text-align:center; padding-top: 5px; font-weight:bold; position:absolute; border:2px outset #F2F2F2; top:0px; left:0px; background-color:#FBFBFB; width:300px; height:25px; visibility:hidden; z-index:50;");var n=document.createElement("span");n.setAttribute("id","SBHE_spanCells_"+a+"");t.appendChild(n);document.body.appendChild(t);this.m_bIsCellsInfoDiv=t}var x=document.getElementById("SBHE_"+a);if(!x){x=document.createElement("div");x.setAttribute("id","SBHE_"+a)}else{jQuery(x).remove()}var s=jQuery(x);s.addClass("sbgrid_boxsizing sbgrid_datagrid").attr("style",z).attr("tabindex","0").css("outline","none");s=null;var p=document.getElementById("SBHE_"+a+"_HLine");if(!p){p=document.createElement("div");p.setAttribute("id","SBHE_"+a+"_HLine")}jQuery(p).addClass("sbgrid_datagrid_HLine");x.appendChild(p);var f=document.getElementById("SBHE_"+a+"_VLine");if(!f){f=document.createElement("div");f.setAttribute("id","SBHE_"+a+"_VLine")}jQuery(f).addClass("sbgrid_datagrid_VLine");x.appendChild(f);var h=document.getElementById("SBHE_"+a+"_MoveColBar");if(!h){h=document.createElement("div");h.setAttribute("id","SBHE_"+a+"_MoveColBar")}jQuery(h).addClass("sbgrid_datagrid_MoveColBar");x.appendChild(h);var l=document.getElementById("SBHE_DATAGRID_WHOLE_"+a);if(!l){l=document.createElement("div");l.setAttribute("id","SBHE_DATAGRID_WHOLE_"+a)}jQuery(l).addClass("sbgrid_datagrid_GridWhole sbgrid_datagrid_LayoutDiv");x.appendChild(l);var c=document.getElementById("SBHE_DATAGRID_EMPTY_RECORDS_"+a);if(!c){c=document.createElement("div");c.setAttribute("id","SBHE_DATAGRID_EMPTY_RECORDS_"+a)}jQuery(c).addClass("sbgrid_datagrid_GridWhole sbgrid_datagrid_LayoutDiv");x.appendChild(c);var o=document.getElementById("SBHE_DATAGRID_FIXED_FROZEN_SCROLLING_ROW_"+a);if(!o){o=document.createElement("div");o.setAttribute("id","SBHE_DATAGRID_FIXED_FROZEN_SCROLLING_ROW_"+a)}jQuery(o).addClass("sbgrid_datagrid_GridFFS sbgrid_datagrid_LayoutDiv");x.appendChild(o);var b=document.getElementById("SBHE_DATAGRID_FIXED_FROZEN_NOSCROLLING_ROW_"+a);if(!b){b=document.createElement("div");b.setAttribute("id","SBHE_DATAGRID_FIXED_FROZEN_NOSCROLLING_ROW_"+a)}jQuery(b).addClass("sbgrid_datagrid_GridFFS sbgrid_datagrid_LayoutDiv");x.appendChild(b);var w=document.getElementById("SBHE_DATAGRID_FIXED_FROZEN_COL_"+a);if(!w){w=document.createElement("div");w.setAttribute("id","SBHE_DATAGRID_FIXED_FROZEN_COL_"+a)}jQuery(w).addClass("sbgrid_datagrid_GridFFC sbgrid_datagrid_LayoutDiv");x.appendChild(w);y.appendChild(x);var d=document.getElementById("SBHE_DATAGRID_SEARCHING_DATA_"+a);if(!d){d=document.createElement("div");d.setAttribute("id","SBHE_DATAGRID_SEARCHING_DATA_"+a)}jQuery(d).addClass("sbgrid_datagrid_SearchingData sbgrid_datagrid_SearchingData_LayoutDiv");document.body.appendChild(d);SBGrid.DEF.__attachEventHandler("SBHE_"+a)};SBGrid.CT.DataGrid.initEngine=function(c,g){if(SBGrid.DEF.bParsed){return}SBGrid.DEF.__initWindow();SBGrid.DEF.__initDocument();SBGrid.DEF.__initWindowAndDocSize();if(SBGrid.DEF.is_ie7){var f=null,b="",a=document.styleSheets.length;if(g!=null&&g!="undefined"){b="Sbgrid_"+g+".css"}else{b="Sbgrid_default.css"}for(var e=0;e<a;e+=1){var f=document.styleSheets[e];if(-1!=f.href.indexOf(b)){break}}if(f!=null&&f.href!=""){f.removeRule(1);f.addRule(".sbgrid_boxsizing","behavior:url('"+SBGrid.DEF.__getAppName()+"kr/co/softbowl/css/boxsizing.htc');box-sizing:border-box;",0)}f=null;b=null;a=null}SBGrid.DS.SBHtml=new SBGrid.CT.HtmlHtml(null,"html","xhtml:html","xfs");SBGrid.DS.SBHead=new SBGrid.CT.HtmlHead("html","head","xhtml:head");SBGrid.DS.SBBody=new SBGrid.CT.HtmlBody("html","","","","",true,"",false,c,-1,"scroll","","","","","","","auto","","xhtml:body","visible");if(typeof SBUx!="undefined"){SBGrid.DEF.__attachEventHandler(document.body.id);SBGrid.DEF.__attachBlurEventHandler(document.body.id)}SBGrid.DS.XMLStorage.getUniqueStorage();SBGrid.DS.JsonStorage.getUniqueStorage();SBGrid.DS.XMLStorage.getUniqueStorage().initChildren();SBGrid.DEF.setFocus("body");SBGrid.DS.XMLStorage.getUniqueStorage().initTabIndex();if(SBGrid.DEF.is_smartphone){jQuery("#"+c).css("-webkit-tap-highlight-color","rgba(0,0,0,0)")}if("visible"==SBGrid.DS.SBBody.getAttribute("visibility")){var d=document.getElementById(c);if(typeof SBUx!="undefined"&&d==null){d=document.getElementById("SBHE_"+c)}if(d==null&&c=="body"){d=document.body;d.id="body"}d.style.visibility="visible"}};SBGrid.CT.DataGrid.prototype.addRow=function(){this.addItem(true,false,false)};SBGrid.CT.DataGrid.prototype.removeRow=function(){this.removeItem(true,false)};SBGrid.CT.DataGrid.prototype.insertRow=function(c,d,e,b,a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".insertRow","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".insertRow","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof d)!="string"){d="below"}else{if(d!="above"&&d!="below"){d="below"}}if(e==null){e=false}if(b==null){b=false}if(a==null){a=false}this.insertItem(c,d,e,b,a)};SBGrid.CT.DataGrid.prototype.deleteRow=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".deleteRow","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".deleteRow","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}this.deleteItem(a,false,false,false)};SBGrid.CT.DataGrid.prototype.getRows=function(){return this.rows};SBGrid.CT.DataGrid.prototype.getCols=function(){return this.cols};SBGrid.CT.DataGrid.prototype.getFixedRows=function(){return this.fixedRows};SBGrid.CT.DataGrid.prototype.getFixedCols=function(){return this.fixedCols};SBGrid.CT.DataGrid.prototype.getRowStatus=function(b){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".getRowStatus","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b=="string"){b=parseInt(b)}if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getRowStatus","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}var a=this.getCellEx(b,0);if(a){return a.getStatus()}else{SBGrid.DEF.APIerrorMsg(this.id+".getRowStatus","Please check if first parameter's value is valid row number.",SBGrid.DEF.DEBUG_MODE);return}return 0};SBGrid.CT.DataGrid.prototype.addStatus=function(b,a){switch(a){case"insert":this.setRowStatus(b,this.getRowStatus(b)|SBGrid.DEF.SBGS_INSERT);break;case"update":this.setRowStatus(b,this.getRowStatus(b)|SBGrid.DEF.SBGS_UPDATE);break;case"delete":this.setRowStatus(b,this.getRowStatus(b)|SBGrid.DEF.SBGS_DELETE);break}};SBGrid.CT.DataGrid.prototype.clearStatus=function(){this.m_arUpdateDeleteList=new Array();for(var a=this.fixedRows;a<this.m_nRealRows;a++){this.setRowStatus(a,SBGrid.DEF.SBGS_NEW)}};SBGrid.CT.DataGrid.prototype.removeStatus=function(e,b){if(e+1<this.fixedRows){return}var d;switch(b){case"insert":d=SBGrid.DEF.SBGS_INSERT;break;case"update":d=SBGrid.DEF.SBGS_UPDATE;break;case"delete":d=SBGrid.DEF.SBGS_DELETE;break;default:return;break}var a=this.getRowStatus(e);var c=a&(~d);this.setRowStatus(e,c)};SBGrid.CT.DataGrid.prototype.rowStatus=function(a){return this.getRowStatus(a)};SBGrid.CT.DataGrid.prototype.setRowStatus=function(d,a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setRowStatus","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof d=="string"){d=parseInt(d)}if(typeof d!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setRowStatus","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(a==null){a=0}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setRowStatus","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}for(var c=0;c<this.cols;c++){var b=this.getCellEx(d,c);if(b){b.setStatus(a);if(a==SBGrid.DEF.SBGS_NEW&&b.m_bUserAddCell){b.m_bUserAddCell=false}if(0==c&&this.m_bRowHeader&&SBGrid.DEF.SBRH_UPDATE==this.getRowHeader()){SBGrid.CF.GridChangeRowHeadUpdate(b,a)}}}};SBGrid.CT.DataGrid.prototype.getGridStatusAll=function(c){if(null==c){c=""}var g;var f=this.attribute.colsep;var b=this.attribute.rowsep;g="m"+f+"rownum";var m=this.m_bRowHeader?1:0;for(var e=0+m;e<this.cols;e++){var h=this.m_arColumn[e].getAttribute("ref");if(h==null||h==""){continue}g+=f;g+=h}if(this.m_bIsRealDataSync){for(var e=0,l=this.m_arExtRefList.length;e<l;e++){g+=f;g+=this.m_arExtRefList[e]}}g+=b;for(var e=this.fixedRows;e<this.m_nRealRows;e++){g+=c;g+=f;g+=String(e);for(var d=0+m;d<this.cols;d++){var h=this.m_arColumn[d].getAttribute("ref");if(h==null||h==""){continue}g+=f;g+=SBGrid.CF.GridGetText(this.getCellEx(e,d))}if(this.m_bIsRealDataSync){for(var d=0,l=this.m_arExtRefList.length;d<l;d++){g+=f;var a=this.m_xlRefNode[e-this.fixedRows][this.m_arExtRefList[d]];g+=(a==undefined?"":a);a=null}}g+=b}return g};SBGrid.CT.DataGrid.prototype.getGridStatus=function(f,c,a){var e;var m;var l=this.attribute.colsep;var d=this.attribute.rowsep;switch(f){case"insert":e=1;break;case"delete":e=4;break;case"update":e=2;break;default:e=0;break}if(c==null){c="m"}else{c=String(c)}if(a==null){a="rownum"}else{a=String(a)}m=c+l+a;var q=this.m_bRowHeader?1:0;for(var h=0+q;h<this.cols;h++){var n=this.m_arColumn[h].getAttribute("ref");if(n==null||n==""){continue}m+=l;m+=n}if(this.m_bIsRealDataSync){for(var h=0,o=this.m_arExtRefList.length;h<o;h++){m+=l;m+=this.m_arExtRefList[h]}}m+=d;if(0==e||4==e){for(var h=0;h<this.m_arUpdateDeleteList.length;h++){m+=this.m_arUpdateDeleteList[h]}}for(var h=this.fixedRows;h<this.m_nRealRows;h++){var p=this.getRowStatus(h);if(3==p){p=1}else{if(4<p&&7>p){p=4}}if(0<p&&(p==e||0==e)){switch(p){case 1:m+="i";break;case 2:m+="u";break;case 4:m+="d";break}m+=l;m+=String(h);for(var g=0+q;g<this.cols;g++){var n=this.m_arColumn[g].getAttribute("ref");if(n==null||n==""){continue}m+=l;m+=SBGrid.CF.GridGetText(this.getCellEx(h,g))}if(this.m_bIsRealDataSync){for(var g=0,o=this.m_arExtRefList.length;g<o;g++){m+=l;var b=this.m_xlRefNode[h-this.fixedRows][this.m_arExtRefList[g]];m+=(b==undefined?"":b);b=null}}m+=d}}return m};SBGrid.CT.DataGrid.prototype.setMergeCells=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setMergeCells","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setMergeCells","Please check if parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(this.autoMerge){if(this.mergeCells!=a){this.mergeCancellation(this.m_arMergeList,this.m_htMergeColList);this.m_htMergeColList={}}this.mergeCells=a;this.mergeDataCells()}else{this.mergeCells=a}};SBGrid.CT.DataGrid.prototype.getMergeCells=function(){return this.mergeCells};SBGrid.CT.DataGrid.prototype.getMergeCellsFixedCols=function(){return this.mergeCellsFixedCols};SBGrid.CT.DataGrid.prototype.getMergeCellsFixedRows=function(){return this.mergeCellsFixedRows};SBGrid.CT.DataGrid.prototype.isColHidden=function(b){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".isColHidden","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".isColHidden","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}var a=this.m_arColumn[b];if(null!=a){return a.m_bHiddenState}};SBGrid.CT.DataGrid.prototype.colHidden=function(a){if(null==a||(0>a||this.cols<=a)){return false}return this.m_arColumn[a].m_bHiddenState};SBGrid.CT.DataGrid.prototype.getColHidden=function(a){return this.colHidden(a)};SBGrid.CT.DataGrid.prototype._rCH=function(){var a=false;this.m_objHeArea.bTotalHiddenCheck=true;for(var b=0;b<this.cols;b++){var c=this.m_arColumn[b];if(null!=c){this._sCH(b,c.m_bHiddenState,a)}}this.gridSetTables();this.m_objHeArea.bTotalHiddenCheck=false};SBGrid.CT.DataGrid.prototype._sCH=function(d,c,a){if(c){this.m_arColumn[d].m_bHiddenState=c;var b=this.m_arHiddenCol[d];this.setColWidth(d,0,a);this.m_arHiddenCol[d]=b}else{this.m_arColumn[d].m_bHiddenState=c;if(0==this.m_arHiddenCol[d]){this._sCW(d,0,a)}else{this._sCW(d,this.m_arHiddenCol[d],a)}}if(!this.m_objHeArea.bTotalHiddenCheck){this.clearMerge();if(this.autoMerge){this.merge()}if(this.m_bIsMergeByFree){this.reMergeByFree()}}};SBGrid.CT.DataGrid.prototype._sCW=function(l,n,o){var f=this.m_arColumn[l];if(f.m_bHiddenState){this.m_arHiddenCol[l]=n;n=0}else{this.m_arHiddenCol[l]=n}var b=false;var a=null;if(!o){a=0==n?"none":"block";if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7||SBGrid.DEF.is_ie9){jQuery('col[colNum="'+this.id+"_"+l+'"]').css("display",a);if(SBGrid.DEF.is_ie8||SBGrid.DEF.is_ie9){jQuery('td[colNum="'+this.id+"_"+l+'"]').css("display",a)}}else{b=true}}this.m_arColWidth[l]=n;if(!o){this.setColGroupWidth(l,n);if(this.extendLastCol&&!this.m_objHeArea.bTotalHiddenCheck){this.setExtendLastCol(this.extendLastCol,true)}}var d=SBGrid.DEF.SBSM_COLHIDE;var p=a=="none"?true:false;if(0==n){for(var h=this.m_objScroll.nTopRow;h<this.m_objScroll.nBottomRow;h++){var g=this.getCellEx(h,l);if(null!=g){if(b){if(null!=g.m_heCtrl){var c=null!=g.m_heCtrl.lastChild&&null!=g.m_heCtrl.lastChild.tagName?g.m_heCtrl.lastChild:g.m_heCtrl;if(p){c.style.display=a}else{c.style.display=""}}}g.mergeType=d}}}else{var e=SBGrid.DEF.SBSM_NORMAL;var m=SBGrid.DEF.SBSM_LOCK;for(var h=this.m_objScroll.nTopRow;h<this.m_objScroll.nBottomRow;h++){var g=this.getCellEx(h,l);if(null!=g){if(b){if(null!=g.m_heCtrl){var c=null!=g.m_heCtrl.lastChild&&null!=g.m_heCtrl.lastChild.tagName?g.m_heCtrl.lastChild:g.m_heCtrl;if(p){c.style.display=a}else{c.style.display=""}}}if(g.mergeType==d){if(f.m_bMerge){g.mergeType=e}else{g.mergeType=m}}}}e=null;m=null}d=null;if(o){return}if(!this.m_objHeArea.bTotalHiddenCheck){this.gridSetTables()}};SBGrid.CT.DataGrid.prototype.reSetColHidden=function(a){if(a==null){a=false}else{if(typeof a!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".reSetColHidden","Please check if parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}this.m_objHeArea.bTotalHiddenCheck=true;for(var b=0;b<this.cols;b++){var c=this.m_arColumn[b];if(null!=c){this.setColHidden(b,c.m_bHiddenState,a)}}this.gridSetTables();this.m_objHeArea.bTotalHiddenCheck=false};SBGrid.CT.DataGrid.prototype.setColHidden=function(d,c,a){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setColHidden","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof d!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setColHidden","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setColHidden","Please check if second parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}if(0>d||this.cols<=d){return}if(a==null||typeof a=="undefined"){a=false}a=false;if(c){this.m_arColumn[d].m_bHiddenState=c;var b=this.m_arHiddenCol[d];this.setColWidth(d,0,a);this.m_arHiddenCol[d]=b}else{this.m_arColumn[d].m_bHiddenState=c;if(0==this.m_arHiddenCol[d]){this.setColWidth(d,0,a)}else{this.setColWidth(d,this.m_arHiddenCol[d],a)}}if(!this.m_objHeArea.bTotalHiddenCheck){this.clearMerge();if(this.autoMerge){this.merge()}if(this.m_bIsMergeByFree){this.reMergeByFree()}}this.dispatch("onresize")};SBGrid.CT.DataGrid.prototype.getHideColumnCount=function(){this.setHideColumnCount();return this.m_nHideColumnsCount};SBGrid.CT.DataGrid.prototype.setHideColumnCount=function(){this.m_nHideColumnsCount=0;for(var a=0;a<this.getCols();a++){var b=this.m_arColumn[a];if(null!=b){if(b.m_bHiddenState){this.m_nHideColumnsCount+=1}}}};SBGrid.CT.DataGrid.prototype.getAutoResize=function(){return this.autoResize};SBGrid.CT.DataGrid.prototype.setAutoResize=function(h,l){if(h==null){h=true}else{if(typeof h!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setAutoResize","Please check if first parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(l==null){l=false}else{if(typeof l!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setAutoResize","Please check if second parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(SBGrid.DEF.is_smartphone){this.autoResize=h;this.attribute.autoresize=String(h);if(this.autoResize){if(null!=this.m_heWhole.firstChild){this.m_heWhole.firstChild.style.tableLayout="auto"}}else{if(null!=this.m_heWhole.firstChild){this.m_heWhole.firstChild.style.tableLayout="fixed"}}return}if(this.autoResize!=h){this.autoResize=h;this.attribute.autoresize=String(h);var e=this.autoResize?"break-word":"normal";for(var r=this.fixedCols;r<this.cols;r++){for(var q=this.fixedRows;q<this.m_nRealRows;q++){if(this.isPhysicalRow(q)){var m=this.getCellEx(q,r);if(null!=m){var b=m.m_heDCtrl;if(null!=b){b.style.wordWrap=e;var v=null;var g=jQuery(b);v=g.text();if(this.autoResize){g.html(v)}else{g.html('<span style="white-space:nowrap;">'+v+"</span>")}g=null}b=null}}}}}this.autoResizeHeight();this.lockedUpHeight(l);var s=this.fixedCols+this.frozenCols;var u=this.fixedRows+this.frozenRows;var f=this.m_nRealRows-this.frozenBottomRows;var d=this.m_heWhole.firstChild.lastChild;var o;var t;var p;var a;var c;if(null!=this.m_heFFS){this.m_heFFS.style.height=this.getFixedFrozenRowHeight()+"px";this.m_heFFNS.style.height=this.getFixedFrozenRowHeight()+"px";if(document.doctype==null){if(!SBGrid.DEF.is_ie7&&!SBGrid.DEF.is_ie8&&!SBGrid.DEF.is_ie9){this.m_heFFS.style.height=this.getFixedFrozenRowHeight()-1+"px";this.m_heFFNS.style.height=this.getFixedFrozenRowHeight()-1+"px"}}o=this.m_heFFS.firstChild.lastChild;t=this.m_heFFNS.firstChild.lastChild;if(this.m_nRowHeight==0){this.m_heFFC.style.top=(parseInt(this.getFixedFrozenRowHeight()+1)).toString()+"px"}else{if(SBGrid.DEF.is_mozBrowser){this.m_heFFC.style.top=(parseInt(this.getFixedFrozenRowHeight()+1)).toString()+"px"}else{this.m_heFFC.style.top=this.getFixedFrozenRowHeight()+"px";if(document.doctype==null){if(!SBGrid.DEF.is_ie7&&!SBGrid.DEF.is_ie8&&!SBGrid.DEF.is_ie9){this.m_heFFC.style.top=this.getFixedFrozenRowHeight()-1+"px"}}}}var n=this.getFixedFrozenRowHeight();if(this.m_heWhole.clientHeight-n<0){this.m_heFFC.style.height=n+"px"}else{this.m_heFFC.style.height=this.m_heWhole.clientHeight-this.getFixedFrozenRowHeight()+"px"}p=this.m_heFFC.firstChild.lastChild}if(null!=this.m_heFFBS){this.m_heFFBS.style.height=this.getFrozenBottomRowHeight()+"px";this.m_heFFBS.style.top=this.m_heWhole.clientHeight-this.getFrozenBottomRowHeight()+"px";a=this.m_heFFBS.firstChild.lastChild;this.m_heFFBNS.style.height=this.getFrozenBottomRowHeight()+"px";this.m_heFFBNS.style.top=this.m_heWhole.clientHeight-this.getFrozenBottomRowHeight()+"px";c=this.m_heFFBNS.firstChild.lastChild}if(!l){if(this._isHScroll()&&this.m_objHeArea.bChangeWidth){this.m_heFFC.style.height=this.m_heWhole.clientHeight-this.m_heFFNS.clientHeight+"px";if(null!=this.m_heFFBS){this.m_heFFBS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBS.clientHeight)+"px";this.m_heFFBNS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBNS.clientHeight)+"px"}}else{if(this.m_objHeArea.bChangeWidth){this.m_heFFC.style.height=this.m_heWhole.clientHeight-this.getFixedFrozenRowHeight()+"px";if(null!=this.m_heFFBS){this.m_heFFBS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBS.clientHeight)+"px";this.m_heFFBNS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBNS.clientHeight)+"px"}}}}};SBGrid.CT.DataGrid.prototype.getBackColorAlternate=function(){return this.backColorAlternate};SBGrid.CT.DataGrid.prototype.setBackColorAlternate=function(g,b){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setBackColorAlternate","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}else{if(b==null){b=false}if((typeof g)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setBackColorAlternate","Please check if parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}else{if(g==""){SBGrid.DEF.APIerrorMsg(this.id+".setBackColorAlternate","Please check parameter's value.",SBGrid.DEF.DEBUG_MODE);return}else{if(SBGrid.DEF.vaildCheckOfColor(g)==false){SBGrid.DEF.APIerrorMsg("setBackColorAlternate","Please check parameter's value.",SBGrid.DEF.DEBUG_MODE);return}this.attribute.backcoloralternate=g;this.backColorAlternate=g;if(!b){var e=false;if(""!=this.backColorFrozen){e=true}var h=!e?this.fixedRows:this.fixedRows+this.frozenRows;var a=!e?this.fixedCols:this.fixedCols+this.frozenCols;if(!e){for(var f=this.fixedCols;f<this.cols;f++){for(var d=this.fixedRows;d<h;d++){this.setCellBCAColor(d,f)}for(var d=this.m_nRealRows-this.m_nBottomRowCount;d<this.m_nRealRows;d++){this.setCellBCAColor(d,f)}}}if(this.m_objScroll.bScrollEvent){h=this.m_objScroll.nTopRow;var c=this.m_objScroll.nBottomRow;for(var f=h;f<=c;f++){for(var d=a;d<this.cols;d++){this.setCellBCAColor(f,d)}}}else{for(var f=h;f<this.m_nRealRows-this.m_nBottomRowCount;f++){for(var d=a;d<this.cols;d++){this.setCellBCAColor(f,d)}}}}}}}};SBGrid.CT.DataGrid.prototype.getDataHeight=function(){return this.dataHeight};SBGrid.CT.DataGrid.prototype.setDataHeight=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setDataHeight","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setDataHeight","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(0<a){var c=null;for(var b=this.fixedRows;b<this.m_nRealRows;b++){c=this.getCellEx(b,0);if(null!=c){this.setRowHeight(b,a)}c=null}this.dataHeight=a;this.makeScrollDiv(this.m_heGridScrollDivCell,true);if(null!=this.m_heFFC){this.makeScrollDiv(this.m_heFFGridScrollDivCell,false)}if(this.autoResize){this.reSizeScrollDiv()}else{this.reSizeScrollDiv();this.scrollAttributeSetting()}}};SBGrid.CT.DataGrid.prototype.setRowHeightMin=function(c){this.rowHeightMin=c;var b=false;for(var a=0;a<this.m_nRealRows;a++){if(null!=this.m_htRowHeight[a]&&c>this.m_htRowHeight[a]){if(a<this.fixedRows){this.setRowHeight(a,c,true);b=true}else{if(this.isPhysicalRow(a)){this.setRowHeight(a,c,true);b=true}else{this.m_htRowHeight[a]=c}}}else{if(null==this.m_htRowHeight[a]){this.m_htRowHeight[a]=c}}}if(b){this.rowHeightResize()}};SBGrid.CT.DataGrid.prototype.getFrozenCols=function(){return this.frozenCols};SBGrid.CT.DataGrid.prototype.setFrozenCols=function(u){if(u.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setFrozenCols","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof u!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setFrozenCols","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}u=parseInt(u);this.stopEditing();if(this.frozenCols==u||this.cols<(u+this.fixedCols)||0>u){return}this.clearSelection();this.clearMerge();if(!SBGrid.DEF.is_smartphone){if(this.frozenCols<u){this.setColGroupCount(u);var n=this.m_heFFC.firstChild.lastChild;var s=this.m_heFFNS.firstChild.lastChild;var c=this.m_heFFBNS.firstChild.lastChild;var l=this.fixedCols;for(var q=(l+this.frozenCols);q<(l+u);q++){for(var p=0;p<this.m_nRealRows;p++){var g=this.getCellEx(p,q);if(null!=g&&null!=g.m_heCtrl){var f=0;var o=g.m_heCtrl;var b=o.cloneNode(false);b.id="";if(SBGrid.DEF.is_firefox){var r=o.parentNode;f=r.rowIndex;r.insertBefore(b,o)}else{var r=o.parentElement;f=r.rowIndex;r.insertBefore(b,o)}var d;if(p<this.fixedRows+this.frozenRows){o.setAttribute("targetcell","ffn");o.setAttribute("colspan","");o.setAttribute("rowspan","");d=s.children[p];d.appendChild(o)}else{if(p>=(this.m_nRealRows-this.frozenBottomRows)){o.setAttribute("targetcell","ffbn");d=c.children[p-(this.m_nRealRows-this.frozenBottomRows)];d.appendChild(o)}else{o.setAttribute("targetcell","ffc");o.setAttribute("frozencell","true");o.setAttribute("cellname",this.id+"_fnc");d=n.children[f-(this.fixedRows+this.frozenRows)];d.appendChild(o)}}}}}}else{this.setColGroupCount(u);var e=this.m_heWhole.firstChild.lastChild;var n=this.m_heFFC.firstChild.lastChild;var m=this.m_heFFS.firstChild.lastChild;var a=this.m_heFFBS.firstChild.lastChild;for(var q=(this.fixedCols+this.frozenCols-1);q>=(this.fixedCols+u);q--){for(var p=0;p<this.m_nRealRows;p++){var g=this.getCellEx(p,q);if(null!=g&&null!=g.m_heCtrl){var o=g.m_heCtrl;var d;if(p<this.fixedRows+this.frozenRows){o.setAttribute("targetcell","ffs");d=m.children[p];var h=d.children[q];d.insertBefore(o,h);d.removeChild(h)}else{if(p>=(this.m_nRealRows-this.frozenBottomRows)){o.setAttribute("targetcell","ffbs");d=a.children[p-(this.m_nRealRows-this.frozenBottomRows)];var h=d.children[q];d.insertBefore(o,h);d.removeChild(h)}else{var f=0;if(SBGrid.DEF.is_firefox){var r=o.parentNode;f=r.rowIndex}else{var r=o.parentElement;f=r.rowIndex}f+=(this.fixedRows+this.frozenRows);d=e.children[f];var h=d.children[q];d.insertBefore(o,h);d.removeChild(h);o.removeAttribute("frozencell");if(""!=this.backColorFrozen){g.m_heCtrl.style.backgroundColor=""}}}}}}}this.frozenCols=u;var t=this.getFixedFrozenColWidth();if(SBGrid.DEF.is_ie7){this.m_heFFNS.style.width=(this.getFixedFrozenColWidth()+this.fixedCols)+"px"}else{this.m_heFFNS.style.width=(this.getFixedFrozenColWidth()+1)+"px"}this.m_heFFNS.firstChild.width=t;if(SBGrid.DEF.is_ie7){this.m_heFFC.style.width=(this.getFixedFrozenColWidth()+this.fixedCols)+"px"}else{this.m_heFFC.style.width=(this.getFixedFrozenColWidth()+1)+"px"}this.m_heFFC.firstChild.width=t;if(0<this.frozenBottomRows){this.m_heFFBNS.style.width=t+"px";this.m_heFFBNS.firstChild.width=t}this.defaultAttributeSetting();if(0<this.frozenBottomRows){this.m_heFFC.style.height=(this.m_heWhole.clientHeight-this.m_heFFNS.clientHeight)+"px"}else{this.m_heFFC.style.height=this.m_heWhole.clientHeight-this.getFixedFrozenRowHeight()+"px"}this.m_heFFBS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBS.clientHeight)+"px";this.m_heFFBNS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBNS.clientHeight)+"px"}else{this.frozenCols=u;this.defaultAttributeSetting()}if(this.autoMerge){this.merge()}if(this.m_bIsMergeByFree){this.reMergeByFree()}};SBGrid.CT.DataGrid.prototype.getFrozenRows=function(){return this.frozenRows};SBGrid.CT.DataGrid.prototype.setFrozenRows=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setFrozenRows","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setFrozenRows","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}this.stopEditing();if(this.frozenRows==a||this.m_nRealRows-this.frozenBottomRows<(a+this.fixedRows)||0>a){return}if(this.m_objScroll.nTopRow>(this.frozenRows+this.fixedRows)){this.m_heWhole.scrollTop=0;window.setTimeout("SBGrid.getGrid('"+this.id+"').setFrozenRowsEx("+a+")",300)}else{this.setFrozenRowsEx(a)}};SBGrid.CT.DataGrid.prototype.setFrozenRowsEx=function(c){this.clearSelection();this.clearMerge();if(!SBGrid.DEF.is_smartphone){if(this.frozenRows<c){var p=this.m_heFFC.firstChild.lastChild;var m=this.m_heFFS.firstChild.lastChild;var d=this.m_heFFNS.firstChild.lastChild;var t;for(var l=(this.fixedRows+this.frozenRows);l<=c;l++){t=document.createElement("tr");m.appendChild(t);t=document.createElement("tr");d.appendChild(t);for(var h=0;h<this.cols;h++){var g=this.getCellEx(l,h);if(null!=g){var o=g.m_heCtrl;var f=o.cloneNode(false);f.id="";if(!(h<this.fixedCols+this.frozenCols&&l>=(this.fixedRows+this.frozenRows))){if(SBGrid.DEF.is_firefox){o.parentNode.insertBefore(f,o)}else{o.parentElement.insertBefore(f,o)}}var q;if(h<this.fixedCols+this.frozenCols){q=m.children[l];var f=o.cloneNode(false);f.id="";q.appendChild(f);q=d.children[l];q.appendChild(o)}else{o.setAttribute("frozencell","true");q=m.children[l];q.appendChild(o)}}}}for(var l=0;l<(c-this.frozenRows);l++){if(0<this.fixedCols+this.frozenCols){p.removeChild(p.firstChild)}}}else{var n=this.m_heWhole.firstChild.lastChild;var p=this.m_heFFC.firstChild.lastChild;var m=this.m_heFFS.firstChild.lastChild;var d=this.m_heFFNS.firstChild.lastChild;var t;for(var l=(this.fixedRows+this.frozenRows)-1;l>c;l--){if(0<this.fixedCols+this.frozenCols){p.insertBefore(document.createElement("tr"),p.firstChild)}for(var h=0;h<this.cols;h++){var g=this.getCellEx(l,h);if(null!=g){var o=g.m_heCtrl;var q;if(h<this.fixedCols+this.frozenCols){q=p.firstChild;q.appendChild(o)}else{q=n.children[l];var e=q.children[h];q.insertBefore(o,e);q.removeChild(e);o.removeAttribute("frozencell");if(""!=this.backColorFrozen){g.m_heCtrl.style.backgroundColor=""}}}}m.removeChild(m.lastChild);d.removeChild(d.lastChild)}}this.frozenRows=c;this.attribute.frozenrows=String(c);var r=this.getFixedFrozenRowHeight();this.m_heFFS.style.height=r+"px";this.m_heFFNS.style.height=r+"px";this.m_heFFC.style.top=r+"px";if(document.doctype==null){if(!SBGrid.DEF.is_ie7&&!SBGrid.DEF.is_ie8&&!SBGrid.DEF.is_ie9){this.m_heFFS.style.height=this.getFixedFrozenRowHeight()-1+"px";this.m_heFFNS.style.height=this.getFixedFrozenRowHeight()-1+"px";this.m_heFFC.style.top=r-1+"px"}}this.defaultAttributeSetting();if(0<this.frozenBottomRows){this.m_heFFC.style.height=(this.m_heWhole.clientHeight-this.m_heFFNS.clientHeight)+"px"}else{this.m_heFFC.style.height=this.m_heWhole.clientHeight-this.getFixedFrozenRowHeight()+"px"}this.m_heFFBS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBS.clientHeight)+"px";this.m_heFFBNS.style.top=(this.m_heWhole.clientHeight-this.m_heFFBNS.clientHeight)+"px"}else{this.frozenRows=c;this.defaultAttributeSetting()}if(this.autoMerge){this.merge()}if(this.m_bIsMergeByFree){this.reMergeByFree()}var s=this.m_objScroll;var a=0;this.m_arTempMatrix=new Array();s.nStartRow=this.fixedRows+this.frozenRows;s.nTopRow=this.fixedRows+this.frozenRows;var b=this.m_nRealRows+s.nStartRow-this.m_nMakeIndex-this.frozenBottomRows;s.nEndRow=b;for(var l=s.nTopRow;l<=s.nBottomRow;l++){this.m_arTempMatrix.push({data:new Array(),hidden:false});for(var h=0;h<this.cols;h++){var g=this.getCellEx(s.arTargetRow[l],h);if(null!=g){if(this.m_arTempMatrix){if(g.m_heCtrl==null){SBGrid.CF.GridInit(g)}this.m_arTempMatrix[a].data[h]={first:g.m_heCtrl,last:g.m_heDCtrl}}}}a++}s=null;a=null;b=null};SBGrid.CT.DataGrid.prototype.getFrozenBottomRows=function(){return this.frozenBottomRows};SBGrid.CT.DataGrid.prototype.setFrozenBottomRows=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setFrozenBottomRows","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setFrozenBottomRows","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}this.stopEditing();if(this.frozenBottomRows==a||(this.m_nRealRows-this.frozenRows)<(a+this.fixedRows)||0>a){return}this.frozenBottomRows=a;this.attribute.frozenbottomrows=String(a);this.rebuild();var f;var b=this.m_replaceString;if(b!=""&&b!="undefined"&&b!=null){f=b.split("?")}for(var e=this.m_nRealRows-this.m_nBottomRowCount;e<this.m_nRealRows;e++){for(var c=this.fixedCols;c<this.cols;c++){var d=this.getCellEx(e,c);if(null!=d){SBGrid.CF.GridSetTextRefresh(d,SBGrid.CF.GridGetText(d),f,this.m_bIsDataReplaceValueChanged)}}}};SBGrid.CT.DataGrid.prototype.getCaption=function(){return this.attribute.caption};SBGrid.CT.DataGrid.prototype.getCurrentCaption=function(){var e="";var b=this.getRowHeader()>0?1:0;for(var d=0;d<this.m_arCaption.length;d++){var a=this.m_arCaption[d];if(e!=""){e=e+"|"}for(var c=b;c<a.length;c++){e=e+a[c];if(a.length-1!=c){e=e+"^"}}}return e};SBGrid.CT.DataGrid.prototype.setCaption=function(g){this.deleteMultiSortShowIcon();if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setCaption","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof g)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setCaption","Please check if parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}this.caption=g;this.attribute.caption=g;var a=g.split("|");this.m_arCaption=new Array();for(var f=0;f<a.length;f++){this.m_arCaption[f]=new Array();var m=a[f];var c=m.split("^");if(this.m_bRowHeader){this.m_arCaption[f][0]=" "}for(var e=0;e<c.length&&e<this.cols;e++){this.m_arCaption[f][(this.m_bRowHeader)?e+1:e]=c[e]}}if(this.fixedRows!=this.m_arCaption.length){this.rebuild();return}this.mergeCancellation(this.m_arMergeFixedRowList,this.m_htMergeFRColList);this.m_htMergeFRColList={};this.m_arMergeFixedRowList=new Array;for(var f=0;f<this.fixedRows;f++){for(var e=0;e<this.cols;e++){if(this.getColWidth(e)==0){continue}var d=this.getCellEx(f,e);if(null!=d){if(d.m_fixedInputType==SBGrid.DEF.SBIT_CHECK||d.m_fixedInputType==SBGrid.DEF.SBIT_INPUTBUTTON){continue}var l=this.m_arCaption[f][e];if(l==null){l=""}if(this.m_objSortIcon&&this.m_objSortIcon.nSortedCol==e){if(this.m_objSortIcon.heBeforeCell==d.m_heCtrl){continue}}SBGrid.CF.GridSetFixedWindowText(d,l.newlineCharConvert())}}}var h="";for(var f=0;f<this.fixedRows;f++){for(var e=0;e<this.cols;e++){var b=this.m_arColumn[e];var d=this.getCellEx(f,e);if(this.m_arCaption[f][e]){h=this.m_arCaption[f][e].newlineCharConvert();if(b&&b.m_fnFixedRenderer){h=b.m_fnFixedRenderer.call(this,this.id,f,e,h);SBGrid.CF.GridSetFixedWindowText(d,h)}}}}this.mergeFixedRows();this.setMultiSortShowIcon()};SBGrid.CT.DataGrid.prototype.setSubTotalPosition=function(a){this.subtotalPosition=a};SBGrid.CT.DataGrid.prototype.getSubTotalPosition=function(){return this.subtotalPosition};SBGrid.CT.DataGrid.prototype.setDataStyle=function(a){this.m_htDataStyle=a;this.applyBaseCellCSS("data")};SBGrid.CT.DataGrid.prototype.setFixedStyle=function(a){this.m_htFixedStyle=a;this.applyBaseCellCSS("fixed")};SBGrid.CT.DataGrid.prototype.getDataStyle=function(){if(null==this.m_htDataStyle){this.m_htDataStyle={}}return this.m_htDataStyle};SBGrid.CT.DataGrid.prototype.getFixedStyle=function(a){if(null==this.m_htFixedStyle){this.m_htFixedStyle={}}return this.m_htFixedStyle};SBGrid.CT.DataGrid.prototype.setDataAttribute=function(b,a){if(null==this.m_htDataStyle){this.m_htDataStyle={}}if("background-image"==b){if(!a.isRegular(/(url\()|(url(\s+)\()|(URL\()|(URL(\s+)\()/g)){a="url("+a+")"}}this.m_htDataStyle[b]=a;this.applyBaseCellCSS("data")};SBGrid.CT.DataGrid.prototype.setFixedAttribute=function(b,a){if(null==this.m_htFixedStyle){this.m_htFixedStyle={}}if("background-image"==b){if(!a.isRegular(/(url\()|(url(\s+)\()|(URL\()|(URL(\s+)\()/g)){a="url("+a+")"}}this.m_htFixedStyle[b]=a;this.applyBaseCellCSS("fixed")};SBGrid.CT.DataGrid.prototype.getDataAttribute=function(a){if(null==this.m_htDataStyle){this.m_htDataStyle={}}if("background-image"==a){if(!strName.isRegular(/(url\()|(url(\s+)\()|(URL\()|(URL(\s+)\()/g)){strName="url("+strName+")"}}return this.m_htDataStyle[a]};SBGrid.CT.DataGrid.prototype.getFixedAttribute=function(a){if(null==this.m_htFixedStyle){this.m_htFixedStyle={}}if("background-image"==a){if(!strName.isRegular(/(url\()|(url(\s+)\()|(URL\()|(URL(\s+)\()/g)){strName="url("+strName+")"}}return this.m_htFixedStyle[a]};SBGrid.CT.DataGrid.prototype.getGroupLevel=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".getGroupLevel","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getGroupLevel","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(null!=this.m_objGroup[a]){return this.m_objGroup[a].depth}return 0};SBGrid.CT.DataGrid.prototype.setGroupLevel=function(a,b){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setGroupLevel","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setGroupLevel","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setGroupLevel","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(null!=a&&null!=b&&"NaN"!=b){if(null!=this.m_objGroup[a]){this.m_objGroup[a].depth=b}else{this.m_objGroup[a]={depth:b,collapsed:false,heControl:null,isChild:false}}}};SBGrid.CT.DataGrid.prototype.getGroupCol=function(){return this.groupCol};SBGrid.CT.DataGrid.prototype.setGroupCol=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setGroupCol","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setGroupCol","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}this.groupCol=a};SBGrid.CT.DataGrid.prototype.getGroupLevelCol=function(){return this.groupLevelCol};SBGrid.CT.DataGrid.prototype.setGroupLevelCol=function(d){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setGroupLevelCol","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof d!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setGroupLevelCol","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(null!=d&&0<=d){this.groupLevelCol=d;if(this.isJsonRef()){var f="";var a=this.m_arColumn[d];if(null!=a){if(null!=a.attribute.ref){f=a.attribute.ref}}if(f==""){return}var h=null;var e="";for(var c=0;c<this.m_xlRefNode.length;c++){h=this.m_xlRefNode[c];e=h[f];this.setGroupLevel((this.fixedRows+c),parseInt(e))}}else{var b=this.nodeset;if((b.length-1)!=b.lastIndexOf("/")){b+="/"}var a=this.m_arColumn[d];if(null!=a){if(null!=a.attribute.ref){b+=a.attribute.ref}}var g=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,b);if(null!=g){for(var c=0;c<g.length;c++){var l=SBGrid.UT.XmlLib.getTextValue(g.item(c));this.setGroupLevel((this.fixedRows+c),parseInt(l))}}}}};SBGrid.CT.DataGrid.prototype.getGroup=function(){var a="";switch(this.group){case 0:a="none";break;case 1:a="symbols";break;case 2:a="complete";break;case 3:a="symbolsleaf";break;case 4:a="completeleaf";break;case 5:a="nodrawing";break;default:a="none";break}return a};SBGrid.CT.DataGrid.prototype.setGroup=function(b){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setGroup","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof b)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setGroup","Please check if parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}var f=this.group;switch(b){case"none":this.group=0;break;case"symbols":this.group=1;break;case"complete":this.group=2;break;case"symbolsleaf":this.group=3;break;case"completeleaf":this.group=4;break;case"nodrawing":this.group=5;break;default:var d=parseInt(b);if("NaN"==d){this.group=0}else{this.group=d}}var e=this.m_nOldGroupCol;if(null!=e){e=this.m_nOldGroupCol!=this.groupCol&&0!=f}else{e=false}var g=5==this.group?"":"sbgrid_group_plus";var a=5==this.group?"":"sbgrid_group_subtraction";var c=2<this.group?"":"sbgrid_group_normal";this.m_objTreeClass={plus:g,subtraction:a,normal:c};if(null==f||f==this.group){if(0==f){return}this.groupRefresh(true,e,g,a,c,true);this.m_nOldGroupCol=this.groupCol;return}if(0!=f&&0==this.group){this.groupRefresh(true,true,g,a,c,false);this.m_nOldGroupCol=this.groupCol;return}else{if(0!=f&&0!=this.group){this.groupRefresh(true,e,g,a,c,true);this.m_nOldGroupCol=this.groupCol;return}}this.groupRefresh(false,e,g,a,c,true);this.m_nOldGroupCol=this.groupCol};SBGrid.CT.DataGrid.prototype.getGroupCollapsed=function(a){if(null!=this.m_objGroup[a]){return this.m_objGroup[a].collapsed}return false};SBGrid.CT.DataGrid.prototype.setGroupCollapsed=function(a,d){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setGroupCollapsed","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setGroupCollapsed","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof d!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setGroupCollapsed","Please check if second parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}var l=null;if(null!=a&&null!=d){if(null!=this.m_objGroup[a]){l=this.m_objScroll;var c=this.m_objGroup[a];var e=c.collapsed;c.collapsed=d;if(this.group>0){if(e!=d){if(l.bScrollEvent){this.gridCellUnInit(l.nTopRow,l.nBottomRow)}if(d){var f=c.depth;for(var g=a+1;(this.m_objGroup[g]!=null)&&(this.m_objGroup[g].depth>f);g++){if(g==(a+1)){c.heControl.className=this.m_objTreeClass.plus}if((this.m_objGroup[g+1]==null)||(this.m_objGroup[g+1].depth<=f)){this.setRowHidden(g,d,false);break}else{this.setRowHidden(g,d,true)}}if(l.bScrollEvent){this.scrollTableReDraw()}if(c.isChild){this.dispatch("oncollapse")}}else{var f=c.depth;var b=true;var i=f;for(var g=a+1;(this.m_objGroup[g]!=null)&&(this.m_objGroup[g].depth>f);g++){var h=this.m_objGroup[g];if(g==(a+1)){c.heControl.className=this.m_objTreeClass.subtraction}if((this.m_objGroup[g+1]==null)||(this.m_objGroup[g+1].depth<=f)){if(b){this.setRowHidden(g,d,false)}break}else{if(b){this.setRowHidden(g,d,true)}}if(h.isChild&&d!=h.collapsed){i=h.depth;if(null!=this.m_objGroup[g+1]&&h.depth<this.m_objGroup[g+1].depth){b=false}}else{if((h.isChild&&b)||(null!=this.m_objGroup[g+1]&&i>=this.m_objGroup[g+1].depth)){b=true}}}if(l.bScrollEvent){this.scrollTableReDraw()}if(c.isChild){this.dispatch("onexpanded")}}}}}else{this.m_objGroup[a]={depth:1,collapsed:d,heControl:null,isChild:false}}}if(l){this.reSizeScrollDiv();if(this.m_heWhole.clientHeight==0){window.setTimeout("SBGrid.getGrid('"+this.id+"').scrollingGrid(true);",100)}else{this.dispatch("onresize");window.setTimeout("SBGrid.getGrid('"+this.id+"').scrollingGrid(true);",100)}}};SBGrid.CT.DataGrid.prototype.setGroupImage=function(b,d){var c=document.styleSheets[0];var a=SBGrid.DEF.is_ie?c.rules[2+b]:c.cssRules[2+b];a.style.backgroundImage="url("+d+")"};SBGrid.CT.DataGrid.prototype.groupRefresh=function(s,n,a,w,e,q){if(n){var f=this.m_arColumn[this.m_nOldGroupCol];var g=null;if(null!=f){if(SBGrid.DEF.SBIT_INPUTBUTTON==f.m_nInputType||SBGrid.DEF.SBIT_INPUTDATE==f.m_nInputType){g=true}else{g=false}}if(null!=g){if(g){for(var r=this.fixedRows;r<this.m_nRealRows;r++){var l=this.getCellEx(r,this.m_nOldGroupCol);if(null!=l&&null!=l.m_heCtrl){l.m_heCtrl.style.overflow="";var v=l.m_heCtrl.firstChild.firstChild.firstChild;var m=v.firstChild;m.nextSibling.style.paddingLeft="";v.removeChild(m)}}}else{for(var r=this.fixedRows;r<this.m_nRealRows;r++){var l=this.getCellEx(r,this.m_nOldGroupCol);if(null!=l&&null!=l.m_heCtrl){l.m_heCtrl.style.overflow="";var A=l.m_heCtrl.firstChild;var p=A.firstChild.firstChild.lastChild.firstChild;l.m_heCtrl.appendChild(p);l.m_heCtrl.removeChild(A)}}}}if(q){this.groupRefresh(false,false,a,w,e)}return}if(s){for(var r=this.fixedRows;r<this.m_nRealRows;r++){var o=this.m_objGroup[r];if(null!=o&&null!=o.heControl){var x=o.heControl;var u=null!=this.m_objGroup[r+1]&&(o.depth+1)==this.m_objGroup[r+1].depth;x.style.width=(18*o.depth)+"px";x.className=u?(o.collapsed?a:w):e;o.isChild=u}}}else{var f=this.m_arColumn[this.groupCol];var g=null;if(null!=f){if(SBGrid.DEF.SBIT_INPUTBUTTON==f.m_nInputType||SBGrid.DEF.SBIT_INPUTDATE==f.m_nInputType||SBGrid.DEF.SBIT_OUTPUTBUTTON==f.m_nInputType){g=true}else{g=false}}if(null!=g){if(g){var z=document.createElement("TD");for(var r=this.fixedRows;r<this.m_nRealRows;r++){var l=this.getCellEx(r,this.groupCol);if(null!=l&&null!=l.m_heCtrl){l.m_heCtrl.style.overflow="hidden";var v=l.m_heCtrl.firstChild.firstChild.firstChild;var m=v.firstChild;var o=this.m_objGroup[r];if(null!=o){var t=(18*o.depth)+"px";var b=z.cloneNode(false);var u=null!=this.m_objGroup[r+1]&&(o.depth+1)==this.m_objGroup[r+1].depth;b.className=u?(o.collapsed?a:w):e;b.style.width=t;b.setAttribute("row",r);b.setAttribute("gridId",this.id);v.insertBefore(b,m);m.style.paddingLeft="2px";o.isChild=u;o.heControl=b;b.onclick=function(){var B=parseInt(this.getAttribute("row"));var D=this.getAttribute("gridId");var C=document.SBHE_allElement.item(D);if(null!=C){var i=C.getGroupCollapsed(B);C.setGroupCollapsed(B,!i)}}}}}}else{for(var r=this.fixedRows;r<this.m_nRealRows;r++){var l=this.getCellEx(r,this.groupCol);if(null!=l&&null!=l.m_heCtrl){l.m_heCtrl.style.overflow="hidden";var p=l.m_heCtrl.firstChild;var o=this.m_objGroup[r];if(null!=o){var d=document.createElement("TABLE");l.m_heCtrl.appendChild(d);var h=document.createElement("TBODY");d.appendChild(h);var y=document.createElement("TR");h.appendChild(y);var c=document.createElement("TD");c.style.paddingLeft="2px";var t=(18*o.depth)+"px";var b=c.cloneNode(false);y.appendChild(b);y.appendChild(c);d.border=0;d.cellSpacing=0;d.cellPadding=0;d.className="sbgrid_datagrid_InputButton_table";d.style.height=SBGrid.DEF.is_mozBrowser?"98%":"100%";var u=null!=this.m_objGroup[r+1]&&(o.depth+1)==this.m_objGroup[r+1].depth;b.className=u?(o.collapsed?a:w):e;b.style.width=t;b.setAttribute("row",r);b.setAttribute("gridId",this.id);c.appendChild(p);o.isChild=u;o.heControl=b;b.onclick=function(){var B=parseInt(this.getAttribute("row"));var D=this.getAttribute("gridId");var C=document.SBHE_allElement.item(D);if(null!=C){var i=C.getGroupCollapsed(B);C.setGroupCollapsed(B,!i)}}}}}}}}};SBGrid.CT.DataGrid.prototype.addRows=function(b){var l=this.rows;var h=null;var f=false;if(typeof(b)=="number"||typeof(b)=="string"){h=parseInt(b)}else{if(typeof(b)=="object"){h=b.length;f=true}}if(h==null||h==0){return false}if(!this.isJsonRef()&&!this.hasInstance()){return false}this.stopEditing();this.clearSelection();var g=l-this.fixedRows;for(var e=0;e<h;e++){this.addRowHasInstanceEx();if(f){this.m_xlRefNode[g++]=b[e];for(var d=this.fixedCols;d<this.cols;d++){var c=this.getCellEx(l,d);var a=this.m_arColumn[d];var m=a.getAttribute("ref");if(null!=c){this.setValueMatrix(l,d,b[e][m])}}}l++}this.m_bIsSort=false;this.scrollingGrid();if(this.m_objScroll.bScrollEvent){this.reSizeScrollDiv()}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}return true};SBGrid.CT.DataGrid.prototype.addRowHasInstanceEx=function(){var b=null;var l=null;if(this.m_objScroll.nMaxLength<=this.m_nMakeIndex){this.m_objScroll.bScrollEvent=true;this.m_objScroll.nEndRow++;if(null==this.m_objScroll.arTargetRow||this.m_nRealRows!=this.m_objScroll.arTargetRow.length){this.m_objScroll.arTargetRow=new Array();for(var g=0;g<this.m_nRealRows;g++){this.m_objScroll.arTargetRow.push(g)}this.m_objScroll.arTargetRow.push(this.m_nRealRows)}else{this.m_objScroll.arTargetRow.push(this.m_nRealRows)}}else{this.m_objScroll.bScrollEvent=false;this.m_objScroll.nBottomRow++;this.m_objScroll.nTargetHeight+=this.dataHeight;this.m_nMakeIndex++}var h=true;var n=this.m_nRealRows-this.frozenBottomRows;if(this.m_nRealRows>=(this.fixedRows+this.frozenRows+this.frozenBottomRows)&&this.frozenBottomRows>0){if(!this.m_objScroll.bScrollEvent){this.physicalRemovePartRow(n,n)}}if(this.rows==this.m_nRealRows){this.rows++}this.m_nRealRows++;this.m_htRowHeight[this.m_nRealRows-1]=this.dataHeight;this.m_xlRefNode=this.getControlNodeList();this.makeScrollDiv(this.m_heGridScrollDivCell,true);if(null!=this.m_heFFC){this.makeScrollDiv(this.m_heFFGridScrollDivCell,false)}if(this.m_nRealRows>(this.fixedRows+this.frozenRows+this.frozenBottomRows)&&this.frozenBottomRows>0){var e;for(var g=0;g<this.cols;g++){e=this.getCellEx(n,g);if(null!=e){if(this.m_objScroll.bScrollEvent){e.attribute["background-color"]=null}else{this.physicalCreateCell(n,g,h,e.m_bIsSubTotal,true)}h=false}}if(!this.m_objScroll.bScrollEvent){for(var g=0;g<this.cols;g++){e=this.getCellEx(n,g);if(null!=e){SBGrid.CF.GridInit(e)}}}if(null!=e){this.setRowStatus(n,e.rowstatus)}}for(var g=0;g<this.cols;g++){if(this.m_objScroll.bScrollEvent){var d=this.m_arColumn[g];var m=d.getAttribute("ref");if(this.isJsonRef()){l=this.m_xlRefNode[this.m_nRealRows-1-this.fixedRows]}else{b=this.m_xlRefNode.item(this.m_nRealRows-1-this.fixedRows)}var a=this.id+"_"+(this.m_nRealRows-1)+"_"+g;if(g<this.fixedCols){var e=this.getCellByIdEx(a);if(null!=e&&a!=e.id){e=null}e=null==e?new SBGrid.CT.DataGridCell(this,g,a,this.m_nRealRows-1,"softbowl:cell"):e;e.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(e,d.m_bMerge)}else{var f=null;var c=null;if(this.isJsonRef()){c=l}else{f=SBGrid.UT.XmlLib.selectSingleNode(b,m)}var e=this.getCellByIdEx(a);if(null!=e&&a!=e.id){e=null}e=null==e||a!=e.id?new SBGrid.CT.DataGridCell(this,g,a,this.m_nRealRows-1,"softbowl:cell"):e;e.setElement(d);this.setLinkedData(e,f,c);SBGrid.CF.GridSetMergeType(e,d.m_bMerge)}}else{this.physicalCreateCell(this.m_nRealRows-1,g,false,false)}}if(!this.m_objScroll.bScrollEvent){for(var g=0;g<this.cols;g++){var e=this.getCellEx(this.m_nRealRows-1,g);if(null!=e){SBGrid.CF.GridInit(e)}}this.m_objScroll.arTargetRow.push(this.m_nRealRows-1)}else{this.setTableMatrix(this.m_objScroll.nTopRow,this.m_objScroll.nBottomRow);this.m_heFFBS.removeChild(this.m_heFFBS.firstChild);this.m_heFFBNS.removeChild(this.m_heFFBNS.firstChild);this.m_heFFBS=this.makeFixedFrozenBottomScrollingRow();this.m_heFFBNS=this.makeFixedFrozenBottomNoScrollingRow()}if(this.m_nRealRows>(this.fixedRows+this.frozenRows)&&this.frozenBottomRows>0&&!this.m_objScroll.bScrollEvent){this.m_nBottomRowCount++}};SBGrid.CT.DataGrid.prototype.rePositionScrollBar=function(){if(SBGrid.DEF.is_chromeFrame){this.m_nReScrollPosition=this.vscroll.getPrevScrollPosition()}else{this.m_nReScrollPosition=this.vscroll.getPrevScrollPosition()}this.showWait(true);this.m_objScroll.arScrollLength.push(1);window.setTimeout("SBGrid.getGrid('"+this.id+"').scrollingGrid(true);",200)};SBGrid.CT.DataGrid.prototype.destroy=function(){var b=false;this.m_clIndexes.clear();this.m_clMultiSortingHistory.clear();this.m_clFilteringHistoryStack.clear();this.m_mapColStyleInfo.clear();this.m_mapGridStyleInfo.clear();this.m_mapMultiSortShowIconInfo.clear();if(this.m_bIsContextMenu==true){jQuery(this.m_heContextMenu).remove()}jQuery(this.m_heGridDataSearchUI).remove();if(document.SBHE_allElement){if(typeof SBUx=="undefined"){if(document.SBHE_grids.count()==1){document.SBHE_allElement.clear();SBGrid.DEF.destroy(document.SBHE_allElement);try{delete document.SBHE_allElement}catch(c){document.SBHE_allElement=undefined}b=true}else{document.SBHE_allElement.remove(this.id)}}else{document.SBHE_allElement.remove(this.id)}}if(document.SBHE_controls){if(typeof SBUx=="undefined"){if(document.SBHE_grids.count()==1){document.SBHE_controls.clear();SBGrid.DEF.destroy(document.SBHE_controls);try{delete document.SBHE_controls}catch(c){document.SBHE_controls=undefined}}else{document.SBHE_controls.remove(this.id)}}else{document.SBHE_controls.remove(this.id)}}if(document.SBHE_grids){SBGrid.DEF.__removeGrid(this.id)}if(document.SBHE_grids.count()==0){if(typeof SBUx=="undefined"){try{delete document.SBHE_grids}catch(c){document.SBHE_grids=undefined}}}SBGrid.DEF.__removeEventHandler("SBHE_"+this.id);var n=document.getElementById(this.parentId);var a=document.getElementById("SBHE_"+this.id);if(a){n.removeChild(a)}for(var e=0,h=this.m_arColumn.length;e<h;e++){var l=this.m_arColumn[e];if(l.getAttribute("type")=="combo"){var f="SBHE_"+l.m_objCombo.id+"_allitem";document.body.removeChild(document.getElementById(f))}}for(var e=0,h=this.m_arColumn.length;e<h;e++){var l=this.m_arColumn[e];if(l.getAttribute("type")=="inputdate"){var m="SBHE_"+l.id+"_calendar";document.body.removeChild(document.getElementById(m))}}var g=this.children.getCollection();for(var e in g){var d=g[e];if(document.SBHE_allElement){document.SBHE_allElement.remove(d.id)}if(document.SBHE_controls){document.SBHE_controls.remove(d.id)}d=null}g=null;this.children.clear();SBGrid.DEF.destroy(this);if(b){SBGrid.DEF.bParsed=false}};SBGrid.CT.DataGrid.prototype.getInputButtonDisabled=function(c,f,b){var a=this.getCellEx(c,f);var d=document.getElementById(this.id+"_"+c+"_"+f+"_data");var e=document.getElementById(this.id+"_"+c+"_"+f+"_button");if(b=="input"&&d.getAttribute("Textflg")=="false"){return true}else{if(b=="button"&&e.getAttribute("Buttonflg")=="false"){return true}else{if(b=="both"){return a.getDisabled()}else{return false}}}};SBGrid.CT.DataGrid.prototype.setInputButtonDisabled=function(c,h,b,g,f){if(arguments.length<3){SBGrid.DEF.APIerrorMsg(this.id+".setInputButtonDisabled","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setInputButtonDisabled","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof h!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setInputButtonDisabled","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setInputButtonDisabled","Please check if third parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof g)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setInputButtonDisabled","Please check if 4th parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}if(f==undefined){f=false}else{if((typeof f)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setInputButtonDisabled","Please check if 5th parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}var a=this.getCellEx(c,h);if(a){if(this.getColType(h)=="inputbutton"){var d=document.getElementById(this.id+"_"+c+"_"+h+"_data");var e=document.getElementById(this.id+"_"+c+"_"+h+"_button");if(b=="input"){d.setAttribute("Textflg",!g)}else{if(b=="button"){e.setAttribute("Buttonflg",!g)}else{if(b=="both"){a.setDisabled(g)}}}}}};SBGrid.CT.DataGrid.prototype.setCellDisabled=function(d,g,f,e){if(arguments.length<3){SBGrid.DEF.APIerrorMsg(this.id+".setCellDisabled","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof d!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setCellDisabled","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof g!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setCellDisabled","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof f)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setCellDisabled","Please check if third parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}if(e==undefined){e=false}else{if((typeof e)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setCellDisabled","Please check if 4th parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}var c=this.getCellEx(d,g);if(c){c.setDisabled(f);if(e&&(d>=this.m_objScroll.nTopRow&&d<=this.m_objScroll.nBottomRow)){var b=null;var a=this.m_replaceString;if(a!=""&&a!="undefined"&&a!=null){b=a.split("?")}SBGrid.CF.GridSetTextRefresh(c,SBGrid.CF.GridGetText(c),b,this.m_bIsDataReplaceValueChanged)}}};SBGrid.CT.DataGrid.prototype.getCellDisabled=function(b,c){var a=this.getCellEx(b,c);return a.getDisabled()};SBGrid.CT.DataGrid.prototype.selectRadio=function(c,e){var b=this.getSelectionMode();var d=this.getColumnControl(e);var a=this.getCellEx(c,e);if(d){if(d.getInputType()==SBGrid.DEF.SBIT_RADIO){if(a){d.setRefElement(a);d.selectRadio();this.refreshCurrentModel(this.attribute.ref);return true}}}return false};SBGrid.CT.DataGrid.prototype.show=function(){SBGrid.CT.Group.prototype.show.call(this);var b=this.m_objScroll.nPosition;this.m_heWhole.scrollTop=this.m_objScroll.nPosition;if(SBGrid.DEF.is_ie8){if(!this.m_objScroll.bScrollEvent){var a=this.selectedRow(0);this.rebuild();if(a<this.getRows()&&a!=-1){this.initGridCell();this.selectRow(a)}}else{var a=this.m_nDownRow;if(SBGrid.DEF.n_scrollingTimer!=null){window.clearTimeout(SBGrid.DEF.n_scrollingTimer)}if(a<this.getRows()&&a!=-1){SBGrid.DEF.n_scrollingTimer=window.setTimeout("SBGrid.DEF.n_scrollingTimer = null; SBGrid.getGrid('"+this.id+"').scrollingGrid(true);SBGrid.getGrid('"+this.id+"').selectRow("+a+");",50)}else{SBGrid.DEF.n_scrollingTimer=window.setTimeout("SBGrid.DEF.n_scrollingTimer = null; SBGrid.getGrid('"+this.id+"').scrollingGrid(true);",50)}}}};SBGrid.CT.DataGrid.prototype.getCellEx=function(b,c){if(isNaN(b)||isNaN(c)){return null}var a=this.getCell(b,c);if(!a){if(this.m_bSMC){a=this.makeGridCell(b,c)}}return a};SBGrid.CT.DataGrid.prototype.getCellByIdEx=function(c){var a=this.getCellById(c);if(!a){if(this.m_bSMC){var b=c.split("_");a=this.makeGridCell(parseInt(b[1]),parseInt(b[2]))}}return this.children.m_htCollection[c]};SBGrid.CT.DataGrid.prototype.getColType=function(c){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".getColType","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof c)!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getColType","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(c<0||c>this.cols){SBGrid.DEF.APIerrorMsg(this.id+".getColType","Please check if first parameter's value is valid.",SBGrid.DEF.DEBUG_MODE);return}var a=this.m_arColumn[c];var b=a.getInputType();if(b==SBGrid.DEF.SBIT_OUTPUT){return"output"}else{if(b==SBGrid.DEF.SBIT_INPUT){return"input"}else{if(b==SBGrid.DEF.SBIT_COMBO){return"combo"}else{if(b==SBGrid.DEF.SBIT_CHECK){return"checkbox"}else{if(b==SBGrid.DEF.SBIT_RADIO){return"radio"}else{if(b==SBGrid.DEF.SBIT_INPUTBUTTON){return"inputbutton"}else{if(b==SBGrid.DEF.SBIT_INPUTDATE){return"inputdate"}else{if(b==SBGrid.DEF.SBIT_IMAGE){return"image"}else{if(b==SBGrid.DEF.SBIT_OUTPUTBUTTON){return"outputbutton"}else{if(b==SBGrid.DEF.SBIT_TEXTAREA){return"textarea"}else{return""}}}}}}}}}}a=b=null};SBGrid.CT.DataGrid.prototype.getRealDataSequence=function(){var a=[];if(this.isJsonRef()){if(this.rows>=this.fixedRows){if(this.m_bIsRealDataSync==false&&this.m_bIsSort){for(var b=0,c=this.rows;b<c;b++){if(b<this.fixedRows){a.push(-1)}else{a.push(this.m_arSortJson[b-this.fixedRows][this.fixedCols].Row)}}}else{for(var b=0,c=this.rows;b<c;b++){if(b<this.fixedRows){a.push(-1)}else{a.push(b-this.fixedRows)}}}}}else{if(this.rows>=this.fixedRows){if(this.m_bIsRealDataSync==false&&this.m_bIsSort){for(var b=0,c=this.rows;b<c;b++){if(b<this.fixedRows){a.push(-1)}else{a.push(this.m_arSortNodeList[b-this.fixedRows][this.fixedCols].Row)}}}else{for(var b=0,c=this.rows;b<c;b++){if(b<this.fixedRows){a.push(-1)}else{a.push(b-this.fixedRows)}}}}}return a};SBGrid.CT.DataGrid.prototype.getDataForClipboard=function(){var g=this.getSelectedCells();var h="";var f=g.keys().sort();var c=g.item(f[f.length-1]).col;for(var d=0,l=g.count();d<l;d++){var b=g.item(f[d]);var a=b.row;var e=b.col;h+=this.getTextMatrix(a,e);if(d<l-1){if(e<c){h+="\t"}else{h+="\n"}}}return h};SBGrid.CT.DataGrid.prototype.getNonAddedColumnDataRefList=function(c){var g=[];if(c==undefined){c=this.fixedRows}if(c<this.fixedRows||c>=this.m_nRealRows){return}var l=this.m_bRowHeader?1:0;if(this.rows-this.fixedRows<1){return g}var b=null;if(this.isJsonRef()){b=this.m_xlRefNode[this.getRealDataSequence()[c]];if(b==undefined){b=this.m_xlRefNode[c-this.fixedRows]}var a=SBGrid.DEF.getPropertyNameList(b);for(var e=0;e<a.length;e++){var h=false;for(var d=0+l;d<this.cols;d++){var f=this.m_arColumn[d].getAttribute("ref");if(a[e]==f){h=true;break}}if(h==false){g.push(a[e])}}SBGrid.DEF.clearArray(a);a=null}else{}b=l=c=null;return g};SBGrid.CT.DataGrid.prototype.getNonAddedColumnData=function(d){var e=new SBGrid.DS.Map();if(d==undefined||d<this.fixedRows||d>=this.m_nRealRows){return e}var a=null;if(this.isJsonRef()){a=this.m_xlRefNode[this.getRealDataSequence()[d]];var b=this.getNonAddedColumnDataRefList();for(var c=0;c<b.length;c++){e.add(b[c],a[b[c]])}SBGrid.DEF.clearArray(b);b=null}else{}a=null;return e};SBGrid.CT.DataGrid.prototype.isRealDataSync=function(){if(this.m_bIsRealDataSync==null){this.m_bIsRealDataSync=false}return this.m_bIsRealDataSync};SBGrid.CT.DataGrid.prototype.resizeHeight=function(){if(this.autoResize&&(this.fixedCols+this.frozenCols<=0)){var b=document.createDocumentFragment();b.appendChild(this.m_heWhole.firstChild.childNodes[1]);var a=$(b.childNodes[0]);var d=a.find("tr:nth-child(n+"+(this.getFixedRows()+1)+"):nth-child(-n+"+(a.children().length)+")");d.each(function(f){$(this).find("td").each(function(){var g=parseInt($(this).attr("rowspan"));if(!isNaN(g)){$(this).css("height","")}})});var c=$(this.m_heWhole.firstChild).append(b);var e=parseInt(c.height())+3;$(this.m_heCtrl.parentNode).height(e);b=a=d=e=null}};SBGrid.CT.DataGrid.prototype.setLimitedSelectRows=function(a){if(this.getSelectionMode()!=SBGrid.DEF.SBSM_LIST&&this.getSelectionMode()!=SBGrid.DEF.SBSM_BYROW){return}if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.m_strTargetGrid+".setLimitedSelectRows","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(!(a instanceof Array)){SBGrid.DEF.APIerrorMsg(this.m_strTargetGrid+".setLimitedSelectRows","Please check if first parameter's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}this.m_setLimitedSelectRows.clear();a.sort(SBGrid.DEF.numberASC);for(var b=0;b<a.length;b++){this.m_setLimitedSelectRows.add(a[b]);this.deSelectRow(a[b])}};SBGrid.CT.DataGrid.prototype.getLimitedSelectRows=function(){return SBGrid.US.clone(this.m_setLimitedSelectRows.keys(true))};SBGrid.DEF.getPivotData=function(c,b){var a=SBGrid.DEF.makePivotData(c,b);return a};SBGrid.DEF.makePivotData=function(e,N){var A=new Array();var T=new Array();var d="";var r="";var p=new SBGrid.DS.Collection();var O=SBGrid.US.clone(e);$.each(O,function(a){d=O[a][N.strStandardRowRef];r=O[a][N.strStandardColRef];if($.inArray(r,A)==-1){A.push(r)}if($.inArray(d,T)==-1){T.push(d)}});var G=new Array(T.length);for(var H=0;H<T.length;H++){G[H]=new Array(A.length);for(var I=0;I<A.length;I++){G[H][I]=0}}$.each(O,function(n){for(var g=0;g<T.length;g++){if(T[g]==O[n][N.strStandardRowRef]){for(var a=0;a<A.length;a++){if(A[a]==O[n][N.strStandardColRef]){G[g][a]+=parseFloat(O[n][N.strCalRef])}}}}});for(var V=0;V<A.length;V++){for(var U=0;U<T.length;U++){var M=A[V];if(p.exists(M)){var B=new SBGrid.DS.Collection();B=p.item(M);var E=T[U];if(B.exists(E)){var s=G[U][V];B.add(E,parseInt(B.item(E))+s)}else{B.add(E,parseInt(G[U][V]))}p.add(M,B)}else{var B=new SBGrid.DS.Collection();B.add(T[U],G[U][V]);p.add(M,B)}}}var u=SBGrid.US.size(objDataConvertInfo.objColValuesInfo);var b=SBGrid.US.values(objDataConvertInfo.objColValuesInfo);var o="";var m="";for(var L=0;L<p.count()+1;L++){if(L==0){o=objDataConvertInfo.strXY_AsixLabel+"^";m=objDataConvertInfo.strXY_AsixLabel+"^"}else{for(var K=0;K<u;K++){o+=p.m_arOrder[L-1];o+=(K==p.count()&&L==b.length)?"":"^";m+=b[K];m+=(K==p.count()&&L==b.length)?"":"^"}}}o+="|"+m;for(var S=0;S<A.length;S++){var t=0;for(var R=0;R<T.length;R++){t+=parseInt(p.item(A[S]).item(T[R]));p.item(A[S]).add("합계",t)}}if(N.arrFrozenRowValuesInfo){for(var V=0;V<N.arrFrozenRowValuesInfo.length;V++){if(N.arrFrozenRowValuesInfo[V]=="평균"){for(var Z=0;Z<A.length;Z++){avg=parseInt(p.item(A[Z]).item("합계")/T.length);p.item(A[Z]).add("평균",avg)}}}}var C={arrGridData:[],strCaption:"",objColumnsInfo:[]};var z=SBGrid.US.keys(objDataConvertInfo.objColValuesInfo);var Q=[];Q.push("col0");for(var U=0;U<A.length;U++){for(var S=0;S<z.length;S++){var Y=z[S]+A[U];Q.push(Y)}}var D=T.length;for(var V=0;V<D;V++){var J={};for(var U=0;U<b.length*A.length+1;U++){if(U==0){J.col0=T[V]}else{J[Q[U]]=0}}C.arrGridData.push(J)}for(var V=0;V<D;V++){for(var S=0;S<A.length;S++){for(var W=0;W<A.length;W++){if(z[S]=="sum"){C.arrGridData[V][z[S]+A[W]]=p.item(A[W]).item(T[V])}else{if(z[S]=="weight"){C.arrGridData[V][z[S]+A[W]]=parseFloat((p.item(A[W]).item(T[V])*100/p.item(A[W]).item("합계")).toFixed(1))}else{if(z[S]=="rate"){if(W==0){C.arrGridData[V][z[S]+A[W]]=parseFloat(0)}else{C.arrGridData[V][z[S]+A[W]]=parseFloat(((p.item(A[W]).item(T[V])-p.item(A[W-1]).item(T[V]))/p.item(A[W-1]).item(T[V])*100).toFixed(1))}}}}}}}if(N.arrFrozenRowValuesInfo){for(var V=0;V<N.arrFrozenRowValuesInfo.length;V++){if(N.arrFrozenRowValuesInfo[V]=="합계"){var P={};P.col0="합계";for(var U=0;U<b.length;U++){for(var S=0;S<A.length;S++){if(z[U]=="sum"){P[z[U]+A[S]]=p.item(A[S]).item("합계")}else{if(z[U]=="weight"){P[z[U]+A[S]]=parseFloat((p.item(A[S]).item("합계")*100/p.item(A[S]).item("합계")).toFixed(1))}else{if(z[U]=="rate"){if(S==0){P[z[U]+A[S]]=parseFloat(0)}else{P[z[U]+A[S]]=parseFloat(((p.item(A[S]).item("합계")-p.item(A[S-1]).item("합계"))/p.item(A[S-1]).item("합계")*100).toFixed(1))}}}}}}C.arrGridData.push(P)}else{if(N.arrFrozenRowValuesInfo[V]=="평균"){var c={};c.col0="평균";for(var U=0;U<b.length;U++){for(var S=0;S<A.length;S++){if(z[U]=="sum"){c[z[U]+A[S]]=p.item(A[S]).item("평균")}else{if(z[U]=="weight"){c[z[U]+A[S]]=""}else{if(z[U]=="rate"){c[z[U]+A[S]]=""}}}}}C.arrGridData.push(c)}}}}var h={id:"col",type:"output",ref:"",style:"text-align:right;padding-right:5px;",format:"###,#.#"};var f=SBGrid.US.keys(h);var q=SBGrid.US.values(h);var l=(A.length*b.length);var X=[];for(var U=0;U<l+1;U++){var F={};for(S=0;S<f.length;S++){if(S==0){strFstCol=q[S]+U}else{if(S==1){strFstCol=q[S]}else{if(S==2){strFstCol=Q[U]}else{if(S==3){if(U==0){strFstCol="text-align:center;"}else{strFstCol=q[S]}}else{if(S==4){if(U==0){strFstCol=""}else{strFstCol=q[S]}}}}}}F[f[S]]=strFstCol}X.push(F)}C.strCaption=o;C.objColumnsInfo=X;return C};SBGrid.CT.DataGrid.prototype.setCSSBottomBorder=function(b,c){this.m_nCSSBottomBorderFlg=true;if(b=="frozencol"){if(c==undefined){jQuery("#SBHE_DATAGRID_FFCOL_TBODY_"+this.id+" td").addClass("sbgrid_datagrid_GridFFC_bottomBorder");jQuery("#SBHE_DATAGRID_FFN_TBODY_"+this.id+" td").addClass("sbgrid_datagrid_GridFFC_bottomBorder")}}else{if(b=="frozenrow"){var a=this.fixedRows;var e=this.frozenRows;for(var f=a;f<e+a;f++){for(var d=0;d<c;d++){var g=this.getCellEx(f,d);jQuery("#SBHE_"+g.id).addClass("sbgrid_datagrid_GridFFC_bottomBorder")}}}else{if(b=="frozenbottomrow"){for(var f=this.getRows()-this.getFrozenBottomRows();f<this.getRows();f++){for(var d=0;d<c;d++){var g=this.getCellEx(f,d);jQuery("#SBHE_"+g.id).addClass("sbgrid_datagrid_GridFFC_bottomBorder")}}}}}};SBGrid.CT.GridCell=function(b,c,f,m,n,i,e,d,o,a,g,l,h){if(!n){return}SBGrid.CT.Caption.call(this,b,"","","","","",false,"",c,f,false,m,n,-1,i,e,d,o,a,g,l,h);this.boolstate=false;this.m_objColumn=this.parent.getColumnControl(this.col);this.m_bUserAddCell=false;this.m_xnNodeElement;this.m_nBeforeSelectRow=0};SBGrid.CT.GridCell.prototype=new SBGrid.CT.Caption;SBGrid.CT.GridCell.prototype.init=function(){SBGrid.CT.Caption.prototype.init.call(this)};SBGrid.CT.GridCell.prototype.inputDataPosition=function(c,f){var d=this.getRefElement();if(d){var e=d.getHtmlElement();if(e!=null){var a=e.offsetLeft+e.clientWidth-18;var b=e;while(null!=b){if(SBGrid.DEF.is_firefox){b=b.parentNode}else{b=b.parentElement}if("DIV"==b.tagName){a+=b.offsetLeft;if("SBHE_"+f==b.id){break}}a-=b.scrollLeft;if("BODY"==b.tagName){break}}return a}}return 0};SBGrid.CT.GridCell.prototype.getBoolState=function(){var a=this.getRefElement();if(a){var d=SBGrid.CF.GridGetText(a);var c=this.getTrueValue();var b=this.getFalseValue();if(d==c){this.boolstate=true}else{if(d==b){this.boolstate=false}else{this.boolstate=false}}return this.boolstate}};SBGrid.CT.GridCell.prototype.setBoolState=function(f,d,a,e){this.boolstate=f;var c=this.getRefElement();if(c){if(d){SBGrid.CF.GridSetText(c,strValue)}if(c.m_heCtrl){var b=c.m_heCtrl.firstChild;if(b){if(SBGrid.DEF.SBIT_CHECK==this.getInputType()){b.src=f?this.getAttribute("checkimage"):this.getAttribute("uncheckimage")}else{if(SBGrid.DEF.SBIT_RADIO==this.getInputType()){b.src=f?this.getAttribute("selectimage"):this.getAttribute("unselectimage")}}}}}};SBGrid.CT.GridCell.prototype.getCheck=function(){return this.getBoolState()};SBGrid.CT.GridCell.prototype.setCheck=function(e){var a=this.getRefElement();if(a){if(SBGrid.DEF.SBIT_CHECK==this.getInputType()){var c=e?this.getTrueValue():this.getFalseValue();this.setBoolState(e);SBGrid.CF.GridSetText(a,c);var b=a.row;var d=a.col;if(this.parent.getColStatus(d)){this.parent.setRowStatus(b,a.rowstatus|SBGrid.DEF.SBGS_UPDATE)}if(e){this.dispatch("onselect");this.dispatch("SBUx_select")}else{this.dispatch("ondeselect");this.dispatch("SBUx_deselect")}this.dispatch("onvaluechanged");this.dispatch("SBUx_value_changed")}}};SBGrid.CT.GridCell.prototype.selectRadio=function(){var c=this.getRefElement();if(c){if(SBGrid.CF.GridGetText(c)==this.getTrueValue()){return}if(this.m_nBeforeSelectRow!=c.row){if(SBGrid.DEF.SBIT_RADIO==this.getInputType()){var e=this.parent;var d=c.row;var h=c.col;for(var b=e.fixedRows;b<e.m_nRealRows;b++){var g=e.getCellEx(b,h);if(null!=g){SBGrid.CF.GridSetText(g,this.getFalseValue())}}if(e.fixedRows<=this.m_nBeforeSelectRow){var a=e.getCellEx(this.m_nBeforeSelectRow,h);if(null!=a){SBGrid.CF.GridSetBoolState(a,false)}}this.m_nBeforeSelectRow=d;var f=this.getTrueValue();SBGrid.CF.GridSetText(c,f);if(this.parent.getColStatus(h)){this.parent.setRowStatus(d,c.rowstatus|SBGrid.DEF.SBGS_UPDATE)}this.dispatch("onselect");this.dispatch("SBUx_select");this.dispatch("onvaluechanged");this.dispatch("SBUx_value_changed")}}}};SBGrid.CT.GridCell.prototype.onFocus=function(c){SBGrid.CT.Group.prototype.onFocus.call(this,c);if(!SBGrid.DEF.is_smartphone){var f=this.row;var l=this.col;var g=this.getRefElement();if(g){f=g.row;l=g.col}var a=this.parent;var d=a.m_heWhole;var q=a.isFrozenCell(f,l);if(a.isNormalCell(f,l)){var e=this.getHtmlElement();if(null!=e){var m=new SBGrid.DS.Rectangle(e.offsetLeft,e.offsetTop,e.offsetWidth,e.offsetHeight);var h=m.getRight();var p=m.getBottom();var o=m.getX();var n=m.getY();var b=a.getFixedFrozenRowHeight();var i=a.getFixedFrozenColWidth();if(l<a.fixedCols+a.frozenCols){n+=b;p+=b}if(d.scrollLeft>o-i){d.scrollLeft=o-i}if(h>d.offsetWidth-(a._isVScroll()?17:0)+d.scrollLeft){if(g.m_bMergeByFree&&o>d.clientWidth/2){d.scrollLeft=o+(d.offsetWidth-(a._isVScroll()?17:0))}else{if(!g.m_bMergeByFree){d.scrollLeft=o+(d.offsetWidth-(a._isVScroll()?17:0))}}}if(this.parent.m_bUseWebAccess==true){e.firstChild.tabIndex="0";e.firstChild.focus()}}}if(!q){if(d&&a.m_heFFS){a.m_heFFS.scrollLeft=d.scrollLeft}if(d&&a.m_heFFBS){a.m_heFFBS.scrollLeft=d.scrollLeft}}if(d&&a.m_heFFC){a.m_heFFC.scrollTop=d.scrollTop}}};SBGrid.CT.GridFixedCell=function(c,g,d,f,e,b,a){if(!f){return}SBGrid.CT.GridCell.call(this,c,g,d,"",f,"","","",-1,"",e,b,a)};SBGrid.CT.GridFixedCell.prototype=new SBGrid.CT.GridCell;SBGrid.CT.GridFixedCell.prototype.onClick=function(b){SBGrid.CT.GridCell.prototype.onClick.call(this,b);var c=this.attribute.gridid,a=this.getRefElement();if(a){if(a.m_fixedInputType==SBGrid.DEF.SBIT_CHECK){this.parent.bIsFixedcellcheckbox=true}if(this.parent.m_bCapturing){return}else{if(a.m_fixedInputType==SBGrid.DEF.SBIT_INPUTBUTTON||a.m_fixedInputType==SBGrid.DEF.SBIT_OUTPUTBUTTON){if((b.target==this.getId())&&(this.inputDataPosition(this.parent.parentId,c)<b.clientX)){this.dispatch("onfixedbuttonclick")}}}}};SBGrid.CT.GridFixedCell.create=function(a,f){var b="";var c=false;var h="";var g="visible";var d="";var e=f.getCollection();for(var i in e){switch(i){case"class":b=e[i];break;case"disabled":if("true"==e[i]){c=true}break;case"id":h=e[i];break;case"visibility":g=e[i];break;default:if(!SBGrid.DEF.SB_STYLELIST[i]){d+=i+":"+e[i]+"; "}break}}e=null;return new SBGrid.CT.GridFixedCell(a,b,c,h,"softbowl:gridfixedcell",g,d)};SBGrid.CT.GridInput=function(s,u,q,l,h,D,N,f,J,o,c,b,H,r,t,d,i,I,G,n,C,p,L,E,g,z,K,a,v,A,m,y,F,e,x,M,B,w){if(!d){return}SBGrid.CT.Input.call(this,s,u,q,l,h,D,N,f,J,o,c,b,H,r,t,d,i,I,G,n,C,p,L,E,g,z,K,a,v,A,m,y,F,e,x,"",M,B,w);this.m_isGridInput=true;this.m_bDependentCtl=true;this.m_bEndEdit=false};SBGrid.CT.GridInput.prototype=new SBGrid.CT.Input;SBGrid.CT.GridInput.prototype.init=function(){SBGrid.CT.Input.prototype.init.call(this)};SBGrid.CT.GridInput.prototype.onBlur=function(a){SBGrid.CT.Group.prototype.onBlur.call(this,a)};SBGrid.CT.GridInput.prototype.onKeyDown=function(c){if(c.keyCode==SBGrid.EVT.TAB){c.browserPreventDefault()}SBGrid.CT.Input.prototype.onKeyDown.call(this,c);if(this.m_bEndEdit){this.m_bEndEdit=false;var b=this.parent.getRow();var e=this.parent.getCol();this.parent.dispatch("onnext");var d=this.parent.getRow();var a=this.parent.getCol();if(b==d&&e==a){c.stopPropagation()}}};SBGrid.CT.GridInput.prototype.getFormat=function(){return this.objFormat};SBGrid.CT.GridInput.create=function(w,B){var z="";var u="";var o="";var n="";var A="";var V="";var i="";var R=false;var r=false;var e=false;var b=true;var F=true;var v="";var y=false;var f="";var g="";var Q="";var O="";var q=false;var L="exclude";var s=-1;var T=-1;var M=9007199254740992;var l="";var I="default";var S="";var a="";var C=false;var J="";var p=0;var H="none";var N="";var h=false;var E="";var U="softbowl:input";var K=false;var D="visible";var d="";var t=B.getCollection();for(var c in t){switch(c){case"alert":z=t[c];break;case"help":u=t[c];break;case"hint":o=t[c];break;case"accesskey":n=t[c];break;case"autonext":A=t[c];break;case"bind":V=t[c];break;case"class":i=t[c];break;case"disabled":if("true"==t[c]){R=true}break;case"dragmode":if("true"==t[c]){r=true}case"dropmode":if("true"==t[c]){e=true}break;case"editable":if("false"==t[c]){b=false}break;case"editmenu":if("false"==t[c]){F=false}break;case"format":v=t[c];break;case"decimalformatinsert":y=t[c];break;case"id":f=t[c];break;case"imemode":g=t[c];break;case"inputtype":Q=t[c];break;case"invalidcharacters":O=t[c];break;case"isemptyformatted":if("true"==t[c]){q=true}break;case"mask":L=t[c];break;case"maxbyte":s=parseInt(t[c]);break;case"maxlength":T=parseInt(t[c]);break;case"navindex":M=parseInt(t[c]);break;case"pastemode":I=t[c];break;case"ref":S=t[c];break;case"jsonref":a=t[c];break;case"required":if("true"==t[c]){C=true}break;case"roundmode":J=t[c];break;case"roundposition":p=parseInt(t[c]);break;case"showmask":if("true"==t[c]){h=true}break;case"tag":U=t[c];break;case"validateformat":if("true"==t[c]){K=true}break;case"visibility":D=t[c];break;default:if(!SBGrid.DEF.SB_STYLELIST[c]){d+=c+":"+t[c]+"; "}break}}t=null;var x=new SBGrid.CT.GridInput(w,z,u,o,n,A,V,i,R,r,e,b,F,v,y,f,g,Q,O,q,L,s,T,M,l,I,S,a,C,J,p,H,N,h,E,U,K,D,d);var G=x.parent.m_heCtrl;var P=x.parent.m_strCGInput;var m=document.createElement("input");SBGrid.CT.GridInput.createAttribute(m,B);m.setAttribute("id","SBHE_"+f);if(null==P){P=""}jQuery(m).addClass("sbgrid_datagrid_Input "+P);G.appendChild(m);if(m.attachEvent){m.attachEvent("onblur",SBGrid.DEF._W_onBlurEvent);m.attachEvent("onpaste",SBGrid.DEF._W_onGridInputClipboad);m.attachEvent("oncut",SBGrid.DEF._W_onGridInputClipboad)}else{m.addEventListener("blur",SBGrid.DEF._W_onBlurEvent,false);m.addEventListener("paste",SBGrid.DEF._W_onGridInputClipboad,false);m.addEventListener("cut",SBGrid.DEF._W_onGridInputClipboad,false)}if(!(SBGrid.DEF.is_ie7||SBGrid.DEF.is_ie8)){m.onkeydown=function(W){if(W.keyCode==13){return false}}}return x};SBGrid.CT.GridInput.createAttribute=function(b,a){b=SBGrid.CT.TextArea.createAttribute(b,a);return b};SBGrid.CT.GridTextarea=function(d,l,e,z,r,o,q,x,v,h,t,u,b,B,g,p,y,a,f,i,c,n,w,C,A,s,m){if(!b){return}SBGrid.CT.TextArea.call(this,d,l,e,z,r,o,q,x,v,h,t,u,b,B,g,p,y,a,f,i,c,n,w,C,A,s,m);this.m_isGridTextarea=true};SBGrid.CT.GridTextarea.prototype=new SBGrid.CT.TextArea;SBGrid.CT.GridTextarea.prototype.init=function(){SBGrid.CT.TextArea.prototype.init.call(this)};SBGrid.CT.GridTextarea.prototype.onBlur=function(a){SBGrid.CT.Group.prototype.onBlur.call(this,a)};SBGrid.CT.GridTextarea.prototype.onKeyDown=function(c){if(c.keyCode==SBGrid.EVT.TAB){c.browserPreventDefault()}SBGrid.CT.TextArea.prototype.onKeyDown.call(this,c);if(this.m_bEndEdit){this.m_bEndEdit=false;var b=this.parent.getRow();var e=this.parent.getCol();this.parent.dispatch("onnext");var d=this.parent.getRow();var a=this.parent.getCol();if(b==d&&e==a){c.stopPropagation()}}};SBGrid.CT.GridTextarea.create=function(d,F){var q="";var e="";var G="";var x="";var t="";var w="";var D=false;var B=false;var l=false;var z=true;var A=true;var b="";var I="";var i=-1;var u=-1;var E=9007199254740992;var a="";var g="default";var m="";var c="";var s="";var C="";var J="";var H="softbowl:textarea";var y="";var r="";var v=F.getCollection();for(var f in v){switch(f){case"alert":q=v[f];break;case"help":e=v[f];break;case"hint":G=v[f];break;case"accesskey":x=v[f];break;case"bind":t=v[f];break;case"class":w=v[f];break;case"disabled":if("true"==v[f]){D=true}break;case"dragmode":if("true"==v[f]){B=true}case"dropmode":if("true"==v[f]){l=true}break;case"editable":if(false==v[f]){z=false}break;case"editmenu":if("false"==v[f]){A=false}break;case"id":b=v[f];break;case"imemode":I=v[f];break;case"maxbyte":i=parseInt(v[f]);break;case"maxlength":u=parseInt(v[f]);break;case"navindex":E=parseInt(v[f]);break;case"pastemode":g=v[f];break;case"ref":m=v[f];break;case"jsonref":c=v[f];break;case"tag":H=v[f];break;case"visibility":y=v[f];break;default:if(!SBGrid.DEF.SB_STYLELIST[f]){r+=f+":"+v[f]+"; "}break}}v=null;var p=new SBGrid.CT.GridTextarea(d,q,e,G,x,t,w,D,B,l,z,A,b,I,i,u,E,a,g,m,c,s,C,J,H,y,r);var o=p.parent.m_heCtrl;var n=p.parent.m_strCGTextarea;var h=document.createElement("textarea");SBGrid.CT.GridTextarea.createAttribute(h,F);h.setAttribute("id","SBHE_"+b);h.setAttribute("col",10);h.setAttribute("row",2);h.style.height="30px";if(null==n){n=""}jQuery(h).addClass("sbgrid_datagrid_Textarea "+n);jQuery(h).addClass("sbgrid_scroll");o.appendChild(h);if(h.attachEvent){h.attachEvent("onblur",SBGrid.DEF._W_onBlurEvent);h.attachEvent("onpaste",SBGrid.DEF._W_onGridInputClipboad);h.attachEvent("oncut",SBGrid.DEF._W_onGridInputClipboad)}else{h.addEventListener("blur",SBGrid.DEF._W_onBlurEvent,false);h.addEventListener("paste",SBGrid.DEF._W_onGridInputClipboad,false);h.addEventListener("cut",SBGrid.DEF._W_onGridInputClipboad,false)}if(!(SBGrid.DEF.is_ie7||SBGrid.DEF.is_ie8)){h.onkeydown=function(K){if(K.keyCode==13){return false}}}return p};SBGrid.CT.GridTextarea.createAttribute=function(b,a){b=SBGrid.CT.TextArea.createAttribute(b,a);return b};SBGrid.CT.GridCombo=function(w,z,v,r,q,T,c,i,m,P,O,s,e,L,l,g,t,G,W,H,o,E,Q,a,I,D,C,K,u,F,S,h,B,R,M,b,y,N,x,A,d,f,n,J,U,p,V){if(!g){return}this.createDefaultComboHtmlTag(w,g);SBGrid.CT.Select1.call(this,w,z,v,r,q,T,c,i,m,P,O,s,e,L,l,g,t,G,W,H,o,E,"","",I,D,C,K,u,F,S,h,"hidden",R,M,b,y,N,x,"minimal",d,f,n,J,p,V);this.m_heCtrl=document.getElementById("SBHE_"+this.id);this.m_heCtrl.style.position="absolute";this.m_heCtrl.style.zIndex=100;this.m_heCtrl.style.borderWidth="0";this.m_objTargetCol=null;this.m_nColId=U;this.m_bGridCombo=true};SBGrid.CT.GridCombo.prototype=new SBGrid.CT.Select1;SBGrid.CT.GridCombo.prototype.init=function(){SBGrid.CT.Select1.prototype.init.call(this);if(null!=this.m_objTargetCol){this.m_objTargetCol.choices=this.choices}};SBGrid.CT.GridCombo.prototype.refresh=function(){if(this.isnodeset){if(this.equlsChangeNode()){this.reBuild();this.applySelectCell()}else{this.applySelectCell()}}SBGrid.CT.Group.prototype.refresh.call(this);var a=this.label;if(null==this.label){a="";this.label=""}else{if("true"==this.getAttribute("showvalue")){a=" ["+this.value+"]     "+a}}this.m_objInput.setWindowText(a)};SBGrid.CT.GridCombo.prototype.showComboRefresh=function(){if(null==this.m_objConnectControl){return}this.m_objInput.setWindowText(jQuery(this.m_objConnectControl.m_heDCtrl).text())};SBGrid.CT.GridCombo.prototype.setNodeset=function(b){if(this.isnodeset){var a=this.m_objTargetCol;if(null!=a){a.m_strComboNodeSet=b}this.nodeset=b;a=null}};SBGrid.CT.GridCombo.prototype.setHeControlGridPosition=function(b,a){this.setPosition(a);this.m_objInput.setWindowText(SBGrid.CF.GridGetWindowText(b));this.m_objConnectControl=b};SBGrid.CT.GridCombo.prototype.getLableByValue=function(d){if(this.isnodeset){for(var b=0;b<this.itemLength;b++){var c=this.item(b).row;var e=this.item(b).col;var a=this.getLabelValue(c,e);if(d==a.value){strText=a.label;if(null!=strText){if("true"==this.getAttribute("showvalue")){strText=" ["+d+"]     "+strText}return strText}else{return""}}}}else{for(var b=0;b<this.itemLength;b++){if(d==SBGrid.CF.GetValue(this.item(b))){strText=SBGrid.CF.GetLabel(this.item(b));if(null!=strText){if("true"==this.getAttribute("showvalue")){strText=" ["+d+"]     "+strText}return strText}else{return""}}}}return""};SBGrid.CT.GridCombo.prototype.setLable=function(a){this.label=a};SBGrid.CT.GridCombo.prototype.setValue=function(a){this.value=a};SBGrid.CT.GridCombo.prototype.onSelect=function(a){if(-1==this.m_nSelectedRow&&-1==this.m_nSelectedCol){return}var b=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);var e=this.parent.getCellEx(this.parent.row,this.parent.col);if(null!=b){var i=this.m_objConnectControl;var d=i.parent;d.dispatch("onselect");d.dispatch("SBUx_select");var h=SBGrid.CF.GridGetWindowText(this.m_objConnectControl);var f=SBGrid.CF.GetLabel(b);var g=SBGrid.CF.GetValue(b);if(h!=f){SBGrid.CF.GridSetText(this.m_objConnectControl,g);d.setRowStatus(i.row,i.getStatus()|SBGrid.DEF.SBGS_UPDATE);var c=d.getCurrentCaption();d.caption=c;d.attribute.caption=c;SBGrid.CF.GridSetTextRefresh(e,g,"",this.parent.m_bIsDataReplaceValueChanged);this.setLable(f);this.setValue(g);if("true"==this.getAttribute("showvalue")){f=" ["+g+"]  "+f}this.m_objInput.setWindowText(f);d.dispatch("onvaluechanged");d.dispatch("SBUx_value_changed")}}};SBGrid.CT.GridCombo.prototype.onKeyDown=function(a){SBGrid.CT.Select1.prototype.onKeyDown.call(this,a);a.stopPropagation()};SBGrid.CT.GridCombo.prototype.onFocus=function(a){SBGrid.CT.Select1.prototype.onFocus.call(this,a);var b=this.m_objInput.m_heCtrl.getAttribute("id");window.setTimeout('document.getElementById("'+b+'").select()',0)};SBGrid.CT.GridCombo.prototype.createDefaultComboHtmlTag=function(a,i){var c=document.getElementById("SBHE_"+a);var g=document.getElementById("SBHE_"+a+"_"+i);if(!g){g=document.createElement("div");jQuery(g).attr("id","SBHE_"+i)}jQuery(g).addClass("sbgrid_select sbgrid_boxsizing sbgrid_datagrid_Combo gridcombo");jQuery(g).attr("style","");var m=document.createElement("table");jQuery(m).attr("cellpadding","0");jQuery(m).attr("cellspacing","0");jQuery(m).attr("style","width:100%; height:100%;");var e=document.createElement("tbody");var d=document.createElement("tr");var h=document.createElement("td");jQuery(h).addClass("sbgrid_combo_input_td");jQuery(h).attr("valign","middle");var l=document.createElement("input");jQuery(l).addClass("sbgrid_combo_input gridcombo_ccomboinput");jQuery(l).attr("id","SBHE_"+i+"_input");jQuery(l).attr("readonly","");jQuery(l).attr("editmode","");jQuery(l).attr("tabindex","0");var f=document.createElement("td");jQuery(f).addClass("sbgrid_combo_button_td");jQuery(f).attr("align","center");jQuery(f).attr("id","SBHE_"+i+"_img");jQuery(f).attr("valign","top");var b=document.createElement("button");jQuery(b).addClass("sbgrid_combo_button gridcombo_ccombobutton");jQuery(b).attr("id","SBHE_"+i+"_button");f.appendChild(b);h.appendChild(l);d.appendChild(h);d.appendChild(f);e.appendChild(d);m.appendChild(e);g.appendChild(m);c.appendChild(g);b.onclick=function(){return false};if(window.attachEvent){g.attachEvent("onblur",SBGrid.DEF._W_onBlurEvent);b.attachEvent("onclick",function(){return false})}else{g.addEventListener("blur",SBGrid.DEF._W_onBlurEvent,false)}};SBGrid.CT.GridButton=function(b,f,c,e,d,a){if(!e){return}SBGrid.CT.Button.call(this,b,"","","","","",false,"",f,c,false,"","","",e,-1,"","","",-1,false,"",d,a)};SBGrid.CT.GridButton.prototype=new SBGrid.CT.Button;SBGrid.CT.GridButton.prototype.init=function(){SBGrid.CT.Button.prototype.init.call(this)};SBGrid.CT.GridButton.prototype.applyDefaultStyle=function(){SBGrid.CT.Caption.prototype.applyDefaultStyle.call(this);if(this.attribute["border-style"]){if(!this.attribute["border-width"]){this.m_heCtrl.style.borderWidth="1px"}}else{this.m_heCtrl.style.borderWidth=""}};SBGrid.CT.GridCol=function(B,ah,I,y,c,n,aa,ag,Y,a,P,b,K,A,g,i,h,w,R,S,p,z,G,ai,Q,t,ad,V,C,N,s,U,am,O,l,T,ak,af,d,r,u,f,M,q,D,m,H,o,L,al,W,e,X,ae,J,aj,F,ab,v,Z,ac,E){if(!g){return}SBGrid.CT.GridCell.call(this,B,n,ag,A,g,ai,ai,Q,t,T,ak,L,e);this.attribute.gridid=B;this.attribute.allowuserresize=ah;this.attribute.autonext=String(I);this.attribute.checkimage=(y.isEmpty()?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgCheck:y);this.attribute.checkvalue=c;this.attribute.cospan=aa;this.attribute.editable=a;this.attribute.editmenu=P;this.attribute.editmode=b;this.attribute.explorerbar=K;this.attribute.imemode=i;this.attribute.itemcount=h;this.attribute.key=w;this.attribute.loadtype=R;this.attribute.mask=S;this.attribute.maxbyte=String(p);this.attribute.maxlength=String(z);this.attribute.pastemode=G;this.attribute.rowspan=ad;this.attribute.savetype=V;this.attribute.secretendposition=C;this.attribute.secretmark=N;this.attribute.secretstartposition=s;this.attribute.selectimage=(U.isEmpty()?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRadio:U);this.attribute.showmask=am;this.attribute.showtoday=O;this.attribute.showvalue=l;this.attribute.type=af;this.attribute.sortable=Y;this.attribute.title=D;this.attribute.uncheckimage=(m.isEmpty()?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgUnCheck:m);this.attribute.unselectimage=(H.isEmpty()?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgUnRadio:H);this.attribute.validateformat=o;this.attribute.ref=ai;this.attribute.calc=al;this.attribute.validate=W;this.attribute.datamerge=X;this.attribute.colhidden=ae;this.attribute.imageUri=d;this.attribute.imageWidth=r;this.attribute.imageHeight=u;this.attribute.imageStyle=f;this.attribute.imageClick=M;this.attribute.imageAlt=q;this.attribute.checkboxValidate=J;this.attribute.checkdisabledimage=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgDisCheck;this.attribute.uncheckdisabledimage=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgDisUnCheck;this.attribute.selectdisabledimage=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgDisRadio;this.attribute.unselectdisabledimage=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgDisUnRadio;this.attribute.textareaWidth=aj;this.attribute.colcontext=ab;this.choices=null;this.m_bMerge=true;this.m_nInputType;this.m_bInputKey;this.m_strTrueValue;this.m_strFalseValue;this.m_bHiddenState=ae;this.m_bEditable=a;this.m_strComboNodeSet=null;this.m_bIsCellCombo=false;this.m_bIsColContext=ab;this.m_objButton=null;this.m_objCombo=null;this.m_objCalendar=null;this.m_strButtonCss=null;this.m_strTrueValue="true";this.m_strFalseValue="false";if(c&&!c.isEmpty()){var x=c.split(",");if(2==x.length){this.m_strTrueValue=x[0];this.m_strFalseValue=x[1]}}this.m_bDataMerge=X;this.m_bSkipAutoResize=F;if(typeof v=="undefined"||v==null){v=""}if(typeof Z=="undefined"||Z==null){Z=""}if(typeof ac=="undefined"||ac==null){ac=""}if(typeof E=="undefined"||E==null){E=""}this.nodeset=v;this.jsonnodeset=Z;this.labelref=ac;this.valueref=E};SBGrid.CT.GridCol.prototype=new SBGrid.CT.GridCell;SBGrid.CT.GridCol.prototype.init=function(){SBGrid.CT.GridCell.prototype.init.call(this);switch(this.getAttribute("type")){case"output":this.m_nInputType=SBGrid.DEF.SBIT_OUTPUT;break;case"input":this.m_nInputType=SBGrid.DEF.SBIT_INPUT;break;case"combo":this.m_nInputType=SBGrid.DEF.SBIT_COMBO;break;case"inputbutton":this.m_nInputType=SBGrid.DEF.SBIT_INPUTBUTTON;break;case"inputdate":this.m_nInputType=SBGrid.DEF.SBIT_INPUTDATE;this.attribute.format=""==this.attribute.format?"yyyy-mm-dd":this.attribute.format;break;case"checkbox":this.m_nInputType=SBGrid.DEF.SBIT_CHECK;break;case"radio":this.m_nInputType=SBGrid.DEF.SBIT_RADIO;break;case"image":this.m_nInputType=SBGrid.DEF.SBIT_IMAGE;break;case"outputbutton":this.m_nInputType=SBGrid.DEF.SBIT_OUTPUTBUTTON;break;case"textarea":this.m_nInputType=SBGrid.DEF.SBIT_TEXTAREA;break}if(SBGrid.DEF.SBIT_INPUTBUTTON==this.m_nInputType||SBGrid.DEF.SBIT_INPUTDATE==this.m_nInputType||SBGrid.DEF.SBIT_OUTPUTBUTTON==this.m_nInputType){if(null==this.m_objButton){this.m_objButton=new SBGrid.CT.GridButton(this.id,"",false,this.id+".button","softbowl:gridbutton","visible");this.m_objButton.init();this.m_strButtonCss=null!=this.attribute.col_gridbutton?this.attribute.col_gridbutton:""}if(SBGrid.DEF.SBIT_INPUTDATE==this.m_nInputType){if(null==this.m_objCalendar){this.m_objCalendar=this.createChild("softbowl:calendar","id:"+this.id+"_calendar;border-style:solid;left:100;top:100;width:200;height:150;visibility:hidden;showtoday:"+this.getAttribute("showtoday")+";")}}}else{if(SBGrid.DEF.SBIT_COMBO==this.m_nInputType){for(var a=0;a<this.parent.m_arCombo.length;a++){if(this.id==this.parent.m_arCombo[a].m_nColId){this.m_objCombo=this.parent.m_arCombo[a];this.m_strComboNodeSet=this.m_objCombo.nodeset;this.m_objCombo.m_objTargetCol=this}}if(null==this.m_objCombo){}}}this.disabled="true"==this.attribute.disabled?true:false};SBGrid.CT.GridCol.prototype.setDataPartBGColor=function(a){this.attribute["background-color"]=a};SBGrid.CT.GridCol.prototype.getDataPartBGColor=function(){return this.attribute["background-color"]};SBGrid.CT.GridCol.prototype.getUseButton=function(){switch(this.getAttribute("type")){case"inputbutton":case"inputdate":case"outputbutton":return true;default:return false}};SBGrid.CT.GridCol.prototype.getInputType=function(){return this.m_nInputType};SBGrid.CT.GridCol.prototype.setInputType=function(a){this.m_nInputType=a};SBGrid.CT.GridCol.prototype.getImageUri=function(){return this.attribute.imageUri};SBGrid.CT.GridCol.prototype.getImageClickFuncName=function(){return this.attribute.imageClick};SBGrid.CT.GridCol.prototype.getImageWidth=function(){return this.attribute.imageWidth};SBGrid.CT.GridCol.prototype.getImageHeight=function(){return this.attribute.imageHeight};SBGrid.CT.GridCol.prototype.getImageStyle=function(){return this.attribute.imageStyle};SBGrid.CT.GridCol.prototype.getImageAlt=function(){return this.attribute.imageAlt};SBGrid.CT.GridCol.prototype.isDisplayValueType=function(){switch(this.getAttribute("type")){case"output":case"input":case"combo":case"inputbutton":case"inputdate":case"seq":case"reverseseq":case"outputbutton":case"textarea":return true;case"checkbox":case"radio":case"select":case"update":return false}};SBGrid.CT.GridCol.prototype.getEditable=function(){switch(this.getAttribute("type")){case"input":case"inputbutton":case"inputdate":case"textarea":return true;case"radio":case"checkbox":case"combo":case"output":case"image":case"outputbutton":return false}};SBGrid.CT.GridCol.prototype.setEditable=function(a){this.m_bEditable=a};SBGrid.CT.GridCol.prototype.getTrueValue=function(){return this.m_strTrueValue};SBGrid.CT.GridCol.prototype.getFalseValue=function(){return this.m_strFalseValue};SBGrid.CT.GridCol.prototype.makeCellElement=function(e,g,f,a,c){e=e+"";if(SBGrid.DS.XMLStorage.getUniqueStorage().getInstance().preserveWhitespace){e=e.replace(/\s/g,"&nbsp;")}var d=null;var b=this.parent.m_replaceString;if(b!=""&&b!="undefined"&&b!=null){d=b.split("?")}if(d!=""&&d!="undefined"&&d!=null){if(e==d[0]){e=d[1];if(this.parent.m_bIsDataReplaceValueChanged){}}}switch(this.getAttribute("type")){case"output":case"input":case"textarea":return this._makeOutput(e,f);case"image":return this._makeImage(e,f);case"combo":return this._makeCombo(e,f);case"inputbutton":case"inputdate":case"outputbutton":return this._makeInputButton(e,g,f,a,c);case"checkbox":return this._makeCheckbox(e);case"radio":return this._makeRadio(e);case"select":return this._makeRowHeaderSelect(e);case"update":return this._makeRowHeaderUpdate(e);case"seq":case"reverseseq":return this._makeRowHeaderSpan(e)}};SBGrid.CT.GridCol.prototype.showCalendar=function(i){var f=this.parent.getCellEx(this.parent.row,this.parent.col);if(null==f){f=this.getRefElement()}else{this.setRefElement(f)}if(null!=f){if(i){this.m_objCalendar.parent=this;var m=nViewportHeight;var p=nViewportWidth;var c=0;var a=0;var e=this.m_heCtrl;if(null!=e){if(this.getClientLeft(true)+this.m_objCalendar.m_heCtrl.offsetWidth>p){a=(this.getClientLeft(true)-(this.m_objCalendar.m_heCtrl.offsetWidth-e.offsetWidth))}else{a=this.getClientLeft(true)}if(this.getClientTop(true)+e.offsetHeight+this.m_objCalendar.m_heCtrl.offsetHeight>m){c=(this.getClientTop(true)-this.m_objCalendar.m_heCtrl.offsetHeight)}else{c=(this.getClientTop(true)+e.offsetHeight)}}this.m_objCalendar.setAttribute("top",c+"px");this.m_objCalendar.setAttribute("left",a+"px");var o=SBGrid.CF.GridGetWindowText(f);if(""!=o){var l=this.getAttribute("format");l=l.replace(/\W/g,"");o=o.replace(/\W/g,"");var h=null;var d=null;var b=null;var n=l.indexOf("y");if(-1!=n&&"y"==l.charAt(n+3)){h=Number(o.substr(n,4))}var q=l.indexOf("m");if(-1!=q&&"m"==l.charAt(q+1)){d=Number(o.substr(q,2))}var g=l.indexOf("d");if(-1!=g&&"d"==l.charAt(g+1)){b=Number(o.substr(g,2))}if(null!=h&&h>99){this.m_objCalendar.year=h.toString()}if(null!=d&&d>0){this.m_objCalendar.month=d.toString()}if(null!=b&&b>0){this.m_objCalendar.day=b.toString()}this.m_objCalendar.refresh()}else{this.m_objCalendar.setToday()}}this.parent.m_bIsShowItem=i;this.m_objCalendar.setVisible(i)}};SBGrid.CT.GridCol.prototype.onKeyDown=function(d){SBGrid.CT.GridCell.prototype.onKeyDown.call(this,d);if((this.getInputType()==SBGrid.DEF.SBIT_RADIO)&&(SBGrid.EVT.SPACE==d.keyCode||SBGrid.EVT.ENTER==d.keyCode)){this.selectRadio();var c=this.parent.getCol();for(var b=0;b<this.parent.getRows();b++){var e=document.getElementById("SBHE_"+this.parent.id+"_"+b+"_"+c);if(e){var f="라디오 선택"+this.parent.m_arUserCaption[c]+"열 입니다.";var a="라디오 해제"+this.parent.m_arUserCaption[c]+"열 입니다.";if(this.parent.m_arUserCaption!=""&&this.parent.row==this.parent.fixedRows){if(e.firstChild.title==f){e.firstChild.title=a}else{if(e.id==this.m_heCtrl.id){this.m_heCtrl.firstChild.title=f}}}else{if(e.firstChild.title=="라디오 선택"){e.firstChild.title="라디오 해제"}else{if(this.parent.m_arUserCaption!=""&&e.firstChild.title==f){e.firstChild.title=a}else{if(e.id==this.m_heCtrl.id){this.m_heCtrl.firstChild.title="라디오 선택"}}}}}else{return}}this.parent.refreshCurrentModel(this.parent.attribute.ref)}else{if((this.getInputType()==SBGrid.DEF.SBIT_CHECK)&&(SBGrid.EVT.SPACE==d.keyCode||SBGrid.EVT.ENTER==d.keyCode)){var c=this.parent.getCol();for(var b=0;b<this.parent.getRows();b++){var e=document.getElementById("SBHE_"+this.parent.id+"_"+b+"_"+c);if(e){if(this.parent.m_arUserCaption!=""&&this.parent.row==this.parent.fixedRows){if(this.getCheck()==true){e.firstChild.title="체크박스 해제 "+this.parent.m_arUserCaption[c]+"열 입니다."}else{if(this.getCheck()==false){this.m_heCtrl.firstChild.title="체크박스 선택 "+this.parent.m_arUserCaption[c]+"열 입니다."}}}else{if(this.getCheck()==true){e.firstChild.title="체크박스 해제"}else{if(this.getCheck()==false){this.m_heCtrl.firstChild.title="체크박스 선택"}}}}else{return}}}}};SBGrid.CT.GridCol.prototype.onClick=function(e){SBGrid.CT.GridCell.prototype.onClick.call(this,e);var g=this.attribute.gridid,c=this.getRefElement();if(this.disabled||null==c||c.m_bIsSubTotal||c.getIsReadOnly()||c.getHidden()){return}var b=this.parent.getCurrentCaption();switch(this.getInputType()){case SBGrid.DEF.SBIT_CHECK:this.setCheck(!this.getCheck());if(this.getCheck()==true){this.m_heCtrl.firstChild.title="체크박스 선택"}else{if(this.getCheck()==false){this.m_heCtrl.firstChild.title="체크박스 해제"}}this.parent.caption=b;this.parent.attribute.caption=b;this.parent.refreshCurrentModel(this.parent.attribute.ref);break;case SBGrid.DEF.SBIT_RADIO:this.selectRadio();var d=this.parent.getCol();for(var a=0;a<this.parent.getRows();a++){var f=document.getElementById("SBHE_"+this.parent.id+"_"+a+"_"+d);if(f){if(f.firstChild.title=="라디오 선택"){f.firstChild.title="라디오 해제"}else{if(f.id==this.m_heCtrl.id){this.m_heCtrl.firstChild.title="라디오 선택"}}}else{return}}this.parent.caption=b;this.parent.attribute.caption=b;this.parent.refreshCurrentModel(this.parent.attribute.ref);break;case SBGrid.DEF.SBIT_INPUTBUTTON:if((e.target==this.getId())&&(this.inputDataPosition(this.parent.parentId,g)<e.clientX)){var h=document.getElementById(this.parent.id+"_"+this.parent.row+"_"+this.parent.col+"_button");if(h.getAttribute("Buttonflg")=="true"){this.dispatch("onbuttonclick")}}break;case SBGrid.DEF.SBIT_OUTPUTBUTTON:if((e.target==this.getId())&&(this.inputDataPosition(this.parent.parentId,g)<e.clientX)){this.dispatch("onbuttonclick")}break;case SBGrid.DEF.SBIT_INPUTDATE:if((e.target==this.getId())&&(this.inputDataPosition(this.parent.parentId,g)<e.clientX)){this.dispatch("onbuttonclick");if(this.m_objCalendar.visible){this.parent.m_bIsShowItem=false;this.m_objCalendar.setVisible(false)}else{this.showCalendar(true)}}break;default:break}};SBGrid.CT.GridCol.prototype.onAfterEdit=function(event){var bChange=false;var nRow=this.parent.getEditRow();var nCol=this.parent.getEditCol();var objCell=this.parent.getCellEx(nRow,nCol);if(null==objCell){return false}var nInputType=this.getInputType();if(SBGrid.DEF.SBIT_INPUT==nInputType||SBGrid.DEF.SBIT_INPUTBUTTON==nInputType||SBGrid.DEF.SBIT_INPUTDATE==nInputType||SBGrid.DEF.SBIT_INPUTSPIN==nInputType){var objInput=this.parent.getEditControl(SBGrid.DEF.SBIT_INPUT);var objFormat=objInput.getFormat();var strPrevText=SBGrid.CF.GridGetText(objCell);var strEditText="";if(SBGrid.DEF.SBIT_TEXTAREA==nInputType){}else{var strIsEmptyFormatted=objCell.getAttribute("isemptyformatted");if(!strIsEmptyFormatted||strIsEmptyFormatted.isEmpty()){strIsEmptyFormatted=this.getAttribute("isemptyformatted")}if((!strEditText||strEditText.isEmpty())&&"true"!=strIsEmptyFormatted){strEditText=objInput.getWindowText()}if(this.getAttribute("validate")!=""){var strValidate=this.getAttribute("validate");if(""!=strValidate){var strValidateName=strValidate.substring(0,strValidate.indexOf("("));var strValidateParam="(this.parent.id, "+nRow.toString()+", "+nCol.toString()+",'"+strEditText+"');";strValidate=strValidateName+strValidateParam;var strResult=eval(strValidate);strEditText=strResult}}if(objFormat){if(strPrevText!=strEditText){var bAutoCData=false;if(objFormat.getFormatExist()){if("include"==this.getAttribute("mask")){strEditText=objFormat.m_heCtrl.value}else{if(objFormat.getChangeClipboad()){strEditText=objFormat.removeMask(objFormat.m_heCtrl.value)}else{strEditText=objFormat.m_strInputRealityData}}if(strPrevText==strEditText){this.setAttribute("#update-text","");return false}if(this.getAttribute("validate")!=""){var strValidate=this.getAttribute("validate");if(""!=strValidate){var strValidateName=strValidate.substring(0,strValidate.indexOf("("));var strValidateParam="(this.parent.id, "+nRow.toString()+", "+nCol.toString()+","+strEditText+");";strValidate=strValidateName+strValidateParam;var strResult=eval(strValidate);strEditText=strResult}}SBGrid.CF.GridSetText(objCell,strEditText,true,bAutoCData)}else{SBGrid.CF.GridSetText(objCell,strEditText,true,bAutoCData)}SBGrid.CF.GridSetWindowText(objCell,strEditText);this.dispatch("onbeforecalc",event);for(var i=0;i<this.parent.cols;i++){var objColumn=this.parent.getColumnControl(i);var strCalc=objColumn.getAttribute("calc");if(""!=strCalc){var objCalcCell=this.parent.getCellEx(nRow,i);var objCalcCol=objCalcCell.getElement();var strCalc=objCalcCol.getAttribute("calc");if(""!=strCalc){var strCalcName=strCalc.substring(0,strCalc.indexOf("("));var strCalcParam="(this.parent.id, "+nRow.toString()+", "+i.toString()+");";strCalc=strCalcName+strCalcParam;var strResult=eval(strCalc);if(null!=strResult){SBGrid.CF.GridSetText(objCalcCell,strResult)}}}}this.dispatch("onaftercalc",event);this.setAttribute("#update-text","true");this.dispatch("onafteredit",event);this.dispatch("onvaluechanged",event);this.dispatch("SBUx_value_changed",event);this.dispatch("onendedit",event);bChange=true}else{this.setAttribute("#update-text","");bChange=false}return bChange}}}else{if(SBGrid.DEF.SBIT_TEXTAREA==nInputType){var objTextarea=this.parent.getEditControl(SBGrid.DEF.SBIT_TEXTAREA);var strPrevText=SBGrid.CF.GridGetText(objCell);var strEditWinText="";var strEditText="";if((!strEditText||strEditText.isEmpty())){strEditText=objTextarea.getWindowText();if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7||SBGrid.DEF.is_ie8){strEditWinText=strEditText.replace(new RegExp("\r\n","gi"),"\n")}}if(this.getAttribute("validate")!=""){var strValidate=this.getAttribute("validate");if(""!=strValidate){var strValidateName=strValidate.substring(0,strValidate.indexOf("("));var strValidateParam="(this.parent.id, "+nRow.toString()+", "+nCol.toString()+",'"+strEditText+"');";strValidate=strValidateName+strValidateParam;var strResult=eval(strValidate);strEditText=strResult}}if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7||SBGrid.DEF.is_ie8){if(strPrevText!=strEditWinText){var bAutoCData=false;SBGrid.CF.GridSetText(objCell,strEditWinText,true,bAutoCData);SBGrid.CF.GridSetWindowText(objCell,strEditWinText);this.setAttribute("#update-text","true");this.dispatch("onafteredit",event);this.dispatch("onvaluechanged",event);this.dispatch("SBUx_value_changed",event);this.dispatch("onendedit",event);bChange=true}else{this.setAttribute("#update-text","");bChange=false}}else{if(strPrevText!=strEditText){var bAutoCData=false;SBGrid.CF.GridSetText(objCell,strEditText,true,bAutoCData);SBGrid.CF.GridSetWindowText(objCell,strEditText);this.setAttribute("#update-text","true");this.dispatch("onafteredit",event);this.dispatch("onvaluechanged",event);this.dispatch("SBUx_value_changed",event);this.dispatch("onendedit",event);bChange=true}else{this.setAttribute("#update-text","");bChange=false}}}}return false};SBGrid.CT.GridCol.prototype.onBeforeEdit=function(p){var m=this.getInputType();if(SBGrid.DEF.SBIT_INPUT==m||SBGrid.DEF.SBIT_TEXTAREA==m||SBGrid.DEF.SBIT_INPUTBUTTON==m||SBGrid.DEF.SBIT_INPUTDATE==m||SBGrid.DEF.SBIT_INPUTSPIN==m){var x=this.parent.getRow();var v=this.parent.getCol();if(SBGrid.DEF.SBIT_TEXTAREA==m){var h=this.parent.getCellEx(x,v);var i=this.parent.getCellContentRect(x,v);var w=this.parent.getEditControl(SBGrid.DEF.SBIT_TEXTAREA);var s;var c=100;var b=this.parent.getRowHeight(x);if(this.parent._isHScroll()){s=this.parent.m_heCtrl.clientHeight-20}else{s=this.parent.m_heCtrl.clientHeight-5}c=(c<b&&b<s)?b-5:c;if(i.getY()<0){i.setY(0)}w.setPosition(i);var a=this.parent.editControlHeight(i.getHeight());if(a<i.getHeight()){i.setY(this.parent.getInputTopPosition(v));i.setHeight(a);nBttomRowHeight=null}var t=SBGrid.CF.GridGetText(h);w.setEditText(t);var f=w.m_heCtrl.scrollHeight;var b=this.parent.getRowHeight(x);f=(f<c)?c:f;var u=s-i.m_nY;if(this.attribute.textareaWidth!=undefined&&this.attribute.textareaWidth>i.m_nWidth){i.setWidth(this.attribute.textareaWidth)}else{if(document.doctype!=null){var o=document.doctype.name;if(o=="html"){if(SBGrid.DEF.is_chrome){i.setWidth(i.m_nWidth-5)}else{i.setWidth(i.m_nWidth-3)}}}else{if(document.doctype==null&&!SBGrid.DEF.is_ie11&&!SBGrid.DEF.is_ie10&&!SBGrid.DEF.is_chrome){i.setWidth(i.m_nWidth-3)}}}if(f<u){i.setHeight(f);if(i.getY()<0){i.setY(0)}w.setPosition(i)}else{f=(f>s)?s-u-20:f;var q=i.getY();var g=i.getBottom();if(SBGrid.DEF.is_chrome){if(u>c){i.setHeight(u-3)}else{if(s>=g){i.setY(s-(s-g)-f-3);if(s-(s-g)-f-3<0){i.setY(0)}}else{if(s<g){i.setY(s-(s-q)-f-3)}}if(document.doctype!=null){i.setHeight(f-3)}else{i.setHeight(f+2)}}}else{if(u>c){i.setHeight(u-1)}else{if(s>=g){i.setY(s-(s-g)-f-3);if(s-(s-g)-f-3<0){i.setY(0)}}else{if(s<g){i.setY(s-(s-q)-f-3)}}if(document.doctype!=null&&document.doctype.name=="html"){i.setHeight(f-1)}else{i.setHeight(f+1)}}}w.setPosition(i)}w.setAttribute("maxbyte",this.attribute.maxbyte);w.setAttribute("maxlength",this.attribute.maxlength);if(this.attribute.editable==false){document.getElementById(w.m_heCtrl.id).readOnly=true}else{w.m_heCtrl.removeAttribute("readOnly")}w.m_heCtrl.style.imeMode="auto";this.m_bInputKey=false}else{var d=0;var h=this.parent.getCellEx(x,v);var e=this.parent.getCellContentRect(x,v);if(SBGrid.DEF.SBIT_INPUTBUTTON==m||SBGrid.DEF.SBIT_INPUTDATE==m||SBGrid.DEF.SBIT_INPUTSPIN==m){d=18;e.setWidth(e.getWidth()-d)}var r=this.parent.getEditControl(SBGrid.DEF.SBIT_INPUT);var a=this.parent.editControlHeight(e.getHeight());if(a<e.getHeight()){e.setY(this.parent.getInputTopPosition(v));e.setHeight(a);nBttomRowHeight=null}r.setPosition(e);if((h.m_heCtrl.offsetWidth-d)<=r.m_heCtrl.offsetWidth){r.m_heCtrl.style.width=(e.getWidth()-(r.m_heCtrl.offsetWidth-(h.m_heCtrl.offsetWidth-d))-2)+"px"}if(h.m_heCtrl.offsetHeight<=r.m_heCtrl.offsetHeight){r.m_heCtrl.style.height=(e.getHeight()-(r.m_heCtrl.offsetHeight-h.m_heCtrl.offsetHeight)-2)+"px"}var n=this.getAttribute("format");n=null!=this.parent.m_htCellFormat[h.id]?this.parent.m_htCellFormat[h.id]:n;r.attribute.format=n;r.setAttribute("autonext",this.attribute.autonext);r.setAttribute("maxbyte",this.attribute.maxbyte);r.setAttribute("maxlength",this.attribute.maxlength);var l=r.getFormat();var t=SBGrid.CF.GridGetText(h);if(""!=n){l.m_strInputRealityData=t;l.init(n)}else{r.m_heCtrl.style.imeMode="auto"}if(!SBGrid.DEF.is_ie7&&!SBGrid.DEF.is_ie8){if(-1!=this.attribute.secretstartposition||-1!=this.attribute.secretendposition){r.m_heCtrl.type="password"}else{r.m_heCtrl.type="text"}}r.setEditText(t);this.m_bInputKey=false}return true}return false};SBGrid.CT.GridCol.prototype.onStartEdit=function(c){var d=this.getInputType();if(SBGrid.DEF.SBIT_INPUT==d||SBGrid.DEF.SBIT_TEXTAREA==d||SBGrid.DEF.SBIT_INPUTBUTTON==d||SBGrid.DEF.SBIT_INPUTDATE==d||SBGrid.DEF.SBIT_INPUTSPIN==d){if(SBGrid.DEF.SBIT_TEXTAREA!=d){var f=this.parent.getEditControl(SBGrid.DEF.SBIT_INPUT);if(null!=f){SBGrid.DS.SBBody.m_heCtrl.onselectstart=new Function("return true");f.setVisible(true,true);window.setTimeout('SBGrid.DEF.setFocus("'+f.getId()+'")',0);var e=f.m_heCtrlInput.getAttribute("id");window.setTimeout('document.getElementById("'+e+'").select()',0)}}else{if(SBGrid.DEF.SBIT_TEXTAREA===d){var a=this.parent.getEditControl(SBGrid.DEF.SBIT_TEXTAREA);if(null!=a){SBGrid.DS.SBBody.m_heCtrl.onselectstart=new Function("return true");a.setVisible(true,true);window.setTimeout('SBGrid.DEF.setFocus("'+a.getId()+'")',0);var b=a.m_heCtrl.getAttribute("id");if(a.m_heCtrl!=null){if(a.m_heCtrl.getAttribute("id")!=null){window.setTimeout('document.getElementById("'+b+'").select()',0)}}}}}return true}return false};SBGrid.CT.GridCol.prototype.setDisabled=function(b,a){};SBGrid.CT.GridCol.prototype.setAttribute=function(a,b){SBGrid.CT.GridCell.prototype.setAttribute.call(this,a,b);switch(a){case"disabled":if("true"==b){this.disabled=true}else{if("false"==b){this.disabled=false}}break;case"editable":if("true"==b){this.m_bEditable=true}else{if("false"==b){this.m_bEditable=false}}break}};SBGrid.CT.GridCol.prototype.onBlur=function(a){SBGrid.CT.GridCell.prototype.onBlur.call(this,a);if(SBGrid.DEF.SBIT_INPUTDATE==this.getInputType()&&-1==a.down.indexOf("calendar")){this.parent.m_bIsShowItem=false;this.m_objCalendar.setVisible(false)}};SBGrid.CT.GridCol.prototype.onDaySelect=function(c){var b=this.parent.getRow();var f=this.parent.getCol();var a=this.parent.getCellEx(b,f);if(null!=a){var d=SBGrid.CF.GridGetText(a);if(""==this.m_objCalendar.day){return}var e=(this.m_objCalendar.year).toString()+(parseInt(this.m_objCalendar.month)>9?(this.m_objCalendar.month).toString():"0"+this.m_objCalendar.month)+(parseInt(this.m_objCalendar.day)>9?(this.m_objCalendar.day).toString():"0"+this.m_objCalendar.day);if(d!=e){SBGrid.CF.GridSetText(a,e);a.setWindowText(e);this.parent.setRowStatus(a.row,this.parent.getRowStatus(a.row)|SBGrid.DEF.SBGS_UPDATE);if("true"!=this.getAttribute("skipvaluechanged")){this.dispatch("onvaluechanged");this.dispatch("SBUx_value_changed")}this.parent.refreshCurrentModel()}this.showCalendar(false)}};SBGrid.CT.GridCol.prototype.getColType=function(){return this.m_nInputType};SBGrid.CT.GridCol.prototype.defaultAction=function(b,a){SBGrid.CT.GridCell.prototype.defaultAction.call(this,b,a);switch(b){case"onbuttonclick":break;case"onhidepopup":if(this.m_objCalendar){this.parent.m_bIsShowItem=false;this.showCalendar(false);break}case"ondayselect":this.onDaySelect();break;case"onselect":break}};SBGrid.CT.GridCol.prototype._makeImage=function(b,c){var d="";var a=this.getAttribute("imageUri");if(""==a||"undifined"==a){d="<div class='sbgrid_datagrid_Image' height='100%' width='100%' id='"+c+"_data'><img src='"+b+"' align='center' alt='"+b+"'></img></div>"}else{d="<div class='sbgrid_datagrid_Image' height='100%' width='100%' id='"+c+"_data'><img src='' align='center' alt=''></img></div>"}return d};SBGrid.CT.GridCol.prototype._makeOutput=function(g,a){if(null==g){g=""}g=g.formatting(this.getAttribute("format"));var h=SBGrid.DEF.formatStatus(this.getAttribute("format"));if(h==4&&""!=this.attribute.roundmode&&""!=this.attribute.roundposition){g=SBGrid.DEF.getRoundMode(g,this.attribute.roundmode,this.attribute.roundposition)}if(""!=g&&(-1!=this.attribute.secretendposition||-1!=this.attribute.secretstartposition)){var d=-1==this.attribute.secretstartposition?0:this.attribute.secretstartposition;var b=-1==this.attribute.secretendposition?g.length:this.attribute.secretendposition;if(b>d){var n=this.attribute.secretmark;var l=g.substr(0,d);var e=g.substr(b,g.length);for(var f=d;f<b;f++){l+=n}g=l+e;n=null;l=null;e=null}d=null;b=null}var o=this.parent.autoResize?"break-word":"normal";var c="";if(this.parent.ellipsis){c="text-overflow:ellipsis;"}var m=new Array();m.push("<div class='sbgrid_datagrid_Output' id='"+a+"_data' style=\"word-wrap:"+o+";"+c+'">');if(this.parent.autoResize){m.push(g.newlineCharConvert())}else{m.push('<span style="white-space:nowrap;">'+g.newlineCharNoBrConvert()+"</span>")}m.push("</div>");o=null;c=null;return m.join("")};SBGrid.CT.GridCol.prototype._makeCombo=function(b,c){var a=this.m_objCombo;b=a.getLableByValue(b);a=null;return"<div class='sbgrid_datagrid_Combo' id='"+c+'_data\'><span style="white-space:nowrap;">'+b.newlineCharNoBrConvert()+"</span></div>"};SBGrid.CT.GridCol.prototype._makeInputButton=function(o,s,b,f,n){if(null==o){o=""}o=o.formatting(this.getAttribute("format"));if(""!=o&&(-1!=this.attribute.secretendposition||-1!=this.attribute.secretstartposition)){var h=-1==this.attribute.secretstartposition?0:this.attribute.secretstartposition;var c=-1==this.attribute.secretendposition?o.length:this.attribute.secretendposition;if(c>h){var r=this.attribute.secretmark;var p=o.substr(0,h);var l=o.substr(c,o.length);for(var m=h;m<c;m++){p+=r}o=p+l;r=null;p=null;l=null}}var t=this.parent.autoResize?"break-word":"normal";var e="";if(this.parent.ellipsis){e="text-overflow:ellipsis;"}var q=SBGrid.DEF.is_mozBrowser?"98%":"100%";var g=new Array();g.push("<table class='sbgrid_datagrid_InputButton_table' cellpadding=0 cellspacing=0 border=0 style=\"height:"+q+";\"><tr><td width='100%'>");g.push("<div class='sbgrid_datagrid_InputButtonDiv' id='"+b+"_data' Textflg='true' style=\"");g.push("word-wrap:"+t+";"+e+'">');if(this.parent.autoResize){g.push(o.newlineCharConvert())}else{g.push('<span style="white-space:nowrap;">'+o.newlineCharNoBrConvert()+"</span>")}g.push("</div>");g.push("</td><td width='18px' style='height:100%'>");var a="";a+=SBGrid.DEF.is_opera?"":"width:18px;";var d=(null!=this.parent.m_strCGButton||null!=this.m_strButtonCss)?"sbgrid_datagrid_IsInputButton":"sbgrid_datagrid_InputButton";if(""!=this.getAttribute("type")&&"undefined"!=this.getAttribute("type")&&null!=this.getAttribute("type")){if(this.getAttribute("type")=="inputdate"){d="sbgrid_datagrid_IsCalenderButton"}}g.push("<input type='button' class='"+d+" "+this.parent.m_strCGButton+" "+this.m_strButtonCss);g.push("' id='"+b+"_button' style=\""+a+'" onclick="return false;" Buttonflg="true"></input>');g.push("</td></tr></table>");return g.join("")};SBGrid.CT.GridCol.prototype._makeCheckbox=function(a){var b="";if(this.m_strTrueValue==a){b="<img title='체크박스 선택' style='vertical-align:middle;' src='"+this.getAttribute("checkimage")+"'>"}else{b="<img title='체크박스 해제' style='vertical-align:middle;' src='"+this.getAttribute("uncheckimage")+"'>"}return b};SBGrid.CT.GridCol.prototype._makeRadio=function(a){var b="";if(this.m_strTrueValue==a){b="<img title='라디오 선택' src='"+this.getAttribute("selectimage")+"'>"}else{b="<img title='라디오 해제' src='"+this.getAttribute("unselectimage")+"'>"}return b};SBGrid.CT.GridCol.prototype._makeRowHeaderSelect=function(a){var b="";b="<img src='"+SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHBlank+"'>";return b};SBGrid.CT.GridCol.prototype._makeRowHeaderUpdate=function(a){var b="";b="<div style='position:relative;left:0px;top:0px;height:100%;width:100%;overflow:hidden;background-image:url("+this.parent.m_strNormalFlagImage+");background-position:center center;'></div>";return b};SBGrid.CT.GridCol.prototype._makeRowHeaderSpan=function(a){var b="<span>"+a+"</span>";return b};SBGrid.CT.GridCol.create=function(B,I,S){var ae=true;var G=true;var x="";var c=I.item("checkvalue")?I.item("checkvalue"):"true,false";var o="";var Y=1;var ad=false;var X=false;var a=true;var O=true;var b="";var J="";var A="";var h="";var m="";var i=-1;var w=true;var Q="";var R="";var q=-1;var z=-1;var E="default";var af="";var P="";var u=0;var aa=1;var U="auto";var C=-1;var N="";var t=-1;var T="";var ai=false;var M=false;var l=false;var ac="output";var d="";var s="";var v="";var g="";var L="";var r="";var D="";var n="";var F="";var p=false;var K="visible";var ah="";var f="";var H="";var ag="";var V="";var W=false;var ab=false;var Z=true;var y=I.getCollection();for(var e in y){switch(e){case"allowuserresize":if("false"==y[e]){ae=false}break;case"autonext":if("false"==y[e]){G=false}break;case"checkimage":x=y[e];break;case"checkvalue":c=y[e];break;case"class":o=y[e];break;case"colspan":Y=parseInt(y[e]);break;case"disabled":if("true"==y[e]){ad=true}break;case"sortable":if("true"==y[e]){X=true}break;case"editable":if("false"==y[e]){a=false}break;case"editmode":b=y[e];break;case"explorerbar":J=y[e];case"format":A=y[e];break;case"id":h=y[e];break;case"imemode":m=y[e];break;case"itemcount":i=parseInt(y[e]);break;case"key":if("false"==y[e]){w=false}break;case"loadtype":Q=y[e];break;case"mask":R=y[e];break;case"showtoday":if("true"==y[e]){M=true}break;case"maxbyte":q=parseInt(y[e]);break;case"maxlength":z=parseInt(y[e]);break;case"pastemode":E=y[e];break;case"ref":af=y[e];break;case"roundmode":strRoundmode=y[e];break;case"roundposition":u=parseInt(y[e]);break;case"rowspan":aa=parseInt(y[e]);break;case"savetype":U=y[e];break;case"secretendposition":C=parseInt(y[e]);break;case"secretmark":N=y[e];break;case"secretstartposition":t=parseInt(y[e]);break;case"selectimage":T=y[e];break;case"showmask":if("true"==y[e]){ai=true}break;case"showvalue":if("true"==y[e]){l=true}break;case"type":ac=y[e];break;case"imageUri":d=y[e];break;case"imageWidth":s=y[e];break;case"imageHeight":v=y[e];break;case"imageStyle":g=y[e];break;case"imageClick":L=y[e];break;case"imageAlt":r=y[e];break;case"title":D=y[e];break;case"uncheckimage":n=y[e];break;case"unselectimage":F=y[e];break;case"validateformat":if("true"==y[e]){p=true}break;case"visibility":K=y[e];break;case"calc":ah=y[e];break;case"validate":V=y[e];break;case"checkboxValidate":H=y[e];break;case"textareaWidth":ag=y[e];break;case"datamerge":W=y[e];break;case"colhidden":ab=y[e];break;case"colcontext":Z=y[e];break;default:if(!SBGrid.DEF.SB_STYLELIST[e]){f+=e+":"+y[e]+"; "}break}}y=null;return new SBGrid.CT.GridCol(B,ae,G,x,c,o,Y,ad,X,a,O,b,J,A,h,m,i,w,Q,R,q,z,E,af,P,u,aa,U,C,N,t,T,ai,M,l,S,"softbowl:col",ac,d,s,v,g,L,r,D,n,F,p,K,ah,V,f,W,ab,H,ag,Z)};SBGrid.CT.ContextMenu=function(a,f,e,d,c,g,b){if(!f){return}SBGrid.CT.Element.call(this,a,f,e);this.m_strNodeset=d;this.m_strLabel=c;this.m_strFunctionName=g;this.m_bEvent=b};SBGrid.CT.ContextMenu.prototype=new SBGrid.CT.Element;SBGrid.CT.ContextMenu.prototype.createContextMenu=function(nLeft,nTop){var strRef=this.m_strNodeset;var objInstance=SBGrid.DS.XMLStorage.getUniqueStorage().getInstance();var xlNode;var bCheckInstance=false;if(objInstance){var xnRoot=objInstance.documentElement;if(xnRoot){xlNode=xnRoot.selectNodes(strRef);if(xlNode){for(var i=0;i<xlNode.length;i++){var xnNode=xlNode.item(i);var xnLabel=xnNode.selectSingleNode(this.m_strLabel);var xnFunction=xnNode.selectSingleNode(this.m_strFunctionName);if(xnLabel&&xnFunction){bCheckInstance=true;break}}}}}if(!bCheckInstance){return}var xnContextMenu=document.createElement("table");xnContextMenu.id="SBHE___SB_ContextMenu";xnContextMenu.cellSpacing=0;xnContextMenu.cellPadding=0;xnContextMenu.style.position="absolute";xnContextMenu.style.left=nLeft+"px";xnContextMenu.style.top=nTop+"px";xnContextMenu.style.border="1px solid #A0A0A0";xnContextMenu.style.backgroundColor="#F0F0F0";xnContextMenu.style.fontFamily=SBGrid.DEF.Lan_DefaultFontFamily;xnContextMenu.style.fontSize="9pt";xnContextMenu.style.color="#000000";xnContextMenu.style.cursor="default";var xnContextMenuTbody=document.createElement("tbody");for(var i=0;i<xlNode.length;i++){var xnNode=xlNode.item(i);var xnLabel=xnNode.selectSingleNode(this.m_strLabel);var xnFunction=xnNode.selectSingleNode(this.m_strFunctionName);if(!xnLabel||!xnFunction){continue}var strLabel=SBGrid.UT.XmlLib.getTextValue(xnLabel);var strFunction=SBGrid.UT.XmlLib.getTextValue(xnFunction);if(strFunction==""){var xnContextMenuTR1=document.createElement("tr");var xnContextMenuTD11=document.createElement("td");xnContextMenuTD11.style.width="28px";xnContextMenuTD11.style.height="1px";var xnContextMenuTD12=document.createElement("td");xnContextMenuTD12.style.width="1px";xnContextMenuTD12.style.backgroundColor="#E2E3E3";var xnContextMenuTD13=document.createElement("td");xnContextMenuTD13.style.width="1px";xnContextMenuTD13.style.backgroundColor="#FFFFFF";var xnContextMenuTD14=document.createElement("td");xnContextMenuTD14.style.width="120px";xnContextMenuTD14.style.backgroundColor="#E2E3E3";xnContextMenuTR1.appendChild(xnContextMenuTD11);xnContextMenuTR1.appendChild(xnContextMenuTD12);xnContextMenuTR1.appendChild(xnContextMenuTD13);xnContextMenuTR1.appendChild(xnContextMenuTD14);xnContextMenuTbody.appendChild(xnContextMenuTR1);var xnContextMenuTR2=document.createElement("tr");var xnContextMenuTD21=document.createElement("td");xnContextMenuTD21.style.width="28px";xnContextMenuTD21.style.height="1px";var xnContextMenuTD22=document.createElement("td");xnContextMenuTD22.style.width="1px";xnContextMenuTD22.style.backgroundColor="#E2E3E3";var xnContextMenuTD23=document.createElement("td");xnContextMenuTD23.style.width="1px";xnContextMenuTD23.style.backgroundColor="#FFFFFF";var xnContextMenuTD24=document.createElement("td");xnContextMenuTD24.style.width="120px";xnContextMenuTD24.style.backgroundColor="#FFFFFF";xnContextMenuTR2.appendChild(xnContextMenuTD21);xnContextMenuTR2.appendChild(xnContextMenuTD22);xnContextMenuTR2.appendChild(xnContextMenuTD23);xnContextMenuTR2.appendChild(xnContextMenuTD24);xnContextMenuTbody.appendChild(xnContextMenuTR2)}else{var xnContextMenuTR=document.createElement("tr");xnContextMenuTR.setAttribute("function",strFunction);xnContextMenuTR.onmouseover=function(){this.style.backgroundColor="#D3E9FE"};xnContextMenuTR.onmouseout=function(){this.style.backgroundColor=""};xnContextMenuTR.onclick=function(){try{if(SBGrid.DS.SBBody.children.item("__SB_ContextMenu").m_bEvent){SBGrid.DS.SBBody.dispatch("onmenu",this.getAttribute("function"))}else{eval(this.getAttribute("function")+"()")}window.top.document.body.removeChild(window.top.document.getElementById("SBHE___SB_ContextMenu"))}catch(e){window.top.document.body.removeChild(window.top.document.getElementById("SBHE___SB_ContextMenu"))}};var xnContextMenuTD1=document.createElement("td");xnContextMenuTD1.style.width="28px";xnContextMenuTD1.style.height="23px";var xnContextMenuTD2=document.createElement("td");xnContextMenuTD2.style.width="1px";xnContextMenuTD2.style.backgroundColor="#E2E3E3";var xnContextMenuTD3=document.createElement("td");xnContextMenuTD3.style.width="1px";xnContextMenuTD3.style.backgroundColor="#FFFFFF";var xnContextMenuTD4=document.createElement("td");xnContextMenuTD4.style.width="120px";xnContextMenuTD4.style.paddingLeft="5px";xnContextMenuTD4.style.paddingRight="10px";var xnContextMenuText=document.createElement("nobr");jQuery(xnContextMenuText).html(strLabel);xnContextMenuTD4.appendChild(xnContextMenuText);xnContextMenuTR.appendChild(xnContextMenuTD1);xnContextMenuTR.appendChild(xnContextMenuTD2);xnContextMenuTR.appendChild(xnContextMenuTD3);xnContextMenuTR.appendChild(xnContextMenuTD4);xnContextMenuTbody.appendChild(xnContextMenuTR)}}xnContextMenu.appendChild(xnContextMenuTbody);window.top.document.body.appendChild(xnContextMenu)};